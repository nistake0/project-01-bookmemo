# BookMemo UI/UX改善設計計画（2024-07-21）

## 1. 背景・目的

- 書籍詳細ページのユーザビリティ向上、およびメモ操作の体験改善を目指す。
- モバイルファーストな直感的UIを導入し、操作性・視認性・効率性を高める。
- テストの堅牢性・保守性も同時に担保する。

## 2. 現状の課題

- メモ一覧で詳細を見るには小さな編集ボタンを押す必要があり、操作しづらい。
- 削除ボタンも小さく、誤タップや押しづらさがある。
- メモ追加ボタンがリスト下部にあり、追加のたびにスクロールが必要。

## 3. 改善案一覧

### 3.1 メモ全体タップで詳細表示
- メモカード全体をタップ可能にし、どこを押しても詳細画面が開く。

### 3.2 Swipe Actions（スワイプで編集・削除）
- メモを左にスワイプすると、右側に編集・削除ボタンが現れるUI（iOS/Androidの標準的な「Swipe Actions」パターン）。
- 小さな編集・削除ボタンは廃止。

### 3.3 メモ追加ボタンの位置変更
- 書籍詳細のすぐ下、メモリストより上に「メモ追加」ボタンを配置。
- ボタン押下で追加ダイアログを表示。

### 3.4 Floating Action Button（FAB）の導入
- 画面右下に常時表示される「＋」ボタンでメモ追加。
- 書籍一覧ページでの書籍追加にも応用可能。

### 3.5 Pull to Refresh
- メモ一覧や書籍一覧で、リストを下方向にスワイプして最新データを取得。

### 3.6 その他の追加案
- 検索・フィルタ機能
- 並び替え機能
- Pull-to-RefreshやFABのアクセシビリティ対応

## 4. 各案の詳細・メリット・デメリット

### 4.1 メモ全体タップ
- **メリット**: 操作が直感的・タップ領域拡大・誤操作減少
- **デメリット**: 編集/削除の導線が隠れるため、別UIでの補完が必要

### 4.2 Swipe Actions
- **メリット**: UIがすっきり・誤操作防止・モバイル標準体験
- **デメリット**: 実装コスト・PCでは直感的でない・アクセシビリティ配慮が必要

### 4.3 メモ追加ボタンの位置変更
- **メリット**: 追加操作が容易・スクロール不要
- **デメリット**: UIの一貫性に注意

### 4.4 Floating Action Button（FAB）
- **利用場所**: 書籍詳細ページ右下（メモ追加）、書籍一覧ページ右下（書籍追加）
- **メリット**: 目立つ・どこでも押せる・UIがすっきり・モバイル標準
- **デメリット**: PCでは違和感・複数FABは混乱・アクセシビリティ対応が必要

### 4.5 Pull to Refresh
- **利用場所**: メモ一覧、書籍一覧
- **メリット**: 直感的・UIすっきり・再読込が簡単
- **デメリット**: PCで直感的でない・実装コスト・誤操作リスク・アクセシビリティ配慮

### 4.6 その他
- 検索・フィルタ: 大量メモ対応、利便性向上
- 並び替え: ユーザーの好みに応じた表示

## 5. テストへの影響と修正方針

### 5.1 影響を受ける主なテスト
- MemoList.test.jsx, MemoCard.test.jsx, BookDetail.test.jsx, E2Eテスト

### 5.2 修正方針
- ユニットテスト: data-testidの付与、スワイプ・タップ操作のシミュレーション
- E2Eテスト: スワイプ操作やFAB押下のシナリオ追加
- テストヘルパー: スワイプ操作のユーティリティ関数追加

## 6. 実装優先順位・今後の進め方

### Phase 1（高優先度）
1. メモ全体タップ可能化
2. メモ追加ボタンの位置変更 or FAB導入
3. Swipe Actionsの基本実装

### Phase 2（中優先度）
1. FABの本格導入
2. 検索・フィルタ機能

### Phase 3（低優先度）
1. Pull to Refresh
2. 並び替え機能

### その他検討事項
- アクセシビリティ対応（スワイプの代替手段、キーボード操作）
- パフォーマンス最適化（大量メモ時の仮想化等）
- 他リスト画面へのUIパターン展開

## 7. 実装戦略（2024-07-21再整理）

### 7.1 基本方針
- **段階的リリース**: 大きなUI変更は一度に全て行わず、ユーザー体験を損なわないよう段階的に導入
- **テストファースト**: 各段階でユニットテスト・E2Eテストを必ず整備・修正
- **アクセシビリティ配慮**: モバイル・PC両対応、キーボード操作やスクリーンリーダーも考慮
- **リファクタリングと新機能の分離**: UIリファクタと新機能追加はコミット・PRを分けて進行

### 7.2 段階的実装ステップ

#### Phase 1: 最小限のUX改善
- **メモ全体タップで詳細表示**
  - MemoCard全体にonClickを付与
  - 編集・削除ボタンは現状維持
  - テスト：クリックで詳細が開くことを確認
- **メモ追加ボタンの位置変更**
  - メモリスト上部 or FABの仮実装
  - テスト：追加ボタンの位置・動作確認

#### Phase 2: Swipe Actionsの導入
- **Swipe ActionsのUI/UX導入**
  - ライブラリ選定（例：react-swipeable-list等）
  - 編集・削除ボタンをスワイプで表示
  - 既存の小ボタンは廃止
  - テスト：スワイプでボタンが現れ、正しく動作すること
- **アクセシビリティの暫定対応**
  - スワイプできない環境向けに長押しやメニューも検討

#### Phase 3: FAB・Pull to Refreshの本格導入
- **FABの本格導入**
  - 画面右下に常時表示
  - メモ追加・書籍追加の両方に応用
  - テスト：FABの表示・動作確認
- **Pull to Refreshの導入**
  - メモ一覧・書籍一覧で下スワイプ更新
  - テスト：リスト更新の動作確認

#### Phase 4: 追加機能・最適化
- **検索・フィルタ・並び替え**
- **パフォーマンス最適化（仮想化等）**
- **アクセシビリティ最終調整**

### 7.3 テスト戦略

- **ユニットテスト**: 各UI部品の動作・イベント・状態遷移を検証
- **E2Eテスト**: Cypress等でユーザー操作フローを再現
- **テストヘルパー**: スワイプやタップのシミュレーション関数を共通化
- **回帰テスト**: 既存機能が壊れていないかを常に確認

### 7.4 リリース・レビュー戦略

- **小さなPR単位でのマージ**: 1つのUI改善ごとにPRを分け、レビューしやすく
- **ユーザーテスト**: 大きなUI変更時は一部ユーザーで先行テスト
- **段階的デプロイ**: 問題があればすぐにロールバックできる体制

### 7.5 技術的考慮事項

#### ライブラリ選定
- **Swipe Actions**: react-swipeable-list, @use-gesture/react等
- **FAB**: Material-UIのFabコンポーネント
- **Pull to Refresh**: react-pull-to-refresh等

#### パフォーマンス
- **仮想化**: 大量メモ時のreact-window等の検討
- **メモ化**: 不要な再レンダリングの防止
- **遅延読み込み**: 必要に応じてLazy Loading

#### アクセシビリティ
- **キーボードナビゲーション**: Tabキーでの操作対応
- **スクリーンリーダー**: ARIA属性の適切な設定
- **代替操作**: スワイプできない環境での代替手段

---

## 8. 作業用ブランチ運用方針（2024-07-21追記）

- **作業ブランチ名**: `feature/ui-ux-improvement-20240721`
- **目的**: 書籍詳細ページを中心としたUI/UX改善・Swipe Actions・FAB・Pull to Refresh等の大規模UIリファクタリング・新機能追加を安全に進めるため
- **運用方針**:
  - 本ブランチ上で段階的にUI/UX改善を実装
  - 各Phaseごとに小さなコミット・PRを作成し、mainブランチへのマージは十分なテスト・レビュー後に行う
  - ドキュメント・設計・テストコードも本ブランチで随時更新
  - 必要に応じてmainブランチの最新をrebase/mergeして取り込む

**作成日**: 2024-07-21
**作成者**: AI Assistant 