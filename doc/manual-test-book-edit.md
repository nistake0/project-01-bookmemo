# 書籍編集機能 手動確認ガイド

## 概要
- 書籍詳細画面から基本情報（タイトル／著者／出版社／出版日／書影URL）を編集できる新ダイアログの手動確認手順を示す。
- openBDを利用した書影取得ボタンや書影クリアボタンの動作も含めて検証する。

## 前提条件
- 書籍編集機能を含む最新ブランチをチェックアウトし、依存パッケージをインストール済み。
- テスト用Firebase環境にログイン可能で、少なくとも1冊以上の書籍が登録されていること。
- 書影未設定の書籍、ISBN付きの書籍があると確認がスムーズ。

## 環境セットアップ
1. 開発サーバーを起動  
   ```bash
   npm run dev
   ```
2. ブラウザ（Chrome推奨）で `https://localhost:5173/` を開き、テストユーザーでログイン。

## 検証手順

### 1. 編集ダイアログの起動
1. 書籍一覧／検索／タグから任意の書籍詳細ページを開く。
2. `書籍情報を編集` ボタン（BookInfo 上部）をクリック。  
   - 期待結果: 書籍情報編集ダイアログが表示され、既存のタイトル・著者・出版社等が入力済みになっている。

### 2. 基本フィールドの編集
1. タイトル・著者・出版社・出版日を変更し、「保存する」をクリック。
2. 保存成功後、ダイアログが閉じ、書籍詳細に変更が反映されることを確認。  
   - Firestore コンソール等でも変更内容が更新されていることを確認できるとなお良い。

### 3. バリデーション
1. タイトルを空欄にしたまま「保存する」をクリックする。  
   - 期待結果: 「タイトルは必須です。」エラーが表示され、保存できない。

### 4. 書影関連の操作
1. ISBNが設定されている書籍で「openBD書影を設定」をクリック。  
   - 期待結果: 書影URL欄に `https://cover.openbd.jp/<ISBN>.jpg` がセットされ、プレビューが更新される。
   - 表示されない場合はダイアログ内に「openBDの書影が見つかりませんでした。」が表示される。
2. 「書影をクリア」をクリック。  
   - 期待結果: URL欄が空になり、プレビューが非表示になる。

### 5. ISBN未設定時の挙動
1. ISBNが空の書籍を編集し、書影取得ボタンが無効化されていることを確認。

### 6. エラーハンドリング（任意）
- ネットワーク断やFirestore権限を調整して保存を失敗させ、ダイアログ内に「書籍情報の更新に失敗しました。」が表示されることを確認。

## 後片付け
- テストのために変更した書籍情報を元に戻す。
- 開発サーバーを停止する場合は、ターミナルで `Ctrl + C`。

## 補足
- 今後E2Eテストを追加する場合は、本ガイドをベースにシナリオ化する。
