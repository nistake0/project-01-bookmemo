var xm=Object.defineProperty;var ym=(r,e,t)=>e in r?xm(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var be=(r,e,t)=>ym(r,typeof e!="symbol"?e+"":e,t);import{r as reactExports,j as jsxRuntimeExports,B as Box,T as Typography,a as TextField,b as Button,C as Card,c as CardContent,d as CardMedia,e as Chip,P as Paper,R as React,D as Dialog,f as DialogTitle,g as DialogContent,A as Alert,h as DialogActions,i as Tooltip,I as IconButton,k as InstallIcon,l as Tabs,m as Tab,n as ToggleButtonGroup,o as ToggleButton,p as CircularProgress,S as SearchIcon,q as ClearIcon$1,L as List,s as ListItem,t as ListItemButton,u as ListItemText,v as DeleteIcon,w as Skeleton,H as HistoryIcon,F as FormControl,x as InputLabel,y as Select,M as MenuItem,z as Autocomplete,E as CameraAltIcon,G as Modal,J as useMediaQuery,K as Rating,N as CardActions,O as Stack,Q as EditIcon,U as FormLabel,V as ContentPasteIcon,W as Snackbar,X as KeyboardArrowDown,Y as Menu,_ as _extends,Z as _objectWithoutPropertiesLoose,$ as useThemeProps,a0 as createSvgIcon,a1 as generateUtilityClass,a2 as generateUtilityClasses,a3 as useRtl,a4 as useSlotProps,a5 as clsx,a6 as styled,a7 as composeClasses,a8 as useControlled,a9 as useEventCallback,aa as ownerDocument,ab as useForkRef,ac as useEnhancedEffect,ad as alpha,ae as MenuList,af as ButtonBase,ag as useTimeout,ah as useFormControl,ai as capitalize,aj as visuallyHidden,ak as shouldForwardProp,al as useId,am as FormHelperText,an as InputAdornment,ao as resolveComponentProps,ap as major,aq as useTheme,ar as Fade,as as TransitionGroup,at as CSSTransition,au as Grow,av as FocusTrap,aw as Popper,ax as dialogClasses,ay as tabsClasses,az as Divider,aA as PropTypes,aB as refType,aC as AddIcon,aD as ListItemIcon,aE as Avatar,aF as BookmarkAdded,aG as CheckCircle,aH as Refresh,aI as PlayArrow,aJ as Fab,aK as ownerWindow,aL as useLazyRef,aM as resolveProps,aN as NoSsr,aO as SpeedIcon,aP as StorageIcon,aQ as StarIcon,aR as CloseIcon,aS as OfflineIcon,aT as OnlineIcon,aU as createTheme,aV as ThemeProvider,aW as CssBaseline,aX as BottomNavigation,aY as BottomNavigationAction,aZ as LibraryBooksIcon,a_ as AddCircleIcon,a$ as BarChartIcon,b0 as PersonIcon}from"./mui-vendor-Cn_dOn-h.js";import{r as requireReact,a as requireReactDom,g as getDefaultExportFromCjs}from"./react-vendor-DJG_os-6.js";import{u as useNavigate,a as axios,b as useSwipeable,c as useParams,d as useLocation,H as HashRouter,R as Routes,e as Route,N as Navigate}from"./utils-vendor-C1pzEOFM.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,function(r){function e(ie,se){var ce=ie.length;ie.push(se);e:for(;0<ce;){var ue=ce-1>>>1,Ae=ie[ue];if(0<i(Ae,se))ie[ue]=se,ie[ce]=Ae,ce=ue;else break e}}function t(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var se=ie[0],ce=ie.pop();if(ce!==se){ie[0]=ce;e:for(var ue=0,Ae=ie.length,Se=Ae>>>1;ue<Se;){var ye=2*(ue+1)-1,he=ie[ye],ke=ye+1,Pe=ie[ke];if(0>i(he,ce))ke<Ae&&0>i(Pe,he)?(ie[ue]=Pe,ie[ke]=ce,ue=ke):(ie[ue]=he,ie[ye]=ce,ue=ye);else if(ke<Ae&&0>i(Pe,ce))ie[ue]=Pe,ie[ke]=ce,ue=ke;else break e}}return se}function i(ie,se){var ce=ie.sortIndex-se.sortIndex;return ce!==0?ce:ie.id-se.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();r.unstable_now=function(){return a.now()-o}}var c=[],h=[],f=1,m=null,g=3,_=!1,E=!1,A=!1,C=!1,I=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function V(ie){for(var se=t(h);se!==null;){if(se.callback===null)n(h);else if(se.startTime<=ie)n(h),se.sortIndex=se.expirationTime,e(c,se);else break;se=t(h)}}function U(ie){if(A=!1,V(ie),!E)if(t(c)!==null)E=!0,W||(W=!0,Y());else{var se=t(h);se!==null&&le(U,se.startTime-ie)}}var W=!1,j=-1,w=5,P=-1;function K(){return C?!0:!(r.unstable_now()-P<w)}function X(){if(C=!1,W){var ie=r.unstable_now();P=ie;var se=!0;try{e:{E=!1,A&&(A=!1,b(j),j=-1),_=!0;var ce=g;try{t:{for(V(ie),m=t(c);m!==null&&!(m.expirationTime>ie&&K());){var ue=m.callback;if(typeof ue=="function"){m.callback=null,g=m.priorityLevel;var Ae=ue(m.expirationTime<=ie);if(ie=r.unstable_now(),typeof Ae=="function"){m.callback=Ae,V(ie),se=!0;break t}m===t(c)&&n(c),V(ie)}else n(c);m=t(c)}if(m!==null)se=!0;else{var Se=t(h);Se!==null&&le(U,Se.startTime-ie),se=!1}}break e}finally{m=null,g=ce,_=!1}se=void 0}}finally{se?Y():W=!1}}}var Y;if(typeof R=="function")Y=function(){R(X)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,ae=Z.port2;Z.port1.onmessage=X,Y=function(){ae.postMessage(null)}}else Y=function(){I(X,0)};function le(ie,se){j=I(function(){ie(r.unstable_now())},se)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(ie){ie.callback=null},r.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<ie?Math.floor(1e3/ie):5},r.unstable_getCurrentPriorityLevel=function(){return g},r.unstable_next=function(ie){switch(g){case 1:case 2:case 3:var se=3;break;default:se=g}var ce=g;g=se;try{return ie()}finally{g=ce}},r.unstable_requestPaint=function(){C=!0},r.unstable_runWithPriority=function(ie,se){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var ce=g;g=ie;try{return se()}finally{g=ce}},r.unstable_scheduleCallback=function(ie,se,ce){var ue=r.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?ue+ce:ue):ce=ue,ie){case 1:var Ae=-1;break;case 2:Ae=250;break;case 5:Ae=1073741823;break;case 4:Ae=1e4;break;default:Ae=5e3}return Ae=ce+Ae,ie={id:f++,callback:se,priorityLevel:ie,startTime:ce,expirationTime:Ae,sortIndex:-1},ce>ue?(ie.sortIndex=ce,e(h,ie),t(c)===null&&ie===t(h)&&(A?(b(j),j=-1):A=!0,le(U,ce-ue))):(ie.sortIndex=Ae,e(c,ie),E||_||(E=!0,W||(W=!0,Y()))),ie},r.unstable_shouldYield=K,r.unstable_wrapCallback=function(ie){var se=g;return function(){var ce=g;g=se;try{return ie.apply(this,arguments)}finally{g=ce}}}}(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var r=requireScheduler(),e=requireReact(),t=requireReactDom();function n(l){var d="https://react.dev/errors/"+l;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+l+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(l){return!(!l||l.nodeType!==1&&l.nodeType!==9&&l.nodeType!==11)}function s(l){var d=l,p=l;if(l.alternate)for(;d.return;)d=d.return;else{l=d;do d=l,(d.flags&4098)!==0&&(p=d.return),l=d.return;while(l)}return d.tag===3?p:null}function a(l){if(l.tag===13){var d=l.memoizedState;if(d===null&&(l=l.alternate,l!==null&&(d=l.memoizedState)),d!==null)return d.dehydrated}return null}function o(l){if(s(l)!==l)throw Error(n(188))}function c(l){var d=l.alternate;if(!d){if(d=s(l),d===null)throw Error(n(188));return d!==l?null:l}for(var p=l,y=d;;){var T=p.return;if(T===null)break;var S=T.alternate;if(S===null){if(y=T.return,y!==null){p=y;continue}break}if(T.child===S.child){for(S=T.child;S;){if(S===p)return o(T),l;if(S===y)return o(T),d;S=S.sibling}throw Error(n(188))}if(p.return!==y.return)p=T,y=S;else{for(var ee=!1,te=T.child;te;){if(te===p){ee=!0,p=T,y=S;break}if(te===y){ee=!0,y=T,p=S;break}te=te.sibling}if(!ee){for(te=S.child;te;){if(te===p){ee=!0,p=S,y=T;break}if(te===y){ee=!0,y=S,p=T;break}te=te.sibling}if(!ee)throw Error(n(189))}}if(p.alternate!==y)throw Error(n(190))}if(p.tag!==3)throw Error(n(188));return p.stateNode.current===p?l:d}function h(l){var d=l.tag;if(d===5||d===26||d===27||d===6)return l;for(l=l.child;l!==null;){if(d=h(l),d!==null)return d;l=l.sibling}return null}var f=Object.assign,m=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),b=Symbol.for("react.consumer"),R=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),U=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),K=Symbol.for("react.memo_cache_sentinel"),X=Symbol.iterator;function Y(l){return l===null||typeof l!="object"?null:(l=X&&l[X]||l["@@iterator"],typeof l=="function"?l:null)}var Z=Symbol.for("react.client.reference");function ae(l){if(l==null)return null;if(typeof l=="function")return l.$$typeof===Z?null:l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case E:return"Fragment";case C:return"Profiler";case A:return"StrictMode";case U:return"Suspense";case W:return"SuspenseList";case P:return"Activity"}if(typeof l=="object")switch(l.$$typeof){case _:return"Portal";case R:return(l.displayName||"Context")+".Provider";case b:return(l._context.displayName||"Context")+".Consumer";case V:var d=l.render;return l=l.displayName,l||(l=d.displayName||d.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case j:return d=l.displayName||null,d!==null?d:ae(l.type)||"Memo";case w:d=l._payload,l=l._init;try{return ae(l(d))}catch{}}return null}var le=Array.isArray,ie=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ce={pending:!1,data:null,method:null,action:null},ue=[],Ae=-1;function Se(l){return{current:l}}function ye(l){0>Ae||(l.current=ue[Ae],ue[Ae]=null,Ae--)}function he(l,d){Ae++,ue[Ae]=l.current,l.current=d}var ke=Se(null),Pe=Se(null),Le=Se(null),$e=Se(null);function qe(l,d){switch(he(Le,d),he(Pe,l),he(ke,null),d.nodeType){case 9:case 11:l=(l=d.documentElement)&&(l=l.namespaceURI)?vf(l):0;break;default:if(l=d.tagName,d=d.namespaceURI)d=vf(d),l=Af(d,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}ye(ke),he(ke,l)}function xe(){ye(ke),ye(Pe),ye(Le)}function Ie(l){l.memoizedState!==null&&he($e,l);var d=ke.current,p=Af(d,l.type);d!==p&&(he(Pe,l),he(ke,p))}function Te(l){Pe.current===l&&(ye(ke),ye(Pe)),$e.current===l&&(ye($e),po._currentValue=ce)}var pe=Object.prototype.hasOwnProperty,Fe=r.unstable_scheduleCallback,Re=r.unstable_cancelCallback,Ue=r.unstable_shouldYield,Ve=r.unstable_requestPaint,Me=r.unstable_now,ze=r.unstable_getCurrentPriorityLevel,He=r.unstable_ImmediatePriority,Ne=r.unstable_UserBlockingPriority,Be=r.unstable_NormalPriority,et=r.unstable_LowPriority,nt=r.unstable_IdlePriority,ir=r.log,dr=r.unstable_setDisableYieldValue,Xe=null,Ke=null;function cr(l){if(typeof ir=="function"&&dr(l),Ke&&typeof Ke.setStrictMode=="function")try{Ke.setStrictMode(Xe,l)}catch{}}var We=Math.clz32?Math.clz32:Gt,tt=Math.log,It=Math.LN2;function Gt(l){return l>>>=0,l===0?32:31-(tt(l)/It|0)|0}var or=256,ur=4194304;function Lt(l){var d=l&42;if(d!==0)return d;switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return l&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return l}}function Lr(l,d,p){var y=l.pendingLanes;if(y===0)return 0;var T=0,S=l.suspendedLanes,ee=l.pingedLanes;l=l.warmLanes;var te=y&134217727;return te!==0?(y=te&~S,y!==0?T=Lt(y):(ee&=te,ee!==0?T=Lt(ee):p||(p=te&~l,p!==0&&(T=Lt(p))))):(te=y&~S,te!==0?T=Lt(te):ee!==0?T=Lt(ee):p||(p=y&~l,p!==0&&(T=Lt(p)))),T===0?0:d!==0&&d!==T&&(d&S)===0&&(S=T&-T,p=d&-d,S>=p||S===32&&(p&4194048)!==0)?d:T}function rt(l,d){return(l.pendingLanes&~(l.suspendedLanes&~l.pingedLanes)&d)===0}function pr(l,d){switch(l){case 1:case 2:case 4:case 8:case 64:return d+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function yr(){var l=or;return or<<=1,(or&4194048)===0&&(or=256),l}function jr(){var l=ur;return ur<<=1,(ur&62914560)===0&&(ur=4194304),l}function Wr(l){for(var d=[],p=0;31>p;p++)d.push(l);return d}function Ar(l,d){l.pendingLanes|=d,d!==268435456&&(l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0)}function Xi(l,d,p,y,T,S){var ee=l.pendingLanes;l.pendingLanes=p,l.suspendedLanes=0,l.pingedLanes=0,l.warmLanes=0,l.expiredLanes&=p,l.entangledLanes&=p,l.errorRecoveryDisabledLanes&=p,l.shellSuspendCounter=0;var te=l.entanglements,oe=l.expirationTimes,_e=l.hiddenUpdates;for(p=ee&~p;0<p;){var we=31-We(p),Oe=1<<we;te[we]=0,oe[we]=-1;var Ee=_e[we];if(Ee!==null)for(_e[we]=null,we=0;we<Ee.length;we++){var ve=Ee[we];ve!==null&&(ve.lane&=-536870913)}p&=~Oe}y!==0&&yn(l,y,0),S!==0&&T===0&&l.tag!==0&&(l.suspendedLanes|=S&~(ee&~d))}function yn(l,d,p){l.pendingLanes|=d,l.suspendedLanes&=~d;var y=31-We(d);l.entangledLanes|=d,l.entanglements[y]=l.entanglements[y]|1073741824|p&4194090}function bs(l,d){var p=l.entangledLanes|=d;for(l=l.entanglements;p;){var y=31-We(p),T=1<<y;T&d|l[y]&d&&(l[y]|=d),p&=~T}}function Zn(l){switch(l){case 2:l=1;break;case 8:l=4;break;case 32:l=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:l=128;break;case 268435456:l=134217728;break;default:l=0}return l}function sr(l){return l&=-l,2<l?8<l?(l&134217727)!==0?32:268435456:8:2}function Tr(){var l=se.p;return l!==0?l:(l=window.event,l===void 0?32:Uf(l.type))}function Ki(l,d){var p=se.p;try{return se.p=l,d()}finally{se.p=p}}var hr=Math.random().toString(36).slice(2),Rr="__reactFiber$"+hr,Cr="__reactProps$"+hr,En="__reactContainer$"+hr,ga="__reactEvents$"+hr,jl="__reactListeners$"+hr,Ti="__reactHandles$"+hr,_o="__reactResources$"+hr,Qi="__reactMarker$"+hr;function Ci(l){delete l[Rr],delete l[Cr],delete l[ga],delete l[jl],delete l[Ti]}function Jn(l){var d=l[Rr];if(d)return d;for(var p=l.parentNode;p;){if(d=p[En]||p[Rr]){if(p=d.alternate,d.child!==null||p!==null&&p.child!==null)for(l=If(l);l!==null;){if(p=l[Rr])return p;l=If(l)}return d}l=p,p=l.parentNode}return null}function Bn(l){if(l=l[Rr]||l[En]){var d=l.tag;if(d===5||d===6||d===13||d===26||d===27||d===3)return l}return null}function Ln(l){var d=l.tag;if(d===5||d===26||d===27||d===6)return l.stateNode;throw Error(n(33))}function Yr(l){var d=l[_o];return d||(d=l[_o]={hoistableStyles:new Map,hoistableScripts:new Map}),d}function _r(l){l[Qi]=!0}var xa=new Set,Rs={};function On(l,d){ei(l,d),ei(l+"Capture",d)}function ei(l,d){for(Rs[l]=d,l=0;l<d.length;l++)xa.add(d[l])}var Eo=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),vo={},Zi={};function Ao(l){return pe.call(Zi,l)?!0:pe.call(vo,l)?!1:Eo.test(l)?Zi[l]=!0:(vo[l]=!0,!1)}function Si(l,d,p){if(Ao(d))if(p===null)l.removeAttribute(d);else{switch(typeof p){case"undefined":case"function":case"symbol":l.removeAttribute(d);return;case"boolean":var y=d.toLowerCase().slice(0,5);if(y!=="data-"&&y!=="aria-"){l.removeAttribute(d);return}}l.setAttribute(d,""+p)}}function jn(l,d,p){if(p===null)l.removeAttribute(d);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(d);return}l.setAttribute(d,""+p)}}function Fr(l,d,p,y){if(y===null)l.removeAttribute(p);else{switch(typeof y){case"undefined":case"function":case"symbol":case"boolean":l.removeAttribute(p);return}l.setAttributeNS(d,p,""+y)}}var Ji,To;function ti(l){if(Ji===void 0)try{throw Error()}catch(p){var d=p.stack.trim().match(/\n( *(at )?)/);Ji=d&&d[1]||"",To=-1<p.stack.indexOf(`
    at`)?" (<anonymous>)":-1<p.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ji+l+To}var ws=!1;function Ps(l,d){if(!l||ws)return"";ws=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var y={DetermineComponentFrameRoot:function(){try{if(d){var Oe=function(){throw Error()};if(Object.defineProperty(Oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Oe,[])}catch(ve){var Ee=ve}Reflect.construct(l,[],Oe)}else{try{Oe.call()}catch(ve){Ee=ve}l.call(Oe.prototype)}}else{try{throw Error()}catch(ve){Ee=ve}(Oe=l())&&typeof Oe.catch=="function"&&Oe.catch(function(){})}}catch(ve){if(ve&&Ee&&typeof ve.stack=="string")return[ve.stack,Ee.stack]}return[null,null]}};y.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var T=Object.getOwnPropertyDescriptor(y.DetermineComponentFrameRoot,"name");T&&T.configurable&&Object.defineProperty(y.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=y.DetermineComponentFrameRoot(),ee=S[0],te=S[1];if(ee&&te){var oe=ee.split(`
`),_e=te.split(`
`);for(T=y=0;y<oe.length&&!oe[y].includes("DetermineComponentFrameRoot");)y++;for(;T<_e.length&&!_e[T].includes("DetermineComponentFrameRoot");)T++;if(y===oe.length||T===_e.length)for(y=oe.length-1,T=_e.length-1;1<=y&&0<=T&&oe[y]!==_e[T];)T--;for(;1<=y&&0<=T;y--,T--)if(oe[y]!==_e[T]){if(y!==1||T!==1)do if(y--,T--,0>T||oe[y]!==_e[T]){var we=`
`+oe[y].replace(" at new "," at ");return l.displayName&&we.includes("<anonymous>")&&(we=we.replace("<anonymous>",l.displayName)),we}while(1<=y&&0<=T);break}}}finally{ws=!1,Error.prepareStackTrace=p}return(p=l?l.displayName||l.name:"")?ti(p):""}function ya(l){switch(l.tag){case 26:case 27:case 5:return ti(l.type);case 16:return ti("Lazy");case 13:return ti("Suspense");case 19:return ti("SuspenseList");case 0:case 15:return Ps(l.type,!1);case 11:return Ps(l.type.render,!1);case 1:return Ps(l.type,!0);case 31:return ti("Activity");default:return""}}function Ds(l){try{var d="";do d+=ya(l),l=l.return;while(l);return d}catch(p){return`
Error generating stack: `+p.message+`
`+p.stack}}function qr(l){switch(typeof l){case"bigint":case"boolean":case"number":case"string":case"undefined":return l;case"object":return l;default:return""}}function Ea(l){var d=l.type;return(l=l.nodeName)&&l.toLowerCase()==="input"&&(d==="checkbox"||d==="radio")}function Fl(l){var d=Ea(l)?"checked":"value",p=Object.getOwnPropertyDescriptor(l.constructor.prototype,d),y=""+l[d];if(!l.hasOwnProperty(d)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var T=p.get,S=p.set;return Object.defineProperty(l,d,{configurable:!0,get:function(){return T.call(this)},set:function(ee){y=""+ee,S.call(this,ee)}}),Object.defineProperty(l,d,{enumerable:p.enumerable}),{getValue:function(){return y},setValue:function(ee){y=""+ee},stopTracking:function(){l._valueTracker=null,delete l[d]}}}}function Os(l){l._valueTracker||(l._valueTracker=Fl(l))}function va(l){if(!l)return!1;var d=l._valueTracker;if(!d)return!0;var p=d.getValue(),y="";return l&&(y=Ea(l)?l.checked?"true":"false":l.value),l=y,l!==p?(d.setValue(l),!0):!1}function es(l){if(l=l||(typeof document<"u"?document:void 0),typeof l>"u")return null;try{return l.activeElement||l.body}catch{return l.body}}var Ul=/[\n"\\]/g;function Sr(l){return l.replace(Ul,function(d){return"\\"+d.charCodeAt(0).toString(16)+" "})}function un(l,d,p,y,T,S,ee,te){l.name="",ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"?l.type=ee:l.removeAttribute("type"),d!=null?ee==="number"?(d===0&&l.value===""||l.value!=d)&&(l.value=""+qr(d)):l.value!==""+qr(d)&&(l.value=""+qr(d)):ee!=="submit"&&ee!=="reset"||l.removeAttribute("value"),d!=null?Ii(l,ee,qr(d)):p!=null?Ii(l,ee,qr(p)):y!=null&&l.removeAttribute("value"),T==null&&S!=null&&(l.defaultChecked=!!S),T!=null&&(l.checked=T&&typeof T!="function"&&typeof T!="symbol"),te!=null&&typeof te!="function"&&typeof te!="symbol"&&typeof te!="boolean"?l.name=""+qr(te):l.removeAttribute("name")}function ts(l,d,p,y,T,S,ee,te){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(l.type=S),d!=null||p!=null){if(!(S!=="submit"&&S!=="reset"||d!=null))return;p=p!=null?""+qr(p):"",d=d!=null?""+qr(d):p,te||d===l.value||(l.value=d),l.defaultValue=d}y=y??T,y=typeof y!="function"&&typeof y!="symbol"&&!!y,l.checked=te?l.checked:!!y,l.defaultChecked=!!y,ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"&&(l.name=ee)}function Ii(l,d,p){d==="number"&&es(l.ownerDocument)===l||l.defaultValue===""+p||(l.defaultValue=""+p)}function ri(l,d,p,y){if(l=l.options,d){d={};for(var T=0;T<p.length;T++)d["$"+p[T]]=!0;for(p=0;p<l.length;p++)T=d.hasOwnProperty("$"+l[p].value),l[p].selected!==T&&(l[p].selected=T),T&&y&&(l[p].defaultSelected=!0)}else{for(p=""+qr(p),d=null,T=0;T<l.length;T++){if(l[T].value===p){l[T].selected=!0,y&&(l[T].defaultSelected=!0);return}d!==null||l[T].disabled||(d=l[T])}d!==null&&(d.selected=!0)}}function er(l,d,p){if(d!=null&&(d=""+qr(d),d!==l.value&&(l.value=d),p==null)){l.defaultValue!==d&&(l.defaultValue=d);return}l.defaultValue=p!=null?""+qr(p):""}function rs(l,d,p,y){if(d==null){if(y!=null){if(p!=null)throw Error(n(92));if(le(y)){if(1<y.length)throw Error(n(93));y=y[0]}p=y}p==null&&(p=""),d=p}p=qr(d),l.defaultValue=p,y=l.textContent,y===p&&y!==""&&y!==null&&(l.value=y)}function vn(l,d){if(d){var p=l.firstChild;if(p&&p===l.lastChild&&p.nodeType===3){p.nodeValue=d;return}}l.textContent=d}var ns=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Co(l,d,p){var y=d.indexOf("--")===0;p==null||typeof p=="boolean"||p===""?y?l.setProperty(d,""):d==="float"?l.cssFloat="":l[d]="":y?l.setProperty(d,p):typeof p!="number"||p===0||ns.has(d)?d==="float"?l.cssFloat=p:l[d]=(""+p).trim():l[d]=p+"px"}function Aa(l,d,p){if(d!=null&&typeof d!="object")throw Error(n(62));if(l=l.style,p!=null){for(var y in p)!p.hasOwnProperty(y)||d!=null&&d.hasOwnProperty(y)||(y.indexOf("--")===0?l.setProperty(y,""):y==="float"?l.cssFloat="":l[y]="");for(var T in d)y=d[T],d.hasOwnProperty(T)&&p[T]!==y&&Co(l,T,y)}else for(var S in d)d.hasOwnProperty(S)&&Co(l,S,d[S])}function Ta(l){if(l.indexOf("-")===-1)return!1;switch(l){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $l=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Hl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ms(l){return Hl.test(""+l)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":l}var ni=null;function An(l){return l=l.target||l.srcElement||window,l.correspondingUseElement&&(l=l.correspondingUseElement),l.nodeType===3?l.parentNode:l}var ii=null,si=null;function Ca(l){var d=Bn(l);if(d&&(l=d.stateNode)){var p=l[Cr]||null;e:switch(l=d.stateNode,d.type){case"input":if(un(l,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name),d=p.name,p.type==="radio"&&d!=null){for(p=l;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll('input[name="'+Sr(""+d)+'"][type="radio"]'),d=0;d<p.length;d++){var y=p[d];if(y!==l&&y.form===l.form){var T=y[Cr]||null;if(!T)throw Error(n(90));un(y,T.value,T.defaultValue,T.defaultValue,T.checked,T.defaultChecked,T.type,T.name)}}for(d=0;d<p.length;d++)y=p[d],y.form===l.form&&va(y)}break e;case"textarea":er(l,p.value,p.defaultValue);break e;case"select":d=p.value,d!=null&&ri(l,!!p.multiple,d,!1)}}}var Fn=!1;function So(l,d,p){if(Fn)return l(d,p);Fn=!0;try{var y=l(d);return y}finally{if(Fn=!1,(ii!==null||si!==null)&&(yl(),ii&&(d=ii,l=si,si=ii=null,Ca(d),l)))for(d=0;d<l.length;d++)Ca(l[d])}}function ss(l,d){var p=l.stateNode;if(p===null)return null;var y=p[Cr]||null;if(y===null)return null;p=y[d];e:switch(d){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(l=l.type,y=!(l==="button"||l==="input"||l==="select"||l==="textarea")),l=!y;break e;default:l=!1}if(l)return null;if(p&&typeof p!="function")throw Error(n(231,d,typeof p));return p}var Mn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tn=!1;if(Mn)try{var as={};Object.defineProperty(as,"passive",{get:function(){Tn=!0}}),window.addEventListener("test",as,as),window.removeEventListener("test",as,as)}catch{Tn=!1}var Un=null,bi=null,ai=null;function Sa(){if(ai)return ai;var l,d=bi,p=d.length,y,T="value"in Un?Un.value:Un.textContent,S=T.length;for(l=0;l<p&&d[l]===T[l];l++);var ee=p-l;for(y=1;y<=ee&&d[p-y]===T[S-y];y++);return ai=T.slice(l,1<y?1-y:void 0)}function $n(l){var d=l.keyCode;return"charCode"in l?(l=l.charCode,l===0&&d===13&&(l=13)):l=d,l===10&&(l=13),32<=l||l===13?l:0}function Hn(){return!0}function Ia(){return!1}function Mr(l){function d(p,y,T,S,ee){this._reactName=p,this._targetInst=T,this.type=y,this.nativeEvent=S,this.target=ee,this.currentTarget=null;for(var te in l)l.hasOwnProperty(te)&&(p=l[te],this[te]=p?p(S):S[te]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?Hn:Ia,this.isPropagationStopped=Ia,this}return f(d.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Hn)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Hn)},persist:function(){},isPersistent:Hn}),d}var Wt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(l){return l.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ks=Mr(Wt),os=f({},Wt,{view:0,detail:0}),Io=Mr(os),Ns,Vs,zn,ls=f({},os,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ds,button:0,buttons:0,relatedTarget:function(l){return l.relatedTarget===void 0?l.fromElement===l.srcElement?l.toElement:l.fromElement:l.relatedTarget},movementX:function(l){return"movementX"in l?l.movementX:(l!==zn&&(zn&&l.type==="mousemove"?(Ns=l.screenX-zn.screenX,Vs=l.screenY-zn.screenY):Vs=Ns=0,zn=l),Ns)},movementY:function(l){return"movementY"in l?l.movementY:Vs}}),Cn=Mr(ls),bo=f({},ls,{dataTransfer:0}),zl=Mr(bo),cs=f({},os,{relatedTarget:0}),Bs=Mr(cs),ba=f({},Wt,{animationName:0,elapsedTime:0,pseudoElement:0}),Ls=Mr(ba),Ro=f({},Wt,{clipboardData:function(l){return"clipboardData"in l?l.clipboardData:window.clipboardData}}),js=Mr(Ro),Gl=f({},Wt,{data:0}),Ra=Mr(Gl),us={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Po={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wa(l){var d=this.nativeEvent;return d.getModifierState?d.getModifierState(l):(l=Po[l])?!!d[l]:!1}function ds(){return wa}var Do=f({},os,{key:function(l){if(l.key){var d=us[l.key]||l.key;if(d!=="Unidentified")return d}return l.type==="keypress"?(l=$n(l),l===13?"Enter":String.fromCharCode(l)):l.type==="keydown"||l.type==="keyup"?wo[l.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ds,charCode:function(l){return l.type==="keypress"?$n(l):0},keyCode:function(l){return l.type==="keydown"||l.type==="keyup"?l.keyCode:0},which:function(l){return l.type==="keypress"?$n(l):l.type==="keydown"||l.type==="keyup"?l.keyCode:0}}),Fs=Mr(Do),Oo=f({},ls,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pa=Mr(Oo),oi=f({},os,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ds}),Mo=Mr(oi),ko=f({},Wt,{propertyName:0,elapsedTime:0,pseudoElement:0}),No=Mr(ko),Vo=f({},ls,{deltaX:function(l){return"deltaX"in l?l.deltaX:"wheelDeltaX"in l?-l.wheelDeltaX:0},deltaY:function(l){return"deltaY"in l?l.deltaY:"wheelDeltaY"in l?-l.wheelDeltaY:"wheelDelta"in l?-l.wheelDelta:0},deltaZ:0,deltaMode:0}),Us=Mr(Vo),Xr=f({},Wt,{newState:0,oldState:0}),Bo=Mr(Xr),Lo=[9,13,27,32],Gn=Mn&&"CompositionEvent"in window,v=null;Mn&&"documentMode"in document&&(v=document.documentMode);var H=Mn&&"TextEvent"in window&&!v,J=Mn&&(!Gn||v&&8<v&&11>=v),ne=" ",me=!1;function Ce(l,d){switch(l){case"keyup":return Lo.indexOf(d.keyCode)!==-1;case"keydown":return d.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function je(l){return l=l.detail,typeof l=="object"&&"data"in l?l.data:null}var Dt=!1;function wr(l,d){switch(l){case"compositionend":return je(d);case"keypress":return d.which!==32?null:(me=!0,ne);case"textInput":return l=d.data,l===ne&&me?null:l;default:return null}}function kt(l,d){if(Dt)return l==="compositionend"||!Gn&&Ce(l,d)?(l=Sa(),ai=bi=Un=null,Dt=!1,l):null;switch(l){case"paste":return null;case"keypress":if(!(d.ctrlKey||d.altKey||d.metaKey)||d.ctrlKey&&d.altKey){if(d.char&&1<d.char.length)return d.char;if(d.which)return String.fromCharCode(d.which)}return null;case"compositionend":return J&&d.locale!=="ko"?null:d.data;default:return null}}var kr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pr(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d==="input"?!!kr[l.type]:d==="textarea"}function li(l,d,p,y){ii?si?si.push(y):si=[y]:ii=y,d=Cl(d,"onChange"),0<d.length&&(p=new ks("onChange","change",null,p,y),l.push({event:p,listeners:d}))}var Ur=null,Wn=null;function Da(l){gf(l,0)}function jo(l){var d=Ln(l);if(va(d))return l}function Vu(l,d){if(l==="change")return d}var Bu=!1;if(Mn){var Wl;if(Mn){var Yl="oninput"in document;if(!Yl){var Lu=document.createElement("div");Lu.setAttribute("oninput","return;"),Yl=typeof Lu.oninput=="function"}Wl=Yl}else Wl=!1;Bu=Wl&&(!document.documentMode||9<document.documentMode)}function ju(){Ur&&(Ur.detachEvent("onpropertychange",Fu),Wn=Ur=null)}function Fu(l){if(l.propertyName==="value"&&jo(Wn)){var d=[];li(d,Wn,l,An(l)),So(Da,d)}}function Yf(l,d,p){l==="focusin"?(ju(),Ur=d,Wn=p,Ur.attachEvent("onpropertychange",Fu)):l==="focusout"&&ju()}function qf(l){if(l==="selectionchange"||l==="keyup"||l==="keydown")return jo(Wn)}function Xf(l,d){if(l==="click")return jo(d)}function Kf(l,d){if(l==="input"||l==="change")return jo(d)}function Qf(l,d){return l===d&&(l!==0||1/l===1/d)||l!==l&&d!==d}var dn=typeof Object.is=="function"?Object.is:Qf;function Oa(l,d){if(dn(l,d))return!0;if(typeof l!="object"||l===null||typeof d!="object"||d===null)return!1;var p=Object.keys(l),y=Object.keys(d);if(p.length!==y.length)return!1;for(y=0;y<p.length;y++){var T=p[y];if(!pe.call(d,T)||!dn(l[T],d[T]))return!1}return!0}function Uu(l){for(;l&&l.firstChild;)l=l.firstChild;return l}function $u(l,d){var p=Uu(l);l=0;for(var y;p;){if(p.nodeType===3){if(y=l+p.textContent.length,l<=d&&y>=d)return{node:p,offset:d-l};l=y}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Uu(p)}}function Hu(l,d){return l&&d?l===d?!0:l&&l.nodeType===3?!1:d&&d.nodeType===3?Hu(l,d.parentNode):"contains"in l?l.contains(d):l.compareDocumentPosition?!!(l.compareDocumentPosition(d)&16):!1:!1}function zu(l){l=l!=null&&l.ownerDocument!=null&&l.ownerDocument.defaultView!=null?l.ownerDocument.defaultView:window;for(var d=es(l.document);d instanceof l.HTMLIFrameElement;){try{var p=typeof d.contentWindow.location.href=="string"}catch{p=!1}if(p)l=d.contentWindow;else break;d=es(l.document)}return d}function ql(l){var d=l&&l.nodeName&&l.nodeName.toLowerCase();return d&&(d==="input"&&(l.type==="text"||l.type==="search"||l.type==="tel"||l.type==="url"||l.type==="password")||d==="textarea"||l.contentEditable==="true")}var Zf=Mn&&"documentMode"in document&&11>=document.documentMode,$s=null,Xl=null,Ma=null,Kl=!1;function Gu(l,d,p){var y=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Kl||$s==null||$s!==es(y)||(y=$s,"selectionStart"in y&&ql(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Ma&&Oa(Ma,y)||(Ma=y,y=Cl(Xl,"onSelect"),0<y.length&&(d=new ks("onSelect","select",null,d,p),l.push({event:d,listeners:y}),d.target=$s)))}function hs(l,d){var p={};return p[l.toLowerCase()]=d.toLowerCase(),p["Webkit"+l]="webkit"+d,p["Moz"+l]="moz"+d,p}var Hs={animationend:hs("Animation","AnimationEnd"),animationiteration:hs("Animation","AnimationIteration"),animationstart:hs("Animation","AnimationStart"),transitionrun:hs("Transition","TransitionRun"),transitionstart:hs("Transition","TransitionStart"),transitioncancel:hs("Transition","TransitionCancel"),transitionend:hs("Transition","TransitionEnd")},Ql={},Wu={};Mn&&(Wu=document.createElement("div").style,"AnimationEvent"in window||(delete Hs.animationend.animation,delete Hs.animationiteration.animation,delete Hs.animationstart.animation),"TransitionEvent"in window||delete Hs.transitionend.transition);function fs(l){if(Ql[l])return Ql[l];if(!Hs[l])return l;var d=Hs[l],p;for(p in d)if(d.hasOwnProperty(p)&&p in Wu)return Ql[l]=d[p];return l}var Yu=fs("animationend"),qu=fs("animationiteration"),Xu=fs("animationstart"),Jf=fs("transitionrun"),ep=fs("transitionstart"),tp=fs("transitioncancel"),Ku=fs("transitionend"),Qu=new Map,Zl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Zl.push("scrollEnd");function kn(l,d){Qu.set(l,d),On(d,[l])}var Zu=new WeakMap;function Sn(l,d){if(typeof l=="object"&&l!==null){var p=Zu.get(l);return p!==void 0?p:(d={value:l,source:d,stack:Ds(d)},Zu.set(l,d),d)}return{value:l,source:d,stack:Ds(d)}}var In=[],zs=0,Jl=0;function Fo(){for(var l=zs,d=Jl=zs=0;d<l;){var p=In[d];In[d++]=null;var y=In[d];In[d++]=null;var T=In[d];In[d++]=null;var S=In[d];if(In[d++]=null,y!==null&&T!==null){var ee=y.pending;ee===null?T.next=T:(T.next=ee.next,ee.next=T),y.pending=T}S!==0&&Ju(p,T,S)}}function Uo(l,d,p,y){In[zs++]=l,In[zs++]=d,In[zs++]=p,In[zs++]=y,Jl|=y,l.lanes|=y,l=l.alternate,l!==null&&(l.lanes|=y)}function ec(l,d,p,y){return Uo(l,d,p,y),$o(l)}function Gs(l,d){return Uo(l,null,null,d),$o(l)}function Ju(l,d,p){l.lanes|=p;var y=l.alternate;y!==null&&(y.lanes|=p);for(var T=!1,S=l.return;S!==null;)S.childLanes|=p,y=S.alternate,y!==null&&(y.childLanes|=p),S.tag===22&&(l=S.stateNode,l===null||l._visibility&1||(T=!0)),l=S,S=S.return;return l.tag===3?(S=l.stateNode,T&&d!==null&&(T=31-We(p),l=S.hiddenUpdates,y=l[T],y===null?l[T]=[d]:y.push(d),d.lane=p|536870912),S):null}function $o(l){if(50<so)throw so=0,au=null,Error(n(185));for(var d=l.return;d!==null;)l=d,d=l.return;return l.tag===3?l.stateNode:null}var Ws={};function rp(l,d,p,y){this.tag=l,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=d,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function hn(l,d,p,y){return new rp(l,d,p,y)}function tc(l){return l=l.prototype,!(!l||!l.isReactComponent)}function ci(l,d){var p=l.alternate;return p===null?(p=hn(l.tag,d,l.key,l.mode),p.elementType=l.elementType,p.type=l.type,p.stateNode=l.stateNode,p.alternate=l,l.alternate=p):(p.pendingProps=d,p.type=l.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=l.flags&65011712,p.childLanes=l.childLanes,p.lanes=l.lanes,p.child=l.child,p.memoizedProps=l.memoizedProps,p.memoizedState=l.memoizedState,p.updateQueue=l.updateQueue,d=l.dependencies,p.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext},p.sibling=l.sibling,p.index=l.index,p.ref=l.ref,p.refCleanup=l.refCleanup,p}function ed(l,d){l.flags&=65011714;var p=l.alternate;return p===null?(l.childLanes=0,l.lanes=d,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=p.childLanes,l.lanes=p.lanes,l.child=p.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=p.memoizedProps,l.memoizedState=p.memoizedState,l.updateQueue=p.updateQueue,l.type=p.type,d=p.dependencies,l.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),l}function Ho(l,d,p,y,T,S){var ee=0;if(y=l,typeof l=="function")tc(l)&&(ee=1);else if(typeof l=="string")ee=im(l,p,ke.current)?26:l==="html"||l==="head"||l==="body"?27:5;else e:switch(l){case P:return l=hn(31,p,d,T),l.elementType=P,l.lanes=S,l;case E:return ps(p.children,T,S,d);case A:ee=8,T|=24;break;case C:return l=hn(12,p,d,T|2),l.elementType=C,l.lanes=S,l;case U:return l=hn(13,p,d,T),l.elementType=U,l.lanes=S,l;case W:return l=hn(19,p,d,T),l.elementType=W,l.lanes=S,l;default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case I:case R:ee=10;break e;case b:ee=9;break e;case V:ee=11;break e;case j:ee=14;break e;case w:ee=16,y=null;break e}ee=29,p=Error(n(130,l===null?"null":typeof l,"")),y=null}return d=hn(ee,p,d,T),d.elementType=l,d.type=y,d.lanes=S,d}function ps(l,d,p,y){return l=hn(7,l,y,d),l.lanes=p,l}function rc(l,d,p){return l=hn(6,l,null,d),l.lanes=p,l}function nc(l,d,p){return d=hn(4,l.children!==null?l.children:[],l.key,d),d.lanes=p,d.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},d}var Ys=[],qs=0,zo=null,Go=0,bn=[],Rn=0,ms=null,ui=1,di="";function gs(l,d){Ys[qs++]=Go,Ys[qs++]=zo,zo=l,Go=d}function td(l,d,p){bn[Rn++]=ui,bn[Rn++]=di,bn[Rn++]=ms,ms=l;var y=ui;l=di;var T=32-We(y)-1;y&=~(1<<T),p+=1;var S=32-We(d)+T;if(30<S){var ee=T-T%5;S=(y&(1<<ee)-1).toString(32),y>>=ee,T-=ee,ui=1<<32-We(d)+T|p<<T|y,di=S+l}else ui=1<<S|p<<T|y,di=l}function ic(l){l.return!==null&&(gs(l,1),td(l,1,0))}function sc(l){for(;l===zo;)zo=Ys[--qs],Ys[qs]=null,Go=Ys[--qs],Ys[qs]=null;for(;l===ms;)ms=bn[--Rn],bn[Rn]=null,di=bn[--Rn],bn[Rn]=null,ui=bn[--Rn],bn[Rn]=null}var Kr=null,gr=null,Ut=!1,xs=null,Yn=!1,ac=Error(n(519));function ys(l){var d=Error(n(418,""));throw Va(Sn(d,l)),ac}function rd(l){var d=l.stateNode,p=l.type,y=l.memoizedProps;switch(d[Rr]=l,d[Cr]=y,p){case"dialog":Ct("cancel",d),Ct("close",d);break;case"iframe":case"object":case"embed":Ct("load",d);break;case"video":case"audio":for(p=0;p<oo.length;p++)Ct(oo[p],d);break;case"source":Ct("error",d);break;case"img":case"image":case"link":Ct("error",d),Ct("load",d);break;case"details":Ct("toggle",d);break;case"input":Ct("invalid",d),ts(d,y.value,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name,!0),Os(d);break;case"select":Ct("invalid",d);break;case"textarea":Ct("invalid",d),rs(d,y.value,y.defaultValue,y.children),Os(d)}p=y.children,typeof p!="string"&&typeof p!="number"&&typeof p!="bigint"||d.textContent===""+p||y.suppressHydrationWarning===!0||Ef(d.textContent,p)?(y.popover!=null&&(Ct("beforetoggle",d),Ct("toggle",d)),y.onScroll!=null&&Ct("scroll",d),y.onScrollEnd!=null&&Ct("scrollend",d),y.onClick!=null&&(d.onclick=Sl),d=!0):d=!1,d||ys(l)}function nd(l){for(Kr=l.return;Kr;)switch(Kr.tag){case 5:case 13:Yn=!1;return;case 27:case 3:Yn=!0;return;default:Kr=Kr.return}}function ka(l){if(l!==Kr)return!1;if(!Ut)return nd(l),Ut=!0,!1;var d=l.tag,p;if((p=d!==3&&d!==27)&&((p=d===5)&&(p=l.type,p=!(p!=="form"&&p!=="button")||Au(l.type,l.memoizedProps)),p=!p),p&&gr&&ys(l),nd(l),d===13){if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(n(317));e:{for(l=l.nextSibling,d=0;l;){if(l.nodeType===8)if(p=l.data,p==="/$"){if(d===0){gr=Vn(l.nextSibling);break e}d--}else p!=="$"&&p!=="$!"&&p!=="$?"||d++;l=l.nextSibling}gr=null}}else d===27?(d=gr,Hi(l.type)?(l=Iu,Iu=null,gr=l):gr=d):gr=Kr?Vn(l.stateNode.nextSibling):null;return!0}function Na(){gr=Kr=null,Ut=!1}function id(){var l=xs;return l!==null&&(Jr===null?Jr=l:Jr.push.apply(Jr,l),xs=null),l}function Va(l){xs===null?xs=[l]:xs.push(l)}var oc=Se(null),_s=null,hi=null;function Ri(l,d,p){he(oc,d._currentValue),d._currentValue=p}function fi(l){l._currentValue=oc.current,ye(oc)}function lc(l,d,p){for(;l!==null;){var y=l.alternate;if((l.childLanes&d)!==d?(l.childLanes|=d,y!==null&&(y.childLanes|=d)):y!==null&&(y.childLanes&d)!==d&&(y.childLanes|=d),l===p)break;l=l.return}}function cc(l,d,p,y){var T=l.child;for(T!==null&&(T.return=l);T!==null;){var S=T.dependencies;if(S!==null){var ee=T.child;S=S.firstContext;e:for(;S!==null;){var te=S;S=T;for(var oe=0;oe<d.length;oe++)if(te.context===d[oe]){S.lanes|=p,te=S.alternate,te!==null&&(te.lanes|=p),lc(S.return,p,l),y||(ee=null);break e}S=te.next}}else if(T.tag===18){if(ee=T.return,ee===null)throw Error(n(341));ee.lanes|=p,S=ee.alternate,S!==null&&(S.lanes|=p),lc(ee,p,l),ee=null}else ee=T.child;if(ee!==null)ee.return=T;else for(ee=T;ee!==null;){if(ee===l){ee=null;break}if(T=ee.sibling,T!==null){T.return=ee.return,ee=T;break}ee=ee.return}T=ee}}function Ba(l,d,p,y){l=null;for(var T=d,S=!1;T!==null;){if(!S){if((T.flags&524288)!==0)S=!0;else if((T.flags&262144)!==0)break}if(T.tag===10){var ee=T.alternate;if(ee===null)throw Error(n(387));if(ee=ee.memoizedProps,ee!==null){var te=T.type;dn(T.pendingProps.value,ee.value)||(l!==null?l.push(te):l=[te])}}else if(T===$e.current){if(ee=T.alternate,ee===null)throw Error(n(387));ee.memoizedState.memoizedState!==T.memoizedState.memoizedState&&(l!==null?l.push(po):l=[po])}T=T.return}l!==null&&cc(d,l,p,y),d.flags|=262144}function Wo(l){for(l=l.firstContext;l!==null;){if(!dn(l.context._currentValue,l.memoizedValue))return!0;l=l.next}return!1}function Es(l){_s=l,hi=null,l=l.dependencies,l!==null&&(l.firstContext=null)}function Gr(l){return sd(_s,l)}function Yo(l,d){return _s===null&&Es(l),sd(l,d)}function sd(l,d){var p=d._currentValue;if(d={context:d,memoizedValue:p,next:null},hi===null){if(l===null)throw Error(n(308));hi=d,l.dependencies={lanes:0,firstContext:d},l.flags|=524288}else hi=hi.next=d;return p}var np=typeof AbortController<"u"?AbortController:function(){var l=[],d=this.signal={aborted:!1,addEventListener:function(p,y){l.push(y)}};this.abort=function(){d.aborted=!0,l.forEach(function(p){return p()})}},ip=r.unstable_scheduleCallback,sp=r.unstable_NormalPriority,Dr={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function uc(){return{controller:new np,data:new Map,refCount:0}}function La(l){l.refCount--,l.refCount===0&&ip(sp,function(){l.controller.abort()})}var Fa=null,dc=0,Xs=0,Ks=null;function ap(l,d){if(Fa===null){var p=Fa=[];dc=0,Xs=fu(),Ks={status:"pending",value:void 0,then:function(y){p.push(y)}}}return dc++,d.then(ad,ad),d}function ad(){if(--dc===0&&Fa!==null){Ks!==null&&(Ks.status="fulfilled");var l=Fa;Fa=null,Xs=0,Ks=null;for(var d=0;d<l.length;d++)(0,l[d])()}}function op(l,d){var p=[],y={status:"pending",value:null,reason:null,then:function(T){p.push(T)}};return l.then(function(){y.status="fulfilled",y.value=d;for(var T=0;T<p.length;T++)(0,p[T])(d)},function(T){for(y.status="rejected",y.reason=T,T=0;T<p.length;T++)(0,p[T])(void 0)}),y}var od=ie.S;ie.S=function(l,d){typeof d=="object"&&d!==null&&typeof d.then=="function"&&ap(l,d),od!==null&&od(l,d)};var vs=Se(null);function hc(){var l=vs.current;return l!==null?l:lr.pooledCache}function qo(l,d){d===null?he(vs,vs.current):he(vs,d.pool)}function ld(){var l=hc();return l===null?null:{parent:Dr._currentValue,pool:l}}var Ua=Error(n(460)),cd=Error(n(474)),Xo=Error(n(542)),fc={then:function(){}};function ud(l){return l=l.status,l==="fulfilled"||l==="rejected"}function Ko(){}function dd(l,d,p){switch(p=l[p],p===void 0?l.push(d):p!==d&&(d.then(Ko,Ko),d=p),d.status){case"fulfilled":return d.value;case"rejected":throw l=d.reason,fd(l),l;default:if(typeof d.status=="string")d.then(Ko,Ko);else{if(l=lr,l!==null&&100<l.shellSuspendCounter)throw Error(n(482));l=d,l.status="pending",l.then(function(y){if(d.status==="pending"){var T=d;T.status="fulfilled",T.value=y}},function(y){if(d.status==="pending"){var T=d;T.status="rejected",T.reason=y}})}switch(d.status){case"fulfilled":return d.value;case"rejected":throw l=d.reason,fd(l),l}throw $a=d,Ua}}var $a=null;function hd(){if($a===null)throw Error(n(459));var l=$a;return $a=null,l}function fd(l){if(l===Ua||l===Xo)throw Error(n(483))}var wi=!1;function pc(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function mc(l,d){l=l.updateQueue,d.updateQueue===l&&(d.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,callbacks:null})}function Pi(l){return{lane:l,tag:0,payload:null,callback:null,next:null}}function Di(l,d,p){var y=l.updateQueue;if(y===null)return null;if(y=y.shared,(qt&2)!==0){var T=y.pending;return T===null?d.next=d:(d.next=T.next,T.next=d),y.pending=d,d=$o(l),Ju(l,null,p),d}return Uo(l,y,d,p),$o(l)}function Ha(l,d,p){if(d=d.updateQueue,d!==null&&(d=d.shared,(p&4194048)!==0)){var y=d.lanes;y&=l.pendingLanes,p|=y,d.lanes=p,bs(l,p)}}function gc(l,d){var p=l.updateQueue,y=l.alternate;if(y!==null&&(y=y.updateQueue,p===y)){var T=null,S=null;if(p=p.firstBaseUpdate,p!==null){do{var ee={lane:p.lane,tag:p.tag,payload:p.payload,callback:null,next:null};S===null?T=S=ee:S=S.next=ee,p=p.next}while(p!==null);S===null?T=S=d:S=S.next=d}else T=S=d;p={baseState:y.baseState,firstBaseUpdate:T,lastBaseUpdate:S,shared:y.shared,callbacks:y.callbacks},l.updateQueue=p;return}l=p.lastBaseUpdate,l===null?p.firstBaseUpdate=d:l.next=d,p.lastBaseUpdate=d}var xc=!1;function za(){if(xc){var l=Ks;if(l!==null)throw l}}function Ga(l,d,p,y){xc=!1;var T=l.updateQueue;wi=!1;var S=T.firstBaseUpdate,ee=T.lastBaseUpdate,te=T.shared.pending;if(te!==null){T.shared.pending=null;var oe=te,_e=oe.next;oe.next=null,ee===null?S=_e:ee.next=_e,ee=oe;var we=l.alternate;we!==null&&(we=we.updateQueue,te=we.lastBaseUpdate,te!==ee&&(te===null?we.firstBaseUpdate=_e:te.next=_e,we.lastBaseUpdate=oe))}if(S!==null){var Oe=T.baseState;ee=0,we=_e=oe=null,te=S;do{var Ee=te.lane&-536870913,ve=Ee!==te.lane;if(ve?(Nt&Ee)===Ee:(y&Ee)===Ee){Ee!==0&&Ee===Xs&&(xc=!0),we!==null&&(we=we.next={lane:0,tag:te.tag,payload:te.payload,callback:null,next:null});e:{var Je=l,Qe=te;Ee=d;var nr=p;switch(Qe.tag){case 1:if(Je=Qe.payload,typeof Je=="function"){Oe=Je.call(nr,Oe,Ee);break e}Oe=Je;break e;case 3:Je.flags=Je.flags&-65537|128;case 0:if(Je=Qe.payload,Ee=typeof Je=="function"?Je.call(nr,Oe,Ee):Je,Ee==null)break e;Oe=f({},Oe,Ee);break e;case 2:wi=!0}}Ee=te.callback,Ee!==null&&(l.flags|=64,ve&&(l.flags|=8192),ve=T.callbacks,ve===null?T.callbacks=[Ee]:ve.push(Ee))}else ve={lane:Ee,tag:te.tag,payload:te.payload,callback:te.callback,next:null},we===null?(_e=we=ve,oe=Oe):we=we.next=ve,ee|=Ee;if(te=te.next,te===null){if(te=T.shared.pending,te===null)break;ve=te,te=ve.next,ve.next=null,T.lastBaseUpdate=ve,T.shared.pending=null}}while(!0);we===null&&(oe=Oe),T.baseState=oe,T.firstBaseUpdate=_e,T.lastBaseUpdate=we,S===null&&(T.shared.lanes=0),ji|=ee,l.lanes=ee,l.memoizedState=Oe}}function pd(l,d){if(typeof l!="function")throw Error(n(191,l));l.call(d)}function md(l,d){var p=l.callbacks;if(p!==null)for(l.callbacks=null,l=0;l<p.length;l++)pd(p[l],d)}var Qs=Se(null),Qo=Se(0);function gd(l,d){l=vi,he(Qo,l),he(Qs,d),vi=l|d.baseLanes}function yc(){he(Qo,vi),he(Qs,Qs.current)}function _c(){vi=Qo.current,ye(Qs),ye(Qo)}var Oi=0,dt=null,tr=null,Ir=null,Zo=!1,Zs=!1,As=!1,Jo=0,Wa=0,Js=null,lp=0;function Er(){throw Error(n(321))}function Ec(l,d){if(d===null)return!1;for(var p=0;p<d.length&&p<l.length;p++)if(!dn(l[p],d[p]))return!1;return!0}function vc(l,d,p,y,T,S){return Oi=S,dt=d,d.memoizedState=null,d.updateQueue=null,d.lanes=0,ie.H=l===null||l.memoizedState===null?Jd:eh,As=!1,S=p(y,T),As=!1,Zs&&(S=yd(d,p,y,T)),xd(l),S}function xd(l){ie.H=sl;var d=tr!==null&&tr.next!==null;if(Oi=0,Ir=tr=dt=null,Zo=!1,Wa=0,Js=null,d)throw Error(n(300));l===null||Nr||(l=l.dependencies,l!==null&&Wo(l)&&(Nr=!0))}function yd(l,d,p,y){dt=l;var T=0;do{if(Zs&&(Js=null),Wa=0,Zs=!1,25<=T)throw Error(n(301));if(T+=1,Ir=tr=null,l.updateQueue!=null){var S=l.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}ie.H=mp,S=d(p,y)}while(Zs);return S}function cp(){var l=ie.H,d=l.useState()[0];return d=typeof d.then=="function"?Ya(d):d,l=l.useState()[0],(tr!==null?tr.memoizedState:null)!==l&&(dt.flags|=1024),d}function Ac(){var l=Jo!==0;return Jo=0,l}function Tc(l,d,p){d.updateQueue=l.updateQueue,d.flags&=-2053,l.lanes&=~p}function Cc(l){if(Zo){for(l=l.memoizedState;l!==null;){var d=l.queue;d!==null&&(d.pending=null),l=l.next}Zo=!1}Oi=0,Ir=tr=dt=null,Zs=!1,Wa=Jo=0,Js=null}function Qr(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ir===null?dt.memoizedState=Ir=l:Ir=Ir.next=l,Ir}function br(){if(tr===null){var l=dt.alternate;l=l!==null?l.memoizedState:null}else l=tr.next;var d=Ir===null?dt.memoizedState:Ir.next;if(d!==null)Ir=d,tr=l;else{if(l===null)throw dt.alternate===null?Error(n(467)):Error(n(310));tr=l,l={memoizedState:tr.memoizedState,baseState:tr.baseState,baseQueue:tr.baseQueue,queue:tr.queue,next:null},Ir===null?dt.memoizedState=Ir=l:Ir=Ir.next=l}return Ir}function Sc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ya(l){var d=Wa;return Wa+=1,Js===null&&(Js=[]),l=dd(Js,l,d),d=dt,(Ir===null?d.memoizedState:Ir.next)===null&&(d=d.alternate,ie.H=d===null||d.memoizedState===null?Jd:eh),l}function el(l){if(l!==null&&typeof l=="object"){if(typeof l.then=="function")return Ya(l);if(l.$$typeof===R)return Gr(l)}throw Error(n(438,String(l)))}function Ic(l){var d=null,p=dt.updateQueue;if(p!==null&&(d=p.memoCache),d==null){var y=dt.alternate;y!==null&&(y=y.updateQueue,y!==null&&(y=y.memoCache,y!=null&&(d={data:y.data.map(function(T){return T.slice()}),index:0})))}if(d==null&&(d={data:[],index:0}),p===null&&(p=Sc(),dt.updateQueue=p),p.memoCache=d,p=d.data[d.index],p===void 0)for(p=d.data[d.index]=Array(l),y=0;y<l;y++)p[y]=K;return d.index++,p}function mi(l,d){return typeof d=="function"?d(l):d}function tl(l){var d=br();return bc(d,tr,l)}function bc(l,d,p){var y=l.queue;if(y===null)throw Error(n(311));y.lastRenderedReducer=p;var T=l.baseQueue,S=y.pending;if(S!==null){if(T!==null){var ee=T.next;T.next=S.next,S.next=ee}d.baseQueue=T=S,y.pending=null}if(S=l.baseState,T===null)l.memoizedState=S;else{d=T.next;var te=ee=null,oe=null,_e=d,we=!1;do{var Oe=_e.lane&-536870913;if(Oe!==_e.lane?(Nt&Oe)===Oe:(Oi&Oe)===Oe){var Ee=_e.revertLane;if(Ee===0)oe!==null&&(oe=oe.next={lane:0,revertLane:0,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null}),Oe===Xs&&(we=!0);else if((Oi&Ee)===Ee){_e=_e.next,Ee===Xs&&(we=!0);continue}else Oe={lane:0,revertLane:_e.revertLane,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null},oe===null?(te=oe=Oe,ee=S):oe=oe.next=Oe,dt.lanes|=Ee,ji|=Ee;Oe=_e.action,As&&p(S,Oe),S=_e.hasEagerState?_e.eagerState:p(S,Oe)}else Ee={lane:Oe,revertLane:_e.revertLane,action:_e.action,hasEagerState:_e.hasEagerState,eagerState:_e.eagerState,next:null},oe===null?(te=oe=Ee,ee=S):oe=oe.next=Ee,dt.lanes|=Oe,ji|=Oe;_e=_e.next}while(_e!==null&&_e!==d);if(oe===null?ee=S:oe.next=te,!dn(S,l.memoizedState)&&(Nr=!0,we&&(p=Ks,p!==null)))throw p;l.memoizedState=S,l.baseState=ee,l.baseQueue=oe,y.lastRenderedState=S}return T===null&&(y.lanes=0),[l.memoizedState,y.dispatch]}function Rc(l){var d=br(),p=d.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=l;var y=p.dispatch,T=p.pending,S=d.memoizedState;if(T!==null){p.pending=null;var ee=T=T.next;do S=l(S,ee.action),ee=ee.next;while(ee!==T);dn(S,d.memoizedState)||(Nr=!0),d.memoizedState=S,d.baseQueue===null&&(d.baseState=S),p.lastRenderedState=S}return[S,y]}function _d(l,d,p){var y=dt,T=br(),S=Ut;if(S){if(p===void 0)throw Error(n(407));p=p()}else p=d();var ee=!dn((tr||T).memoizedState,p);ee&&(T.memoizedState=p,Nr=!0),T=T.queue;var te=Ad.bind(null,y,T,l);if(qa(2048,8,te,[l]),T.getSnapshot!==d||ee||Ir!==null&&Ir.memoizedState.tag&1){if(y.flags|=2048,ea(9,rl(),vd.bind(null,y,T,p,d),null),lr===null)throw Error(n(349));S||(Oi&124)!==0||Ed(y,d,p)}return p}function Ed(l,d,p){l.flags|=16384,l={getSnapshot:d,value:p},d=dt.updateQueue,d===null?(d=Sc(),dt.updateQueue=d,d.stores=[l]):(p=d.stores,p===null?d.stores=[l]:p.push(l))}function vd(l,d,p,y){d.value=p,d.getSnapshot=y,Td(d)&&Cd(l)}function Ad(l,d,p){return p(function(){Td(d)&&Cd(l)})}function Td(l){var d=l.getSnapshot;l=l.value;try{var p=d();return!dn(l,p)}catch{return!0}}function Cd(l){var d=Gs(l,2);d!==null&&xn(d,l,2)}function wc(l){var d=Qr();if(typeof l=="function"){var p=l;if(l=p(),As){cr(!0);try{p()}finally{cr(!1)}}}return d.memoizedState=d.baseState=l,d.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:l},d}function Sd(l,d,p,y){return l.baseState=p,bc(l,tr,typeof y=="function"?y:mi)}function up(l,d,p,y,T){if(il(l))throw Error(n(485));if(l=d.action,l!==null){var S={payload:T,action:l,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ee){S.listeners.push(ee)}};ie.T!==null?p(!0):S.isTransition=!1,y(S),p=d.pending,p===null?(S.next=d.pending=S,Id(d,S)):(S.next=p.next,d.pending=p.next=S)}}function Id(l,d){var p=d.action,y=d.payload,T=l.state;if(d.isTransition){var S=ie.T,ee={};ie.T=ee;try{var te=p(T,y),oe=ie.S;oe!==null&&oe(ee,te),bd(l,d,te)}catch(_e){Pc(l,d,_e)}finally{ie.T=S}}else try{S=p(T,y),bd(l,d,S)}catch(_e){Pc(l,d,_e)}}function bd(l,d,p){p!==null&&typeof p=="object"&&typeof p.then=="function"?p.then(function(y){Rd(l,d,y)},function(y){return Pc(l,d,y)}):Rd(l,d,p)}function Rd(l,d,p){d.status="fulfilled",d.value=p,wd(d),l.state=p,d=l.pending,d!==null&&(p=d.next,p===d?l.pending=null:(p=p.next,d.next=p,Id(l,p)))}function Pc(l,d,p){var y=l.pending;if(l.pending=null,y!==null){y=y.next;do d.status="rejected",d.reason=p,wd(d),d=d.next;while(d!==y)}l.action=null}function wd(l){l=l.listeners;for(var d=0;d<l.length;d++)(0,l[d])()}function Pd(l,d){return d}function Dd(l,d){if(Ut){var p=lr.formState;if(p!==null){e:{var y=dt;if(Ut){if(gr){t:{for(var T=gr,S=Yn;T.nodeType!==8;){if(!S){T=null;break t}if(T=Vn(T.nextSibling),T===null){T=null;break t}}S=T.data,T=S==="F!"||S==="F"?T:null}if(T){gr=Vn(T.nextSibling),y=T.data==="F!";break e}}ys(y)}y=!1}y&&(d=p[0])}}return p=Qr(),p.memoizedState=p.baseState=d,y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Pd,lastRenderedState:d},p.queue=y,p=Kd.bind(null,dt,y),y.dispatch=p,y=wc(!1),S=Nc.bind(null,dt,!1,y.queue),y=Qr(),T={state:d,dispatch:null,action:l,pending:null},y.queue=T,p=up.bind(null,dt,T,S,p),T.dispatch=p,y.memoizedState=l,[d,p,!1]}function Od(l){var d=br();return Md(d,tr,l)}function Md(l,d,p){if(d=bc(l,d,Pd)[0],l=tl(mi)[0],typeof d=="object"&&d!==null&&typeof d.then=="function")try{var y=Ya(d)}catch(ee){throw ee===Ua?Xo:ee}else y=d;d=br();var T=d.queue,S=T.dispatch;return p!==d.memoizedState&&(dt.flags|=2048,ea(9,rl(),dp.bind(null,T,p),null)),[y,S,l]}function dp(l,d){l.action=d}function kd(l){var d=br(),p=tr;if(p!==null)return Md(d,p,l);br(),d=d.memoizedState,p=br();var y=p.queue.dispatch;return p.memoizedState=l,[d,y,!1]}function ea(l,d,p,y){return l={tag:l,create:p,deps:y,inst:d,next:null},d=dt.updateQueue,d===null&&(d=Sc(),dt.updateQueue=d),p=d.lastEffect,p===null?d.lastEffect=l.next=l:(y=p.next,p.next=l,l.next=y,d.lastEffect=l),l}function rl(){return{destroy:void 0,resource:void 0}}function Nd(){return br().memoizedState}function nl(l,d,p,y){var T=Qr();y=y===void 0?null:y,dt.flags|=l,T.memoizedState=ea(1|d,rl(),p,y)}function qa(l,d,p,y){var T=br();y=y===void 0?null:y;var S=T.memoizedState.inst;tr!==null&&y!==null&&Ec(y,tr.memoizedState.deps)?T.memoizedState=ea(d,S,p,y):(dt.flags|=l,T.memoizedState=ea(1|d,S,p,y))}function Vd(l,d){nl(8390656,8,l,d)}function Bd(l,d){qa(2048,8,l,d)}function Ld(l,d){return qa(4,2,l,d)}function jd(l,d){return qa(4,4,l,d)}function Fd(l,d){if(typeof d=="function"){l=l();var p=d(l);return function(){typeof p=="function"?p():d(null)}}if(d!=null)return l=l(),d.current=l,function(){d.current=null}}function Ud(l,d,p){p=p!=null?p.concat([l]):null,qa(4,4,Fd.bind(null,d,l),p)}function Dc(){}function $d(l,d){var p=br();d=d===void 0?null:d;var y=p.memoizedState;return d!==null&&Ec(d,y[1])?y[0]:(p.memoizedState=[l,d],l)}function Hd(l,d){var p=br();d=d===void 0?null:d;var y=p.memoizedState;if(d!==null&&Ec(d,y[1]))return y[0];if(y=l(),As){cr(!0);try{l()}finally{cr(!1)}}return p.memoizedState=[y,d],y}function Oc(l,d,p){return p===void 0||(Oi&1073741824)!==0?l.memoizedState=d:(l.memoizedState=p,l=Wh(),dt.lanes|=l,ji|=l,p)}function zd(l,d,p,y){return dn(p,d)?p:Qs.current!==null?(l=Oc(l,p,y),dn(l,d)||(Nr=!0),l):(Oi&42)===0?(Nr=!0,l.memoizedState=p):(l=Wh(),dt.lanes|=l,ji|=l,d)}function Gd(l,d,p,y,T){var S=se.p;se.p=S!==0&&8>S?S:8;var ee=ie.T,te={};ie.T=te,Nc(l,!1,d,p);try{var oe=T(),_e=ie.S;if(_e!==null&&_e(te,oe),oe!==null&&typeof oe=="object"&&typeof oe.then=="function"){var we=op(oe,y);Xa(l,d,we,gn(l))}else Xa(l,d,y,gn(l))}catch(Oe){Xa(l,d,{then:function(){},status:"rejected",reason:Oe},gn())}finally{se.p=S,ie.T=ee}}function hp(){}function Mc(l,d,p,y){if(l.tag!==5)throw Error(n(476));var T=Wd(l).queue;Gd(l,T,d,ce,p===null?hp:function(){return Yd(l),p(y)})}function Wd(l){var d=l.memoizedState;if(d!==null)return d;d={memoizedState:ce,baseState:ce,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:ce},next:null};var p={};return d.next={memoizedState:p,baseState:p,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mi,lastRenderedState:p},next:null},l.memoizedState=d,l=l.alternate,l!==null&&(l.memoizedState=d),d}function Yd(l){var d=Wd(l).next.queue;Xa(l,d,{},gn())}function kc(){return Gr(po)}function qd(){return br().memoizedState}function Xd(){return br().memoizedState}function fp(l){for(var d=l.return;d!==null;){switch(d.tag){case 24:case 3:var p=gn();l=Pi(p);var y=Di(d,l,p);y!==null&&(xn(y,d,p),Ha(y,d,p)),d={cache:uc()},l.payload=d;return}d=d.return}}function pp(l,d,p){var y=gn();p={lane:y,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null},il(l)?Qd(d,p):(p=ec(l,d,p,y),p!==null&&(xn(p,l,y),Zd(p,d,y)))}function Kd(l,d,p){var y=gn();Xa(l,d,p,y)}function Xa(l,d,p,y){var T={lane:y,revertLane:0,action:p,hasEagerState:!1,eagerState:null,next:null};if(il(l))Qd(d,T);else{var S=l.alternate;if(l.lanes===0&&(S===null||S.lanes===0)&&(S=d.lastRenderedReducer,S!==null))try{var ee=d.lastRenderedState,te=S(ee,p);if(T.hasEagerState=!0,T.eagerState=te,dn(te,ee))return Uo(l,d,T,0),lr===null&&Fo(),!1}catch{}finally{}if(p=ec(l,d,T,y),p!==null)return xn(p,l,y),Zd(p,d,y),!0}return!1}function Nc(l,d,p,y){if(y={lane:2,revertLane:fu(),action:y,hasEagerState:!1,eagerState:null,next:null},il(l)){if(d)throw Error(n(479))}else d=ec(l,p,y,2),d!==null&&xn(d,l,2)}function il(l){var d=l.alternate;return l===dt||d!==null&&d===dt}function Qd(l,d){Zs=Zo=!0;var p=l.pending;p===null?d.next=d:(d.next=p.next,p.next=d),l.pending=d}function Zd(l,d,p){if((p&4194048)!==0){var y=d.lanes;y&=l.pendingLanes,p|=y,d.lanes=p,bs(l,p)}}var sl={readContext:Gr,use:el,useCallback:Er,useContext:Er,useEffect:Er,useImperativeHandle:Er,useLayoutEffect:Er,useInsertionEffect:Er,useMemo:Er,useReducer:Er,useRef:Er,useState:Er,useDebugValue:Er,useDeferredValue:Er,useTransition:Er,useSyncExternalStore:Er,useId:Er,useHostTransitionStatus:Er,useFormState:Er,useActionState:Er,useOptimistic:Er,useMemoCache:Er,useCacheRefresh:Er},Jd={readContext:Gr,use:el,useCallback:function(l,d){return Qr().memoizedState=[l,d===void 0?null:d],l},useContext:Gr,useEffect:Vd,useImperativeHandle:function(l,d,p){p=p!=null?p.concat([l]):null,nl(4194308,4,Fd.bind(null,d,l),p)},useLayoutEffect:function(l,d){return nl(4194308,4,l,d)},useInsertionEffect:function(l,d){nl(4,2,l,d)},useMemo:function(l,d){var p=Qr();d=d===void 0?null:d;var y=l();if(As){cr(!0);try{l()}finally{cr(!1)}}return p.memoizedState=[y,d],y},useReducer:function(l,d,p){var y=Qr();if(p!==void 0){var T=p(d);if(As){cr(!0);try{p(d)}finally{cr(!1)}}}else T=d;return y.memoizedState=y.baseState=T,l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:T},y.queue=l,l=l.dispatch=pp.bind(null,dt,l),[y.memoizedState,l]},useRef:function(l){var d=Qr();return l={current:l},d.memoizedState=l},useState:function(l){l=wc(l);var d=l.queue,p=Kd.bind(null,dt,d);return d.dispatch=p,[l.memoizedState,p]},useDebugValue:Dc,useDeferredValue:function(l,d){var p=Qr();return Oc(p,l,d)},useTransition:function(){var l=wc(!1);return l=Gd.bind(null,dt,l.queue,!0,!1),Qr().memoizedState=l,[!1,l]},useSyncExternalStore:function(l,d,p){var y=dt,T=Qr();if(Ut){if(p===void 0)throw Error(n(407));p=p()}else{if(p=d(),lr===null)throw Error(n(349));(Nt&124)!==0||Ed(y,d,p)}T.memoizedState=p;var S={value:p,getSnapshot:d};return T.queue=S,Vd(Ad.bind(null,y,S,l),[l]),y.flags|=2048,ea(9,rl(),vd.bind(null,y,S,p,d),null),p},useId:function(){var l=Qr(),d=lr.identifierPrefix;if(Ut){var p=di,y=ui;p=(y&~(1<<32-We(y)-1)).toString(32)+p,d="«"+d+"R"+p,p=Jo++,0<p&&(d+="H"+p.toString(32)),d+="»"}else p=lp++,d="«"+d+"r"+p.toString(32)+"»";return l.memoizedState=d},useHostTransitionStatus:kc,useFormState:Dd,useActionState:Dd,useOptimistic:function(l){var d=Qr();d.memoizedState=d.baseState=l;var p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return d.queue=p,d=Nc.bind(null,dt,!0,p),p.dispatch=d,[l,d]},useMemoCache:Ic,useCacheRefresh:function(){return Qr().memoizedState=fp.bind(null,dt)}},eh={readContext:Gr,use:el,useCallback:$d,useContext:Gr,useEffect:Bd,useImperativeHandle:Ud,useInsertionEffect:Ld,useLayoutEffect:jd,useMemo:Hd,useReducer:tl,useRef:Nd,useState:function(){return tl(mi)},useDebugValue:Dc,useDeferredValue:function(l,d){var p=br();return zd(p,tr.memoizedState,l,d)},useTransition:function(){var l=tl(mi)[0],d=br().memoizedState;return[typeof l=="boolean"?l:Ya(l),d]},useSyncExternalStore:_d,useId:qd,useHostTransitionStatus:kc,useFormState:Od,useActionState:Od,useOptimistic:function(l,d){var p=br();return Sd(p,tr,l,d)},useMemoCache:Ic,useCacheRefresh:Xd},mp={readContext:Gr,use:el,useCallback:$d,useContext:Gr,useEffect:Bd,useImperativeHandle:Ud,useInsertionEffect:Ld,useLayoutEffect:jd,useMemo:Hd,useReducer:Rc,useRef:Nd,useState:function(){return Rc(mi)},useDebugValue:Dc,useDeferredValue:function(l,d){var p=br();return tr===null?Oc(p,l,d):zd(p,tr.memoizedState,l,d)},useTransition:function(){var l=Rc(mi)[0],d=br().memoizedState;return[typeof l=="boolean"?l:Ya(l),d]},useSyncExternalStore:_d,useId:qd,useHostTransitionStatus:kc,useFormState:kd,useActionState:kd,useOptimistic:function(l,d){var p=br();return tr!==null?Sd(p,tr,l,d):(p.baseState=l,[l,p.queue.dispatch])},useMemoCache:Ic,useCacheRefresh:Xd},ta=null,Ka=0;function al(l){var d=Ka;return Ka+=1,ta===null&&(ta=[]),dd(ta,l,d)}function Qa(l,d){d=d.props.ref,l.ref=d!==void 0?d:null}function ol(l,d){throw d.$$typeof===m?Error(n(525)):(l=Object.prototype.toString.call(d),Error(n(31,l==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":l)))}function th(l){var d=l._init;return d(l._payload)}function rh(l){function d(fe,de){if(l){var ge=fe.deletions;ge===null?(fe.deletions=[de],fe.flags|=16):ge.push(de)}}function p(fe,de){if(!l)return null;for(;de!==null;)d(fe,de),de=de.sibling;return null}function y(fe){for(var de=new Map;fe!==null;)fe.key!==null?de.set(fe.key,fe):de.set(fe.index,fe),fe=fe.sibling;return de}function T(fe,de){return fe=ci(fe,de),fe.index=0,fe.sibling=null,fe}function S(fe,de,ge){return fe.index=ge,l?(ge=fe.alternate,ge!==null?(ge=ge.index,ge<de?(fe.flags|=67108866,de):ge):(fe.flags|=67108866,de)):(fe.flags|=1048576,de)}function ee(fe){return l&&fe.alternate===null&&(fe.flags|=67108866),fe}function te(fe,de,ge,De){return de===null||de.tag!==6?(de=rc(ge,fe.mode,De),de.return=fe,de):(de=T(de,ge),de.return=fe,de)}function oe(fe,de,ge,De){var Ge=ge.type;return Ge===E?we(fe,de,ge.props.children,De,ge.key):de!==null&&(de.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===w&&th(Ge)===de.type)?(de=T(de,ge.props),Qa(de,ge),de.return=fe,de):(de=Ho(ge.type,ge.key,ge.props,null,fe.mode,De),Qa(de,ge),de.return=fe,de)}function _e(fe,de,ge,De){return de===null||de.tag!==4||de.stateNode.containerInfo!==ge.containerInfo||de.stateNode.implementation!==ge.implementation?(de=nc(ge,fe.mode,De),de.return=fe,de):(de=T(de,ge.children||[]),de.return=fe,de)}function we(fe,de,ge,De,Ge){return de===null||de.tag!==7?(de=ps(ge,fe.mode,De,Ge),de.return=fe,de):(de=T(de,ge),de.return=fe,de)}function Oe(fe,de,ge){if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return de=rc(""+de,fe.mode,ge),de.return=fe,de;if(typeof de=="object"&&de!==null){switch(de.$$typeof){case g:return ge=Ho(de.type,de.key,de.props,null,fe.mode,ge),Qa(ge,de),ge.return=fe,ge;case _:return de=nc(de,fe.mode,ge),de.return=fe,de;case w:var De=de._init;return de=De(de._payload),Oe(fe,de,ge)}if(le(de)||Y(de))return de=ps(de,fe.mode,ge,null),de.return=fe,de;if(typeof de.then=="function")return Oe(fe,al(de),ge);if(de.$$typeof===R)return Oe(fe,Yo(fe,de),ge);ol(fe,de)}return null}function Ee(fe,de,ge,De){var Ge=de!==null?de.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return Ge!==null?null:te(fe,de,""+ge,De);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case g:return ge.key===Ge?oe(fe,de,ge,De):null;case _:return ge.key===Ge?_e(fe,de,ge,De):null;case w:return Ge=ge._init,ge=Ge(ge._payload),Ee(fe,de,ge,De)}if(le(ge)||Y(ge))return Ge!==null?null:we(fe,de,ge,De,null);if(typeof ge.then=="function")return Ee(fe,de,al(ge),De);if(ge.$$typeof===R)return Ee(fe,de,Yo(fe,ge),De);ol(fe,ge)}return null}function ve(fe,de,ge,De,Ge){if(typeof De=="string"&&De!==""||typeof De=="number"||typeof De=="bigint")return fe=fe.get(ge)||null,te(de,fe,""+De,Ge);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case g:return fe=fe.get(De.key===null?ge:De.key)||null,oe(de,fe,De,Ge);case _:return fe=fe.get(De.key===null?ge:De.key)||null,_e(de,fe,De,Ge);case w:var pt=De._init;return De=pt(De._payload),ve(fe,de,ge,De,Ge)}if(le(De)||Y(De))return fe=fe.get(ge)||null,we(de,fe,De,Ge,null);if(typeof De.then=="function")return ve(fe,de,ge,al(De),Ge);if(De.$$typeof===R)return ve(fe,de,ge,Yo(de,De),Ge);ol(de,De)}return null}function Je(fe,de,ge,De){for(var Ge=null,pt=null,Ye=de,Ze=de=0,Br=null;Ye!==null&&Ze<ge.length;Ze++){Ye.index>Ze?(Br=Ye,Ye=null):Br=Ye.sibling;var Bt=Ee(fe,Ye,ge[Ze],De);if(Bt===null){Ye===null&&(Ye=Br);break}l&&Ye&&Bt.alternate===null&&d(fe,Ye),de=S(Bt,de,Ze),pt===null?Ge=Bt:pt.sibling=Bt,pt=Bt,Ye=Br}if(Ze===ge.length)return p(fe,Ye),Ut&&gs(fe,Ze),Ge;if(Ye===null){for(;Ze<ge.length;Ze++)Ye=Oe(fe,ge[Ze],De),Ye!==null&&(de=S(Ye,de,Ze),pt===null?Ge=Ye:pt.sibling=Ye,pt=Ye);return Ut&&gs(fe,Ze),Ge}for(Ye=y(Ye);Ze<ge.length;Ze++)Br=ve(Ye,fe,Ze,ge[Ze],De),Br!==null&&(l&&Br.alternate!==null&&Ye.delete(Br.key===null?Ze:Br.key),de=S(Br,de,Ze),pt===null?Ge=Br:pt.sibling=Br,pt=Br);return l&&Ye.forEach(function(qi){return d(fe,qi)}),Ut&&gs(fe,Ze),Ge}function Qe(fe,de,ge,De){if(ge==null)throw Error(n(151));for(var Ge=null,pt=null,Ye=de,Ze=de=0,Br=null,Bt=ge.next();Ye!==null&&!Bt.done;Ze++,Bt=ge.next()){Ye.index>Ze?(Br=Ye,Ye=null):Br=Ye.sibling;var qi=Ee(fe,Ye,Bt.value,De);if(qi===null){Ye===null&&(Ye=Br);break}l&&Ye&&qi.alternate===null&&d(fe,Ye),de=S(qi,de,Ze),pt===null?Ge=qi:pt.sibling=qi,pt=qi,Ye=Br}if(Bt.done)return p(fe,Ye),Ut&&gs(fe,Ze),Ge;if(Ye===null){for(;!Bt.done;Ze++,Bt=ge.next())Bt=Oe(fe,Bt.value,De),Bt!==null&&(de=S(Bt,de,Ze),pt===null?Ge=Bt:pt.sibling=Bt,pt=Bt);return Ut&&gs(fe,Ze),Ge}for(Ye=y(Ye);!Bt.done;Ze++,Bt=ge.next())Bt=ve(Ye,fe,Ze,Bt.value,De),Bt!==null&&(l&&Bt.alternate!==null&&Ye.delete(Bt.key===null?Ze:Bt.key),de=S(Bt,de,Ze),pt===null?Ge=Bt:pt.sibling=Bt,pt=Bt);return l&&Ye.forEach(function(gm){return d(fe,gm)}),Ut&&gs(fe,Ze),Ge}function nr(fe,de,ge,De){if(typeof ge=="object"&&ge!==null&&ge.type===E&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case g:e:{for(var Ge=ge.key;de!==null;){if(de.key===Ge){if(Ge=ge.type,Ge===E){if(de.tag===7){p(fe,de.sibling),De=T(de,ge.props.children),De.return=fe,fe=De;break e}}else if(de.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===w&&th(Ge)===de.type){p(fe,de.sibling),De=T(de,ge.props),Qa(De,ge),De.return=fe,fe=De;break e}p(fe,de);break}else d(fe,de);de=de.sibling}ge.type===E?(De=ps(ge.props.children,fe.mode,De,ge.key),De.return=fe,fe=De):(De=Ho(ge.type,ge.key,ge.props,null,fe.mode,De),Qa(De,ge),De.return=fe,fe=De)}return ee(fe);case _:e:{for(Ge=ge.key;de!==null;){if(de.key===Ge)if(de.tag===4&&de.stateNode.containerInfo===ge.containerInfo&&de.stateNode.implementation===ge.implementation){p(fe,de.sibling),De=T(de,ge.children||[]),De.return=fe,fe=De;break e}else{p(fe,de);break}else d(fe,de);de=de.sibling}De=nc(ge,fe.mode,De),De.return=fe,fe=De}return ee(fe);case w:return Ge=ge._init,ge=Ge(ge._payload),nr(fe,de,ge,De)}if(le(ge))return Je(fe,de,ge,De);if(Y(ge)){if(Ge=Y(ge),typeof Ge!="function")throw Error(n(150));return ge=Ge.call(ge),Qe(fe,de,ge,De)}if(typeof ge.then=="function")return nr(fe,de,al(ge),De);if(ge.$$typeof===R)return nr(fe,de,Yo(fe,ge),De);ol(fe,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint"?(ge=""+ge,de!==null&&de.tag===6?(p(fe,de.sibling),De=T(de,ge),De.return=fe,fe=De):(p(fe,de),De=rc(ge,fe.mode,De),De.return=fe,fe=De),ee(fe)):p(fe,de)}return function(fe,de,ge,De){try{Ka=0;var Ge=nr(fe,de,ge,De);return ta=null,Ge}catch(Ye){if(Ye===Ua||Ye===Xo)throw Ye;var pt=hn(29,Ye,null,fe.mode);return pt.lanes=De,pt.return=fe,pt}finally{}}}var ra=rh(!0),nh=rh(!1),wn=Se(null),qn=null;function Mi(l){var d=l.alternate;he(Or,Or.current&1),he(wn,l),qn===null&&(d===null||Qs.current!==null||d.memoizedState!==null)&&(qn=l)}function ih(l){if(l.tag===22){if(he(Or,Or.current),he(wn,l),qn===null){var d=l.alternate;d!==null&&d.memoizedState!==null&&(qn=l)}}else ki()}function ki(){he(Or,Or.current),he(wn,wn.current)}function gi(l){ye(wn),qn===l&&(qn=null),ye(Or)}var Or=Se(0);function ll(l){for(var d=l;d!==null;){if(d.tag===13){var p=d.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||Su(p)))return d}else if(d.tag===19&&d.memoizedProps.revealOrder!==void 0){if((d.flags&128)!==0)return d}else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return null;d=d.return}d.sibling.return=d.return,d=d.sibling}return null}function Vc(l,d,p,y){d=l.memoizedState,p=p(y,d),p=p==null?d:f({},d,p),l.memoizedState=p,l.lanes===0&&(l.updateQueue.baseState=p)}var Bc={enqueueSetState:function(l,d,p){l=l._reactInternals;var y=gn(),T=Pi(y);T.payload=d,p!=null&&(T.callback=p),d=Di(l,T,y),d!==null&&(xn(d,l,y),Ha(d,l,y))},enqueueReplaceState:function(l,d,p){l=l._reactInternals;var y=gn(),T=Pi(y);T.tag=1,T.payload=d,p!=null&&(T.callback=p),d=Di(l,T,y),d!==null&&(xn(d,l,y),Ha(d,l,y))},enqueueForceUpdate:function(l,d){l=l._reactInternals;var p=gn(),y=Pi(p);y.tag=2,d!=null&&(y.callback=d),d=Di(l,y,p),d!==null&&(xn(d,l,p),Ha(d,l,p))}};function sh(l,d,p,y,T,S,ee){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(y,S,ee):d.prototype&&d.prototype.isPureReactComponent?!Oa(p,y)||!Oa(T,S):!0}function ah(l,d,p,y){l=d.state,typeof d.componentWillReceiveProps=="function"&&d.componentWillReceiveProps(p,y),typeof d.UNSAFE_componentWillReceiveProps=="function"&&d.UNSAFE_componentWillReceiveProps(p,y),d.state!==l&&Bc.enqueueReplaceState(d,d.state,null)}function Ts(l,d){var p=d;if("ref"in d){p={};for(var y in d)y!=="ref"&&(p[y]=d[y])}if(l=l.defaultProps){p===d&&(p=f({},p));for(var T in l)p[T]===void 0&&(p[T]=l[T])}return p}var cl=typeof reportError=="function"?reportError:function(l){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var d=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof l=="object"&&l!==null&&typeof l.message=="string"?String(l.message):String(l),error:l});if(!window.dispatchEvent(d))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",l);return}console.error(l)};function oh(l){cl(l)}function lh(l){console.error(l)}function ch(l){cl(l)}function ul(l,d){try{var p=l.onUncaughtError;p(d.value,{componentStack:d.stack})}catch(y){setTimeout(function(){throw y})}}function uh(l,d,p){try{var y=l.onCaughtError;y(p.value,{componentStack:p.stack,errorBoundary:d.tag===1?d.stateNode:null})}catch(T){setTimeout(function(){throw T})}}function Lc(l,d,p){return p=Pi(p),p.tag=3,p.payload={element:null},p.callback=function(){ul(l,d)},p}function dh(l){return l=Pi(l),l.tag=3,l}function hh(l,d,p,y){var T=p.type.getDerivedStateFromError;if(typeof T=="function"){var S=y.value;l.payload=function(){return T(S)},l.callback=function(){uh(d,p,y)}}var ee=p.stateNode;ee!==null&&typeof ee.componentDidCatch=="function"&&(l.callback=function(){uh(d,p,y),typeof T!="function"&&(Fi===null?Fi=new Set([this]):Fi.add(this));var te=y.stack;this.componentDidCatch(y.value,{componentStack:te!==null?te:""})})}function gp(l,d,p,y,T){if(p.flags|=32768,y!==null&&typeof y=="object"&&typeof y.then=="function"){if(d=p.alternate,d!==null&&Ba(d,p,T,!0),p=wn.current,p!==null){switch(p.tag){case 13:return qn===null?lu():p.alternate===null&&xr===0&&(xr=3),p.flags&=-257,p.flags|=65536,p.lanes=T,y===fc?p.flags|=16384:(d=p.updateQueue,d===null?p.updateQueue=new Set([y]):d.add(y),uu(l,y,T)),!1;case 22:return p.flags|=65536,y===fc?p.flags|=16384:(d=p.updateQueue,d===null?(d={transitions:null,markerInstances:null,retryQueue:new Set([y])},p.updateQueue=d):(p=d.retryQueue,p===null?d.retryQueue=new Set([y]):p.add(y)),uu(l,y,T)),!1}throw Error(n(435,p.tag))}return uu(l,y,T),lu(),!1}if(Ut)return d=wn.current,d!==null?((d.flags&65536)===0&&(d.flags|=256),d.flags|=65536,d.lanes=T,y!==ac&&(l=Error(n(422),{cause:y}),Va(Sn(l,p)))):(y!==ac&&(d=Error(n(423),{cause:y}),Va(Sn(d,p))),l=l.current.alternate,l.flags|=65536,T&=-T,l.lanes|=T,y=Sn(y,p),T=Lc(l.stateNode,y,T),gc(l,T),xr!==4&&(xr=2)),!1;var S=Error(n(520),{cause:y});if(S=Sn(S,p),io===null?io=[S]:io.push(S),xr!==4&&(xr=2),d===null)return!0;y=Sn(y,p),p=d;do{switch(p.tag){case 3:return p.flags|=65536,l=T&-T,p.lanes|=l,l=Lc(p.stateNode,y,l),gc(p,l),!1;case 1:if(d=p.type,S=p.stateNode,(p.flags&128)===0&&(typeof d.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Fi===null||!Fi.has(S))))return p.flags|=65536,T&=-T,p.lanes|=T,T=dh(T),hh(T,l,p,y),gc(p,T),!1}p=p.return}while(p!==null);return!1}var fh=Error(n(461)),Nr=!1;function $r(l,d,p,y){d.child=l===null?nh(d,null,p,y):ra(d,l.child,p,y)}function ph(l,d,p,y,T){p=p.render;var S=d.ref;if("ref"in y){var ee={};for(var te in y)te!=="ref"&&(ee[te]=y[te])}else ee=y;return Es(d),y=vc(l,d,p,ee,S,T),te=Ac(),l!==null&&!Nr?(Tc(l,d,T),xi(l,d,T)):(Ut&&te&&ic(d),d.flags|=1,$r(l,d,y,T),d.child)}function mh(l,d,p,y,T){if(l===null){var S=p.type;return typeof S=="function"&&!tc(S)&&S.defaultProps===void 0&&p.compare===null?(d.tag=15,d.type=S,gh(l,d,S,y,T)):(l=Ho(p.type,null,y,d,d.mode,T),l.ref=d.ref,l.return=d,d.child=l)}if(S=l.child,!Wc(l,T)){var ee=S.memoizedProps;if(p=p.compare,p=p!==null?p:Oa,p(ee,y)&&l.ref===d.ref)return xi(l,d,T)}return d.flags|=1,l=ci(S,y),l.ref=d.ref,l.return=d,d.child=l}function gh(l,d,p,y,T){if(l!==null){var S=l.memoizedProps;if(Oa(S,y)&&l.ref===d.ref)if(Nr=!1,d.pendingProps=y=S,Wc(l,T))(l.flags&131072)!==0&&(Nr=!0);else return d.lanes=l.lanes,xi(l,d,T)}return jc(l,d,p,y,T)}function xh(l,d,p){var y=d.pendingProps,T=y.children,S=l!==null?l.memoizedState:null;if(y.mode==="hidden"){if((d.flags&128)!==0){if(y=S!==null?S.baseLanes|p:p,l!==null){for(T=d.child=l.child,S=0;T!==null;)S=S|T.lanes|T.childLanes,T=T.sibling;d.childLanes=S&~y}else d.childLanes=0,d.child=null;return yh(l,d,y,p)}if((p&536870912)!==0)d.memoizedState={baseLanes:0,cachePool:null},l!==null&&qo(d,S!==null?S.cachePool:null),S!==null?gd(d,S):yc(),ih(d);else return d.lanes=d.childLanes=536870912,yh(l,d,S!==null?S.baseLanes|p:p,p)}else S!==null?(qo(d,S.cachePool),gd(d,S),ki(),d.memoizedState=null):(l!==null&&qo(d,null),yc(),ki());return $r(l,d,T,p),d.child}function yh(l,d,p,y){var T=hc();return T=T===null?null:{parent:Dr._currentValue,pool:T},d.memoizedState={baseLanes:p,cachePool:T},l!==null&&qo(d,null),yc(),ih(d),l!==null&&Ba(l,d,y,!0),null}function dl(l,d){var p=d.ref;if(p===null)l!==null&&l.ref!==null&&(d.flags|=4194816);else{if(typeof p!="function"&&typeof p!="object")throw Error(n(284));(l===null||l.ref!==p)&&(d.flags|=4194816)}}function jc(l,d,p,y,T){return Es(d),p=vc(l,d,p,y,void 0,T),y=Ac(),l!==null&&!Nr?(Tc(l,d,T),xi(l,d,T)):(Ut&&y&&ic(d),d.flags|=1,$r(l,d,p,T),d.child)}function _h(l,d,p,y,T,S){return Es(d),d.updateQueue=null,p=yd(d,y,p,T),xd(l),y=Ac(),l!==null&&!Nr?(Tc(l,d,S),xi(l,d,S)):(Ut&&y&&ic(d),d.flags|=1,$r(l,d,p,S),d.child)}function Eh(l,d,p,y,T){if(Es(d),d.stateNode===null){var S=Ws,ee=p.contextType;typeof ee=="object"&&ee!==null&&(S=Gr(ee)),S=new p(y,S),d.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=Bc,d.stateNode=S,S._reactInternals=d,S=d.stateNode,S.props=y,S.state=d.memoizedState,S.refs={},pc(d),ee=p.contextType,S.context=typeof ee=="object"&&ee!==null?Gr(ee):Ws,S.state=d.memoizedState,ee=p.getDerivedStateFromProps,typeof ee=="function"&&(Vc(d,p,ee,y),S.state=d.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(ee=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),ee!==S.state&&Bc.enqueueReplaceState(S,S.state,null),Ga(d,y,S,T),za(),S.state=d.memoizedState),typeof S.componentDidMount=="function"&&(d.flags|=4194308),y=!0}else if(l===null){S=d.stateNode;var te=d.memoizedProps,oe=Ts(p,te);S.props=oe;var _e=S.context,we=p.contextType;ee=Ws,typeof we=="object"&&we!==null&&(ee=Gr(we));var Oe=p.getDerivedStateFromProps;we=typeof Oe=="function"||typeof S.getSnapshotBeforeUpdate=="function",te=d.pendingProps!==te,we||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(te||_e!==ee)&&ah(d,S,y,ee),wi=!1;var Ee=d.memoizedState;S.state=Ee,Ga(d,y,S,T),za(),_e=d.memoizedState,te||Ee!==_e||wi?(typeof Oe=="function"&&(Vc(d,p,Oe,y),_e=d.memoizedState),(oe=wi||sh(d,p,oe,y,Ee,_e,ee))?(we||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(d.flags|=4194308)):(typeof S.componentDidMount=="function"&&(d.flags|=4194308),d.memoizedProps=y,d.memoizedState=_e),S.props=y,S.state=_e,S.context=ee,y=oe):(typeof S.componentDidMount=="function"&&(d.flags|=4194308),y=!1)}else{S=d.stateNode,mc(l,d),ee=d.memoizedProps,we=Ts(p,ee),S.props=we,Oe=d.pendingProps,Ee=S.context,_e=p.contextType,oe=Ws,typeof _e=="object"&&_e!==null&&(oe=Gr(_e)),te=p.getDerivedStateFromProps,(_e=typeof te=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(ee!==Oe||Ee!==oe)&&ah(d,S,y,oe),wi=!1,Ee=d.memoizedState,S.state=Ee,Ga(d,y,S,T),za();var ve=d.memoizedState;ee!==Oe||Ee!==ve||wi||l!==null&&l.dependencies!==null&&Wo(l.dependencies)?(typeof te=="function"&&(Vc(d,p,te,y),ve=d.memoizedState),(we=wi||sh(d,p,we,y,Ee,ve,oe)||l!==null&&l.dependencies!==null&&Wo(l.dependencies))?(_e||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(y,ve,oe),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(y,ve,oe)),typeof S.componentDidUpdate=="function"&&(d.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(d.flags|=1024)):(typeof S.componentDidUpdate!="function"||ee===l.memoizedProps&&Ee===l.memoizedState||(d.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||ee===l.memoizedProps&&Ee===l.memoizedState||(d.flags|=1024),d.memoizedProps=y,d.memoizedState=ve),S.props=y,S.state=ve,S.context=oe,y=we):(typeof S.componentDidUpdate!="function"||ee===l.memoizedProps&&Ee===l.memoizedState||(d.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||ee===l.memoizedProps&&Ee===l.memoizedState||(d.flags|=1024),y=!1)}return S=y,dl(l,d),y=(d.flags&128)!==0,S||y?(S=d.stateNode,p=y&&typeof p.getDerivedStateFromError!="function"?null:S.render(),d.flags|=1,l!==null&&y?(d.child=ra(d,l.child,null,T),d.child=ra(d,null,p,T)):$r(l,d,p,T),d.memoizedState=S.state,l=d.child):l=xi(l,d,T),l}function vh(l,d,p,y){return Na(),d.flags|=256,$r(l,d,p,y),d.child}var Fc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Uc(l){return{baseLanes:l,cachePool:ld()}}function $c(l,d,p){return l=l!==null?l.childLanes&~p:0,d&&(l|=Pn),l}function Ah(l,d,p){var y=d.pendingProps,T=!1,S=(d.flags&128)!==0,ee;if((ee=S)||(ee=l!==null&&l.memoizedState===null?!1:(Or.current&2)!==0),ee&&(T=!0,d.flags&=-129),ee=(d.flags&32)!==0,d.flags&=-33,l===null){if(Ut){if(T?Mi(d):ki(),Ut){var te=gr,oe;if(oe=te){e:{for(oe=te,te=Yn;oe.nodeType!==8;){if(!te){te=null;break e}if(oe=Vn(oe.nextSibling),oe===null){te=null;break e}}te=oe}te!==null?(d.memoizedState={dehydrated:te,treeContext:ms!==null?{id:ui,overflow:di}:null,retryLane:536870912,hydrationErrors:null},oe=hn(18,null,null,0),oe.stateNode=te,oe.return=d,d.child=oe,Kr=d,gr=null,oe=!0):oe=!1}oe||ys(d)}if(te=d.memoizedState,te!==null&&(te=te.dehydrated,te!==null))return Su(te)?d.lanes=32:d.lanes=536870912,null;gi(d)}return te=y.children,y=y.fallback,T?(ki(),T=d.mode,te=hl({mode:"hidden",children:te},T),y=ps(y,T,p,null),te.return=d,y.return=d,te.sibling=y,d.child=te,T=d.child,T.memoizedState=Uc(p),T.childLanes=$c(l,ee,p),d.memoizedState=Fc,y):(Mi(d),Hc(d,te))}if(oe=l.memoizedState,oe!==null&&(te=oe.dehydrated,te!==null)){if(S)d.flags&256?(Mi(d),d.flags&=-257,d=zc(l,d,p)):d.memoizedState!==null?(ki(),d.child=l.child,d.flags|=128,d=null):(ki(),T=y.fallback,te=d.mode,y=hl({mode:"visible",children:y.children},te),T=ps(T,te,p,null),T.flags|=2,y.return=d,T.return=d,y.sibling=T,d.child=y,ra(d,l.child,null,p),y=d.child,y.memoizedState=Uc(p),y.childLanes=$c(l,ee,p),d.memoizedState=Fc,d=T);else if(Mi(d),Su(te)){if(ee=te.nextSibling&&te.nextSibling.dataset,ee)var _e=ee.dgst;ee=_e,y=Error(n(419)),y.stack="",y.digest=ee,Va({value:y,source:null,stack:null}),d=zc(l,d,p)}else if(Nr||Ba(l,d,p,!1),ee=(p&l.childLanes)!==0,Nr||ee){if(ee=lr,ee!==null&&(y=p&-p,y=(y&42)!==0?1:Zn(y),y=(y&(ee.suspendedLanes|p))!==0?0:y,y!==0&&y!==oe.retryLane))throw oe.retryLane=y,Gs(l,y),xn(ee,l,y),fh;te.data==="$?"||lu(),d=zc(l,d,p)}else te.data==="$?"?(d.flags|=192,d.child=l.child,d=null):(l=oe.treeContext,gr=Vn(te.nextSibling),Kr=d,Ut=!0,xs=null,Yn=!1,l!==null&&(bn[Rn++]=ui,bn[Rn++]=di,bn[Rn++]=ms,ui=l.id,di=l.overflow,ms=d),d=Hc(d,y.children),d.flags|=4096);return d}return T?(ki(),T=y.fallback,te=d.mode,oe=l.child,_e=oe.sibling,y=ci(oe,{mode:"hidden",children:y.children}),y.subtreeFlags=oe.subtreeFlags&65011712,_e!==null?T=ci(_e,T):(T=ps(T,te,p,null),T.flags|=2),T.return=d,y.return=d,y.sibling=T,d.child=y,y=T,T=d.child,te=l.child.memoizedState,te===null?te=Uc(p):(oe=te.cachePool,oe!==null?(_e=Dr._currentValue,oe=oe.parent!==_e?{parent:_e,pool:_e}:oe):oe=ld(),te={baseLanes:te.baseLanes|p,cachePool:oe}),T.memoizedState=te,T.childLanes=$c(l,ee,p),d.memoizedState=Fc,y):(Mi(d),p=l.child,l=p.sibling,p=ci(p,{mode:"visible",children:y.children}),p.return=d,p.sibling=null,l!==null&&(ee=d.deletions,ee===null?(d.deletions=[l],d.flags|=16):ee.push(l)),d.child=p,d.memoizedState=null,p)}function Hc(l,d){return d=hl({mode:"visible",children:d},l.mode),d.return=l,l.child=d}function hl(l,d){return l=hn(22,l,null,d),l.lanes=0,l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},l}function zc(l,d,p){return ra(d,l.child,null,p),l=Hc(d,d.pendingProps.children),l.flags|=2,d.memoizedState=null,l}function Th(l,d,p){l.lanes|=d;var y=l.alternate;y!==null&&(y.lanes|=d),lc(l.return,d,p)}function Gc(l,d,p,y,T){var S=l.memoizedState;S===null?l.memoizedState={isBackwards:d,rendering:null,renderingStartTime:0,last:y,tail:p,tailMode:T}:(S.isBackwards=d,S.rendering=null,S.renderingStartTime=0,S.last=y,S.tail=p,S.tailMode=T)}function Ch(l,d,p){var y=d.pendingProps,T=y.revealOrder,S=y.tail;if($r(l,d,y.children,p),y=Or.current,(y&2)!==0)y=y&1|2,d.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=d.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Th(l,p,d);else if(l.tag===19)Th(l,p,d);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===d)break e;for(;l.sibling===null;){if(l.return===null||l.return===d)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}y&=1}switch(he(Or,y),T){case"forwards":for(p=d.child,T=null;p!==null;)l=p.alternate,l!==null&&ll(l)===null&&(T=p),p=p.sibling;p=T,p===null?(T=d.child,d.child=null):(T=p.sibling,p.sibling=null),Gc(d,!1,T,p,S);break;case"backwards":for(p=null,T=d.child,d.child=null;T!==null;){if(l=T.alternate,l!==null&&ll(l)===null){d.child=T;break}l=T.sibling,T.sibling=p,p=T,T=l}Gc(d,!0,p,null,S);break;case"together":Gc(d,!1,null,null,void 0);break;default:d.memoizedState=null}return d.child}function xi(l,d,p){if(l!==null&&(d.dependencies=l.dependencies),ji|=d.lanes,(p&d.childLanes)===0)if(l!==null){if(Ba(l,d,p,!1),(p&d.childLanes)===0)return null}else return null;if(l!==null&&d.child!==l.child)throw Error(n(153));if(d.child!==null){for(l=d.child,p=ci(l,l.pendingProps),d.child=p,p.return=d;l.sibling!==null;)l=l.sibling,p=p.sibling=ci(l,l.pendingProps),p.return=d;p.sibling=null}return d.child}function Wc(l,d){return(l.lanes&d)!==0?!0:(l=l.dependencies,!!(l!==null&&Wo(l)))}function xp(l,d,p){switch(d.tag){case 3:qe(d,d.stateNode.containerInfo),Ri(d,Dr,l.memoizedState.cache),Na();break;case 27:case 5:Ie(d);break;case 4:qe(d,d.stateNode.containerInfo);break;case 10:Ri(d,d.type,d.memoizedProps.value);break;case 13:var y=d.memoizedState;if(y!==null)return y.dehydrated!==null?(Mi(d),d.flags|=128,null):(p&d.child.childLanes)!==0?Ah(l,d,p):(Mi(d),l=xi(l,d,p),l!==null?l.sibling:null);Mi(d);break;case 19:var T=(l.flags&128)!==0;if(y=(p&d.childLanes)!==0,y||(Ba(l,d,p,!1),y=(p&d.childLanes)!==0),T){if(y)return Ch(l,d,p);d.flags|=128}if(T=d.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),he(Or,Or.current),y)break;return null;case 22:case 23:return d.lanes=0,xh(l,d,p);case 24:Ri(d,Dr,l.memoizedState.cache)}return xi(l,d,p)}function Sh(l,d,p){if(l!==null)if(l.memoizedProps!==d.pendingProps)Nr=!0;else{if(!Wc(l,p)&&(d.flags&128)===0)return Nr=!1,xp(l,d,p);Nr=(l.flags&131072)!==0}else Nr=!1,Ut&&(d.flags&1048576)!==0&&td(d,Go,d.index);switch(d.lanes=0,d.tag){case 16:e:{l=d.pendingProps;var y=d.elementType,T=y._init;if(y=T(y._payload),d.type=y,typeof y=="function")tc(y)?(l=Ts(y,l),d.tag=1,d=Eh(null,d,y,l,p)):(d.tag=0,d=jc(null,d,y,l,p));else{if(y!=null){if(T=y.$$typeof,T===V){d.tag=11,d=ph(null,d,y,l,p);break e}else if(T===j){d.tag=14,d=mh(null,d,y,l,p);break e}}throw d=ae(y)||y,Error(n(306,d,""))}}return d;case 0:return jc(l,d,d.type,d.pendingProps,p);case 1:return y=d.type,T=Ts(y,d.pendingProps),Eh(l,d,y,T,p);case 3:e:{if(qe(d,d.stateNode.containerInfo),l===null)throw Error(n(387));y=d.pendingProps;var S=d.memoizedState;T=S.element,mc(l,d),Ga(d,y,null,p);var ee=d.memoizedState;if(y=ee.cache,Ri(d,Dr,y),y!==S.cache&&cc(d,[Dr],p,!0),za(),y=ee.element,S.isDehydrated)if(S={element:y,isDehydrated:!1,cache:ee.cache},d.updateQueue.baseState=S,d.memoizedState=S,d.flags&256){d=vh(l,d,y,p);break e}else if(y!==T){T=Sn(Error(n(424)),d),Va(T),d=vh(l,d,y,p);break e}else{switch(l=d.stateNode.containerInfo,l.nodeType){case 9:l=l.body;break;default:l=l.nodeName==="HTML"?l.ownerDocument.body:l}for(gr=Vn(l.firstChild),Kr=d,Ut=!0,xs=null,Yn=!0,p=nh(d,null,y,p),d.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling}else{if(Na(),y===T){d=xi(l,d,p);break e}$r(l,d,y,p)}d=d.child}return d;case 26:return dl(l,d),l===null?(p=Pf(d.type,null,d.pendingProps,null))?d.memoizedState=p:Ut||(p=d.type,l=d.pendingProps,y=Il(Le.current).createElement(p),y[Rr]=d,y[Cr]=l,zr(y,p,l),_r(y),d.stateNode=y):d.memoizedState=Pf(d.type,l.memoizedProps,d.pendingProps,l.memoizedState),null;case 27:return Ie(d),l===null&&Ut&&(y=d.stateNode=bf(d.type,d.pendingProps,Le.current),Kr=d,Yn=!0,T=gr,Hi(d.type)?(Iu=T,gr=Vn(y.firstChild)):gr=T),$r(l,d,d.pendingProps.children,p),dl(l,d),l===null&&(d.flags|=4194304),d.child;case 5:return l===null&&Ut&&((T=y=gr)&&(y=Gp(y,d.type,d.pendingProps,Yn),y!==null?(d.stateNode=y,Kr=d,gr=Vn(y.firstChild),Yn=!1,T=!0):T=!1),T||ys(d)),Ie(d),T=d.type,S=d.pendingProps,ee=l!==null?l.memoizedProps:null,y=S.children,Au(T,S)?y=null:ee!==null&&Au(T,ee)&&(d.flags|=32),d.memoizedState!==null&&(T=vc(l,d,cp,null,null,p),po._currentValue=T),dl(l,d),$r(l,d,y,p),d.child;case 6:return l===null&&Ut&&((l=p=gr)&&(p=Wp(p,d.pendingProps,Yn),p!==null?(d.stateNode=p,Kr=d,gr=null,l=!0):l=!1),l||ys(d)),null;case 13:return Ah(l,d,p);case 4:return qe(d,d.stateNode.containerInfo),y=d.pendingProps,l===null?d.child=ra(d,null,y,p):$r(l,d,y,p),d.child;case 11:return ph(l,d,d.type,d.pendingProps,p);case 7:return $r(l,d,d.pendingProps,p),d.child;case 8:return $r(l,d,d.pendingProps.children,p),d.child;case 12:return $r(l,d,d.pendingProps.children,p),d.child;case 10:return y=d.pendingProps,Ri(d,d.type,y.value),$r(l,d,y.children,p),d.child;case 9:return T=d.type._context,y=d.pendingProps.children,Es(d),T=Gr(T),y=y(T),d.flags|=1,$r(l,d,y,p),d.child;case 14:return mh(l,d,d.type,d.pendingProps,p);case 15:return gh(l,d,d.type,d.pendingProps,p);case 19:return Ch(l,d,p);case 31:return y=d.pendingProps,p=d.mode,y={mode:y.mode,children:y.children},l===null?(p=hl(y,p),p.ref=d.ref,d.child=p,p.return=d,d=p):(p=ci(l.child,y),p.ref=d.ref,d.child=p,p.return=d,d=p),d;case 22:return xh(l,d,p);case 24:return Es(d),y=Gr(Dr),l===null?(T=hc(),T===null&&(T=lr,S=uc(),T.pooledCache=S,S.refCount++,S!==null&&(T.pooledCacheLanes|=p),T=S),d.memoizedState={parent:y,cache:T},pc(d),Ri(d,Dr,T)):((l.lanes&p)!==0&&(mc(l,d),Ga(d,null,null,p),za()),T=l.memoizedState,S=d.memoizedState,T.parent!==y?(T={parent:y,cache:y},d.memoizedState=T,d.lanes===0&&(d.memoizedState=d.updateQueue.baseState=T),Ri(d,Dr,y)):(y=S.cache,Ri(d,Dr,y),y!==T.cache&&cc(d,[Dr],p,!0))),$r(l,d,d.pendingProps.children,p),d.child;case 29:throw d.pendingProps}throw Error(n(156,d.tag))}function yi(l){l.flags|=4}function Ih(l,d){if(d.type!=="stylesheet"||(d.state.loading&4)!==0)l.flags&=-16777217;else if(l.flags|=16777216,!Nf(d)){if(d=wn.current,d!==null&&((Nt&4194048)===Nt?qn!==null:(Nt&62914560)!==Nt&&(Nt&536870912)===0||d!==qn))throw $a=fc,cd;l.flags|=8192}}function fl(l,d){d!==null&&(l.flags|=4),l.flags&16384&&(d=l.tag!==22?jr():536870912,l.lanes|=d,aa|=d)}function Za(l,d){if(!Ut)switch(l.tailMode){case"hidden":d=l.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?l.tail=null:p.sibling=null;break;case"collapsed":p=l.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?d||l.tail===null?l.tail=null:l.tail.sibling=null:y.sibling=null}}function mr(l){var d=l.alternate!==null&&l.alternate.child===l.child,p=0,y=0;if(d)for(var T=l.child;T!==null;)p|=T.lanes|T.childLanes,y|=T.subtreeFlags&65011712,y|=T.flags&65011712,T.return=l,T=T.sibling;else for(T=l.child;T!==null;)p|=T.lanes|T.childLanes,y|=T.subtreeFlags,y|=T.flags,T.return=l,T=T.sibling;return l.subtreeFlags|=y,l.childLanes=p,d}function yp(l,d,p){var y=d.pendingProps;switch(sc(d),d.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mr(d),null;case 1:return mr(d),null;case 3:return p=d.stateNode,y=null,l!==null&&(y=l.memoizedState.cache),d.memoizedState.cache!==y&&(d.flags|=2048),fi(Dr),xe(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(l===null||l.child===null)&&(ka(d)?yi(d):l===null||l.memoizedState.isDehydrated&&(d.flags&256)===0||(d.flags|=1024,id())),mr(d),null;case 26:return p=d.memoizedState,l===null?(yi(d),p!==null?(mr(d),Ih(d,p)):(mr(d),d.flags&=-16777217)):p?p!==l.memoizedState?(yi(d),mr(d),Ih(d,p)):(mr(d),d.flags&=-16777217):(l.memoizedProps!==y&&yi(d),mr(d),d.flags&=-16777217),null;case 27:Te(d),p=Le.current;var T=d.type;if(l!==null&&d.stateNode!=null)l.memoizedProps!==y&&yi(d);else{if(!y){if(d.stateNode===null)throw Error(n(166));return mr(d),null}l=ke.current,ka(d)?rd(d):(l=bf(T,y,p),d.stateNode=l,yi(d))}return mr(d),null;case 5:if(Te(d),p=d.type,l!==null&&d.stateNode!=null)l.memoizedProps!==y&&yi(d);else{if(!y){if(d.stateNode===null)throw Error(n(166));return mr(d),null}if(l=ke.current,ka(d))rd(d);else{switch(T=Il(Le.current),l){case 1:l=T.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:l=T.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":l=T.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":l=T.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":l=T.createElement("div"),l.innerHTML="<script><\/script>",l=l.removeChild(l.firstChild);break;case"select":l=typeof y.is=="string"?T.createElement("select",{is:y.is}):T.createElement("select"),y.multiple?l.multiple=!0:y.size&&(l.size=y.size);break;default:l=typeof y.is=="string"?T.createElement(p,{is:y.is}):T.createElement(p)}}l[Rr]=d,l[Cr]=y;e:for(T=d.child;T!==null;){if(T.tag===5||T.tag===6)l.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===d)break e;for(;T.sibling===null;){if(T.return===null||T.return===d)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}d.stateNode=l;e:switch(zr(l,p,y),p){case"button":case"input":case"select":case"textarea":l=!!y.autoFocus;break e;case"img":l=!0;break e;default:l=!1}l&&yi(d)}}return mr(d),d.flags&=-16777217,null;case 6:if(l&&d.stateNode!=null)l.memoizedProps!==y&&yi(d);else{if(typeof y!="string"&&d.stateNode===null)throw Error(n(166));if(l=Le.current,ka(d)){if(l=d.stateNode,p=d.memoizedProps,y=null,T=Kr,T!==null)switch(T.tag){case 27:case 5:y=T.memoizedProps}l[Rr]=d,l=!!(l.nodeValue===p||y!==null&&y.suppressHydrationWarning===!0||Ef(l.nodeValue,p)),l||ys(d)}else l=Il(l).createTextNode(y),l[Rr]=d,d.stateNode=l}return mr(d),null;case 13:if(y=d.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(T=ka(d),y!==null&&y.dehydrated!==null){if(l===null){if(!T)throw Error(n(318));if(T=d.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(n(317));T[Rr]=d}else Na(),(d.flags&128)===0&&(d.memoizedState=null),d.flags|=4;mr(d),T=!1}else T=id(),l!==null&&l.memoizedState!==null&&(l.memoizedState.hydrationErrors=T),T=!0;if(!T)return d.flags&256?(gi(d),d):(gi(d),null)}if(gi(d),(d.flags&128)!==0)return d.lanes=p,d;if(p=y!==null,l=l!==null&&l.memoizedState!==null,p){y=d.child,T=null,y.alternate!==null&&y.alternate.memoizedState!==null&&y.alternate.memoizedState.cachePool!==null&&(T=y.alternate.memoizedState.cachePool.pool);var S=null;y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(S=y.memoizedState.cachePool.pool),S!==T&&(y.flags|=2048)}return p!==l&&p&&(d.child.flags|=8192),fl(d,d.updateQueue),mr(d),null;case 4:return xe(),l===null&&xu(d.stateNode.containerInfo),mr(d),null;case 10:return fi(d.type),mr(d),null;case 19:if(ye(Or),T=d.memoizedState,T===null)return mr(d),null;if(y=(d.flags&128)!==0,S=T.rendering,S===null)if(y)Za(T,!1);else{if(xr!==0||l!==null&&(l.flags&128)!==0)for(l=d.child;l!==null;){if(S=ll(l),S!==null){for(d.flags|=128,Za(T,!1),l=S.updateQueue,d.updateQueue=l,fl(d,l),d.subtreeFlags=0,l=p,p=d.child;p!==null;)ed(p,l),p=p.sibling;return he(Or,Or.current&1|2),d.child}l=l.sibling}T.tail!==null&&Me()>gl&&(d.flags|=128,y=!0,Za(T,!1),d.lanes=4194304)}else{if(!y)if(l=ll(S),l!==null){if(d.flags|=128,y=!0,l=l.updateQueue,d.updateQueue=l,fl(d,l),Za(T,!0),T.tail===null&&T.tailMode==="hidden"&&!S.alternate&&!Ut)return mr(d),null}else 2*Me()-T.renderingStartTime>gl&&p!==536870912&&(d.flags|=128,y=!0,Za(T,!1),d.lanes=4194304);T.isBackwards?(S.sibling=d.child,d.child=S):(l=T.last,l!==null?l.sibling=S:d.child=S,T.last=S)}return T.tail!==null?(d=T.tail,T.rendering=d,T.tail=d.sibling,T.renderingStartTime=Me(),d.sibling=null,l=Or.current,he(Or,y?l&1|2:l&1),d):(mr(d),null);case 22:case 23:return gi(d),_c(),y=d.memoizedState!==null,l!==null?l.memoizedState!==null!==y&&(d.flags|=8192):y&&(d.flags|=8192),y?(p&536870912)!==0&&(d.flags&128)===0&&(mr(d),d.subtreeFlags&6&&(d.flags|=8192)):mr(d),p=d.updateQueue,p!==null&&fl(d,p.retryQueue),p=null,l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),y=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==p&&(d.flags|=2048),l!==null&&ye(vs),null;case 24:return p=null,l!==null&&(p=l.memoizedState.cache),d.memoizedState.cache!==p&&(d.flags|=2048),fi(Dr),mr(d),null;case 25:return null;case 30:return null}throw Error(n(156,d.tag))}function _p(l,d){switch(sc(d),d.tag){case 1:return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 3:return fi(Dr),xe(),l=d.flags,(l&65536)!==0&&(l&128)===0?(d.flags=l&-65537|128,d):null;case 26:case 27:case 5:return Te(d),null;case 13:if(gi(d),l=d.memoizedState,l!==null&&l.dehydrated!==null){if(d.alternate===null)throw Error(n(340));Na()}return l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 19:return ye(Or),null;case 4:return xe(),null;case 10:return fi(d.type),null;case 22:case 23:return gi(d),_c(),l!==null&&ye(vs),l=d.flags,l&65536?(d.flags=l&-65537|128,d):null;case 24:return fi(Dr),null;case 25:return null;default:return null}}function bh(l,d){switch(sc(d),d.tag){case 3:fi(Dr),xe();break;case 26:case 27:case 5:Te(d);break;case 4:xe();break;case 13:gi(d);break;case 19:ye(Or);break;case 10:fi(d.type);break;case 22:case 23:gi(d),_c(),l!==null&&ye(vs);break;case 24:fi(Dr)}}function Ja(l,d){try{var p=d.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var T=y.next;p=T;do{if((p.tag&l)===l){y=void 0;var S=p.create,ee=p.inst;y=S(),ee.destroy=y}p=p.next}while(p!==T)}}catch(te){ar(d,d.return,te)}}function Ni(l,d,p){try{var y=d.updateQueue,T=y!==null?y.lastEffect:null;if(T!==null){var S=T.next;y=S;do{if((y.tag&l)===l){var ee=y.inst,te=ee.destroy;if(te!==void 0){ee.destroy=void 0,T=d;var oe=p,_e=te;try{_e()}catch(we){ar(T,oe,we)}}}y=y.next}while(y!==S)}}catch(we){ar(d,d.return,we)}}function Rh(l){var d=l.updateQueue;if(d!==null){var p=l.stateNode;try{md(d,p)}catch(y){ar(l,l.return,y)}}}function wh(l,d,p){p.props=Ts(l.type,l.memoizedProps),p.state=l.memoizedState;try{p.componentWillUnmount()}catch(y){ar(l,d,y)}}function eo(l,d){try{var p=l.ref;if(p!==null){switch(l.tag){case 26:case 27:case 5:var y=l.stateNode;break;case 30:y=l.stateNode;break;default:y=l.stateNode}typeof p=="function"?l.refCleanup=p(y):p.current=y}}catch(T){ar(l,d,T)}}function Xn(l,d){var p=l.ref,y=l.refCleanup;if(p!==null)if(typeof y=="function")try{y()}catch(T){ar(l,d,T)}finally{l.refCleanup=null,l=l.alternate,l!=null&&(l.refCleanup=null)}else if(typeof p=="function")try{p(null)}catch(T){ar(l,d,T)}else p.current=null}function Ph(l){var d=l.type,p=l.memoizedProps,y=l.stateNode;try{e:switch(d){case"button":case"input":case"select":case"textarea":p.autoFocus&&y.focus();break e;case"img":p.src?y.src=p.src:p.srcSet&&(y.srcset=p.srcSet)}}catch(T){ar(l,l.return,T)}}function Yc(l,d,p){try{var y=l.stateNode;Fp(y,l.type,p,d),y[Cr]=d}catch(T){ar(l,l.return,T)}}function Dh(l){return l.tag===5||l.tag===3||l.tag===26||l.tag===27&&Hi(l.type)||l.tag===4}function qc(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Dh(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.tag===27&&Hi(l.type)||l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function Xc(l,d,p){var y=l.tag;if(y===5||y===6)l=l.stateNode,d?(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p).insertBefore(l,d):(d=p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,d.appendChild(l),p=p._reactRootContainer,p!=null||d.onclick!==null||(d.onclick=Sl));else if(y!==4&&(y===27&&Hi(l.type)&&(p=l.stateNode,d=null),l=l.child,l!==null))for(Xc(l,d,p),l=l.sibling;l!==null;)Xc(l,d,p),l=l.sibling}function pl(l,d,p){var y=l.tag;if(y===5||y===6)l=l.stateNode,d?p.insertBefore(l,d):p.appendChild(l);else if(y!==4&&(y===27&&Hi(l.type)&&(p=l.stateNode),l=l.child,l!==null))for(pl(l,d,p),l=l.sibling;l!==null;)pl(l,d,p),l=l.sibling}function Oh(l){var d=l.stateNode,p=l.memoizedProps;try{for(var y=l.type,T=d.attributes;T.length;)d.removeAttributeNode(T[0]);zr(d,y,p),d[Rr]=l,d[Cr]=p}catch(S){ar(l,l.return,S)}}var _i=!1,vr=!1,Kc=!1,Mh=typeof WeakSet=="function"?WeakSet:Set,Vr=null;function Ep(l,d){if(l=l.containerInfo,Eu=Ol,l=zu(l),ql(l)){if("selectionStart"in l)var p={start:l.selectionStart,end:l.selectionEnd};else e:{p=(p=l.ownerDocument)&&p.defaultView||window;var y=p.getSelection&&p.getSelection();if(y&&y.rangeCount!==0){p=y.anchorNode;var T=y.anchorOffset,S=y.focusNode;y=y.focusOffset;try{p.nodeType,S.nodeType}catch{p=null;break e}var ee=0,te=-1,oe=-1,_e=0,we=0,Oe=l,Ee=null;t:for(;;){for(var ve;Oe!==p||T!==0&&Oe.nodeType!==3||(te=ee+T),Oe!==S||y!==0&&Oe.nodeType!==3||(oe=ee+y),Oe.nodeType===3&&(ee+=Oe.nodeValue.length),(ve=Oe.firstChild)!==null;)Ee=Oe,Oe=ve;for(;;){if(Oe===l)break t;if(Ee===p&&++_e===T&&(te=ee),Ee===S&&++we===y&&(oe=ee),(ve=Oe.nextSibling)!==null)break;Oe=Ee,Ee=Oe.parentNode}Oe=ve}p=te===-1||oe===-1?null:{start:te,end:oe}}else p=null}p=p||{start:0,end:0}}else p=null;for(vu={focusedElem:l,selectionRange:p},Ol=!1,Vr=d;Vr!==null;)if(d=Vr,l=d.child,(d.subtreeFlags&1024)!==0&&l!==null)l.return=d,Vr=l;else for(;Vr!==null;){switch(d=Vr,S=d.alternate,l=d.flags,d.tag){case 0:break;case 11:case 15:break;case 1:if((l&1024)!==0&&S!==null){l=void 0,p=d,T=S.memoizedProps,S=S.memoizedState,y=p.stateNode;try{var Je=Ts(p.type,T,p.elementType===p.type);l=y.getSnapshotBeforeUpdate(Je,S),y.__reactInternalSnapshotBeforeUpdate=l}catch(Qe){ar(p,p.return,Qe)}}break;case 3:if((l&1024)!==0){if(l=d.stateNode.containerInfo,p=l.nodeType,p===9)Cu(l);else if(p===1)switch(l.nodeName){case"HEAD":case"HTML":case"BODY":Cu(l);break;default:l.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((l&1024)!==0)throw Error(n(163))}if(l=d.sibling,l!==null){l.return=d.return,Vr=l;break}Vr=d.return}}function kh(l,d,p){var y=p.flags;switch(p.tag){case 0:case 11:case 15:Vi(l,p),y&4&&Ja(5,p);break;case 1:if(Vi(l,p),y&4)if(l=p.stateNode,d===null)try{l.componentDidMount()}catch(ee){ar(p,p.return,ee)}else{var T=Ts(p.type,d.memoizedProps);d=d.memoizedState;try{l.componentDidUpdate(T,d,l.__reactInternalSnapshotBeforeUpdate)}catch(ee){ar(p,p.return,ee)}}y&64&&Rh(p),y&512&&eo(p,p.return);break;case 3:if(Vi(l,p),y&64&&(l=p.updateQueue,l!==null)){if(d=null,p.child!==null)switch(p.child.tag){case 27:case 5:d=p.child.stateNode;break;case 1:d=p.child.stateNode}try{md(l,d)}catch(ee){ar(p,p.return,ee)}}break;case 27:d===null&&y&4&&Oh(p);case 26:case 5:Vi(l,p),d===null&&y&4&&Ph(p),y&512&&eo(p,p.return);break;case 12:Vi(l,p);break;case 13:Vi(l,p),y&4&&Bh(l,p),y&64&&(l=p.memoizedState,l!==null&&(l=l.dehydrated,l!==null&&(p=wp.bind(null,p),Yp(l,p))));break;case 22:if(y=p.memoizedState!==null||_i,!y){d=d!==null&&d.memoizedState!==null||vr,T=_i;var S=vr;_i=y,(vr=d)&&!S?Bi(l,p,(p.subtreeFlags&8772)!==0):Vi(l,p),_i=T,vr=S}break;case 30:break;default:Vi(l,p)}}function Nh(l){var d=l.alternate;d!==null&&(l.alternate=null,Nh(d)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(d=l.stateNode,d!==null&&Ci(d)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}var fr=null,Zr=!1;function Ei(l,d,p){for(p=p.child;p!==null;)Vh(l,d,p),p=p.sibling}function Vh(l,d,p){if(Ke&&typeof Ke.onCommitFiberUnmount=="function")try{Ke.onCommitFiberUnmount(Xe,p)}catch{}switch(p.tag){case 26:vr||Xn(p,d),Ei(l,d,p),p.memoizedState?p.memoizedState.count--:p.stateNode&&(p=p.stateNode,p.parentNode.removeChild(p));break;case 27:vr||Xn(p,d);var y=fr,T=Zr;Hi(p.type)&&(fr=p.stateNode,Zr=!1),Ei(l,d,p),co(p.stateNode),fr=y,Zr=T;break;case 5:vr||Xn(p,d);case 6:if(y=fr,T=Zr,fr=null,Ei(l,d,p),fr=y,Zr=T,fr!==null)if(Zr)try{(fr.nodeType===9?fr.body:fr.nodeName==="HTML"?fr.ownerDocument.body:fr).removeChild(p.stateNode)}catch(S){ar(p,d,S)}else try{fr.removeChild(p.stateNode)}catch(S){ar(p,d,S)}break;case 18:fr!==null&&(Zr?(l=fr,Sf(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,p.stateNode),yo(l)):Sf(fr,p.stateNode));break;case 4:y=fr,T=Zr,fr=p.stateNode.containerInfo,Zr=!0,Ei(l,d,p),fr=y,Zr=T;break;case 0:case 11:case 14:case 15:vr||Ni(2,p,d),vr||Ni(4,p,d),Ei(l,d,p);break;case 1:vr||(Xn(p,d),y=p.stateNode,typeof y.componentWillUnmount=="function"&&wh(p,d,y)),Ei(l,d,p);break;case 21:Ei(l,d,p);break;case 22:vr=(y=vr)||p.memoizedState!==null,Ei(l,d,p),vr=y;break;default:Ei(l,d,p)}}function Bh(l,d){if(d.memoizedState===null&&(l=d.alternate,l!==null&&(l=l.memoizedState,l!==null&&(l=l.dehydrated,l!==null))))try{yo(l)}catch(p){ar(d,d.return,p)}}function vp(l){switch(l.tag){case 13:case 19:var d=l.stateNode;return d===null&&(d=l.stateNode=new Mh),d;case 22:return l=l.stateNode,d=l._retryCache,d===null&&(d=l._retryCache=new Mh),d;default:throw Error(n(435,l.tag))}}function Qc(l,d){var p=vp(l);d.forEach(function(y){var T=Pp.bind(null,l,y);p.has(y)||(p.add(y),y.then(T,T))})}function fn(l,d){var p=d.deletions;if(p!==null)for(var y=0;y<p.length;y++){var T=p[y],S=l,ee=d,te=ee;e:for(;te!==null;){switch(te.tag){case 27:if(Hi(te.type)){fr=te.stateNode,Zr=!1;break e}break;case 5:fr=te.stateNode,Zr=!1;break e;case 3:case 4:fr=te.stateNode.containerInfo,Zr=!0;break e}te=te.return}if(fr===null)throw Error(n(160));Vh(S,ee,T),fr=null,Zr=!1,S=T.alternate,S!==null&&(S.return=null),T.return=null}if(d.subtreeFlags&13878)for(d=d.child;d!==null;)Lh(d,l),d=d.sibling}var Nn=null;function Lh(l,d){var p=l.alternate,y=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:fn(d,l),pn(l),y&4&&(Ni(3,l,l.return),Ja(3,l),Ni(5,l,l.return));break;case 1:fn(d,l),pn(l),y&512&&(vr||p===null||Xn(p,p.return)),y&64&&_i&&(l=l.updateQueue,l!==null&&(y=l.callbacks,y!==null&&(p=l.shared.hiddenCallbacks,l.shared.hiddenCallbacks=p===null?y:p.concat(y))));break;case 26:var T=Nn;if(fn(d,l),pn(l),y&512&&(vr||p===null||Xn(p,p.return)),y&4){var S=p!==null?p.memoizedState:null;if(y=l.memoizedState,p===null)if(y===null)if(l.stateNode===null){e:{y=l.type,p=l.memoizedProps,T=T.ownerDocument||T;t:switch(y){case"title":S=T.getElementsByTagName("title")[0],(!S||S[Qi]||S[Rr]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=T.createElement(y),T.head.insertBefore(S,T.querySelector("head > title"))),zr(S,y,p),S[Rr]=l,_r(S),y=S;break e;case"link":var ee=Mf("link","href",T).get(y+(p.href||""));if(ee){for(var te=0;te<ee.length;te++)if(S=ee[te],S.getAttribute("href")===(p.href==null||p.href===""?null:p.href)&&S.getAttribute("rel")===(p.rel==null?null:p.rel)&&S.getAttribute("title")===(p.title==null?null:p.title)&&S.getAttribute("crossorigin")===(p.crossOrigin==null?null:p.crossOrigin)){ee.splice(te,1);break t}}S=T.createElement(y),zr(S,y,p),T.head.appendChild(S);break;case"meta":if(ee=Mf("meta","content",T).get(y+(p.content||""))){for(te=0;te<ee.length;te++)if(S=ee[te],S.getAttribute("content")===(p.content==null?null:""+p.content)&&S.getAttribute("name")===(p.name==null?null:p.name)&&S.getAttribute("property")===(p.property==null?null:p.property)&&S.getAttribute("http-equiv")===(p.httpEquiv==null?null:p.httpEquiv)&&S.getAttribute("charset")===(p.charSet==null?null:p.charSet)){ee.splice(te,1);break t}}S=T.createElement(y),zr(S,y,p),T.head.appendChild(S);break;default:throw Error(n(468,y))}S[Rr]=l,_r(S),y=S}l.stateNode=y}else kf(T,l.type,l.stateNode);else l.stateNode=Of(T,y,l.memoizedProps);else S!==y?(S===null?p.stateNode!==null&&(p=p.stateNode,p.parentNode.removeChild(p)):S.count--,y===null?kf(T,l.type,l.stateNode):Of(T,y,l.memoizedProps)):y===null&&l.stateNode!==null&&Yc(l,l.memoizedProps,p.memoizedProps)}break;case 27:fn(d,l),pn(l),y&512&&(vr||p===null||Xn(p,p.return)),p!==null&&y&4&&Yc(l,l.memoizedProps,p.memoizedProps);break;case 5:if(fn(d,l),pn(l),y&512&&(vr||p===null||Xn(p,p.return)),l.flags&32){T=l.stateNode;try{vn(T,"")}catch(ve){ar(l,l.return,ve)}}y&4&&l.stateNode!=null&&(T=l.memoizedProps,Yc(l,T,p!==null?p.memoizedProps:T)),y&1024&&(Kc=!0);break;case 6:if(fn(d,l),pn(l),y&4){if(l.stateNode===null)throw Error(n(162));y=l.memoizedProps,p=l.stateNode;try{p.nodeValue=y}catch(ve){ar(l,l.return,ve)}}break;case 3:if(wl=null,T=Nn,Nn=bl(d.containerInfo),fn(d,l),Nn=T,pn(l),y&4&&p!==null&&p.memoizedState.isDehydrated)try{yo(d.containerInfo)}catch(ve){ar(l,l.return,ve)}Kc&&(Kc=!1,jh(l));break;case 4:y=Nn,Nn=bl(l.stateNode.containerInfo),fn(d,l),pn(l),Nn=y;break;case 12:fn(d,l),pn(l);break;case 13:fn(d,l),pn(l),l.child.flags&8192&&l.memoizedState!==null!=(p!==null&&p.memoizedState!==null)&&(nu=Me()),y&4&&(y=l.updateQueue,y!==null&&(l.updateQueue=null,Qc(l,y)));break;case 22:T=l.memoizedState!==null;var oe=p!==null&&p.memoizedState!==null,_e=_i,we=vr;if(_i=_e||T,vr=we||oe,fn(d,l),vr=we,_i=_e,pn(l),y&8192)e:for(d=l.stateNode,d._visibility=T?d._visibility&-2:d._visibility|1,T&&(p===null||oe||_i||vr||Cs(l)),p=null,d=l;;){if(d.tag===5||d.tag===26){if(p===null){oe=p=d;try{if(S=oe.stateNode,T)ee=S.style,typeof ee.setProperty=="function"?ee.setProperty("display","none","important"):ee.display="none";else{te=oe.stateNode;var Oe=oe.memoizedProps.style,Ee=Oe!=null&&Oe.hasOwnProperty("display")?Oe.display:null;te.style.display=Ee==null||typeof Ee=="boolean"?"":(""+Ee).trim()}}catch(ve){ar(oe,oe.return,ve)}}}else if(d.tag===6){if(p===null){oe=d;try{oe.stateNode.nodeValue=T?"":oe.memoizedProps}catch(ve){ar(oe,oe.return,ve)}}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===l)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break e;for(;d.sibling===null;){if(d.return===null||d.return===l)break e;p===d&&(p=null),d=d.return}p===d&&(p=null),d.sibling.return=d.return,d=d.sibling}y&4&&(y=l.updateQueue,y!==null&&(p=y.retryQueue,p!==null&&(y.retryQueue=null,Qc(l,p))));break;case 19:fn(d,l),pn(l),y&4&&(y=l.updateQueue,y!==null&&(l.updateQueue=null,Qc(l,y)));break;case 30:break;case 21:break;default:fn(d,l),pn(l)}}function pn(l){var d=l.flags;if(d&2){try{for(var p,y=l.return;y!==null;){if(Dh(y)){p=y;break}y=y.return}if(p==null)throw Error(n(160));switch(p.tag){case 27:var T=p.stateNode,S=qc(l);pl(l,S,T);break;case 5:var ee=p.stateNode;p.flags&32&&(vn(ee,""),p.flags&=-33);var te=qc(l);pl(l,te,ee);break;case 3:case 4:var oe=p.stateNode.containerInfo,_e=qc(l);Xc(l,_e,oe);break;default:throw Error(n(161))}}catch(we){ar(l,l.return,we)}l.flags&=-3}d&4096&&(l.flags&=-4097)}function jh(l){if(l.subtreeFlags&1024)for(l=l.child;l!==null;){var d=l;jh(d),d.tag===5&&d.flags&1024&&d.stateNode.reset(),l=l.sibling}}function Vi(l,d){if(d.subtreeFlags&8772)for(d=d.child;d!==null;)kh(l,d.alternate,d),d=d.sibling}function Cs(l){for(l=l.child;l!==null;){var d=l;switch(d.tag){case 0:case 11:case 14:case 15:Ni(4,d,d.return),Cs(d);break;case 1:Xn(d,d.return);var p=d.stateNode;typeof p.componentWillUnmount=="function"&&wh(d,d.return,p),Cs(d);break;case 27:co(d.stateNode);case 26:case 5:Xn(d,d.return),Cs(d);break;case 22:d.memoizedState===null&&Cs(d);break;case 30:Cs(d);break;default:Cs(d)}l=l.sibling}}function Bi(l,d,p){for(p=p&&(d.subtreeFlags&8772)!==0,d=d.child;d!==null;){var y=d.alternate,T=l,S=d,ee=S.flags;switch(S.tag){case 0:case 11:case 15:Bi(T,S,p),Ja(4,S);break;case 1:if(Bi(T,S,p),y=S,T=y.stateNode,typeof T.componentDidMount=="function")try{T.componentDidMount()}catch(_e){ar(y,y.return,_e)}if(y=S,T=y.updateQueue,T!==null){var te=y.stateNode;try{var oe=T.shared.hiddenCallbacks;if(oe!==null)for(T.shared.hiddenCallbacks=null,T=0;T<oe.length;T++)pd(oe[T],te)}catch(_e){ar(y,y.return,_e)}}p&&ee&64&&Rh(S),eo(S,S.return);break;case 27:Oh(S);case 26:case 5:Bi(T,S,p),p&&y===null&&ee&4&&Ph(S),eo(S,S.return);break;case 12:Bi(T,S,p);break;case 13:Bi(T,S,p),p&&ee&4&&Bh(T,S);break;case 22:S.memoizedState===null&&Bi(T,S,p),eo(S,S.return);break;case 30:break;default:Bi(T,S,p)}d=d.sibling}}function Zc(l,d){var p=null;l!==null&&l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),l=null,d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(l=d.memoizedState.cachePool.pool),l!==p&&(l!=null&&l.refCount++,p!=null&&La(p))}function Jc(l,d){l=null,d.alternate!==null&&(l=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==l&&(d.refCount++,l!=null&&La(l))}function Kn(l,d,p,y){if(d.subtreeFlags&10256)for(d=d.child;d!==null;)Fh(l,d,p,y),d=d.sibling}function Fh(l,d,p,y){var T=d.flags;switch(d.tag){case 0:case 11:case 15:Kn(l,d,p,y),T&2048&&Ja(9,d);break;case 1:Kn(l,d,p,y);break;case 3:Kn(l,d,p,y),T&2048&&(l=null,d.alternate!==null&&(l=d.alternate.memoizedState.cache),d=d.memoizedState.cache,d!==l&&(d.refCount++,l!=null&&La(l)));break;case 12:if(T&2048){Kn(l,d,p,y),l=d.stateNode;try{var S=d.memoizedProps,ee=S.id,te=S.onPostCommit;typeof te=="function"&&te(ee,d.alternate===null?"mount":"update",l.passiveEffectDuration,-0)}catch(oe){ar(d,d.return,oe)}}else Kn(l,d,p,y);break;case 13:Kn(l,d,p,y);break;case 23:break;case 22:S=d.stateNode,ee=d.alternate,d.memoizedState!==null?S._visibility&2?Kn(l,d,p,y):to(l,d):S._visibility&2?Kn(l,d,p,y):(S._visibility|=2,na(l,d,p,y,(d.subtreeFlags&10256)!==0)),T&2048&&Zc(ee,d);break;case 24:Kn(l,d,p,y),T&2048&&Jc(d.alternate,d);break;default:Kn(l,d,p,y)}}function na(l,d,p,y,T){for(T=T&&(d.subtreeFlags&10256)!==0,d=d.child;d!==null;){var S=l,ee=d,te=p,oe=y,_e=ee.flags;switch(ee.tag){case 0:case 11:case 15:na(S,ee,te,oe,T),Ja(8,ee);break;case 23:break;case 22:var we=ee.stateNode;ee.memoizedState!==null?we._visibility&2?na(S,ee,te,oe,T):to(S,ee):(we._visibility|=2,na(S,ee,te,oe,T)),T&&_e&2048&&Zc(ee.alternate,ee);break;case 24:na(S,ee,te,oe,T),T&&_e&2048&&Jc(ee.alternate,ee);break;default:na(S,ee,te,oe,T)}d=d.sibling}}function to(l,d){if(d.subtreeFlags&10256)for(d=d.child;d!==null;){var p=l,y=d,T=y.flags;switch(y.tag){case 22:to(p,y),T&2048&&Zc(y.alternate,y);break;case 24:to(p,y),T&2048&&Jc(y.alternate,y);break;default:to(p,y)}d=d.sibling}}var ro=8192;function ia(l){if(l.subtreeFlags&ro)for(l=l.child;l!==null;)Uh(l),l=l.sibling}function Uh(l){switch(l.tag){case 26:ia(l),l.flags&ro&&l.memoizedState!==null&&am(Nn,l.memoizedState,l.memoizedProps);break;case 5:ia(l);break;case 3:case 4:var d=Nn;Nn=bl(l.stateNode.containerInfo),ia(l),Nn=d;break;case 22:l.memoizedState===null&&(d=l.alternate,d!==null&&d.memoizedState!==null?(d=ro,ro=16777216,ia(l),ro=d):ia(l));break;default:ia(l)}}function $h(l){var d=l.alternate;if(d!==null&&(l=d.child,l!==null)){d.child=null;do d=l.sibling,l.sibling=null,l=d;while(l!==null)}}function no(l){var d=l.deletions;if((l.flags&16)!==0){if(d!==null)for(var p=0;p<d.length;p++){var y=d[p];Vr=y,zh(y,l)}$h(l)}if(l.subtreeFlags&10256)for(l=l.child;l!==null;)Hh(l),l=l.sibling}function Hh(l){switch(l.tag){case 0:case 11:case 15:no(l),l.flags&2048&&Ni(9,l,l.return);break;case 3:no(l);break;case 12:no(l);break;case 22:var d=l.stateNode;l.memoizedState!==null&&d._visibility&2&&(l.return===null||l.return.tag!==13)?(d._visibility&=-3,ml(l)):no(l);break;default:no(l)}}function ml(l){var d=l.deletions;if((l.flags&16)!==0){if(d!==null)for(var p=0;p<d.length;p++){var y=d[p];Vr=y,zh(y,l)}$h(l)}for(l=l.child;l!==null;){switch(d=l,d.tag){case 0:case 11:case 15:Ni(8,d,d.return),ml(d);break;case 22:p=d.stateNode,p._visibility&2&&(p._visibility&=-3,ml(d));break;default:ml(d)}l=l.sibling}}function zh(l,d){for(;Vr!==null;){var p=Vr;switch(p.tag){case 0:case 11:case 15:Ni(8,p,d);break;case 23:case 22:if(p.memoizedState!==null&&p.memoizedState.cachePool!==null){var y=p.memoizedState.cachePool.pool;y!=null&&y.refCount++}break;case 24:La(p.memoizedState.cache)}if(y=p.child,y!==null)y.return=p,Vr=y;else e:for(p=l;Vr!==null;){y=Vr;var T=y.sibling,S=y.return;if(Nh(y),y===p){Vr=null;break e}if(T!==null){T.return=S,Vr=T;break e}Vr=S}}}var Ap={getCacheForType:function(l){var d=Gr(Dr),p=d.data.get(l);return p===void 0&&(p=l(),d.data.set(l,p)),p}},Tp=typeof WeakMap=="function"?WeakMap:Map,qt=0,lr=null,vt=null,Nt=0,Kt=0,mn=null,Li=!1,sa=!1,eu=!1,vi=0,xr=0,ji=0,Ss=0,tu=0,Pn=0,aa=0,io=null,Jr=null,ru=!1,nu=0,gl=1/0,xl=null,Fi=null,Hr=0,Ui=null,oa=null,la=0,iu=0,su=null,Gh=null,so=0,au=null;function gn(){if((qt&2)!==0&&Nt!==0)return Nt&-Nt;if(ie.T!==null){var l=Xs;return l!==0?l:fu()}return Tr()}function Wh(){Pn===0&&(Pn=(Nt&536870912)===0||Ut?yr():536870912);var l=wn.current;return l!==null&&(l.flags|=32),Pn}function xn(l,d,p){(l===lr&&(Kt===2||Kt===9)||l.cancelPendingCommit!==null)&&(ca(l,0),$i(l,Nt,Pn,!1)),Ar(l,p),((qt&2)===0||l!==lr)&&(l===lr&&((qt&2)===0&&(Ss|=p),xr===4&&$i(l,Nt,Pn,!1)),Qn(l))}function Yh(l,d,p){if((qt&6)!==0)throw Error(n(327));var y=!p&&(d&124)===0&&(d&l.expiredLanes)===0||rt(l,d),T=y?Ip(l,d):cu(l,d,!0),S=y;do{if(T===0){sa&&!y&&$i(l,d,0,!1);break}else{if(p=l.current.alternate,S&&!Cp(p)){T=cu(l,d,!1),S=!1;continue}if(T===2){if(S=d,l.errorRecoveryDisabledLanes&S)var ee=0;else ee=l.pendingLanes&-536870913,ee=ee!==0?ee:ee&536870912?536870912:0;if(ee!==0){d=ee;e:{var te=l;T=io;var oe=te.current.memoizedState.isDehydrated;if(oe&&(ca(te,ee).flags|=256),ee=cu(te,ee,!1),ee!==2){if(eu&&!oe){te.errorRecoveryDisabledLanes|=S,Ss|=S,T=4;break e}S=Jr,Jr=T,S!==null&&(Jr===null?Jr=S:Jr.push.apply(Jr,S))}T=ee}if(S=!1,T!==2)continue}}if(T===1){ca(l,0),$i(l,d,0,!0);break}e:{switch(y=l,S=T,S){case 0:case 1:throw Error(n(345));case 4:if((d&4194048)!==d)break;case 6:$i(y,d,Pn,!Li);break e;case 2:Jr=null;break;case 3:case 5:break;default:throw Error(n(329))}if((d&62914560)===d&&(T=nu+300-Me(),10<T)){if($i(y,d,Pn,!Li),Lr(y,0,!0)!==0)break e;y.timeoutHandle=Tf(qh.bind(null,y,p,Jr,xl,ru,d,Pn,Ss,aa,Li,S,2,-0,0),T);break e}qh(y,p,Jr,xl,ru,d,Pn,Ss,aa,Li,S,0,-0,0)}}break}while(!0);Qn(l)}function qh(l,d,p,y,T,S,ee,te,oe,_e,we,Oe,Ee,ve){if(l.timeoutHandle=-1,Oe=d.subtreeFlags,(Oe&8192||(Oe&16785408)===16785408)&&(fo={stylesheets:null,count:0,unsuspend:sm},Uh(d),Oe=om(),Oe!==null)){l.cancelPendingCommit=Oe(tf.bind(null,l,d,S,p,y,T,ee,te,oe,we,1,Ee,ve)),$i(l,S,ee,!_e);return}tf(l,d,S,p,y,T,ee,te,oe)}function Cp(l){for(var d=l;;){var p=d.tag;if((p===0||p===11||p===15)&&d.flags&16384&&(p=d.updateQueue,p!==null&&(p=p.stores,p!==null)))for(var y=0;y<p.length;y++){var T=p[y],S=T.getSnapshot;T=T.value;try{if(!dn(S(),T))return!1}catch{return!1}}if(p=d.child,d.subtreeFlags&16384&&p!==null)p.return=d,d=p;else{if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return!0;d=d.return}d.sibling.return=d.return,d=d.sibling}}return!0}function $i(l,d,p,y){d&=~tu,d&=~Ss,l.suspendedLanes|=d,l.pingedLanes&=~d,y&&(l.warmLanes|=d),y=l.expirationTimes;for(var T=d;0<T;){var S=31-We(T),ee=1<<S;y[S]=-1,T&=~ee}p!==0&&yn(l,p,d)}function yl(){return(qt&6)===0?(ao(0),!1):!0}function ou(){if(vt!==null){if(Kt===0)var l=vt.return;else l=vt,hi=_s=null,Cc(l),ta=null,Ka=0,l=vt;for(;l!==null;)bh(l.alternate,l),l=l.return;vt=null}}function ca(l,d){var p=l.timeoutHandle;p!==-1&&(l.timeoutHandle=-1,$p(p)),p=l.cancelPendingCommit,p!==null&&(l.cancelPendingCommit=null,p()),ou(),lr=l,vt=p=ci(l.current,null),Nt=d,Kt=0,mn=null,Li=!1,sa=rt(l,d),eu=!1,aa=Pn=tu=Ss=ji=xr=0,Jr=io=null,ru=!1,(d&8)!==0&&(d|=d&32);var y=l.entangledLanes;if(y!==0)for(l=l.entanglements,y&=d;0<y;){var T=31-We(y),S=1<<T;d|=l[T],y&=~S}return vi=d,Fo(),p}function Xh(l,d){dt=null,ie.H=sl,d===Ua||d===Xo?(d=hd(),Kt=3):d===cd?(d=hd(),Kt=4):Kt=d===fh?8:d!==null&&typeof d=="object"&&typeof d.then=="function"?6:1,mn=d,vt===null&&(xr=1,ul(l,Sn(d,l.current)))}function Kh(){var l=ie.H;return ie.H=sl,l===null?sl:l}function Qh(){var l=ie.A;return ie.A=Ap,l}function lu(){xr=4,Li||(Nt&4194048)!==Nt&&wn.current!==null||(sa=!0),(ji&134217727)===0&&(Ss&134217727)===0||lr===null||$i(lr,Nt,Pn,!1)}function cu(l,d,p){var y=qt;qt|=2;var T=Kh(),S=Qh();(lr!==l||Nt!==d)&&(xl=null,ca(l,d)),d=!1;var ee=xr;e:do try{if(Kt!==0&&vt!==null){var te=vt,oe=mn;switch(Kt){case 8:ou(),ee=6;break e;case 3:case 2:case 9:case 6:wn.current===null&&(d=!0);var _e=Kt;if(Kt=0,mn=null,ua(l,te,oe,_e),p&&sa){ee=0;break e}break;default:_e=Kt,Kt=0,mn=null,ua(l,te,oe,_e)}}Sp(),ee=xr;break}catch(we){Xh(l,we)}while(!0);return d&&l.shellSuspendCounter++,hi=_s=null,qt=y,ie.H=T,ie.A=S,vt===null&&(lr=null,Nt=0,Fo()),ee}function Sp(){for(;vt!==null;)Zh(vt)}function Ip(l,d){var p=qt;qt|=2;var y=Kh(),T=Qh();lr!==l||Nt!==d?(xl=null,gl=Me()+500,ca(l,d)):sa=rt(l,d);e:do try{if(Kt!==0&&vt!==null){d=vt;var S=mn;t:switch(Kt){case 1:Kt=0,mn=null,ua(l,d,S,1);break;case 2:case 9:if(ud(S)){Kt=0,mn=null,Jh(d);break}d=function(){Kt!==2&&Kt!==9||lr!==l||(Kt=7),Qn(l)},S.then(d,d);break e;case 3:Kt=7;break e;case 4:Kt=5;break e;case 7:ud(S)?(Kt=0,mn=null,Jh(d)):(Kt=0,mn=null,ua(l,d,S,7));break;case 5:var ee=null;switch(vt.tag){case 26:ee=vt.memoizedState;case 5:case 27:var te=vt;if(!ee||Nf(ee)){Kt=0,mn=null;var oe=te.sibling;if(oe!==null)vt=oe;else{var _e=te.return;_e!==null?(vt=_e,_l(_e)):vt=null}break t}}Kt=0,mn=null,ua(l,d,S,5);break;case 6:Kt=0,mn=null,ua(l,d,S,6);break;case 8:ou(),xr=6;break e;default:throw Error(n(462))}}bp();break}catch(we){Xh(l,we)}while(!0);return hi=_s=null,ie.H=y,ie.A=T,qt=p,vt!==null?0:(lr=null,Nt=0,Fo(),xr)}function bp(){for(;vt!==null&&!Ue();)Zh(vt)}function Zh(l){var d=Sh(l.alternate,l,vi);l.memoizedProps=l.pendingProps,d===null?_l(l):vt=d}function Jh(l){var d=l,p=d.alternate;switch(d.tag){case 15:case 0:d=_h(p,d,d.pendingProps,d.type,void 0,Nt);break;case 11:d=_h(p,d,d.pendingProps,d.type.render,d.ref,Nt);break;case 5:Cc(d);default:bh(p,d),d=vt=ed(d,vi),d=Sh(p,d,vi)}l.memoizedProps=l.pendingProps,d===null?_l(l):vt=d}function ua(l,d,p,y){hi=_s=null,Cc(d),ta=null,Ka=0;var T=d.return;try{if(gp(l,T,d,p,Nt)){xr=1,ul(l,Sn(p,l.current)),vt=null;return}}catch(S){if(T!==null)throw vt=T,S;xr=1,ul(l,Sn(p,l.current)),vt=null;return}d.flags&32768?(Ut||y===1?l=!0:sa||(Nt&536870912)!==0?l=!1:(Li=l=!0,(y===2||y===9||y===3||y===6)&&(y=wn.current,y!==null&&y.tag===13&&(y.flags|=16384))),ef(d,l)):_l(d)}function _l(l){var d=l;do{if((d.flags&32768)!==0){ef(d,Li);return}l=d.return;var p=yp(d.alternate,d,vi);if(p!==null){vt=p;return}if(d=d.sibling,d!==null){vt=d;return}vt=d=l}while(d!==null);xr===0&&(xr=5)}function ef(l,d){do{var p=_p(l.alternate,l);if(p!==null){p.flags&=32767,vt=p;return}if(p=l.return,p!==null&&(p.flags|=32768,p.subtreeFlags=0,p.deletions=null),!d&&(l=l.sibling,l!==null)){vt=l;return}vt=l=p}while(l!==null);xr=6,vt=null}function tf(l,d,p,y,T,S,ee,te,oe){l.cancelPendingCommit=null;do El();while(Hr!==0);if((qt&6)!==0)throw Error(n(327));if(d!==null){if(d===l.current)throw Error(n(177));if(S=d.lanes|d.childLanes,S|=Jl,Xi(l,p,S,ee,te,oe),l===lr&&(vt=lr=null,Nt=0),oa=d,Ui=l,la=p,iu=S,su=T,Gh=y,(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?(l.callbackNode=null,l.callbackPriority=0,Dp(Be,function(){return of(),null})):(l.callbackNode=null,l.callbackPriority=0),y=(d.flags&13878)!==0,(d.subtreeFlags&13878)!==0||y){y=ie.T,ie.T=null,T=se.p,se.p=2,ee=qt,qt|=4;try{Ep(l,d,p)}finally{qt=ee,se.p=T,ie.T=y}}Hr=1,rf(),nf(),sf()}}function rf(){if(Hr===1){Hr=0;var l=Ui,d=oa,p=(d.flags&13878)!==0;if((d.subtreeFlags&13878)!==0||p){p=ie.T,ie.T=null;var y=se.p;se.p=2;var T=qt;qt|=4;try{Lh(d,l);var S=vu,ee=zu(l.containerInfo),te=S.focusedElem,oe=S.selectionRange;if(ee!==te&&te&&te.ownerDocument&&Hu(te.ownerDocument.documentElement,te)){if(oe!==null&&ql(te)){var _e=oe.start,we=oe.end;if(we===void 0&&(we=_e),"selectionStart"in te)te.selectionStart=_e,te.selectionEnd=Math.min(we,te.value.length);else{var Oe=te.ownerDocument||document,Ee=Oe&&Oe.defaultView||window;if(Ee.getSelection){var ve=Ee.getSelection(),Je=te.textContent.length,Qe=Math.min(oe.start,Je),nr=oe.end===void 0?Qe:Math.min(oe.end,Je);!ve.extend&&Qe>nr&&(ee=nr,nr=Qe,Qe=ee);var fe=$u(te,Qe),de=$u(te,nr);if(fe&&de&&(ve.rangeCount!==1||ve.anchorNode!==fe.node||ve.anchorOffset!==fe.offset||ve.focusNode!==de.node||ve.focusOffset!==de.offset)){var ge=Oe.createRange();ge.setStart(fe.node,fe.offset),ve.removeAllRanges(),Qe>nr?(ve.addRange(ge),ve.extend(de.node,de.offset)):(ge.setEnd(de.node,de.offset),ve.addRange(ge))}}}}for(Oe=[],ve=te;ve=ve.parentNode;)ve.nodeType===1&&Oe.push({element:ve,left:ve.scrollLeft,top:ve.scrollTop});for(typeof te.focus=="function"&&te.focus(),te=0;te<Oe.length;te++){var De=Oe[te];De.element.scrollLeft=De.left,De.element.scrollTop=De.top}}Ol=!!Eu,vu=Eu=null}finally{qt=T,se.p=y,ie.T=p}}l.current=d,Hr=2}}function nf(){if(Hr===2){Hr=0;var l=Ui,d=oa,p=(d.flags&8772)!==0;if((d.subtreeFlags&8772)!==0||p){p=ie.T,ie.T=null;var y=se.p;se.p=2;var T=qt;qt|=4;try{kh(l,d.alternate,d)}finally{qt=T,se.p=y,ie.T=p}}Hr=3}}function sf(){if(Hr===4||Hr===3){Hr=0,Ve();var l=Ui,d=oa,p=la,y=Gh;(d.subtreeFlags&10256)!==0||(d.flags&10256)!==0?Hr=5:(Hr=0,oa=Ui=null,af(l,l.pendingLanes));var T=l.pendingLanes;if(T===0&&(Fi=null),sr(p),d=d.stateNode,Ke&&typeof Ke.onCommitFiberRoot=="function")try{Ke.onCommitFiberRoot(Xe,d,void 0,(d.current.flags&128)===128)}catch{}if(y!==null){d=ie.T,T=se.p,se.p=2,ie.T=null;try{for(var S=l.onRecoverableError,ee=0;ee<y.length;ee++){var te=y[ee];S(te.value,{componentStack:te.stack})}}finally{ie.T=d,se.p=T}}(la&3)!==0&&El(),Qn(l),T=l.pendingLanes,(p&4194090)!==0&&(T&42)!==0?l===au?so++:(so=0,au=l):so=0,ao(0)}}function af(l,d){(l.pooledCacheLanes&=d)===0&&(d=l.pooledCache,d!=null&&(l.pooledCache=null,La(d)))}function El(l){return rf(),nf(),sf(),of()}function of(){if(Hr!==5)return!1;var l=Ui,d=iu;iu=0;var p=sr(la),y=ie.T,T=se.p;try{se.p=32>p?32:p,ie.T=null,p=su,su=null;var S=Ui,ee=la;if(Hr=0,oa=Ui=null,la=0,(qt&6)!==0)throw Error(n(331));var te=qt;if(qt|=4,Hh(S.current),Fh(S,S.current,ee,p),qt=te,ao(0,!1),Ke&&typeof Ke.onPostCommitFiberRoot=="function")try{Ke.onPostCommitFiberRoot(Xe,S)}catch{}return!0}finally{se.p=T,ie.T=y,af(l,d)}}function lf(l,d,p){d=Sn(p,d),d=Lc(l.stateNode,d,2),l=Di(l,d,2),l!==null&&(Ar(l,2),Qn(l))}function ar(l,d,p){if(l.tag===3)lf(l,l,p);else for(;d!==null;){if(d.tag===3){lf(d,l,p);break}else if(d.tag===1){var y=d.stateNode;if(typeof d.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(Fi===null||!Fi.has(y))){l=Sn(p,l),p=dh(2),y=Di(d,p,2),y!==null&&(hh(p,y,d,l),Ar(y,2),Qn(y));break}}d=d.return}}function uu(l,d,p){var y=l.pingCache;if(y===null){y=l.pingCache=new Tp;var T=new Set;y.set(d,T)}else T=y.get(d),T===void 0&&(T=new Set,y.set(d,T));T.has(p)||(eu=!0,T.add(p),l=Rp.bind(null,l,d,p),d.then(l,l))}function Rp(l,d,p){var y=l.pingCache;y!==null&&y.delete(d),l.pingedLanes|=l.suspendedLanes&p,l.warmLanes&=~p,lr===l&&(Nt&p)===p&&(xr===4||xr===3&&(Nt&62914560)===Nt&&300>Me()-nu?(qt&2)===0&&ca(l,0):tu|=p,aa===Nt&&(aa=0)),Qn(l)}function cf(l,d){d===0&&(d=jr()),l=Gs(l,d),l!==null&&(Ar(l,d),Qn(l))}function wp(l){var d=l.memoizedState,p=0;d!==null&&(p=d.retryLane),cf(l,p)}function Pp(l,d){var p=0;switch(l.tag){case 13:var y=l.stateNode,T=l.memoizedState;T!==null&&(p=T.retryLane);break;case 19:y=l.stateNode;break;case 22:y=l.stateNode._retryCache;break;default:throw Error(n(314))}y!==null&&y.delete(d),cf(l,p)}function Dp(l,d){return Fe(l,d)}var vl=null,da=null,du=!1,Al=!1,hu=!1,Is=0;function Qn(l){l!==da&&l.next===null&&(da===null?vl=da=l:da=da.next=l),Al=!0,du||(du=!0,Mp())}function ao(l,d){if(!hu&&Al){hu=!0;do for(var p=!1,y=vl;y!==null;){if(l!==0){var T=y.pendingLanes;if(T===0)var S=0;else{var ee=y.suspendedLanes,te=y.pingedLanes;S=(1<<31-We(42|l)+1)-1,S&=T&~(ee&~te),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(p=!0,ff(y,S))}else S=Nt,S=Lr(y,y===lr?S:0,y.cancelPendingCommit!==null||y.timeoutHandle!==-1),(S&3)===0||rt(y,S)||(p=!0,ff(y,S));y=y.next}while(p);hu=!1}}function Op(){uf()}function uf(){Al=du=!1;var l=0;Is!==0&&(Up()&&(l=Is),Is=0);for(var d=Me(),p=null,y=vl;y!==null;){var T=y.next,S=df(y,d);S===0?(y.next=null,p===null?vl=T:p.next=T,T===null&&(da=p)):(p=y,(l!==0||(S&3)!==0)&&(Al=!0)),y=T}ao(l)}function df(l,d){for(var p=l.suspendedLanes,y=l.pingedLanes,T=l.expirationTimes,S=l.pendingLanes&-62914561;0<S;){var ee=31-We(S),te=1<<ee,oe=T[ee];oe===-1?((te&p)===0||(te&y)!==0)&&(T[ee]=pr(te,d)):oe<=d&&(l.expiredLanes|=te),S&=~te}if(d=lr,p=Nt,p=Lr(l,l===d?p:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),y=l.callbackNode,p===0||l===d&&(Kt===2||Kt===9)||l.cancelPendingCommit!==null)return y!==null&&y!==null&&Re(y),l.callbackNode=null,l.callbackPriority=0;if((p&3)===0||rt(l,p)){if(d=p&-p,d===l.callbackPriority)return d;switch(y!==null&&Re(y),sr(p)){case 2:case 8:p=Ne;break;case 32:p=Be;break;case 268435456:p=nt;break;default:p=Be}return y=hf.bind(null,l),p=Fe(p,y),l.callbackPriority=d,l.callbackNode=p,d}return y!==null&&y!==null&&Re(y),l.callbackPriority=2,l.callbackNode=null,2}function hf(l,d){if(Hr!==0&&Hr!==5)return l.callbackNode=null,l.callbackPriority=0,null;var p=l.callbackNode;if(El()&&l.callbackNode!==p)return null;var y=Nt;return y=Lr(l,l===lr?y:0,l.cancelPendingCommit!==null||l.timeoutHandle!==-1),y===0?null:(Yh(l,y,d),df(l,Me()),l.callbackNode!=null&&l.callbackNode===p?hf.bind(null,l):null)}function ff(l,d){if(El())return null;Yh(l,d,!0)}function Mp(){Hp(function(){(qt&6)!==0?Fe(He,Op):uf()})}function fu(){return Is===0&&(Is=yr()),Is}function pf(l){return l==null||typeof l=="symbol"||typeof l=="boolean"?null:typeof l=="function"?l:Ms(""+l)}function mf(l,d){var p=d.ownerDocument.createElement("input");return p.name=d.name,p.value=d.value,l.id&&p.setAttribute("form",l.id),d.parentNode.insertBefore(p,d),l=new FormData(l),p.parentNode.removeChild(p),l}function kp(l,d,p,y,T){if(d==="submit"&&p&&p.stateNode===T){var S=pf((T[Cr]||null).action),ee=y.submitter;ee&&(d=(d=ee[Cr]||null)?pf(d.formAction):ee.getAttribute("formAction"),d!==null&&(S=d,ee=null));var te=new ks("action","action",null,y,T);l.push({event:te,listeners:[{instance:null,listener:function(){if(y.defaultPrevented){if(Is!==0){var oe=ee?mf(T,ee):new FormData(T);Mc(p,{pending:!0,data:oe,method:T.method,action:S},null,oe)}}else typeof S=="function"&&(te.preventDefault(),oe=ee?mf(T,ee):new FormData(T),Mc(p,{pending:!0,data:oe,method:T.method,action:S},S,oe))},currentTarget:T}]})}}for(var pu=0;pu<Zl.length;pu++){var mu=Zl[pu],Np=mu.toLowerCase(),Vp=mu[0].toUpperCase()+mu.slice(1);kn(Np,"on"+Vp)}kn(Yu,"onAnimationEnd"),kn(qu,"onAnimationIteration"),kn(Xu,"onAnimationStart"),kn("dblclick","onDoubleClick"),kn("focusin","onFocus"),kn("focusout","onBlur"),kn(Jf,"onTransitionRun"),kn(ep,"onTransitionStart"),kn(tp,"onTransitionCancel"),kn(Ku,"onTransitionEnd"),ei("onMouseEnter",["mouseout","mouseover"]),ei("onMouseLeave",["mouseout","mouseover"]),ei("onPointerEnter",["pointerout","pointerover"]),ei("onPointerLeave",["pointerout","pointerover"]),On("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),On("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),On("onBeforeInput",["compositionend","keypress","textInput","paste"]),On("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),On("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),On("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Bp=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(oo));function gf(l,d){d=(d&4)!==0;for(var p=0;p<l.length;p++){var y=l[p],T=y.event;y=y.listeners;e:{var S=void 0;if(d)for(var ee=y.length-1;0<=ee;ee--){var te=y[ee],oe=te.instance,_e=te.currentTarget;if(te=te.listener,oe!==S&&T.isPropagationStopped())break e;S=te,T.currentTarget=_e;try{S(T)}catch(we){cl(we)}T.currentTarget=null,S=oe}else for(ee=0;ee<y.length;ee++){if(te=y[ee],oe=te.instance,_e=te.currentTarget,te=te.listener,oe!==S&&T.isPropagationStopped())break e;S=te,T.currentTarget=_e;try{S(T)}catch(we){cl(we)}T.currentTarget=null,S=oe}}}}function Ct(l,d){var p=d[ga];p===void 0&&(p=d[ga]=new Set);var y=l+"__bubble";p.has(y)||(xf(d,l,2,!1),p.add(y))}function gu(l,d,p){var y=0;d&&(y|=4),xf(p,l,y,d)}var Tl="_reactListening"+Math.random().toString(36).slice(2);function xu(l){if(!l[Tl]){l[Tl]=!0,xa.forEach(function(p){p!=="selectionchange"&&(Bp.has(p)||gu(p,!1,l),gu(p,!0,l))});var d=l.nodeType===9?l:l.ownerDocument;d===null||d[Tl]||(d[Tl]=!0,gu("selectionchange",!1,d))}}function xf(l,d,p,y){switch(Uf(d)){case 2:var T=um;break;case 8:T=dm;break;default:T=Du}p=T.bind(null,d,p,l),T=void 0,!Tn||d!=="touchstart"&&d!=="touchmove"&&d!=="wheel"||(T=!0),y?T!==void 0?l.addEventListener(d,p,{capture:!0,passive:T}):l.addEventListener(d,p,!0):T!==void 0?l.addEventListener(d,p,{passive:T}):l.addEventListener(d,p,!1)}function yu(l,d,p,y,T){var S=y;if((d&1)===0&&(d&2)===0&&y!==null)e:for(;;){if(y===null)return;var ee=y.tag;if(ee===3||ee===4){var te=y.stateNode.containerInfo;if(te===T)break;if(ee===4)for(ee=y.return;ee!==null;){var oe=ee.tag;if((oe===3||oe===4)&&ee.stateNode.containerInfo===T)return;ee=ee.return}for(;te!==null;){if(ee=Jn(te),ee===null)return;if(oe=ee.tag,oe===5||oe===6||oe===26||oe===27){y=S=ee;continue e}te=te.parentNode}}y=y.return}So(function(){var _e=S,we=An(p),Oe=[];e:{var Ee=Qu.get(l);if(Ee!==void 0){var ve=ks,Je=l;switch(l){case"keypress":if($n(p)===0)break e;case"keydown":case"keyup":ve=Fs;break;case"focusin":Je="focus",ve=Bs;break;case"focusout":Je="blur",ve=Bs;break;case"beforeblur":case"afterblur":ve=Bs;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=Cn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=zl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=Mo;break;case Yu:case qu:case Xu:ve=Ls;break;case Ku:ve=No;break;case"scroll":case"scrollend":ve=Io;break;case"wheel":ve=Us;break;case"copy":case"cut":case"paste":ve=js;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Pa;break;case"toggle":case"beforetoggle":ve=Bo}var Qe=(d&4)!==0,nr=!Qe&&(l==="scroll"||l==="scrollend"),fe=Qe?Ee!==null?Ee+"Capture":null:Ee;Qe=[];for(var de=_e,ge;de!==null;){var De=de;if(ge=De.stateNode,De=De.tag,De!==5&&De!==26&&De!==27||ge===null||fe===null||(De=ss(de,fe),De!=null&&Qe.push(lo(de,De,ge))),nr)break;de=de.return}0<Qe.length&&(Ee=new ve(Ee,Je,null,p,we),Oe.push({event:Ee,listeners:Qe}))}}if((d&7)===0){e:{if(Ee=l==="mouseover"||l==="pointerover",ve=l==="mouseout"||l==="pointerout",Ee&&p!==ni&&(Je=p.relatedTarget||p.fromElement)&&(Jn(Je)||Je[En]))break e;if((ve||Ee)&&(Ee=we.window===we?we:(Ee=we.ownerDocument)?Ee.defaultView||Ee.parentWindow:window,ve?(Je=p.relatedTarget||p.toElement,ve=_e,Je=Je?Jn(Je):null,Je!==null&&(nr=s(Je),Qe=Je.tag,Je!==nr||Qe!==5&&Qe!==27&&Qe!==6)&&(Je=null)):(ve=null,Je=_e),ve!==Je)){if(Qe=Cn,De="onMouseLeave",fe="onMouseEnter",de="mouse",(l==="pointerout"||l==="pointerover")&&(Qe=Pa,De="onPointerLeave",fe="onPointerEnter",de="pointer"),nr=ve==null?Ee:Ln(ve),ge=Je==null?Ee:Ln(Je),Ee=new Qe(De,de+"leave",ve,p,we),Ee.target=nr,Ee.relatedTarget=ge,De=null,Jn(we)===_e&&(Qe=new Qe(fe,de+"enter",Je,p,we),Qe.target=ge,Qe.relatedTarget=nr,De=Qe),nr=De,ve&&Je)t:{for(Qe=ve,fe=Je,de=0,ge=Qe;ge;ge=ha(ge))de++;for(ge=0,De=fe;De;De=ha(De))ge++;for(;0<de-ge;)Qe=ha(Qe),de--;for(;0<ge-de;)fe=ha(fe),ge--;for(;de--;){if(Qe===fe||fe!==null&&Qe===fe.alternate)break t;Qe=ha(Qe),fe=ha(fe)}Qe=null}else Qe=null;ve!==null&&yf(Oe,Ee,ve,Qe,!1),Je!==null&&nr!==null&&yf(Oe,nr,Je,Qe,!0)}}e:{if(Ee=_e?Ln(_e):window,ve=Ee.nodeName&&Ee.nodeName.toLowerCase(),ve==="select"||ve==="input"&&Ee.type==="file")var Ge=Vu;else if(Pr(Ee))if(Bu)Ge=Kf;else{Ge=qf;var pt=Yf}else ve=Ee.nodeName,!ve||ve.toLowerCase()!=="input"||Ee.type!=="checkbox"&&Ee.type!=="radio"?_e&&Ta(_e.elementType)&&(Ge=Vu):Ge=Xf;if(Ge&&(Ge=Ge(l,_e))){li(Oe,Ge,p,we);break e}pt&&pt(l,Ee,_e),l==="focusout"&&_e&&Ee.type==="number"&&_e.memoizedProps.value!=null&&Ii(Ee,"number",Ee.value)}switch(pt=_e?Ln(_e):window,l){case"focusin":(Pr(pt)||pt.contentEditable==="true")&&($s=pt,Xl=_e,Ma=null);break;case"focusout":Ma=Xl=$s=null;break;case"mousedown":Kl=!0;break;case"contextmenu":case"mouseup":case"dragend":Kl=!1,Gu(Oe,p,we);break;case"selectionchange":if(Zf)break;case"keydown":case"keyup":Gu(Oe,p,we)}var Ye;if(Gn)e:{switch(l){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else Dt?Ce(l,p)&&(Ze="onCompositionEnd"):l==="keydown"&&p.keyCode===229&&(Ze="onCompositionStart");Ze&&(J&&p.locale!=="ko"&&(Dt||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&Dt&&(Ye=Sa()):(Un=we,bi="value"in Un?Un.value:Un.textContent,Dt=!0)),pt=Cl(_e,Ze),0<pt.length&&(Ze=new Ra(Ze,l,null,p,we),Oe.push({event:Ze,listeners:pt}),Ye?Ze.data=Ye:(Ye=je(p),Ye!==null&&(Ze.data=Ye)))),(Ye=H?wr(l,p):kt(l,p))&&(Ze=Cl(_e,"onBeforeInput"),0<Ze.length&&(pt=new Ra("onBeforeInput","beforeinput",null,p,we),Oe.push({event:pt,listeners:Ze}),pt.data=Ye)),kp(Oe,l,_e,p,we)}gf(Oe,d)})}function lo(l,d,p){return{instance:l,listener:d,currentTarget:p}}function Cl(l,d){for(var p=d+"Capture",y=[];l!==null;){var T=l,S=T.stateNode;if(T=T.tag,T!==5&&T!==26&&T!==27||S===null||(T=ss(l,p),T!=null&&y.unshift(lo(l,T,S)),T=ss(l,d),T!=null&&y.push(lo(l,T,S))),l.tag===3)return y;l=l.return}return[]}function ha(l){if(l===null)return null;do l=l.return;while(l&&l.tag!==5&&l.tag!==27);return l||null}function yf(l,d,p,y,T){for(var S=d._reactName,ee=[];p!==null&&p!==y;){var te=p,oe=te.alternate,_e=te.stateNode;if(te=te.tag,oe!==null&&oe===y)break;te!==5&&te!==26&&te!==27||_e===null||(oe=_e,T?(_e=ss(p,S),_e!=null&&ee.unshift(lo(p,_e,oe))):T||(_e=ss(p,S),_e!=null&&ee.push(lo(p,_e,oe)))),p=p.return}ee.length!==0&&l.push({event:d,listeners:ee})}var Lp=/\r\n?/g,jp=/\u0000|\uFFFD/g;function _f(l){return(typeof l=="string"?l:""+l).replace(Lp,`
`).replace(jp,"")}function Ef(l,d){return d=_f(d),_f(l)===d}function Sl(){}function rr(l,d,p,y,T,S){switch(p){case"children":typeof y=="string"?d==="body"||d==="textarea"&&y===""||vn(l,y):(typeof y=="number"||typeof y=="bigint")&&d!=="body"&&vn(l,""+y);break;case"className":jn(l,"class",y);break;case"tabIndex":jn(l,"tabindex",y);break;case"dir":case"role":case"viewBox":case"width":case"height":jn(l,p,y);break;case"style":Aa(l,y,S);break;case"data":if(d!=="object"){jn(l,"data",y);break}case"src":case"href":if(y===""&&(d!=="a"||p!=="href")){l.removeAttribute(p);break}if(y==null||typeof y=="function"||typeof y=="symbol"||typeof y=="boolean"){l.removeAttribute(p);break}y=Ms(""+y),l.setAttribute(p,y);break;case"action":case"formAction":if(typeof y=="function"){l.setAttribute(p,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(p==="formAction"?(d!=="input"&&rr(l,d,"name",T.name,T,null),rr(l,d,"formEncType",T.formEncType,T,null),rr(l,d,"formMethod",T.formMethod,T,null),rr(l,d,"formTarget",T.formTarget,T,null)):(rr(l,d,"encType",T.encType,T,null),rr(l,d,"method",T.method,T,null),rr(l,d,"target",T.target,T,null)));if(y==null||typeof y=="symbol"||typeof y=="boolean"){l.removeAttribute(p);break}y=Ms(""+y),l.setAttribute(p,y);break;case"onClick":y!=null&&(l.onclick=Sl);break;case"onScroll":y!=null&&Ct("scroll",l);break;case"onScrollEnd":y!=null&&Ct("scrollend",l);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(n(61));if(p=y.__html,p!=null){if(T.children!=null)throw Error(n(60));l.innerHTML=p}}break;case"multiple":l.multiple=y&&typeof y!="function"&&typeof y!="symbol";break;case"muted":l.muted=y&&typeof y!="function"&&typeof y!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(y==null||typeof y=="function"||typeof y=="boolean"||typeof y=="symbol"){l.removeAttribute("xlink:href");break}p=Ms(""+y),l.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",p);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":y!=null&&typeof y!="function"&&typeof y!="symbol"?l.setAttribute(p,""+y):l.removeAttribute(p);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":y&&typeof y!="function"&&typeof y!="symbol"?l.setAttribute(p,""):l.removeAttribute(p);break;case"capture":case"download":y===!0?l.setAttribute(p,""):y!==!1&&y!=null&&typeof y!="function"&&typeof y!="symbol"?l.setAttribute(p,y):l.removeAttribute(p);break;case"cols":case"rows":case"size":case"span":y!=null&&typeof y!="function"&&typeof y!="symbol"&&!isNaN(y)&&1<=y?l.setAttribute(p,y):l.removeAttribute(p);break;case"rowSpan":case"start":y==null||typeof y=="function"||typeof y=="symbol"||isNaN(y)?l.removeAttribute(p):l.setAttribute(p,y);break;case"popover":Ct("beforetoggle",l),Ct("toggle",l),Si(l,"popover",y);break;case"xlinkActuate":Fr(l,"http://www.w3.org/1999/xlink","xlink:actuate",y);break;case"xlinkArcrole":Fr(l,"http://www.w3.org/1999/xlink","xlink:arcrole",y);break;case"xlinkRole":Fr(l,"http://www.w3.org/1999/xlink","xlink:role",y);break;case"xlinkShow":Fr(l,"http://www.w3.org/1999/xlink","xlink:show",y);break;case"xlinkTitle":Fr(l,"http://www.w3.org/1999/xlink","xlink:title",y);break;case"xlinkType":Fr(l,"http://www.w3.org/1999/xlink","xlink:type",y);break;case"xmlBase":Fr(l,"http://www.w3.org/XML/1998/namespace","xml:base",y);break;case"xmlLang":Fr(l,"http://www.w3.org/XML/1998/namespace","xml:lang",y);break;case"xmlSpace":Fr(l,"http://www.w3.org/XML/1998/namespace","xml:space",y);break;case"is":Si(l,"is",y);break;case"innerText":case"textContent":break;default:(!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(p=$l.get(p)||p,Si(l,p,y))}}function _u(l,d,p,y,T,S){switch(p){case"style":Aa(l,y,S);break;case"dangerouslySetInnerHTML":if(y!=null){if(typeof y!="object"||!("__html"in y))throw Error(n(61));if(p=y.__html,p!=null){if(T.children!=null)throw Error(n(60));l.innerHTML=p}}break;case"children":typeof y=="string"?vn(l,y):(typeof y=="number"||typeof y=="bigint")&&vn(l,""+y);break;case"onScroll":y!=null&&Ct("scroll",l);break;case"onScrollEnd":y!=null&&Ct("scrollend",l);break;case"onClick":y!=null&&(l.onclick=Sl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Rs.hasOwnProperty(p))e:{if(p[0]==="o"&&p[1]==="n"&&(T=p.endsWith("Capture"),d=p.slice(2,T?p.length-7:void 0),S=l[Cr]||null,S=S!=null?S[p]:null,typeof S=="function"&&l.removeEventListener(d,S,T),typeof y=="function")){typeof S!="function"&&S!==null&&(p in l?l[p]=null:l.hasAttribute(p)&&l.removeAttribute(p)),l.addEventListener(d,y,T);break e}p in l?l[p]=y:y===!0?l.setAttribute(p,""):Si(l,p,y)}}}function zr(l,d,p){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ct("error",l),Ct("load",l);var y=!1,T=!1,S;for(S in p)if(p.hasOwnProperty(S)){var ee=p[S];if(ee!=null)switch(S){case"src":y=!0;break;case"srcSet":T=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,d));default:rr(l,d,S,ee,p,null)}}T&&rr(l,d,"srcSet",p.srcSet,p,null),y&&rr(l,d,"src",p.src,p,null);return;case"input":Ct("invalid",l);var te=S=ee=T=null,oe=null,_e=null;for(y in p)if(p.hasOwnProperty(y)){var we=p[y];if(we!=null)switch(y){case"name":T=we;break;case"type":ee=we;break;case"checked":oe=we;break;case"defaultChecked":_e=we;break;case"value":S=we;break;case"defaultValue":te=we;break;case"children":case"dangerouslySetInnerHTML":if(we!=null)throw Error(n(137,d));break;default:rr(l,d,y,we,p,null)}}ts(l,S,te,oe,_e,ee,T,!1),Os(l);return;case"select":Ct("invalid",l),y=ee=S=null;for(T in p)if(p.hasOwnProperty(T)&&(te=p[T],te!=null))switch(T){case"value":S=te;break;case"defaultValue":ee=te;break;case"multiple":y=te;default:rr(l,d,T,te,p,null)}d=S,p=ee,l.multiple=!!y,d!=null?ri(l,!!y,d,!1):p!=null&&ri(l,!!y,p,!0);return;case"textarea":Ct("invalid",l),S=T=y=null;for(ee in p)if(p.hasOwnProperty(ee)&&(te=p[ee],te!=null))switch(ee){case"value":y=te;break;case"defaultValue":T=te;break;case"children":S=te;break;case"dangerouslySetInnerHTML":if(te!=null)throw Error(n(91));break;default:rr(l,d,ee,te,p,null)}rs(l,y,T,S),Os(l);return;case"option":for(oe in p)if(p.hasOwnProperty(oe)&&(y=p[oe],y!=null))switch(oe){case"selected":l.selected=y&&typeof y!="function"&&typeof y!="symbol";break;default:rr(l,d,oe,y,p,null)}return;case"dialog":Ct("beforetoggle",l),Ct("toggle",l),Ct("cancel",l),Ct("close",l);break;case"iframe":case"object":Ct("load",l);break;case"video":case"audio":for(y=0;y<oo.length;y++)Ct(oo[y],l);break;case"image":Ct("error",l),Ct("load",l);break;case"details":Ct("toggle",l);break;case"embed":case"source":case"link":Ct("error",l),Ct("load",l);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(_e in p)if(p.hasOwnProperty(_e)&&(y=p[_e],y!=null))switch(_e){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,d));default:rr(l,d,_e,y,p,null)}return;default:if(Ta(d)){for(we in p)p.hasOwnProperty(we)&&(y=p[we],y!==void 0&&_u(l,d,we,y,p,void 0));return}}for(te in p)p.hasOwnProperty(te)&&(y=p[te],y!=null&&rr(l,d,te,y,p,null))}function Fp(l,d,p,y){switch(d){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var T=null,S=null,ee=null,te=null,oe=null,_e=null,we=null;for(ve in p){var Oe=p[ve];if(p.hasOwnProperty(ve)&&Oe!=null)switch(ve){case"checked":break;case"value":break;case"defaultValue":oe=Oe;default:y.hasOwnProperty(ve)||rr(l,d,ve,null,y,Oe)}}for(var Ee in y){var ve=y[Ee];if(Oe=p[Ee],y.hasOwnProperty(Ee)&&(ve!=null||Oe!=null))switch(Ee){case"type":S=ve;break;case"name":T=ve;break;case"checked":_e=ve;break;case"defaultChecked":we=ve;break;case"value":ee=ve;break;case"defaultValue":te=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,d));break;default:ve!==Oe&&rr(l,d,Ee,ve,y,Oe)}}un(l,ee,te,oe,_e,we,S,T);return;case"select":ve=ee=te=Ee=null;for(S in p)if(oe=p[S],p.hasOwnProperty(S)&&oe!=null)switch(S){case"value":break;case"multiple":ve=oe;default:y.hasOwnProperty(S)||rr(l,d,S,null,y,oe)}for(T in y)if(S=y[T],oe=p[T],y.hasOwnProperty(T)&&(S!=null||oe!=null))switch(T){case"value":Ee=S;break;case"defaultValue":te=S;break;case"multiple":ee=S;default:S!==oe&&rr(l,d,T,S,y,oe)}d=te,p=ee,y=ve,Ee!=null?ri(l,!!p,Ee,!1):!!y!=!!p&&(d!=null?ri(l,!!p,d,!0):ri(l,!!p,p?[]:"",!1));return;case"textarea":ve=Ee=null;for(te in p)if(T=p[te],p.hasOwnProperty(te)&&T!=null&&!y.hasOwnProperty(te))switch(te){case"value":break;case"children":break;default:rr(l,d,te,null,y,T)}for(ee in y)if(T=y[ee],S=p[ee],y.hasOwnProperty(ee)&&(T!=null||S!=null))switch(ee){case"value":Ee=T;break;case"defaultValue":ve=T;break;case"children":break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(n(91));break;default:T!==S&&rr(l,d,ee,T,y,S)}er(l,Ee,ve);return;case"option":for(var Je in p)if(Ee=p[Je],p.hasOwnProperty(Je)&&Ee!=null&&!y.hasOwnProperty(Je))switch(Je){case"selected":l.selected=!1;break;default:rr(l,d,Je,null,y,Ee)}for(oe in y)if(Ee=y[oe],ve=p[oe],y.hasOwnProperty(oe)&&Ee!==ve&&(Ee!=null||ve!=null))switch(oe){case"selected":l.selected=Ee&&typeof Ee!="function"&&typeof Ee!="symbol";break;default:rr(l,d,oe,Ee,y,ve)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qe in p)Ee=p[Qe],p.hasOwnProperty(Qe)&&Ee!=null&&!y.hasOwnProperty(Qe)&&rr(l,d,Qe,null,y,Ee);for(_e in y)if(Ee=y[_e],ve=p[_e],y.hasOwnProperty(_e)&&Ee!==ve&&(Ee!=null||ve!=null))switch(_e){case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(n(137,d));break;default:rr(l,d,_e,Ee,y,ve)}return;default:if(Ta(d)){for(var nr in p)Ee=p[nr],p.hasOwnProperty(nr)&&Ee!==void 0&&!y.hasOwnProperty(nr)&&_u(l,d,nr,void 0,y,Ee);for(we in y)Ee=y[we],ve=p[we],!y.hasOwnProperty(we)||Ee===ve||Ee===void 0&&ve===void 0||_u(l,d,we,Ee,y,ve);return}}for(var fe in p)Ee=p[fe],p.hasOwnProperty(fe)&&Ee!=null&&!y.hasOwnProperty(fe)&&rr(l,d,fe,null,y,Ee);for(Oe in y)Ee=y[Oe],ve=p[Oe],!y.hasOwnProperty(Oe)||Ee===ve||Ee==null&&ve==null||rr(l,d,Oe,Ee,y,ve)}var Eu=null,vu=null;function Il(l){return l.nodeType===9?l:l.ownerDocument}function vf(l){switch(l){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Af(l,d){if(l===0)switch(d){case"svg":return 1;case"math":return 2;default:return 0}return l===1&&d==="foreignObject"?0:l}function Au(l,d){return l==="textarea"||l==="noscript"||typeof d.children=="string"||typeof d.children=="number"||typeof d.children=="bigint"||typeof d.dangerouslySetInnerHTML=="object"&&d.dangerouslySetInnerHTML!==null&&d.dangerouslySetInnerHTML.__html!=null}var Tu=null;function Up(){var l=window.event;return l&&l.type==="popstate"?l===Tu?!1:(Tu=l,!0):(Tu=null,!1)}var Tf=typeof setTimeout=="function"?setTimeout:void 0,$p=typeof clearTimeout=="function"?clearTimeout:void 0,Cf=typeof Promise=="function"?Promise:void 0,Hp=typeof queueMicrotask=="function"?queueMicrotask:typeof Cf<"u"?function(l){return Cf.resolve(null).then(l).catch(zp)}:Tf;function zp(l){setTimeout(function(){throw l})}function Hi(l){return l==="head"}function Sf(l,d){var p=d,y=0,T=0;do{var S=p.nextSibling;if(l.removeChild(p),S&&S.nodeType===8)if(p=S.data,p==="/$"){if(0<y&&8>y){p=y;var ee=l.ownerDocument;if(p&1&&co(ee.documentElement),p&2&&co(ee.body),p&4)for(p=ee.head,co(p),ee=p.firstChild;ee;){var te=ee.nextSibling,oe=ee.nodeName;ee[Qi]||oe==="SCRIPT"||oe==="STYLE"||oe==="LINK"&&ee.rel.toLowerCase()==="stylesheet"||p.removeChild(ee),ee=te}}if(T===0){l.removeChild(S),yo(d);return}T--}else p==="$"||p==="$?"||p==="$!"?T++:y=p.charCodeAt(0)-48;else y=0;p=S}while(p);yo(d)}function Cu(l){var d=l.firstChild;for(d&&d.nodeType===10&&(d=d.nextSibling);d;){var p=d;switch(d=d.nextSibling,p.nodeName){case"HTML":case"HEAD":case"BODY":Cu(p),Ci(p);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(p.rel.toLowerCase()==="stylesheet")continue}l.removeChild(p)}}function Gp(l,d,p,y){for(;l.nodeType===1;){var T=p;if(l.nodeName.toLowerCase()!==d.toLowerCase()){if(!y&&(l.nodeName!=="INPUT"||l.type!=="hidden"))break}else if(y){if(!l[Qi])switch(d){case"meta":if(!l.hasAttribute("itemprop"))break;return l;case"link":if(S=l.getAttribute("rel"),S==="stylesheet"&&l.hasAttribute("data-precedence"))break;if(S!==T.rel||l.getAttribute("href")!==(T.href==null||T.href===""?null:T.href)||l.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin)||l.getAttribute("title")!==(T.title==null?null:T.title))break;return l;case"style":if(l.hasAttribute("data-precedence"))break;return l;case"script":if(S=l.getAttribute("src"),(S!==(T.src==null?null:T.src)||l.getAttribute("type")!==(T.type==null?null:T.type)||l.getAttribute("crossorigin")!==(T.crossOrigin==null?null:T.crossOrigin))&&S&&l.hasAttribute("async")&&!l.hasAttribute("itemprop"))break;return l;default:return l}}else if(d==="input"&&l.type==="hidden"){var S=T.name==null?null:""+T.name;if(T.type==="hidden"&&l.getAttribute("name")===S)return l}else return l;if(l=Vn(l.nextSibling),l===null)break}return null}function Wp(l,d,p){if(d==="")return null;for(;l.nodeType!==3;)if((l.nodeType!==1||l.nodeName!=="INPUT"||l.type!=="hidden")&&!p||(l=Vn(l.nextSibling),l===null))return null;return l}function Su(l){return l.data==="$!"||l.data==="$?"&&l.ownerDocument.readyState==="complete"}function Yp(l,d){var p=l.ownerDocument;if(l.data!=="$?"||p.readyState==="complete")d();else{var y=function(){d(),p.removeEventListener("DOMContentLoaded",y)};p.addEventListener("DOMContentLoaded",y),l._reactRetry=y}}function Vn(l){for(;l!=null;l=l.nextSibling){var d=l.nodeType;if(d===1||d===3)break;if(d===8){if(d=l.data,d==="$"||d==="$!"||d==="$?"||d==="F!"||d==="F")break;if(d==="/$")return null}}return l}var Iu=null;function If(l){l=l.previousSibling;for(var d=0;l;){if(l.nodeType===8){var p=l.data;if(p==="$"||p==="$!"||p==="$?"){if(d===0)return l;d--}else p==="/$"&&d++}l=l.previousSibling}return null}function bf(l,d,p){switch(d=Il(p),l){case"html":if(l=d.documentElement,!l)throw Error(n(452));return l;case"head":if(l=d.head,!l)throw Error(n(453));return l;case"body":if(l=d.body,!l)throw Error(n(454));return l;default:throw Error(n(451))}}function co(l){for(var d=l.attributes;d.length;)l.removeAttributeNode(d[0]);Ci(l)}var Dn=new Map,Rf=new Set;function bl(l){return typeof l.getRootNode=="function"?l.getRootNode():l.nodeType===9?l:l.ownerDocument}var Ai=se.d;se.d={f:qp,r:Xp,D:Kp,C:Qp,L:Zp,m:Jp,X:tm,S:em,M:rm};function qp(){var l=Ai.f(),d=yl();return l||d}function Xp(l){var d=Bn(l);d!==null&&d.tag===5&&d.type==="form"?Yd(d):Ai.r(l)}var fa=typeof document>"u"?null:document;function wf(l,d,p){var y=fa;if(y&&typeof d=="string"&&d){var T=Sr(d);T='link[rel="'+l+'"][href="'+T+'"]',typeof p=="string"&&(T+='[crossorigin="'+p+'"]'),Rf.has(T)||(Rf.add(T),l={rel:l,crossOrigin:p,href:d},y.querySelector(T)===null&&(d=y.createElement("link"),zr(d,"link",l),_r(d),y.head.appendChild(d)))}}function Kp(l){Ai.D(l),wf("dns-prefetch",l,null)}function Qp(l,d){Ai.C(l,d),wf("preconnect",l,d)}function Zp(l,d,p){Ai.L(l,d,p);var y=fa;if(y&&l&&d){var T='link[rel="preload"][as="'+Sr(d)+'"]';d==="image"&&p&&p.imageSrcSet?(T+='[imagesrcset="'+Sr(p.imageSrcSet)+'"]',typeof p.imageSizes=="string"&&(T+='[imagesizes="'+Sr(p.imageSizes)+'"]')):T+='[href="'+Sr(l)+'"]';var S=T;switch(d){case"style":S=pa(l);break;case"script":S=ma(l)}Dn.has(S)||(l=f({rel:"preload",href:d==="image"&&p&&p.imageSrcSet?void 0:l,as:d},p),Dn.set(S,l),y.querySelector(T)!==null||d==="style"&&y.querySelector(uo(S))||d==="script"&&y.querySelector(ho(S))||(d=y.createElement("link"),zr(d,"link",l),_r(d),y.head.appendChild(d)))}}function Jp(l,d){Ai.m(l,d);var p=fa;if(p&&l){var y=d&&typeof d.as=="string"?d.as:"script",T='link[rel="modulepreload"][as="'+Sr(y)+'"][href="'+Sr(l)+'"]',S=T;switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=ma(l)}if(!Dn.has(S)&&(l=f({rel:"modulepreload",href:l},d),Dn.set(S,l),p.querySelector(T)===null)){switch(y){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(p.querySelector(ho(S)))return}y=p.createElement("link"),zr(y,"link",l),_r(y),p.head.appendChild(y)}}}function em(l,d,p){Ai.S(l,d,p);var y=fa;if(y&&l){var T=Yr(y).hoistableStyles,S=pa(l);d=d||"default";var ee=T.get(S);if(!ee){var te={loading:0,preload:null};if(ee=y.querySelector(uo(S)))te.loading=5;else{l=f({rel:"stylesheet",href:l,"data-precedence":d},p),(p=Dn.get(S))&&bu(l,p);var oe=ee=y.createElement("link");_r(oe),zr(oe,"link",l),oe._p=new Promise(function(_e,we){oe.onload=_e,oe.onerror=we}),oe.addEventListener("load",function(){te.loading|=1}),oe.addEventListener("error",function(){te.loading|=2}),te.loading|=4,Rl(ee,d,y)}ee={type:"stylesheet",instance:ee,count:1,state:te},T.set(S,ee)}}}function tm(l,d){Ai.X(l,d);var p=fa;if(p&&l){var y=Yr(p).hoistableScripts,T=ma(l),S=y.get(T);S||(S=p.querySelector(ho(T)),S||(l=f({src:l,async:!0},d),(d=Dn.get(T))&&Ru(l,d),S=p.createElement("script"),_r(S),zr(S,"link",l),p.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},y.set(T,S))}}function rm(l,d){Ai.M(l,d);var p=fa;if(p&&l){var y=Yr(p).hoistableScripts,T=ma(l),S=y.get(T);S||(S=p.querySelector(ho(T)),S||(l=f({src:l,async:!0,type:"module"},d),(d=Dn.get(T))&&Ru(l,d),S=p.createElement("script"),_r(S),zr(S,"link",l),p.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},y.set(T,S))}}function Pf(l,d,p,y){var T=(T=Le.current)?bl(T):null;if(!T)throw Error(n(446));switch(l){case"meta":case"title":return null;case"style":return typeof p.precedence=="string"&&typeof p.href=="string"?(d=pa(p.href),p=Yr(T).hoistableStyles,y=p.get(d),y||(y={type:"style",instance:null,count:0,state:null},p.set(d,y)),y):{type:"void",instance:null,count:0,state:null};case"link":if(p.rel==="stylesheet"&&typeof p.href=="string"&&typeof p.precedence=="string"){l=pa(p.href);var S=Yr(T).hoistableStyles,ee=S.get(l);if(ee||(T=T.ownerDocument||T,ee={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(l,ee),(S=T.querySelector(uo(l)))&&!S._p&&(ee.instance=S,ee.state.loading=5),Dn.has(l)||(p={rel:"preload",as:"style",href:p.href,crossOrigin:p.crossOrigin,integrity:p.integrity,media:p.media,hrefLang:p.hrefLang,referrerPolicy:p.referrerPolicy},Dn.set(l,p),S||nm(T,l,p,ee.state))),d&&y===null)throw Error(n(528,""));return ee}if(d&&y!==null)throw Error(n(529,""));return null;case"script":return d=p.async,p=p.src,typeof p=="string"&&d&&typeof d!="function"&&typeof d!="symbol"?(d=ma(p),p=Yr(T).hoistableScripts,y=p.get(d),y||(y={type:"script",instance:null,count:0,state:null},p.set(d,y)),y):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,l))}}function pa(l){return'href="'+Sr(l)+'"'}function uo(l){return'link[rel="stylesheet"]['+l+"]"}function Df(l){return f({},l,{"data-precedence":l.precedence,precedence:null})}function nm(l,d,p,y){l.querySelector('link[rel="preload"][as="style"]['+d+"]")?y.loading=1:(d=l.createElement("link"),y.preload=d,d.addEventListener("load",function(){return y.loading|=1}),d.addEventListener("error",function(){return y.loading|=2}),zr(d,"link",p),_r(d),l.head.appendChild(d))}function ma(l){return'[src="'+Sr(l)+'"]'}function ho(l){return"script[async]"+l}function Of(l,d,p){if(d.count++,d.instance===null)switch(d.type){case"style":var y=l.querySelector('style[data-href~="'+Sr(p.href)+'"]');if(y)return d.instance=y,_r(y),y;var T=f({},p,{"data-href":p.href,"data-precedence":p.precedence,href:null,precedence:null});return y=(l.ownerDocument||l).createElement("style"),_r(y),zr(y,"style",T),Rl(y,p.precedence,l),d.instance=y;case"stylesheet":T=pa(p.href);var S=l.querySelector(uo(T));if(S)return d.state.loading|=4,d.instance=S,_r(S),S;y=Df(p),(T=Dn.get(T))&&bu(y,T),S=(l.ownerDocument||l).createElement("link"),_r(S);var ee=S;return ee._p=new Promise(function(te,oe){ee.onload=te,ee.onerror=oe}),zr(S,"link",y),d.state.loading|=4,Rl(S,p.precedence,l),d.instance=S;case"script":return S=ma(p.src),(T=l.querySelector(ho(S)))?(d.instance=T,_r(T),T):(y=p,(T=Dn.get(S))&&(y=f({},p),Ru(y,T)),l=l.ownerDocument||l,T=l.createElement("script"),_r(T),zr(T,"link",y),l.head.appendChild(T),d.instance=T);case"void":return null;default:throw Error(n(443,d.type))}else d.type==="stylesheet"&&(d.state.loading&4)===0&&(y=d.instance,d.state.loading|=4,Rl(y,p.precedence,l));return d.instance}function Rl(l,d,p){for(var y=p.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),T=y.length?y[y.length-1]:null,S=T,ee=0;ee<y.length;ee++){var te=y[ee];if(te.dataset.precedence===d)S=te;else if(S!==T)break}S?S.parentNode.insertBefore(l,S.nextSibling):(d=p.nodeType===9?p.head:p,d.insertBefore(l,d.firstChild))}function bu(l,d){l.crossOrigin==null&&(l.crossOrigin=d.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=d.referrerPolicy),l.title==null&&(l.title=d.title)}function Ru(l,d){l.crossOrigin==null&&(l.crossOrigin=d.crossOrigin),l.referrerPolicy==null&&(l.referrerPolicy=d.referrerPolicy),l.integrity==null&&(l.integrity=d.integrity)}var wl=null;function Mf(l,d,p){if(wl===null){var y=new Map,T=wl=new Map;T.set(p,y)}else T=wl,y=T.get(p),y||(y=new Map,T.set(p,y));if(y.has(l))return y;for(y.set(l,null),p=p.getElementsByTagName(l),T=0;T<p.length;T++){var S=p[T];if(!(S[Qi]||S[Rr]||l==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var ee=S.getAttribute(d)||"";ee=l+ee;var te=y.get(ee);te?te.push(S):y.set(ee,[S])}}return y}function kf(l,d,p){l=l.ownerDocument||l,l.head.insertBefore(p,d==="title"?l.querySelector("head > title"):null)}function im(l,d,p){if(p===1||d.itemProp!=null)return!1;switch(l){case"meta":case"title":return!0;case"style":if(typeof d.precedence!="string"||typeof d.href!="string"||d.href==="")break;return!0;case"link":if(typeof d.rel!="string"||typeof d.href!="string"||d.href===""||d.onLoad||d.onError)break;switch(d.rel){case"stylesheet":return l=d.disabled,typeof d.precedence=="string"&&l==null;default:return!0}case"script":if(d.async&&typeof d.async!="function"&&typeof d.async!="symbol"&&!d.onLoad&&!d.onError&&d.src&&typeof d.src=="string")return!0}return!1}function Nf(l){return!(l.type==="stylesheet"&&(l.state.loading&3)===0)}var fo=null;function sm(){}function am(l,d,p){if(fo===null)throw Error(n(475));var y=fo;if(d.type==="stylesheet"&&(typeof p.media!="string"||matchMedia(p.media).matches!==!1)&&(d.state.loading&4)===0){if(d.instance===null){var T=pa(p.href),S=l.querySelector(uo(T));if(S){l=S._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(y.count++,y=Pl.bind(y),l.then(y,y)),d.state.loading|=4,d.instance=S,_r(S);return}S=l.ownerDocument||l,p=Df(p),(T=Dn.get(T))&&bu(p,T),S=S.createElement("link"),_r(S);var ee=S;ee._p=new Promise(function(te,oe){ee.onload=te,ee.onerror=oe}),zr(S,"link",p),d.instance=S}y.stylesheets===null&&(y.stylesheets=new Map),y.stylesheets.set(d,l),(l=d.state.preload)&&(d.state.loading&3)===0&&(y.count++,d=Pl.bind(y),l.addEventListener("load",d),l.addEventListener("error",d))}}function om(){if(fo===null)throw Error(n(475));var l=fo;return l.stylesheets&&l.count===0&&wu(l,l.stylesheets),0<l.count?function(d){var p=setTimeout(function(){if(l.stylesheets&&wu(l,l.stylesheets),l.unsuspend){var y=l.unsuspend;l.unsuspend=null,y()}},6e4);return l.unsuspend=d,function(){l.unsuspend=null,clearTimeout(p)}}:null}function Pl(){if(this.count--,this.count===0){if(this.stylesheets)wu(this,this.stylesheets);else if(this.unsuspend){var l=this.unsuspend;this.unsuspend=null,l()}}}var Dl=null;function wu(l,d){l.stylesheets=null,l.unsuspend!==null&&(l.count++,Dl=new Map,d.forEach(lm,l),Dl=null,Pl.call(l))}function lm(l,d){if(!(d.state.loading&4)){var p=Dl.get(l);if(p)var y=p.get(null);else{p=new Map,Dl.set(l,p);for(var T=l.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<T.length;S++){var ee=T[S];(ee.nodeName==="LINK"||ee.getAttribute("media")!=="not all")&&(p.set(ee.dataset.precedence,ee),y=ee)}y&&p.set(null,y)}T=d.instance,ee=T.getAttribute("data-precedence"),S=p.get(ee)||y,S===y&&p.set(null,T),p.set(ee,T),this.count++,y=Pl.bind(this),T.addEventListener("load",y),T.addEventListener("error",y),S?S.parentNode.insertBefore(T,S.nextSibling):(l=l.nodeType===9?l.head:l,l.insertBefore(T,l.firstChild)),d.state.loading|=4}}var po={$$typeof:R,Provider:null,Consumer:null,_currentValue:ce,_currentValue2:ce,_threadCount:0};function cm(l,d,p,y,T,S,ee,te){this.tag=1,this.containerInfo=l,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Wr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wr(0),this.hiddenUpdates=Wr(null),this.identifierPrefix=y,this.onUncaughtError=T,this.onCaughtError=S,this.onRecoverableError=ee,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=te,this.incompleteTransitions=new Map}function Vf(l,d,p,y,T,S,ee,te,oe,_e,we,Oe){return l=new cm(l,d,p,ee,te,oe,_e,Oe),d=1,S===!0&&(d|=24),S=hn(3,null,null,d),l.current=S,S.stateNode=l,d=uc(),d.refCount++,l.pooledCache=d,d.refCount++,S.memoizedState={element:y,isDehydrated:p,cache:d},pc(S),l}function Bf(l){return l?(l=Ws,l):Ws}function Lf(l,d,p,y,T,S){T=Bf(T),y.context===null?y.context=T:y.pendingContext=T,y=Pi(d),y.payload={element:p},S=S===void 0?null:S,S!==null&&(y.callback=S),p=Di(l,y,d),p!==null&&(xn(p,l,d),Ha(p,l,d))}function jf(l,d){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var p=l.retryLane;l.retryLane=p!==0&&p<d?p:d}}function Pu(l,d){jf(l,d),(l=l.alternate)&&jf(l,d)}function Ff(l){if(l.tag===13){var d=Gs(l,67108864);d!==null&&xn(d,l,67108864),Pu(l,67108864)}}var Ol=!0;function um(l,d,p,y){var T=ie.T;ie.T=null;var S=se.p;try{se.p=2,Du(l,d,p,y)}finally{se.p=S,ie.T=T}}function dm(l,d,p,y){var T=ie.T;ie.T=null;var S=se.p;try{se.p=8,Du(l,d,p,y)}finally{se.p=S,ie.T=T}}function Du(l,d,p,y){if(Ol){var T=Ou(y);if(T===null)yu(l,d,y,Ml,p),$f(l,y);else if(fm(T,l,d,p,y))y.stopPropagation();else if($f(l,y),d&4&&-1<hm.indexOf(l)){for(;T!==null;){var S=Bn(T);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var ee=Lt(S.pendingLanes);if(ee!==0){var te=S;for(te.pendingLanes|=2,te.entangledLanes|=2;ee;){var oe=1<<31-We(ee);te.entanglements[1]|=oe,ee&=~oe}Qn(S),(qt&6)===0&&(gl=Me()+500,ao(0))}}break;case 13:te=Gs(S,2),te!==null&&xn(te,S,2),yl(),Pu(S,2)}if(S=Ou(y),S===null&&yu(l,d,y,Ml,p),S===T)break;T=S}T!==null&&y.stopPropagation()}else yu(l,d,y,null,p)}}function Ou(l){return l=An(l),Mu(l)}var Ml=null;function Mu(l){if(Ml=null,l=Jn(l),l!==null){var d=s(l);if(d===null)l=null;else{var p=d.tag;if(p===13){if(l=a(d),l!==null)return l;l=null}else if(p===3){if(d.stateNode.current.memoizedState.isDehydrated)return d.tag===3?d.stateNode.containerInfo:null;l=null}else d!==l&&(l=null)}}return Ml=l,null}function Uf(l){switch(l){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ze()){case He:return 2;case Ne:return 8;case Be:case et:return 32;case nt:return 268435456;default:return 32}default:return 32}}var ku=!1,zi=null,Gi=null,Wi=null,mo=new Map,go=new Map,Yi=[],hm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function $f(l,d){switch(l){case"focusin":case"focusout":zi=null;break;case"dragenter":case"dragleave":Gi=null;break;case"mouseover":case"mouseout":Wi=null;break;case"pointerover":case"pointerout":mo.delete(d.pointerId);break;case"gotpointercapture":case"lostpointercapture":go.delete(d.pointerId)}}function xo(l,d,p,y,T,S){return l===null||l.nativeEvent!==S?(l={blockedOn:d,domEventName:p,eventSystemFlags:y,nativeEvent:S,targetContainers:[T]},d!==null&&(d=Bn(d),d!==null&&Ff(d)),l):(l.eventSystemFlags|=y,d=l.targetContainers,T!==null&&d.indexOf(T)===-1&&d.push(T),l)}function fm(l,d,p,y,T){switch(d){case"focusin":return zi=xo(zi,l,d,p,y,T),!0;case"dragenter":return Gi=xo(Gi,l,d,p,y,T),!0;case"mouseover":return Wi=xo(Wi,l,d,p,y,T),!0;case"pointerover":var S=T.pointerId;return mo.set(S,xo(mo.get(S)||null,l,d,p,y,T)),!0;case"gotpointercapture":return S=T.pointerId,go.set(S,xo(go.get(S)||null,l,d,p,y,T)),!0}return!1}function Hf(l){var d=Jn(l.target);if(d!==null){var p=s(d);if(p!==null){if(d=p.tag,d===13){if(d=a(p),d!==null){l.blockedOn=d,Ki(l.priority,function(){if(p.tag===13){var y=gn();y=Zn(y);var T=Gs(p,y);T!==null&&xn(T,p,y),Pu(p,y)}});return}}else if(d===3&&p.stateNode.current.memoizedState.isDehydrated){l.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}l.blockedOn=null}function kl(l){if(l.blockedOn!==null)return!1;for(var d=l.targetContainers;0<d.length;){var p=Ou(l.nativeEvent);if(p===null){p=l.nativeEvent;var y=new p.constructor(p.type,p);ni=y,p.target.dispatchEvent(y),ni=null}else return d=Bn(p),d!==null&&Ff(d),l.blockedOn=p,!1;d.shift()}return!0}function zf(l,d,p){kl(l)&&p.delete(d)}function pm(){ku=!1,zi!==null&&kl(zi)&&(zi=null),Gi!==null&&kl(Gi)&&(Gi=null),Wi!==null&&kl(Wi)&&(Wi=null),mo.forEach(zf),go.forEach(zf)}function Nl(l,d){l.blockedOn===d&&(l.blockedOn=null,ku||(ku=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,pm)))}var Vl=null;function Gf(l){Vl!==l&&(Vl=l,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){Vl===l&&(Vl=null);for(var d=0;d<l.length;d+=3){var p=l[d],y=l[d+1],T=l[d+2];if(typeof y!="function"){if(Mu(y||p)===null)continue;break}var S=Bn(p);S!==null&&(l.splice(d,3),d-=3,Mc(S,{pending:!0,data:T,method:p.method,action:y},y,T))}}))}function yo(l){function d(oe){return Nl(oe,l)}zi!==null&&Nl(zi,l),Gi!==null&&Nl(Gi,l),Wi!==null&&Nl(Wi,l),mo.forEach(d),go.forEach(d);for(var p=0;p<Yi.length;p++){var y=Yi[p];y.blockedOn===l&&(y.blockedOn=null)}for(;0<Yi.length&&(p=Yi[0],p.blockedOn===null);)Hf(p),p.blockedOn===null&&Yi.shift();if(p=(l.ownerDocument||l).$$reactFormReplay,p!=null)for(y=0;y<p.length;y+=3){var T=p[y],S=p[y+1],ee=T[Cr]||null;if(typeof S=="function")ee||Gf(p);else if(ee){var te=null;if(S&&S.hasAttribute("formAction")){if(T=S,ee=S[Cr]||null)te=ee.formAction;else if(Mu(T)!==null)continue}else te=ee.action;typeof te=="function"?p[y+1]=te:(p.splice(y,3),y-=3),Gf(p)}}}function Nu(l){this._internalRoot=l}Bl.prototype.render=Nu.prototype.render=function(l){var d=this._internalRoot;if(d===null)throw Error(n(409));var p=d.current,y=gn();Lf(p,y,l,d,null,null)},Bl.prototype.unmount=Nu.prototype.unmount=function(){var l=this._internalRoot;if(l!==null){this._internalRoot=null;var d=l.containerInfo;Lf(l.current,2,null,l,null,null),yl(),d[En]=null}};function Bl(l){this._internalRoot=l}Bl.prototype.unstable_scheduleHydration=function(l){if(l){var d=Tr();l={blockedOn:null,target:l,priority:d};for(var p=0;p<Yi.length&&d!==0&&d<Yi[p].priority;p++);Yi.splice(p,0,l),p===0&&Hf(l)}};var Wf=e.version;if(Wf!=="19.1.0")throw Error(n(527,Wf,"19.1.0"));se.findDOMNode=function(l){var d=l._reactInternals;if(d===void 0)throw typeof l.render=="function"?Error(n(188)):(l=Object.keys(l).join(","),Error(n(268,l)));return l=c(d),l=l!==null?h(l):null,l=l===null?null:l.stateNode,l};var mm={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ll=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ll.isDisabled&&Ll.supportsFiber)try{Xe=Ll.inject(mm),Ke=Ll}catch{}}return reactDomClient_production.createRoot=function(l,d){if(!i(l))throw Error(n(299));var p=!1,y="",T=oh,S=lh,ee=ch,te=null;return d!=null&&(d.unstable_strictMode===!0&&(p=!0),d.identifierPrefix!==void 0&&(y=d.identifierPrefix),d.onUncaughtError!==void 0&&(T=d.onUncaughtError),d.onCaughtError!==void 0&&(S=d.onCaughtError),d.onRecoverableError!==void 0&&(ee=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(te=d.unstable_transitionCallbacks)),d=Vf(l,1,!1,null,null,p,y,T,S,ee,te,null),l[En]=d.current,xu(l),new Nu(d)},reactDomClient_production.hydrateRoot=function(l,d,p){if(!i(l))throw Error(n(299));var y=!1,T="",S=oh,ee=lh,te=ch,oe=null,_e=null;return p!=null&&(p.unstable_strictMode===!0&&(y=!0),p.identifierPrefix!==void 0&&(T=p.identifierPrefix),p.onUncaughtError!==void 0&&(S=p.onUncaughtError),p.onCaughtError!==void 0&&(ee=p.onCaughtError),p.onRecoverableError!==void 0&&(te=p.onRecoverableError),p.unstable_transitionCallbacks!==void 0&&(oe=p.unstable_transitionCallbacks),p.formState!==void 0&&(_e=p.formState)),d=Vf(l,1,!0,d,p??null,y,T,S,ee,te,oe,_e),d.context=Bf(null),p=d.current,y=gn(),y=Zn(y),T=Pi(y),T.callback=null,Di(p,T,y),p=y,d.current.lanes=p,Ar(d,p),Qn(d),l[En]=d.current,xu(l),new Bl(d)},reactDomClient_production.version="19.1.0",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient();const getDefaultsFromPostinstall=()=>{};var define_process_env_default$3={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const stringToByteArray$1=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},byteArrayToString=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=r[t++],a=r[t++],o=r[t++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{const s=r[t++],a=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],a=i+1<r.length,o=a?r[i+1]:0,c=i+2<r.length,h=c?r[i+2]:0,f=s>>2,m=(s&3)<<4|o>>4;let g=(o&15)<<2|h>>6,_=h&63;c||(_=64,a||(g=64)),n.push(t[f],t[m],t[g],t[_])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(stringToByteArray$1(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):byteArrayToString(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],o=i<r.length?t[r.charAt(i)]:0;++i;const h=i<r.length?t[r.charAt(i)]:64;++i;const m=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||o==null||h==null||m==null)throw new DecodeBase64StringError;const g=s<<2|o>>4;if(n.push(g),h!==64){const _=o<<4&240|h>>2;if(n.push(_),m!==64){const E=h<<6&192|m;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(r){const e=stringToByteArray$1(r);return base64.encodeByteArray(e,!0)},base64urlEncodeWithoutPadding=function(r){return base64Encode(r).replace(/\./g,"")},base64Decode=function(r){try{return base64.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getGlobal(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const getDefaultsFromGlobal=()=>getGlobal().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(typeof process>"u"||typeof define_process_env_default$3>"u")return;const r=define_process_env_default$3.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},getDefaultsFromCookie=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&base64Decode(r[1]);return e&&JSON.parse(e)},getDefaults=()=>{try{return getDefaultsFromPostinstall()||getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},getDefaultEmulatorHost=r=>{var e,t;return(t=(e=getDefaults())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},getDefaultEmulatorHostnameAndPort=r=>{const e=getDefaultEmulatorHost(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},getDefaultAppConfig=()=>{var r;return(r=getDefaults())===null||r===void 0?void 0:r.config},getExperimentalSetting=r=>{var e;return(e=getDefaults())===null||e===void 0?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isCloudWorkstation(r){try{return(r.startsWith("http://")||r.startsWith("https://")?new URL(r).hostname:r).endsWith(".cloudworkstations.dev")}catch{return!1}}async function pingServer(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[base64urlEncodeWithoutPadding(JSON.stringify(t)),base64urlEncodeWithoutPadding(JSON.stringify(a)),""].join(".")}const emulatorStatus={};function getEmulatorSummary(){const r={prod:[],emulator:[]};for(const e of Object.keys(emulatorStatus))emulatorStatus[e]?r.emulator.push(e):r.prod.push(e);return r}function getOrCreateEl(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let previouslyDismissed=!1;function updateEmulatorBanner(r,e){if(typeof window>"u"||typeof document>"u"||!isCloudWorkstation(window.location.host)||emulatorStatus[r]===e||emulatorStatus[r]||previouslyDismissed)return;emulatorStatus[r]=e;function t(g){return`__firebase__banner__${g}`}const n="__firebase__banner",s=getEmulatorSummary().prod.length>0;function a(){const g=document.getElementById(n);g&&g.remove()}function o(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,_){g.setAttribute("width","24"),g.setAttribute("id",_),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{previouslyDismissed=!0,a()},g}function f(g,_){g.setAttribute("id",_),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=getOrCreateEl(n),_=t("text"),E=document.getElementById(_)||document.createElement("span"),A=t("learnmore"),C=document.getElementById(A)||document.createElement("a"),I=t("preprendIcon"),b=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const R=g.element;o(R),f(C,A);const V=h();c(b,I),R.append(b,E,C,V),document.body.appendChild(R)}s?(E.innerText="Preview backend disconnected.",b.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(b.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isNode(){var r;const e=(r=getDefaults())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function isCloudflareWorker(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function isBrowserExtension(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function isReactNative(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isIE(){const r=getUA();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function isSafari(){return!isNode()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?replaceTemplate(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new FirebaseError(i,o,n)}}function replaceTemplate(r,e){return r.replace(PATTERN,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const PATTERN=/\{\$([^}]+)}/g;function isEmpty$1(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function deepEqual(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],a=e[i];if(isObject(s)&&isObject(a)){if(!deepEqual(s,a))return!1}else if(s!==a)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function isObject(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function querystringDecode(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function extractQuerystring(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function createSubscribe(r,e){const t=new ObserverProxy(r,e);return t.subscribe.bind(t)}class ObserverProxy{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");implementsAnyMethods(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=noop$3),i.error===void 0&&(i.error=noop$3),i.complete===void 0&&(i.complete=noop$3);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function implementsAnyMethods(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function noop$3(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(r){return r&&r._delegate?r._delegate:r}class Component{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME$1="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Provider{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Deferred;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(isComponentEager(e))try{this.getOrInitializeService({instanceIdentifier:DEFAULT_ENTRY_NAME$1})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=DEFAULT_ENTRY_NAME$1){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=DEFAULT_ENTRY_NAME$1){return this.instances.has(e)}getOptions(e=DEFAULT_ENTRY_NAME$1){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:normalizeIdentifierForFactory(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=DEFAULT_ENTRY_NAME$1){return this.component?this.component.multipleInstances?e:DEFAULT_ENTRY_NAME$1:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function normalizeIdentifierForFactory(r){return r===DEFAULT_ENTRY_NAME$1?void 0:r}function isComponentEager(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ComponentContainer{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Provider(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LogLevel;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=ConsoleMethod[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Logger{constructor(e){this.name=e,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in LogLevel))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?levelStringToEnum[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...e),this._logHandler(this,LogLevel.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...e),this._logHandler(this,LogLevel.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...e),this._logHandler(this,LogLevel.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...e),this._logHandler(this,LogLevel.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...e),this._logHandler(this,LogLevel.ERROR,...e)}}const instanceOfAny=(r,e)=>e.some(t=>r instanceof t);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",a)},s=()=>{t(wrap(r.result)),i()},a=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&cursorRequestMap.set(t,r)}).catch(()=>{}),reverseTransformCache.set(e,r),e}function cacheDonePromiseForTransaction(r){if(transactionDoneMap.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",a),r.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",a),r.addEventListener("abort",a)});transactionDoneMap.set(r,e)}let idbProxyTraps={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return transactionDoneMap.get(r);if(e==="objectStoreNames")return r.objectStoreNames||transactionStoreNamesMap.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return wrap(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function replaceTraps(r){idbProxyTraps=r(idbProxyTraps)}function wrapFunction(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(unwrap(this),e,...t);return transactionStoreNamesMap.set(n,e.sort?e.sort():[e]),wrap(n)}:getCursorAdvanceMethods().includes(r)?function(...e){return r.apply(unwrap(this),e),wrap(cursorRequestMap.get(this))}:function(...e){return wrap(r.apply(unwrap(this),e))}}function transformCachableValue(r){return typeof r=="function"?wrapFunction(r):(r instanceof IDBTransaction&&cacheDonePromiseForTransaction(r),instanceOfAny(r,getIdbProxyableTypes())?new Proxy(r,idbProxyTraps):r)}function wrap(r){if(r instanceof IDBRequest)return promisifyRequest(r);if(transformCache.has(r))return transformCache.get(r);const e=transformCachableValue(r);return e!==r&&(transformCache.set(r,e),reverseTransformCache.set(e,r)),e}const unwrap=r=>reverseTransformCache.get(r);function openDB(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const a=indexedDB.open(r,e),o=wrap(a);return n&&a.addEventListener("upgradeneeded",c=>{n(wrap(a.result),c.oldVersion,c.newVersion,wrap(a.transaction),c)}),t&&a.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),o}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(cachedMethods.get(e))return cachedMethods.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=writeMethods.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||readMethods.includes(t)))return;const s=async function(a,...o){const c=this.transaction(a,i?"readwrite":"readonly");let h=c.store;return n&&(h=h.index(o.shift())),(await Promise.all([h[t](...o),i&&c.done]))[0]};return cachedMethods.set(e,s),s}replaceTraps(r=>({...r,get:(e,t,n)=>getMethod(e,t)||r.get(e,t,n),has:(e,t)=>!!getMethod(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(isVersionServiceProvider(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function isVersionServiceProvider(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const name$q="@firebase/app",version$1$1="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logger$1=new Logger("@firebase/app"),name$p="@firebase/app-compat",name$o="@firebase/analytics-compat",name$n="@firebase/analytics",name$m="@firebase/app-check-compat",name$l="@firebase/app-check",name$k="@firebase/auth",name$j="@firebase/auth-compat",name$i="@firebase/database",name$h="@firebase/data-connect",name$g="@firebase/database-compat",name$f="@firebase/functions",name$e="@firebase/functions-compat",name$d="@firebase/installations",name$c="@firebase/installations-compat",name$b="@firebase/messaging",name$a="@firebase/messaging-compat",name$9="@firebase/performance",name$8="@firebase/performance-compat",name$7="@firebase/remote-config",name$6="@firebase/remote-config-compat",name$5="@firebase/storage",name$4="@firebase/storage-compat",name$3="@firebase/firestore",name$2="@firebase/ai",name$1$1="@firebase/firestore-compat",name$r="firebase",version$2="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ENTRY_NAME="[DEFAULT]",PLATFORM_LOG_STRING={[name$q]:"fire-core",[name$p]:"fire-core-compat",[name$n]:"fire-analytics",[name$o]:"fire-analytics-compat",[name$l]:"fire-app-check",[name$m]:"fire-app-check-compat",[name$k]:"fire-auth",[name$j]:"fire-auth-compat",[name$i]:"fire-rtdb",[name$h]:"fire-data-connect",[name$g]:"fire-rtdb-compat",[name$f]:"fire-fn",[name$e]:"fire-fn-compat",[name$d]:"fire-iid",[name$c]:"fire-iid-compat",[name$b]:"fire-fcm",[name$a]:"fire-fcm-compat",[name$9]:"fire-perf",[name$8]:"fire-perf-compat",[name$7]:"fire-rc",[name$6]:"fire-rc-compat",[name$5]:"fire-gcs",[name$4]:"fire-gcs-compat",[name$3]:"fire-fst",[name$1$1]:"fire-fst-compat",[name$2]:"fire-vertex","fire-js":"fire-js",[name$r]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _apps=new Map,_serverApps=new Map,_components=new Map;function _addComponent(r,e){try{r.container.addComponent(e)}catch(t){logger$1.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function _registerComponent(r){const e=r.name;if(_components.has(e))return logger$1.debug(`There were multiple attempts to register component ${e}.`),!1;_components.set(e,r);for(const t of _apps.values())_addComponent(t,r);for(const t of _serverApps.values())_addComponent(t,r);return!0}function _getProvider(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function _isFirebaseServerApp(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ERRORS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ERROR_FACTORY=new ErrorFactory("app","Firebase",ERRORS);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FirebaseAppImpl{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ERROR_FACTORY.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SDK_VERSION=version$2;function initializeApp(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:DEFAULT_ENTRY_NAME,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw ERROR_FACTORY.create("bad-app-name",{appName:String(i)});if(t||(t=getDefaultAppConfig()),!t)throw ERROR_FACTORY.create("no-options");const s=_apps.get(i);if(s){if(deepEqual(t,s.options)&&deepEqual(n,s.config))return s;throw ERROR_FACTORY.create("duplicate-app",{appName:i})}const a=new ComponentContainer(i);for(const c of _components.values())a.addComponent(c);const o=new FirebaseAppImpl(t,n,a);return _apps.set(i,o),o}function getApp(r=DEFAULT_ENTRY_NAME){const e=_apps.get(r);if(!e&&r===DEFAULT_ENTRY_NAME&&getDefaultAppConfig())return initializeApp();if(!e)throw ERROR_FACTORY.create("no-app",{appName:r});return e}function registerVersion(r,e,t){var n;let i=(n=PLATFORM_LOG_STRING[r])!==null&&n!==void 0?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){const o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),logger$1.warn(o.join(" "));return}_registerComponent(new Component(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME$1="firebase-heartbeat-database",DB_VERSION$1=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME$1,DB_VERSION$1,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(STORE_NAME)}catch(t){console.warn(t)}}}}).catch(r=>{throw ERROR_FACTORY.create("idb-open",{originalErrorMessage:r.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(r){try{const t=(await getDbPromise()).transaction(STORE_NAME),n=await t.objectStore(STORE_NAME).get(computeKey(r));return await t.done,n}catch(e){if(e instanceof FirebaseError)logger$1.warn(e.message);else{const t=ERROR_FACTORY.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});logger$1.warn(t.message)}}}async function writeHeartbeatsToIndexedDB(r,e){try{const n=(await getDbPromise()).transaction(STORE_NAME,"readwrite");await n.objectStore(STORE_NAME).put(e,computeKey(r)),await n.done}catch(t){if(t instanceof FirebaseError)logger$1.warn(t.message);else{const n=ERROR_FACTORY.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});logger$1.warn(n.message)}}}function computeKey(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MAX_HEADER_BYTES=1024,MAX_NUM_STORED_HEARTBEATS=30;class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=getUTCDateString();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>MAX_NUM_STORED_HEARTBEATS){const a=getEarliestHeartbeatIdx(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){logger$1.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=getUTCDateString(),{heartbeatsToSend:n,unsentEntries:i}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),s=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return logger$1.warn(t),""}}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(r,e=MAX_HEADER_BYTES){const t=[];let n=r.slice();for(const i of r){const s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),countBytes(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),countBytes(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await readHeartbeatsFromIndexedDB(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function countBytes(r){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:r})).length}function getEarliestHeartbeatIdx(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function registerCoreComponents(r){_registerComponent(new Component("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new Component("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(name$q,version$1$1,r),registerVersion(name$q,version$1$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");function __rest(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}typeof SuppressedError=="function"&&SuppressedError;function _prodErrorMap(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const prodErrorMap=_prodErrorMap,_DEFAULT_AUTH_ERROR_FACTORY=new ErrorFactory("auth","Firebase",_prodErrorMap());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const logClient=new Logger("@firebase/auth");function _logWarn(r,...e){logClient.logLevel<=LogLevel.WARN&&logClient.warn(`Auth (${SDK_VERSION}): ${r}`,...e)}function _logError(r,...e){logClient.logLevel<=LogLevel.ERROR&&logClient.error(`Auth (${SDK_VERSION}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(r,...e){throw createErrorInternal(r,...e)}function _createError(r,...e){return createErrorInternal(r,...e)}function _errorWithCustomMessage(r,e,t){const n=Object.assign(Object.assign({},prodErrorMap()),{[e]:t});return new ErrorFactory("auth","Firebase",n).create(e,{appName:r.name})}function _serverAppCurrentUserOperationNotSupportedError(r){return _errorWithCustomMessage(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function createErrorInternal(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return _DEFAULT_AUTH_ERROR_FACTORY.create(r,...e)}function _assert(r,e,...t){if(!r)throw createErrorInternal(e,...t)}function debugFail(r){const e="INTERNAL ASSERTION FAILED: "+r;throw _logError(e),new Error(e)}function debugAssert(r,e){r||debugFail(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.href)||""}function _isHttpOrHttps(){return _getCurrentScheme()==="http:"||_getCurrentScheme()==="https:"}function _getCurrentScheme(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isOnline(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_isHttpOrHttps()||isBrowserExtension()||"connection"in navigator)?navigator.onLine:!0}function _getUserLanguage(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Delay{constructor(e,t){this.shortDelay=e,this.longDelay=t,debugAssert(t>e,"Short delay should be less than long delay!"),this.isMobile=isMobileCordova()||isReactNative()}get(){return _isOnline()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(r,e){debugAssert(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FetchProvider{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SERVER_ERROR_MAP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CookieAuthProxiedEndpoints=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],DEFAULT_API_TIMEOUT_MS=new Delay(3e4,6e4);function _addTidIfNecessary(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}async function _performApiRequest(r,e,t,n,i={}){return _performFetchWithErrorHandling(r,i,async()=>{let s={},a={};n&&(e==="GET"?a=n:s={body:JSON.stringify(n)});const o=querystring(Object.assign({key:r.config.apiKey},a)).slice(1),c=await r._getAdditionalHeaders();c["Content-Type"]="application/json",r.languageCode&&(c["X-Firebase-Locale"]=r.languageCode);const h=Object.assign({method:e,headers:c},s);return isCloudflareWorker()||(h.referrerPolicy="no-referrer"),r.emulatorConfig&&isCloudWorkstation(r.emulatorConfig.host)&&(h.credentials="include"),FetchProvider.fetch()(await _getFinalTarget(r,r.config.apiHost,t,o),h)})}async function _performFetchWithErrorHandling(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},SERVER_ERROR_MAP),e);try{const i=new NetworkTimeout(r),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const a=await s.json();if("needConfirmation"in a)throw _makeTaggedError(r,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{const o=s.ok?a.errorMessage:a.error.message,[c,h]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw _makeTaggedError(r,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw _makeTaggedError(r,"email-already-in-use",a);if(c==="USER_DISABLED")throw _makeTaggedError(r,"user-disabled",a);const f=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw _errorWithCustomMessage(r,f,h);_fail(r,f)}}catch(i){if(i instanceof FirebaseError)throw i;_fail(r,"network-request-failed",{message:String(i)})}}async function _performSignInRequest(r,e,t,n,i={}){const s=await _performApiRequest(r,e,t,n,i);return"mfaPendingCredential"in s&&_fail(r,"multi-factor-auth-required",{_serverResponse:s}),s}async function _getFinalTarget(r,e,t,n){const i=`${e}${t}?${n}`,s=r,a=s.config.emulator?_emulatorUrl(r.config,i):`${r.config.apiScheme}://${i}`;return CookieAuthProxiedEndpoints.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(a).toString():a}function _parseEnforcementState(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class NetworkTimeout{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(_createError(this.auth,"network-request-failed")),DEFAULT_API_TIMEOUT_MS.get())})}}function _makeTaggedError(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=_createError(r,e,n);return i.customData._tokenResponse=t,i}function isEnterprise(r){return r!==void 0&&r.enterprise!==void 0}class RecaptchaConfig{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return _parseEnforcementState(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function getRecaptchaConfig(r,e){return _performApiRequest(r,"GET","/v2/recaptchaConfig",_addTidIfNecessary(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function deleteAccount(r,e){return _performApiRequest(r,"POST","/v1/accounts:delete",e)}async function getAccountInfo(r,e){return _performApiRequest(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function getIdTokenResult(r,e=!1){const t=getModularInstance(r),n=await t.getIdToken(e),i=_parseToken(n);_assert(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,a=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:utcTimestampToDateString(secondsStringToMilliseconds(i.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(i.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(i.exp)),signInProvider:a||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function secondsStringToMilliseconds(r){return Number(r)*1e3}function _parseToken(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{const i=base64Decode(t);return i?JSON.parse(i):(_logError("Failed to decode base64 JWT payload"),null)}catch(i){return _logError("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function _tokenExpiresIn(r){const e=_parseToken(r);return _assert(e,"internal-error"),_assert(typeof e.exp<"u","internal-error"),_assert(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _logoutIfInvalidated(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof FirebaseError&&isUserInvalidated(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function isUserInvalidated({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ProactiveRefresh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserMetadata{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reloadWithoutSaving(r){var e;const t=r.auth,n=await r.getIdToken(),i=await _logoutIfInvalidated(r,getAccountInfo(t,{idToken:n}));_assert(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];r._notifyReloadListener(s);const a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?extractProviderData(s.providerUserInfo):[],o=mergeProviderData(r.providerData,a),c=r.isAnonymous,h=!(r.email&&s.passwordHash)&&!(o!=null&&o.length),f=c?h:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new UserMetadata(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(r,m)}async function reload(r){const e=getModularInstance(r);await _reloadWithoutSaving(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function mergeProviderData(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function extractProviderData(r){return r.map(e=>{var{providerId:t}=e,n=__rest(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function requestStsToken(r,e){const t=await _performFetchWithErrorHandling(r,{},async()=>{const n=querystring({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,a=await _getFinalTarget(r,i,"/v1/token",`key=${s}`),o=await r._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:o,body:n};return r.emulatorConfig&&isCloudWorkstation(r.emulatorConfig.host)&&(c.credentials="include"),FetchProvider.fetch()(a,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function revokeToken(r,e){return _performApiRequest(r,"POST","/v2/accounts:revokeToken",_addTidIfNecessary(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_assert(e.idToken,"internal-error"),_assert(typeof e.idToken<"u","internal-error"),_assert(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):_tokenExpiresIn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){_assert(e.length!==0,"internal-error");const t=_tokenExpiresIn(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(_assert(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await requestStsToken(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,a=new StsTokenManager;return n&&(_assert(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(_assert(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(_assert(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(r,e){_assert(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class UserImpl{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=__rest(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new UserMetadata(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,e));return _assert(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return getIdTokenResult(this,e)}reload(){return reload(this)}_assign(e){this!==e&&(_assert(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new UserImpl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){_assert(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await _reloadWithoutSaving(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(_isFirebaseServerApp(this.auth.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this.auth));const e=await this.getIdToken();return await _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,s,a,o,c,h,f;const m=(n=t.displayName)!==null&&n!==void 0?n:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(a=t.photoURL)!==null&&a!==void 0?a:void 0,A=(o=t.tenantId)!==null&&o!==void 0?o:void 0,C=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,I=(h=t.createdAt)!==null&&h!==void 0?h:void 0,b=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:R,emailVerified:V,isAnonymous:U,providerData:W,stsTokenManager:j}=t;_assert(R&&j,e,"internal-error");const w=StsTokenManager.fromJSON(this.name,j);_assert(typeof R=="string",e,"internal-error"),assertStringOrUndefined(m,e.name),assertStringOrUndefined(g,e.name),_assert(typeof V=="boolean",e,"internal-error"),_assert(typeof U=="boolean",e,"internal-error"),assertStringOrUndefined(_,e.name),assertStringOrUndefined(E,e.name),assertStringOrUndefined(A,e.name),assertStringOrUndefined(C,e.name),assertStringOrUndefined(I,e.name),assertStringOrUndefined(b,e.name);const P=new UserImpl({uid:R,auth:e,email:g,emailVerified:V,displayName:m,isAnonymous:U,photoURL:E,phoneNumber:_,tenantId:A,stsTokenManager:w,createdAt:I,lastLoginAt:b});return W&&Array.isArray(W)&&(P.providerData=W.map(K=>Object.assign({},K))),C&&(P._redirectEventId=C),P}static async _fromIdTokenResponse(e,t,n=!1){const i=new StsTokenManager;i.updateFromServerResponse(t);const s=new UserImpl({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await _reloadWithoutSaving(s),s}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];_assert(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?extractProviderData(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),o=new StsTokenManager;o.updateFromIdToken(n);const c=new UserImpl({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new UserMetadata(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,h),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const instanceCache=new Map;function _getInstance(r){debugAssert(r instanceof Function,"Expected a class definition");let e=instanceCache.get(r);return e?(debugAssert(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,instanceCache.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}InMemoryPersistence.type="NONE";const inMemoryPersistence=InMemoryPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(r,e,t){return`firebase:${r}:${e}:${t}`}class PersistenceUserManager{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,i.apiKey,s),this.fullPersistenceKey=_persistenceKeyName("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await getAccountInfo(this.auth,{idToken:e}).catch(()=>{});return t?UserImpl._fromGetAccountInfoResponse(this.auth,t,e):null}return UserImpl._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new PersistenceUserManager(_getInstance(inMemoryPersistence),e,n);const i=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=i[0]||_getInstance(inMemoryPersistence);const a=_persistenceKeyName(n,e.config.apiKey,e.name);let o=null;for(const h of t)try{const f=await h._get(a);if(f){let m;if(typeof f=="string"){const g=await getAccountInfo(e,{idToken:f}).catch(()=>{});if(!g)break;m=await UserImpl._fromGetAccountInfoResponse(e,g,f)}else m=UserImpl._fromJSON(e,f);h!==s&&(o=m),s=h;break}}catch{}const c=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new PersistenceUserManager(s,e,n):(s=c[0],o&&await s._set(a,o.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(a)}catch{}})),new PersistenceUserManager(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(_isIEMobile(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(_isFirefox(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_isBlackBerry(e))return"Blackberry";if(_isWebOS(e))return"Webos";if(_isSafari(e))return"Safari";if((e.includes("chrome/")||_isChromeIOS(e))&&!e.includes("edge/"))return"Chrome";if(_isAndroid(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function _isFirefox(r=getUA()){return/firefox\//i.test(r)}function _isSafari(r=getUA()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _isChromeIOS(r=getUA()){return/crios\//i.test(r)}function _isIEMobile(r=getUA()){return/iemobile/i.test(r)}function _isAndroid(r=getUA()){return/android/i.test(r)}function _isBlackBerry(r=getUA()){return/blackberry/i.test(r)}function _isWebOS(r=getUA()){return/webos/i.test(r)}function _isIOS(r=getUA()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function _isIOSStandalone(r=getUA()){var e;return _isIOS(r)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function _isIE10(){return isIE()&&document.documentMode===10}function _isMobileBrowser(r=getUA()){return _isIOS(r)||_isAndroid(r)||_isWebOS(r)||_isBlackBerry(r)||/windows phone/i.test(r)||_isIEMobile(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(r,e=[]){let t;switch(r){case"Browser":t=_getBrowserName(getUA());break;case"Worker":t=`${_getBrowserName(getUA())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${SDK_VERSION}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthMiddlewareQueue{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((a,o)=>{try{const c=e(s);a(c)}catch(c){o(c)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getPasswordPolicy(r,e={}){return _performApiRequest(r,"GET","/v2/passwordPolicy",_addTidIfNecessary(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MINIMUM_MIN_PASSWORD_LENGTH=6;class PasswordPolicyImpl{constructor(e){var t,n,i,s;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:MINIMUM_MIN_PASSWORD_LENGTH,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,s,a,o;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(o=c.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),c}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthImpl{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription(this),this.idTokenSubscription=new Subscription(this),this.beforeStateQueue=new AuthMiddlewareQueue(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_DEFAULT_AUTH_ERROR_FACTORY,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_getInstance(t)),this._initializationPromise=this.queue(async()=>{var n,i,s;if(!this._deleted&&(this.persistenceManager=await PersistenceUserManager.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await getAccountInfo(this,{idToken:e}),n=await UserImpl._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(_isFirebaseServerApp(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,o=i==null?void 0:i._redirectEventId,c=await this.tryRedirectSignIn(e);(!a||a===o)&&(c!=null&&c.user)&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return _assert(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await _reloadWithoutSaving(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_getUserLanguage()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(_isFirebaseServerApp(this.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this));const t=e?getModularInstance(e):null;return t&&_assert(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&_assert(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return _isFirebaseServerApp(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_getInstance(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _getPasswordPolicy(this),t=new PasswordPolicyImpl(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ErrorFactory("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await revokeToken(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&_getInstance(e)||this._popupRedirectResolver;_assert(t,this,"argument-error"),this.redirectPersistenceManager=await PersistenceUserManager.create(this,[_getInstance(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(_assert(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,n,i);return()=>{a=!0,c()}}else{const c=e.addObserver(t);return()=>{a=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _assert(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(_isFirebaseServerApp(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&_logWarn(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function _castAuth(r){return getModularInstance(r)}class Subscription{constructor(e){this.auth=e,this.observer=null,this.addObserver=createSubscribe(t=>this.observer=t)}get next(){return _assert(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let externalJSProvider={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _setExternalJSProvider(r){externalJSProvider=r}function _loadJS(r){return externalJSProvider.loadJS(r)}function _recaptchaEnterpriseScriptUrl(){return externalJSProvider.recaptchaEnterpriseScript}function _gapiScriptUrl(){return externalJSProvider.gapiScript}function _generateCallbackName(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class MockGreCAPTCHATopLevel{constructor(){this.enterprise=new MockGreCAPTCHA}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class MockGreCAPTCHA{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const RECAPTCHA_ENTERPRISE_VERIFIER_TYPE="recaptcha-enterprise",FAKE_TOKEN="NO_RECAPTCHA";class RecaptchaEnterpriseVerifier{constructor(e){this.type=RECAPTCHA_ENTERPRISE_VERIFIER_TYPE,this.auth=_castAuth(e)}async verify(e="verify",t=!1){async function n(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(a,o)=>{getRecaptchaConfig(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const h=new RecaptchaConfig(c);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,a(h.siteKey)}}).catch(c=>{o(c)})})}function i(s,a,o){const c=window.grecaptcha;isEnterprise(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(h=>{a(h)}).catch(()=>{a(FAKE_TOKEN)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new MockGreCAPTCHATopLevel().execute("siteKey",{action:"verify"}):new Promise((s,a)=>{n(this.auth).then(o=>{if(!t&&isEnterprise(window.grecaptcha))i(o,s,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let c=_recaptchaEnterpriseScriptUrl();c.length!==0&&(c+=o),_loadJS(c).then(()=>{i(o,s,a)}).catch(h=>{a(h)})}}).catch(o=>{a(o)})})}}async function injectRecaptchaFields(r,e,t,n=!1,i=!1){const s=new RecaptchaEnterpriseVerifier(r);let a;if(i)a=FAKE_TOKEN;else try{a=await s.verify(t)}catch{a=await s.verify(t,!0)}const o=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in o){const c=o.phoneEnrollmentInfo.phoneNumber,h=o.phoneEnrollmentInfo.recaptchaToken;Object.assign(o,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:h,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in o){const c=o.phoneSignInInfo.recaptchaToken;Object.assign(o,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:a,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return o}return n?Object.assign(o,{captchaResp:a}):Object.assign(o,{captchaResponse:a}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function handleRecaptchaFlow(r,e,t,n,i){var s;if(!((s=r._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const a=await injectRecaptchaFields(r,e,t,t==="getOobCode");return n(r,a)}else return n(r,e).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await injectRecaptchaFields(r,e,t,t==="getOobCode");return n(r,o)}else return Promise.reject(a)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function initializeAuth(r,e){const t=_getProvider(r,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(deepEqual(s,e??{}))return i;_fail(i,"already-initialized")}return t.initialize({options:e})}function _initializeAuthInstance(r,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(_getInstance);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function connectAuthEmulator(r,e,t){const n=_castAuth(r);_assert(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=extractProtocol(e),{host:a,port:o}=extractHostAndPort(e),c=o===null?"":`:${o}`,h={url:`${s}//${a}${c}/`},f=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){_assert(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),_assert(deepEqual(h,n.config.emulator)&&deepEqual(f,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=f,n.settings.appVerificationDisabledForTesting=!0,isCloudWorkstation(a)?(pingServer(`${s}//${a}${c}`),updateEmulatorBanner("Auth",!0)):emitEmulatorWarning()}function extractProtocol(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function extractHostAndPort(r){const e=extractProtocol(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:parsePort(n.substr(s.length+1))}}else{const[s,a]=n.split(":");return{host:s,port:parsePort(a)}}}function parsePort(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function emitEmulatorWarning(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthCredential{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return debugFail("not implemented")}_getIdTokenResponse(e){return debugFail("not implemented")}_linkToIdToken(e,t){return debugFail("not implemented")}_getReauthenticationResolver(e){return debugFail("not implemented")}}async function linkEmailPassword(r,e){return _performApiRequest(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithPassword(r,e){return _performSignInRequest(r,"POST","/v1/accounts:signInWithPassword",_addTidIfNecessary(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithEmailLink$1(r,e){return _performSignInRequest(r,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(r,e))}async function signInWithEmailLinkForLinking(r,e){return _performSignInRequest(r,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EmailAuthCredential extends AuthCredential{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new EmailAuthCredential(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new EmailAuthCredential(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return handleRecaptchaFlow(e,t,"signInWithPassword",signInWithPassword);case"emailLink":return signInWithEmailLink$1(e,{email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return handleRecaptchaFlow(e,n,"signUpPassword",linkEmailPassword);case"emailLink":return signInWithEmailLinkForLinking(e,{idToken:t,email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithIdp(r,e){return _performSignInRequest(r,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IDP_REQUEST_URI$1="http://localhost";class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new OAuthCredential(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_fail("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=__rest(t,["providerId","signInMethod"]);if(!n||!i)return null;const a=new OAuthCredential(n,i);return a.idToken=s.idToken||void 0,a.accessToken=s.accessToken||void 0,a.secret=s.secret,a.nonce=s.nonce,a.pendingToken=s.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return signInWithIdp(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,signInWithIdp(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,signInWithIdp(e,t)}buildRequest(){const e={requestUri:IDP_REQUEST_URI$1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=querystring(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function parseMode(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function parseDeepLink(r){const e=querystringDecode(extractQuerystring(r)).link,t=e?querystringDecode(extractQuerystring(e)).deep_link_id:null,n=querystringDecode(extractQuerystring(r)).deep_link_id;return(n?querystringDecode(extractQuerystring(n)).link:null)||n||t||e||r}class ActionCodeURL{constructor(e){var t,n,i,s,a,o;const c=querystringDecode(extractQuerystring(e)),h=(t=c.apiKey)!==null&&t!==void 0?t:null,f=(n=c.oobCode)!==null&&n!==void 0?n:null,m=parseMode((i=c.mode)!==null&&i!==void 0?i:null);_assert(h&&f&&m,"argument-error"),this.apiKey=h,this.operation=m,this.code=f,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(a=c.lang)!==null&&a!==void 0?a:null,this.tenantId=(o=c.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const t=parseDeepLink(e);try{return new ActionCodeURL(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EmailAuthProvider{constructor(){this.providerId=EmailAuthProvider.PROVIDER_ID}static credential(e,t){return EmailAuthCredential._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=ActionCodeURL.parseLink(t);return _assert(n,"argument-error"),EmailAuthCredential._fromEmailAndCode(e,n.code,n.tenantId)}}EmailAuthProvider.PROVIDER_ID="password";EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD="password";EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FederatedAuthProvider{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential(e){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return FacebookAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return FacebookAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return FacebookAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com";FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return GoogleAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GoogleAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return GoogleAuthProvider.credential(t,n)}catch{return null}}}GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com";GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential(e){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return GithubAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GithubAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return GithubAuthProvider.credential(e.oauthAccessToken)}catch{return null}}}GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com";GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential(e,t){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return TwitterAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return TwitterAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return TwitterAuthProvider.credential(t,n)}catch{return null}}}TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com";TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signUp(r,e){return _performSignInRequest(r,"POST","/v1/accounts:signUp",_addTidIfNecessary(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UserCredentialImpl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const s=await UserImpl._fromIdTokenResponse(e,n,i),a=providerIdForResponse(n);return new UserCredentialImpl({user:s,providerId:a,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=providerIdForResponse(n);return new UserCredentialImpl({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function providerIdForResponse(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MultiFactorError extends FirebaseError{constructor(e,t,n,i){var s;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,MultiFactorError.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new MultiFactorError(e,t,n,i)}}function _processCredentialSavingMfaContextIfNecessary(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?MultiFactorError._fromErrorAndOperation(r,s,e,n):s})}async function _link$1(r,e,t=!1){const n=await _logoutIfInvalidated(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return UserCredentialImpl._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reauthenticate(r,e,t=!1){const{auth:n}=r;if(_isFirebaseServerApp(n.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(n));const i="reauthenticate";try{const s=await _logoutIfInvalidated(r,_processCredentialSavingMfaContextIfNecessary(n,i,e,r),t);_assert(s.idToken,n,"internal-error");const a=_parseToken(s.idToken);_assert(a,n,"internal-error");const{sub:o}=a;return _assert(r.uid===o,n,"user-mismatch"),UserCredentialImpl._forOperation(r,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&_fail(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _signInWithCredential(r,e,t=!1){if(_isFirebaseServerApp(r.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(r));const n="signIn",i=await _processCredentialSavingMfaContextIfNecessary(r,n,e),s=await UserCredentialImpl._fromIdTokenResponse(r,n,i);return t||await r._updateCurrentUser(s.user),s}async function signInWithCredential(r,e){return _signInWithCredential(_castAuth(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function recachePasswordPolicy(r){const e=_castAuth(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function createUserWithEmailAndPassword(r,e,t){if(_isFirebaseServerApp(r.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(r));const n=_castAuth(r),a=await handleRecaptchaFlow(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",signUp).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&recachePasswordPolicy(r),c}),o=await UserCredentialImpl._fromIdTokenResponse(n,"signIn",a);return await n._updateCurrentUser(o.user),o}function signInWithEmailAndPassword(r,e,t){return _isFirebaseServerApp(r.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(r)):signInWithCredential(getModularInstance(r),EmailAuthProvider.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&recachePasswordPolicy(r),n})}function onIdTokenChanged(r,e,t,n){return getModularInstance(r).onIdTokenChanged(e,t,n)}function beforeAuthStateChanged(r,e,t){return getModularInstance(r).beforeAuthStateChanged(e,t)}function onAuthStateChanged(r,e,t,n){return getModularInstance(r).onAuthStateChanged(e,t,n)}const STORAGE_AVAILABLE_KEY="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserPersistenceClass{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(STORAGE_AVAILABLE_KEY,"1"),this.storage.removeItem(STORAGE_AVAILABLE_KEY),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLLING_INTERVAL_MS$1=1e3,IE10_LOCAL_STORAGE_SYNC_DELAY=10;class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,c)=>{this.notifyListeners(a,c)});return}const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const a=this.storage.getItem(n);!t&&this.localCache[n]===a||this.notifyListeners(n,a)},s=this.storage.getItem(n);_isIE10()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,IE10_LOCAL_STORAGE_SYNC_DELAY):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},_POLLING_INTERVAL_MS$1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}BrowserLocalPersistence.type="LOCAL";const browserLocalPersistence=BrowserLocalPersistence;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}BrowserSessionPersistence.type="SESSION";const browserSessionPersistence=BrowserSessionPersistence;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _allSettled(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Receiver{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const n=new Receiver(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:s}=t.data,a=this.handlersMap[i];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(a).map(async h=>h(t.origin,s)),c=await _allSettled(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Receiver.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sender{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,a;return new Promise((o,c)=>{const h=_generateEventId("",20);i.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},n);a={messageChannel:i,onMessage(m){const g=m;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(g.data.response);break;default:clearTimeout(f),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(a),i.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window(){return window}function _setWindowLocation(r){_window().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker(){return typeof _window().WorkerGlobalScope<"u"&&typeof _window().importScripts=="function"}async function _getActiveServiceWorker(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _getServiceWorkerController(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)===null||r===void 0?void 0:r.controller)||null}function _getWorkerGlobalScope(){return _isWorker()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DB_NAME="firebaseLocalStorageDb",DB_VERSION=1,DB_OBJECTSTORE_NAME="firebaseLocalStorage",DB_DATA_KEYPATH="fbase_key";class DBPromise{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function getObjectStore(r,e){return r.transaction([DB_OBJECTSTORE_NAME],e?"readwrite":"readonly").objectStore(DB_OBJECTSTORE_NAME)}function _deleteDatabase(){const r=indexedDB.deleteDatabase(DB_NAME);return new DBPromise(r).toPromise()}function _openDatabase(){const r=indexedDB.open(DB_NAME,DB_VERSION);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(DB_OBJECTSTORE_NAME,{keyPath:DB_DATA_KEYPATH})}catch(i){t(i)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(DB_OBJECTSTORE_NAME)?e(n):(n.close(),await _deleteDatabase(),e(await _openDatabase()))})})}async function _putObject(r,e,t){const n=getObjectStore(r,!0).put({[DB_DATA_KEYPATH]:e,value:t});return new DBPromise(n).toPromise()}async function getObject(r,e){const t=getObjectStore(r,!1).get(e),n=await new DBPromise(t).toPromise();return n===void 0?null:n.value}function _deleteObject(r,e){const t=getObjectStore(r,!0).delete(e);return new DBPromise(t).toPromise()}const _POLLING_INTERVAL_MS=800,_TRANSACTION_RETRY_COUNT=3;class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _openDatabase(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>_TRANSACTION_RETRY_COUNT)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _isWorker()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Receiver._getInstance(_getWorkerGlobalScope()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((t=n[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_getServiceWorkerController()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _openDatabase();return await _putObject(e,STORAGE_AVAILABLE_KEY,"1"),await _deleteObject(e,STORAGE_AVAILABLE_KEY),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>_putObject(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>getObject(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>_deleteObject(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=getObjectStore(i,!1).getAll();return new DBPromise(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_POLLING_INTERVAL_MS)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}IndexedDBLocalPersistence.type="LOCAL";const indexedDBLocalPersistence=IndexedDBLocalPersistence;new Delay(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _withDefaultResolver(r,e){return e?_getInstance(e):(_assert(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IdpCredential extends AuthCredential{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return signInWithIdp(e,this._buildIdpRequest())}_linkToIdToken(e,t){return signInWithIdp(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return signInWithIdp(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function _signIn(r){return _signInWithCredential(r.auth,new IdpCredential(r),r.bypassAuthState)}function _reauth(r){const{auth:e,user:t}=r;return _assert(t,e,"internal-error"),_reauthenticate(t,new IdpCredential(r),r.bypassAuthState)}async function _link(r){const{auth:e,user:t}=r;return _assert(t,e,"internal-error"),_link$1(t,new IdpCredential(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AbstractPopupRedirectOperation{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:s,error:a,type:o}=e;if(a){this.reject(a);return}const c={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){debugAssert(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _POLL_WINDOW_CLOSE_TIMEOUT=new Delay(2e3,1e4);class PopupOperation extends AbstractPopupRedirectOperation{constructor(e,t,n,i,s){super(e,t,i,s),this.provider=n,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return _assert(e,this.auth,"internal-error"),e}async onExecution(){debugAssert(this.filter.length===1,"Popup operations only handle one event");const e=_generateEventId();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if(!((n=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,_POLL_WINDOW_CLOSE_TIMEOUT.get())};e()}}PopupOperation.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PENDING_REDIRECT_KEY="pendingRedirect",redirectOutcomeMap=new Map;class RedirectAction extends AbstractPopupRedirectOperation{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=redirectOutcomeMap.get(this.auth._key());if(!e){try{const n=await _getAndClearPendingRedirectStatus(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}redirectOutcomeMap.set(this.auth._key(),e)}return this.bypassAuthState||redirectOutcomeMap.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function _getAndClearPendingRedirectStatus(r,e){const t=pendingRedirectKey(e),n=resolverPersistence(r);if(!await n._isAvailable())return!1;const i=await n._get(t)==="true";return await n._remove(t),i}function _overrideRedirectResult(r,e){redirectOutcomeMap.set(r._key(),e)}function resolverPersistence(r){return _getInstance(r._redirectPersistence)}function pendingRedirectKey(r){return _persistenceKeyName(PENDING_REDIRECT_KEY,r.config.apiKey,r.name)}async function _getRedirectResult(r,e,t=!1){if(_isFirebaseServerApp(r.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(r));const n=_castAuth(r),i=_withDefaultResolver(n,e),a=await new RedirectAction(n,i,t).execute();return a&&!t&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EVENT_DUPLICATION_CACHE_DURATION_MS=600*1e3;class AuthEventManager{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!isRedirectEvent(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!isNullRedirectEvent(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";t.onError(_createError(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EVENT_DUPLICATION_CACHE_DURATION_MS&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid(e))}saveEventToCache(e){this.cachedEventUids.add(eventUid(e)),this.lastProcessedEventTime=Date.now()}}function eventUid(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function isNullRedirectEvent({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function isRedirectEvent(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getProjectConfig(r,e={}){return _performApiRequest(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IP_ADDRESS_REGEX=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,HTTP_REGEX=/^https?/;async function _validateOrigin(r){if(r.config.emulator)return;const{authorizedDomains:e}=await _getProjectConfig(r);for(const t of e)try{if(matchDomain(t))return}catch{}_fail(r,"unauthorized-domain")}function matchDomain(r){const e=_getCurrentUrl(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const a=new URL(r);return a.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===n}if(!HTTP_REGEX.test(t))return!1;if(IP_ADDRESS_REGEX.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NETWORK_TIMEOUT=new Delay(3e4,6e4);function resetUnloadedGapiModules(){const r=_window().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function loadGapi(r){return new Promise((e,t)=>{var n,i,s;function a(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),t(_createError(r,"network-request-failed"))},timeout:NETWORK_TIMEOUT.get()})}if(!((i=(n=_window().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=_window().gapi)===null||s===void 0)&&s.load)a();else{const o=_generateCallbackName("iframefcb");return _window()[o]=()=>{gapi.load?a():t(_createError(r,"network-request-failed"))},_loadJS(`${_gapiScriptUrl()}?onload=${o}`).catch(c=>t(c))}}).catch(e=>{throw cachedGApiLoader=null,e})}let cachedGApiLoader=null;function _loadGapi(r){return cachedGApiLoader=cachedGApiLoader||loadGapi(r),cachedGApiLoader}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PING_TIMEOUT=new Delay(5e3,15e3),IFRAME_PATH="__/auth/iframe",EMULATED_IFRAME_PATH="emulator/auth/iframe",IFRAME_ATTRIBUTES={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},EID_FROM_APIHOST=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function getIframeUrl(r){const e=r.config;_assert(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?_emulatorUrl(e,EMULATED_IFRAME_PATH):`https://${r.config.authDomain}/${IFRAME_PATH}`,n={apiKey:e.apiKey,appName:r.name,v:SDK_VERSION},i=EID_FROM_APIHOST.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${querystring(n).slice(1)}`}async function _openIframe(r){const e=await _loadGapi(r),t=_window().gapi;return _assert(t,r,"internal-error"),e.open({where:document.body,url:getIframeUrl(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IFRAME_ATTRIBUTES,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const a=_createError(r,"network-request-failed"),o=_window().setTimeout(()=>{s(a)},PING_TIMEOUT.get());function c(){_window().clearTimeout(o),i(n)}n.ping(c).then(c,()=>{s(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BASE_POPUP_OPTIONS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},DEFAULT_WIDTH=500,DEFAULT_HEIGHT=600,TARGET_BLANK="_blank",FIREFOX_EMPTY_URL="http://localhost";class AuthPopup{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function _open(r,e,t,n=DEFAULT_WIDTH,i=DEFAULT_HEIGHT){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const c=Object.assign(Object.assign({},BASE_POPUP_OPTIONS),{width:n.toString(),height:i.toString(),top:s,left:a}),h=getUA().toLowerCase();t&&(o=_isChromeIOS(h)?TARGET_BLANK:t),_isFirefox(h)&&(e=e||FIREFOX_EMPTY_URL,c.scrollbars="yes");const f=Object.entries(c).reduce((g,[_,E])=>`${g}${_}=${E},`,"");if(_isIOSStandalone(h)&&o!=="_self")return openAsNewWindowIOS(e||"",o),new AuthPopup(null);const m=window.open(e||"",o,f);_assert(m,r,"popup-blocked");try{m.focus()}catch{}return new AuthPopup(m)}function openAsNewWindowIOS(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WIDGET_PATH="__/auth/handler",EMULATOR_WIDGET_PATH="emulator/auth/handler",FIREBASE_APP_CHECK_FRAGMENT_ID=encodeURIComponent("fac");async function _getRedirectUrl(r,e,t,n,i,s){_assert(r.config.authDomain,r,"auth-domain-config-required"),_assert(r.config.apiKey,r,"invalid-api-key");const a={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:SDK_VERSION,eventId:i};if(e instanceof FederatedAuthProvider){e.setDefaultLanguage(r.languageCode),a.providerId=e.providerId||"",isEmpty$1(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,m]of Object.entries({}))a[f]=m}if(e instanceof BaseOAuthProvider){const f=e.getScopes().filter(m=>m!=="");f.length>0&&(a.scopes=f.join(","))}r.tenantId&&(a.tid=r.tenantId);const o=a;for(const f of Object.keys(o))o[f]===void 0&&delete o[f];const c=await r._getAppCheckToken(),h=c?`#${FIREBASE_APP_CHECK_FRAGMENT_ID}=${encodeURIComponent(c)}`:"";return`${getHandlerBase(r)}?${querystring(o).slice(1)}${h}`}function getHandlerBase({config:r}){return r.emulator?_emulatorUrl(r,EMULATOR_WIDGET_PATH):`https://${r.authDomain}/${WIDGET_PATH}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WEB_STORAGE_SUPPORT_KEY="webStorageSupport";class BrowserPopupRedirectResolver{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=browserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _openPopup(e,t,n,i){var s;debugAssert((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const a=await _getRedirectUrl(e,t,n,_getCurrentUrl(),i);return _open(e,a,_generateEventId())}async _openRedirect(e,t,n,i){await this._originValidation(e);const s=await _getRedirectUrl(e,t,n,_getCurrentUrl(),i);return _setWindowLocation(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(debugAssert(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await _openIframe(e),n=new AuthEventManager(e);return t.register("authEvent",i=>(_assert(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(WEB_STORAGE_SUPPORT_KEY,{type:WEB_STORAGE_SUPPORT_KEY},i=>{var s;const a=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[WEB_STORAGE_SUPPORT_KEY];a!==void 0&&t(!!a),_fail(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=_validateOrigin(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}}const browserPopupRedirectResolver=BrowserPopupRedirectResolver;var name$1="@firebase/auth",version$1="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AuthInterop{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getVersionForPlatform(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function registerAuth(r){_registerComponent(new Component("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;_assert(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const c={apiKey:a,authDomain:o,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(r)},h=new AuthImpl(n,i,s,c);return _initializeAuthInstance(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),_registerComponent(new Component("auth-internal",e=>{const t=_castAuth(e.getProvider("auth").getImmediate());return(n=>new AuthInterop(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),registerVersion(name$1,version$1,getVersionForPlatform(r)),registerVersion(name$1,version$1,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DEFAULT_ID_TOKEN_MAX_AGE=300,authIdTokenMaxAge=getExperimentalSetting("authIdTokenMaxAge")||DEFAULT_ID_TOKEN_MAX_AGE;let lastPostedIdToken=null;const mintCookieFactory=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>authIdTokenMaxAge)return;const i=t==null?void 0:t.token;lastPostedIdToken!==i&&(lastPostedIdToken=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function getAuth(r=getApp()){const e=_getProvider(r,"auth");if(e.isInitialized())return e.getImmediate();const t=initializeAuth(r,{popupRedirectResolver:browserPopupRedirectResolver,persistence:[indexedDBLocalPersistence,browserLocalPersistence,browserSessionPersistence]}),n=getExperimentalSetting("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const a=mintCookieFactory(s.toString());beforeAuthStateChanged(t,a,()=>a(t.currentUser)),onIdTokenChanged(t,o=>a(o))}}const i=getDefaultEmulatorHost("auth");return i&&connectAuthEmulator(t,`http://${i}`),t}function getScriptParentElement(){var r,e;return(e=(r=document.getElementsByTagName("head"))===null||r===void 0?void 0:r[0])!==null&&e!==void 0?e:document}_setExternalJSProvider({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=_createError("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",getScriptParentElement().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});registerAuth("Browser");var name="firebase",version="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */registerVersion(name,version,"app");var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Integer$1,Md5;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(j,w){function P(){}P.prototype=w.prototype,j.D=w.prototype,j.prototype=new P,j.prototype.constructor=j,j.C=function(K,X,Y){for(var Z=Array(arguments.length-2),ae=2;ae<arguments.length;ae++)Z[ae-2]=arguments[ae];return w.prototype[X].apply(K,Z)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(j,w,P){P||(P=0);var K=Array(16);if(typeof w=="string")for(var X=0;16>X;++X)K[X]=w.charCodeAt(P++)|w.charCodeAt(P++)<<8|w.charCodeAt(P++)<<16|w.charCodeAt(P++)<<24;else for(X=0;16>X;++X)K[X]=w[P++]|w[P++]<<8|w[P++]<<16|w[P++]<<24;w=j.g[0],P=j.g[1],X=j.g[2];var Y=j.g[3],Z=w+(Y^P&(X^Y))+K[0]+3614090360&4294967295;w=P+(Z<<7&4294967295|Z>>>25),Z=Y+(X^w&(P^X))+K[1]+3905402710&4294967295,Y=w+(Z<<12&4294967295|Z>>>20),Z=X+(P^Y&(w^P))+K[2]+606105819&4294967295,X=Y+(Z<<17&4294967295|Z>>>15),Z=P+(w^X&(Y^w))+K[3]+3250441966&4294967295,P=X+(Z<<22&4294967295|Z>>>10),Z=w+(Y^P&(X^Y))+K[4]+4118548399&4294967295,w=P+(Z<<7&4294967295|Z>>>25),Z=Y+(X^w&(P^X))+K[5]+1200080426&4294967295,Y=w+(Z<<12&4294967295|Z>>>20),Z=X+(P^Y&(w^P))+K[6]+2821735955&4294967295,X=Y+(Z<<17&4294967295|Z>>>15),Z=P+(w^X&(Y^w))+K[7]+4249261313&4294967295,P=X+(Z<<22&4294967295|Z>>>10),Z=w+(Y^P&(X^Y))+K[8]+1770035416&4294967295,w=P+(Z<<7&4294967295|Z>>>25),Z=Y+(X^w&(P^X))+K[9]+2336552879&4294967295,Y=w+(Z<<12&4294967295|Z>>>20),Z=X+(P^Y&(w^P))+K[10]+4294925233&4294967295,X=Y+(Z<<17&4294967295|Z>>>15),Z=P+(w^X&(Y^w))+K[11]+2304563134&4294967295,P=X+(Z<<22&4294967295|Z>>>10),Z=w+(Y^P&(X^Y))+K[12]+1804603682&4294967295,w=P+(Z<<7&4294967295|Z>>>25),Z=Y+(X^w&(P^X))+K[13]+4254626195&4294967295,Y=w+(Z<<12&4294967295|Z>>>20),Z=X+(P^Y&(w^P))+K[14]+2792965006&4294967295,X=Y+(Z<<17&4294967295|Z>>>15),Z=P+(w^X&(Y^w))+K[15]+1236535329&4294967295,P=X+(Z<<22&4294967295|Z>>>10),Z=w+(X^Y&(P^X))+K[1]+4129170786&4294967295,w=P+(Z<<5&4294967295|Z>>>27),Z=Y+(P^X&(w^P))+K[6]+3225465664&4294967295,Y=w+(Z<<9&4294967295|Z>>>23),Z=X+(w^P&(Y^w))+K[11]+643717713&4294967295,X=Y+(Z<<14&4294967295|Z>>>18),Z=P+(Y^w&(X^Y))+K[0]+3921069994&4294967295,P=X+(Z<<20&4294967295|Z>>>12),Z=w+(X^Y&(P^X))+K[5]+3593408605&4294967295,w=P+(Z<<5&4294967295|Z>>>27),Z=Y+(P^X&(w^P))+K[10]+38016083&4294967295,Y=w+(Z<<9&4294967295|Z>>>23),Z=X+(w^P&(Y^w))+K[15]+3634488961&4294967295,X=Y+(Z<<14&4294967295|Z>>>18),Z=P+(Y^w&(X^Y))+K[4]+3889429448&4294967295,P=X+(Z<<20&4294967295|Z>>>12),Z=w+(X^Y&(P^X))+K[9]+568446438&4294967295,w=P+(Z<<5&4294967295|Z>>>27),Z=Y+(P^X&(w^P))+K[14]+3275163606&4294967295,Y=w+(Z<<9&4294967295|Z>>>23),Z=X+(w^P&(Y^w))+K[3]+4107603335&4294967295,X=Y+(Z<<14&4294967295|Z>>>18),Z=P+(Y^w&(X^Y))+K[8]+1163531501&4294967295,P=X+(Z<<20&4294967295|Z>>>12),Z=w+(X^Y&(P^X))+K[13]+2850285829&4294967295,w=P+(Z<<5&4294967295|Z>>>27),Z=Y+(P^X&(w^P))+K[2]+4243563512&4294967295,Y=w+(Z<<9&4294967295|Z>>>23),Z=X+(w^P&(Y^w))+K[7]+1735328473&4294967295,X=Y+(Z<<14&4294967295|Z>>>18),Z=P+(Y^w&(X^Y))+K[12]+2368359562&4294967295,P=X+(Z<<20&4294967295|Z>>>12),Z=w+(P^X^Y)+K[5]+4294588738&4294967295,w=P+(Z<<4&4294967295|Z>>>28),Z=Y+(w^P^X)+K[8]+2272392833&4294967295,Y=w+(Z<<11&4294967295|Z>>>21),Z=X+(Y^w^P)+K[11]+1839030562&4294967295,X=Y+(Z<<16&4294967295|Z>>>16),Z=P+(X^Y^w)+K[14]+4259657740&4294967295,P=X+(Z<<23&4294967295|Z>>>9),Z=w+(P^X^Y)+K[1]+2763975236&4294967295,w=P+(Z<<4&4294967295|Z>>>28),Z=Y+(w^P^X)+K[4]+1272893353&4294967295,Y=w+(Z<<11&4294967295|Z>>>21),Z=X+(Y^w^P)+K[7]+4139469664&4294967295,X=Y+(Z<<16&4294967295|Z>>>16),Z=P+(X^Y^w)+K[10]+3200236656&4294967295,P=X+(Z<<23&4294967295|Z>>>9),Z=w+(P^X^Y)+K[13]+681279174&4294967295,w=P+(Z<<4&4294967295|Z>>>28),Z=Y+(w^P^X)+K[0]+3936430074&4294967295,Y=w+(Z<<11&4294967295|Z>>>21),Z=X+(Y^w^P)+K[3]+3572445317&4294967295,X=Y+(Z<<16&4294967295|Z>>>16),Z=P+(X^Y^w)+K[6]+76029189&4294967295,P=X+(Z<<23&4294967295|Z>>>9),Z=w+(P^X^Y)+K[9]+3654602809&4294967295,w=P+(Z<<4&4294967295|Z>>>28),Z=Y+(w^P^X)+K[12]+3873151461&4294967295,Y=w+(Z<<11&4294967295|Z>>>21),Z=X+(Y^w^P)+K[15]+530742520&4294967295,X=Y+(Z<<16&4294967295|Z>>>16),Z=P+(X^Y^w)+K[2]+3299628645&4294967295,P=X+(Z<<23&4294967295|Z>>>9),Z=w+(X^(P|~Y))+K[0]+4096336452&4294967295,w=P+(Z<<6&4294967295|Z>>>26),Z=Y+(P^(w|~X))+K[7]+1126891415&4294967295,Y=w+(Z<<10&4294967295|Z>>>22),Z=X+(w^(Y|~P))+K[14]+2878612391&4294967295,X=Y+(Z<<15&4294967295|Z>>>17),Z=P+(Y^(X|~w))+K[5]+4237533241&4294967295,P=X+(Z<<21&4294967295|Z>>>11),Z=w+(X^(P|~Y))+K[12]+1700485571&4294967295,w=P+(Z<<6&4294967295|Z>>>26),Z=Y+(P^(w|~X))+K[3]+2399980690&4294967295,Y=w+(Z<<10&4294967295|Z>>>22),Z=X+(w^(Y|~P))+K[10]+4293915773&4294967295,X=Y+(Z<<15&4294967295|Z>>>17),Z=P+(Y^(X|~w))+K[1]+2240044497&4294967295,P=X+(Z<<21&4294967295|Z>>>11),Z=w+(X^(P|~Y))+K[8]+1873313359&4294967295,w=P+(Z<<6&4294967295|Z>>>26),Z=Y+(P^(w|~X))+K[15]+4264355552&4294967295,Y=w+(Z<<10&4294967295|Z>>>22),Z=X+(w^(Y|~P))+K[6]+2734768916&4294967295,X=Y+(Z<<15&4294967295|Z>>>17),Z=P+(Y^(X|~w))+K[13]+1309151649&4294967295,P=X+(Z<<21&4294967295|Z>>>11),Z=w+(X^(P|~Y))+K[4]+4149444226&4294967295,w=P+(Z<<6&4294967295|Z>>>26),Z=Y+(P^(w|~X))+K[11]+3174756917&4294967295,Y=w+(Z<<10&4294967295|Z>>>22),Z=X+(w^(Y|~P))+K[2]+718787259&4294967295,X=Y+(Z<<15&4294967295|Z>>>17),Z=P+(Y^(X|~w))+K[9]+3951481745&4294967295,j.g[0]=j.g[0]+w&4294967295,j.g[1]=j.g[1]+(X+(Z<<21&4294967295|Z>>>11))&4294967295,j.g[2]=j.g[2]+X&4294967295,j.g[3]=j.g[3]+Y&4294967295}n.prototype.u=function(j,w){w===void 0&&(w=j.length);for(var P=w-this.blockSize,K=this.B,X=this.h,Y=0;Y<w;){if(X==0)for(;Y<=P;)i(this,j,Y),Y+=this.blockSize;if(typeof j=="string"){for(;Y<w;)if(K[X++]=j.charCodeAt(Y++),X==this.blockSize){i(this,K),X=0;break}}else for(;Y<w;)if(K[X++]=j[Y++],X==this.blockSize){i(this,K),X=0;break}}this.h=X,this.o+=w},n.prototype.v=function(){var j=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);j[0]=128;for(var w=1;w<j.length-8;++w)j[w]=0;var P=8*this.o;for(w=j.length-8;w<j.length;++w)j[w]=P&255,P/=256;for(this.u(j),j=Array(16),w=P=0;4>w;++w)for(var K=0;32>K;K+=8)j[P++]=this.g[w]>>>K&255;return j};function s(j,w){var P=o;return Object.prototype.hasOwnProperty.call(P,j)?P[j]:P[j]=w(j)}function a(j,w){this.h=w;for(var P=[],K=!0,X=j.length-1;0<=X;X--){var Y=j[X]|0;K&&Y==w||(P[X]=Y,K=!1)}this.g=P}var o={};function c(j){return-128<=j&&128>j?s(j,function(w){return new a([w|0],0>w?-1:0)}):new a([j|0],0>j?-1:0)}function h(j){if(isNaN(j)||!isFinite(j))return m;if(0>j)return C(h(-j));for(var w=[],P=1,K=0;j>=P;K++)w[K]=j/P|0,P*=4294967296;return new a(w,0)}function f(j,w){if(j.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(j.charAt(0)=="-")return C(f(j.substring(1),w));if(0<=j.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=h(Math.pow(w,8)),K=m,X=0;X<j.length;X+=8){var Y=Math.min(8,j.length-X),Z=parseInt(j.substring(X,X+Y),w);8>Y?(Y=h(Math.pow(w,Y)),K=K.j(Y).add(h(Z))):(K=K.j(P),K=K.add(h(Z)))}return K}var m=c(0),g=c(1),_=c(16777216);r=a.prototype,r.m=function(){if(A(this))return-C(this).m();for(var j=0,w=1,P=0;P<this.g.length;P++){var K=this.i(P);j+=(0<=K?K:4294967296+K)*w,w*=4294967296}return j},r.toString=function(j){if(j=j||10,2>j||36<j)throw Error("radix out of range: "+j);if(E(this))return"0";if(A(this))return"-"+C(this).toString(j);for(var w=h(Math.pow(j,6)),P=this,K="";;){var X=V(P,w).g;P=I(P,X.j(w));var Y=((0<P.g.length?P.g[0]:P.h)>>>0).toString(j);if(P=X,E(P))return Y+K;for(;6>Y.length;)Y="0"+Y;K=Y+K}},r.i=function(j){return 0>j?0:j<this.g.length?this.g[j]:this.h};function E(j){if(j.h!=0)return!1;for(var w=0;w<j.g.length;w++)if(j.g[w]!=0)return!1;return!0}function A(j){return j.h==-1}r.l=function(j){return j=I(this,j),A(j)?-1:E(j)?0:1};function C(j){for(var w=j.g.length,P=[],K=0;K<w;K++)P[K]=~j.g[K];return new a(P,~j.h).add(g)}r.abs=function(){return A(this)?C(this):this},r.add=function(j){for(var w=Math.max(this.g.length,j.g.length),P=[],K=0,X=0;X<=w;X++){var Y=K+(this.i(X)&65535)+(j.i(X)&65535),Z=(Y>>>16)+(this.i(X)>>>16)+(j.i(X)>>>16);K=Z>>>16,Y&=65535,Z&=65535,P[X]=Z<<16|Y}return new a(P,P[P.length-1]&-2147483648?-1:0)};function I(j,w){return j.add(C(w))}r.j=function(j){if(E(this)||E(j))return m;if(A(this))return A(j)?C(this).j(C(j)):C(C(this).j(j));if(A(j))return C(this.j(C(j)));if(0>this.l(_)&&0>j.l(_))return h(this.m()*j.m());for(var w=this.g.length+j.g.length,P=[],K=0;K<2*w;K++)P[K]=0;for(K=0;K<this.g.length;K++)for(var X=0;X<j.g.length;X++){var Y=this.i(K)>>>16,Z=this.i(K)&65535,ae=j.i(X)>>>16,le=j.i(X)&65535;P[2*K+2*X]+=Z*le,b(P,2*K+2*X),P[2*K+2*X+1]+=Y*le,b(P,2*K+2*X+1),P[2*K+2*X+1]+=Z*ae,b(P,2*K+2*X+1),P[2*K+2*X+2]+=Y*ae,b(P,2*K+2*X+2)}for(K=0;K<w;K++)P[K]=P[2*K+1]<<16|P[2*K];for(K=w;K<2*w;K++)P[K]=0;return new a(P,0)};function b(j,w){for(;(j[w]&65535)!=j[w];)j[w+1]+=j[w]>>>16,j[w]&=65535,w++}function R(j,w){this.g=j,this.h=w}function V(j,w){if(E(w))throw Error("division by zero");if(E(j))return new R(m,m);if(A(j))return w=V(C(j),w),new R(C(w.g),C(w.h));if(A(w))return w=V(j,C(w)),new R(C(w.g),w.h);if(30<j.g.length){if(A(j)||A(w))throw Error("slowDivide_ only works with positive integers.");for(var P=g,K=w;0>=K.l(j);)P=U(P),K=U(K);var X=W(P,1),Y=W(K,1);for(K=W(K,2),P=W(P,2);!E(K);){var Z=Y.add(K);0>=Z.l(j)&&(X=X.add(P),Y=Z),K=W(K,1),P=W(P,1)}return w=I(j,X.j(w)),new R(X,w)}for(X=m;0<=j.l(w);){for(P=Math.max(1,Math.floor(j.m()/w.m())),K=Math.ceil(Math.log(P)/Math.LN2),K=48>=K?1:Math.pow(2,K-48),Y=h(P),Z=Y.j(w);A(Z)||0<Z.l(j);)P-=K,Y=h(P),Z=Y.j(w);E(Y)&&(Y=g),X=X.add(Y),j=I(j,Z)}return new R(X,j)}r.A=function(j){return V(this,j).h},r.and=function(j){for(var w=Math.max(this.g.length,j.g.length),P=[],K=0;K<w;K++)P[K]=this.i(K)&j.i(K);return new a(P,this.h&j.h)},r.or=function(j){for(var w=Math.max(this.g.length,j.g.length),P=[],K=0;K<w;K++)P[K]=this.i(K)|j.i(K);return new a(P,this.h|j.h)},r.xor=function(j){for(var w=Math.max(this.g.length,j.g.length),P=[],K=0;K<w;K++)P[K]=this.i(K)^j.i(K);return new a(P,this.h^j.h)};function U(j){for(var w=j.g.length+1,P=[],K=0;K<w;K++)P[K]=j.i(K)<<1|j.i(K-1)>>>31;return new a(P,j.h)}function W(j,w){var P=w>>5;w%=32;for(var K=j.g.length-P,X=[],Y=0;Y<K;Y++)X[Y]=0<w?j.i(Y+P)>>>w|j.i(Y+P+1)<<32-w:j.i(Y+P);return new a(X,j.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Md5=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=h,a.fromString=f,Integer$1=a}).apply(typeof commonjsGlobal$1<"u"?commonjsGlobal$1:typeof self<"u"?self:typeof window<"u"?window:{});var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XhrIo,WebChannel,EventType,ErrorCode,Stat,Event,getStatEventTarget,createWebChannelTransport;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(v,H,J){return v==Array.prototype||v==Object.prototype||(v[H]=J.value),v};function t(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof commonjsGlobal=="object"&&commonjsGlobal];for(var H=0;H<v.length;++H){var J=v[H];if(J&&J.Math==Math)return J}throw Error("Cannot find global object")}var n=t(this);function i(v,H){if(H)e:{var J=n;v=v.split(".");for(var ne=0;ne<v.length-1;ne++){var me=v[ne];if(!(me in J))break e;J=J[me]}v=v[v.length-1],ne=J[v],H=H(ne),H!=ne&&H!=null&&e(J,v,{configurable:!0,writable:!0,value:H})}}function s(v,H){v instanceof String&&(v+="");var J=0,ne=!1,me={next:function(){if(!ne&&J<v.length){var Ce=J++;return{value:H(Ce,v[Ce]),done:!1}}return ne=!0,{done:!0,value:void 0}}};return me[Symbol.iterator]=function(){return me},me}i("Array.prototype.values",function(v){return v||function(){return s(this,function(H,J){return J})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function c(v){var H=typeof v;return H=H!="object"?H:v?Array.isArray(v)?"array":H:"null",H=="array"||H=="object"&&typeof v.length=="number"}function h(v){var H=typeof v;return H=="object"&&v!=null||H=="function"}function f(v,H,J){return v.call.apply(v.bind,arguments)}function m(v,H,J){if(!v)throw Error();if(2<arguments.length){var ne=Array.prototype.slice.call(arguments,2);return function(){var me=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(me,ne),v.apply(H,me)}}return function(){return v.apply(H,arguments)}}function g(v,H,J){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:m,g.apply(null,arguments)}function _(v,H){var J=Array.prototype.slice.call(arguments,1);return function(){var ne=J.slice();return ne.push.apply(ne,arguments),v.apply(this,ne)}}function E(v,H){function J(){}J.prototype=H.prototype,v.aa=H.prototype,v.prototype=new J,v.prototype.constructor=v,v.Qb=function(ne,me,Ce){for(var je=Array(arguments.length-2),Dt=2;Dt<arguments.length;Dt++)je[Dt-2]=arguments[Dt];return H.prototype[me].apply(ne,je)}}function A(v){const H=v.length;if(0<H){const J=Array(H);for(let ne=0;ne<H;ne++)J[ne]=v[ne];return J}return[]}function C(v,H){for(let J=1;J<arguments.length;J++){const ne=arguments[J];if(c(ne)){const me=v.length||0,Ce=ne.length||0;v.length=me+Ce;for(let je=0;je<Ce;je++)v[me+je]=ne[je]}else v.push(ne)}}class I{constructor(H,J){this.i=H,this.j=J,this.h=0,this.g=null}get(){let H;return 0<this.h?(this.h--,H=this.g,this.g=H.next,H.next=null):H=this.i(),H}}function b(v){return/^[\s\xa0]*$/.test(v)}function R(){var v=o.navigator;return v&&(v=v.userAgent)?v:""}function V(v){return V[" "](v),v}V[" "]=function(){};var U=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function W(v,H,J){for(const ne in v)H.call(J,v[ne],ne,v)}function j(v,H){for(const J in v)H.call(void 0,v[J],J,v)}function w(v){const H={};for(const J in v)H[J]=v[J];return H}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function K(v,H){let J,ne;for(let me=1;me<arguments.length;me++){ne=arguments[me];for(J in ne)v[J]=ne[J];for(let Ce=0;Ce<P.length;Ce++)J=P[Ce],Object.prototype.hasOwnProperty.call(ne,J)&&(v[J]=ne[J])}}function X(v){var H=1;v=v.split(":");const J=[];for(;0<H&&v.length;)J.push(v.shift()),H--;return v.length&&J.push(v.join(":")),J}function Y(v){o.setTimeout(()=>{throw v},0)}function Z(){var v=ue;let H=null;return v.g&&(H=v.g,v.g=v.g.next,v.g||(v.h=null),H.next=null),H}class ae{constructor(){this.h=this.g=null}add(H,J){const ne=le.get();ne.set(H,J),this.h?this.h.next=ne:this.g=ne,this.h=ne}}var le=new I(()=>new ie,v=>v.reset());class ie{constructor(){this.next=this.g=this.h=null}set(H,J){this.h=H,this.g=J,this.next=null}reset(){this.next=this.g=this.h=null}}let se,ce=!1,ue=new ae,Ae=()=>{const v=o.Promise.resolve(void 0);se=()=>{v.then(Se)}};var Se=()=>{for(var v;v=Z();){try{v.h.call(v.g)}catch(J){Y(J)}var H=le;H.j(v),100>H.h&&(H.h++,v.next=H.g,H.g=v)}ce=!1};function ye(){this.s=this.s,this.C=this.C}ye.prototype.s=!1,ye.prototype.ma=function(){this.s||(this.s=!0,this.N())},ye.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function he(v,H){this.type=v,this.g=this.target=H,this.defaultPrevented=!1}he.prototype.h=function(){this.defaultPrevented=!0};var ke=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var v=!1,H=Object.defineProperty({},"passive",{get:function(){v=!0}});try{const J=()=>{};o.addEventListener("test",J,H),o.removeEventListener("test",J,H)}catch{}return v}();function Pe(v,H){if(he.call(this,v?v.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,v){var J=this.type=v.type,ne=v.changedTouches&&v.changedTouches.length?v.changedTouches[0]:null;if(this.target=v.target||v.srcElement,this.g=H,H=v.relatedTarget){if(U){e:{try{V(H.nodeName);var me=!0;break e}catch{}me=!1}me||(H=null)}}else J=="mouseover"?H=v.fromElement:J=="mouseout"&&(H=v.toElement);this.relatedTarget=H,ne?(this.clientX=ne.clientX!==void 0?ne.clientX:ne.pageX,this.clientY=ne.clientY!==void 0?ne.clientY:ne.pageY,this.screenX=ne.screenX||0,this.screenY=ne.screenY||0):(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0),this.button=v.button,this.key=v.key||"",this.ctrlKey=v.ctrlKey,this.altKey=v.altKey,this.shiftKey=v.shiftKey,this.metaKey=v.metaKey,this.pointerId=v.pointerId||0,this.pointerType=typeof v.pointerType=="string"?v.pointerType:Le[v.pointerType]||"",this.state=v.state,this.i=v,v.defaultPrevented&&Pe.aa.h.call(this)}}E(Pe,he);var Le={2:"touch",3:"pen",4:"mouse"};Pe.prototype.h=function(){Pe.aa.h.call(this);var v=this.i;v.preventDefault?v.preventDefault():v.returnValue=!1};var $e="closure_listenable_"+(1e6*Math.random()|0),qe=0;function xe(v,H,J,ne,me){this.listener=v,this.proxy=null,this.src=H,this.type=J,this.capture=!!ne,this.ha=me,this.key=++qe,this.da=this.fa=!1}function Ie(v){v.da=!0,v.listener=null,v.proxy=null,v.src=null,v.ha=null}function Te(v){this.src=v,this.g={},this.h=0}Te.prototype.add=function(v,H,J,ne,me){var Ce=v.toString();v=this.g[Ce],v||(v=this.g[Ce]=[],this.h++);var je=Fe(v,H,ne,me);return-1<je?(H=v[je],J||(H.fa=!1)):(H=new xe(H,this.src,Ce,!!ne,me),H.fa=J,v.push(H)),H};function pe(v,H){var J=H.type;if(J in v.g){var ne=v.g[J],me=Array.prototype.indexOf.call(ne,H,void 0),Ce;(Ce=0<=me)&&Array.prototype.splice.call(ne,me,1),Ce&&(Ie(H),v.g[J].length==0&&(delete v.g[J],v.h--))}}function Fe(v,H,J,ne){for(var me=0;me<v.length;++me){var Ce=v[me];if(!Ce.da&&Ce.listener==H&&Ce.capture==!!J&&Ce.ha==ne)return me}return-1}var Re="closure_lm_"+(1e6*Math.random()|0),Ue={};function Ve(v,H,J,ne,me){if(Array.isArray(H)){for(var Ce=0;Ce<H.length;Ce++)Ve(v,H[Ce],J,ne,me);return null}return J=dr(J),v&&v[$e]?v.K(H,J,h(ne)?!!ne.capture:!1,me):Me(v,H,J,!1,ne,me)}function Me(v,H,J,ne,me,Ce){if(!H)throw Error("Invalid event type");var je=h(me)?!!me.capture:!!me,Dt=nt(v);if(Dt||(v[Re]=Dt=new Te(v)),J=Dt.add(H,J,ne,je,Ce),J.proxy)return J;if(ne=ze(),J.proxy=ne,ne.src=v,ne.listener=J,v.addEventListener)ke||(me=je),me===void 0&&(me=!1),v.addEventListener(H.toString(),ne,me);else if(v.attachEvent)v.attachEvent(Be(H.toString()),ne);else if(v.addListener&&v.removeListener)v.addListener(ne);else throw Error("addEventListener and attachEvent are unavailable.");return J}function ze(){function v(J){return H.call(v.src,v.listener,J)}const H=et;return v}function He(v,H,J,ne,me){if(Array.isArray(H))for(var Ce=0;Ce<H.length;Ce++)He(v,H[Ce],J,ne,me);else ne=h(ne)?!!ne.capture:!!ne,J=dr(J),v&&v[$e]?(v=v.i,H=String(H).toString(),H in v.g&&(Ce=v.g[H],J=Fe(Ce,J,ne,me),-1<J&&(Ie(Ce[J]),Array.prototype.splice.call(Ce,J,1),Ce.length==0&&(delete v.g[H],v.h--)))):v&&(v=nt(v))&&(H=v.g[H.toString()],v=-1,H&&(v=Fe(H,J,ne,me)),(J=-1<v?H[v]:null)&&Ne(J))}function Ne(v){if(typeof v!="number"&&v&&!v.da){var H=v.src;if(H&&H[$e])pe(H.i,v);else{var J=v.type,ne=v.proxy;H.removeEventListener?H.removeEventListener(J,ne,v.capture):H.detachEvent?H.detachEvent(Be(J),ne):H.addListener&&H.removeListener&&H.removeListener(ne),(J=nt(H))?(pe(J,v),J.h==0&&(J.src=null,H[Re]=null)):Ie(v)}}}function Be(v){return v in Ue?Ue[v]:Ue[v]="on"+v}function et(v,H){if(v.da)v=!0;else{H=new Pe(H,this);var J=v.listener,ne=v.ha||v.src;v.fa&&Ne(v),v=J.call(ne,H)}return v}function nt(v){return v=v[Re],v instanceof Te?v:null}var ir="__closure_events_fn_"+(1e9*Math.random()>>>0);function dr(v){return typeof v=="function"?v:(v[ir]||(v[ir]=function(H){return v.handleEvent(H)}),v[ir])}function Xe(){ye.call(this),this.i=new Te(this),this.M=this,this.F=null}E(Xe,ye),Xe.prototype[$e]=!0,Xe.prototype.removeEventListener=function(v,H,J,ne){He(this,v,H,J,ne)};function Ke(v,H){var J,ne=v.F;if(ne)for(J=[];ne;ne=ne.F)J.push(ne);if(v=v.M,ne=H.type||H,typeof H=="string")H=new he(H,v);else if(H instanceof he)H.target=H.target||v;else{var me=H;H=new he(ne,v),K(H,me)}if(me=!0,J)for(var Ce=J.length-1;0<=Ce;Ce--){var je=H.g=J[Ce];me=cr(je,ne,!0,H)&&me}if(je=H.g=v,me=cr(je,ne,!0,H)&&me,me=cr(je,ne,!1,H)&&me,J)for(Ce=0;Ce<J.length;Ce++)je=H.g=J[Ce],me=cr(je,ne,!1,H)&&me}Xe.prototype.N=function(){if(Xe.aa.N.call(this),this.i){var v=this.i,H;for(H in v.g){for(var J=v.g[H],ne=0;ne<J.length;ne++)Ie(J[ne]);delete v.g[H],v.h--}}this.F=null},Xe.prototype.K=function(v,H,J,ne){return this.i.add(String(v),H,!1,J,ne)},Xe.prototype.L=function(v,H,J,ne){return this.i.add(String(v),H,!0,J,ne)};function cr(v,H,J,ne){if(H=v.i.g[String(H)],!H)return!0;H=H.concat();for(var me=!0,Ce=0;Ce<H.length;++Ce){var je=H[Ce];if(je&&!je.da&&je.capture==J){var Dt=je.listener,wr=je.ha||je.src;je.fa&&pe(v.i,je),me=Dt.call(wr,ne)!==!1&&me}}return me&&!ne.defaultPrevented}function We(v,H,J){if(typeof v=="function")J&&(v=g(v,J));else if(v&&typeof v.handleEvent=="function")v=g(v.handleEvent,v);else throw Error("Invalid listener argument");return 2147483647<Number(H)?-1:o.setTimeout(v,H||0)}function tt(v){v.g=We(()=>{v.g=null,v.i&&(v.i=!1,tt(v))},v.l);const H=v.h;v.h=null,v.m.apply(null,H)}class It extends ye{constructor(H,J){super(),this.m=H,this.l=J,this.h=null,this.i=!1,this.g=null}j(H){this.h=arguments,this.g?this.i=!0:tt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Gt(v){ye.call(this),this.h=v,this.g={}}E(Gt,ye);var or=[];function ur(v){W(v.g,function(H,J){this.g.hasOwnProperty(J)&&Ne(H)},v),v.g={}}Gt.prototype.N=function(){Gt.aa.N.call(this),ur(this)},Gt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Lt=o.JSON.stringify,Lr=o.JSON.parse,rt=class{stringify(v){return o.JSON.stringify(v,void 0)}parse(v){return o.JSON.parse(v,void 0)}};function pr(){}pr.prototype.h=null;function yr(v){return v.h||(v.h=v.i())}function jr(){}var Wr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ar(){he.call(this,"d")}E(Ar,he);function Xi(){he.call(this,"c")}E(Xi,he);var yn={},bs=null;function Zn(){return bs=bs||new Xe}yn.La="serverreachability";function sr(v){he.call(this,yn.La,v)}E(sr,he);function Tr(v){const H=Zn();Ke(H,new sr(H))}yn.STAT_EVENT="statevent";function Ki(v,H){he.call(this,yn.STAT_EVENT,v),this.stat=H}E(Ki,he);function hr(v){const H=Zn();Ke(H,new Ki(H,v))}yn.Ma="timingevent";function Rr(v,H){he.call(this,yn.Ma,v),this.size=H}E(Rr,he);function Cr(v,H){if(typeof v!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){v()},H)}function En(){this.g=!0}En.prototype.xa=function(){this.g=!1};function ga(v,H,J,ne,me,Ce){v.info(function(){if(v.g)if(Ce)for(var je="",Dt=Ce.split("&"),wr=0;wr<Dt.length;wr++){var kt=Dt[wr].split("=");if(1<kt.length){var kr=kt[0];kt=kt[1];var Pr=kr.split("_");je=2<=Pr.length&&Pr[1]=="type"?je+(kr+"="+kt+"&"):je+(kr+"=redacted&")}}else je=null;else je=Ce;return"XMLHTTP REQ ("+ne+") [attempt "+me+"]: "+H+`
`+J+`
`+je})}function jl(v,H,J,ne,me,Ce,je){v.info(function(){return"XMLHTTP RESP ("+ne+") [ attempt "+me+"]: "+H+`
`+J+`
`+Ce+" "+je})}function Ti(v,H,J,ne){v.info(function(){return"XMLHTTP TEXT ("+H+"): "+Qi(v,J)+(ne?" "+ne:"")})}function _o(v,H){v.info(function(){return"TIMEOUT: "+H})}En.prototype.info=function(){};function Qi(v,H){if(!v.g)return H;if(!H)return null;try{var J=JSON.parse(H);if(J){for(v=0;v<J.length;v++)if(Array.isArray(J[v])){var ne=J[v];if(!(2>ne.length)){var me=ne[1];if(Array.isArray(me)&&!(1>me.length)){var Ce=me[0];if(Ce!="noop"&&Ce!="stop"&&Ce!="close")for(var je=1;je<me.length;je++)me[je]=""}}}}return Lt(J)}catch{return H}}var Ci={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Jn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Bn;function Ln(){}E(Ln,pr),Ln.prototype.g=function(){return new XMLHttpRequest},Ln.prototype.i=function(){return{}},Bn=new Ln;function Yr(v,H,J,ne){this.j=v,this.i=H,this.l=J,this.R=ne||1,this.U=new Gt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new _r}function _r(){this.i=null,this.g="",this.h=!1}var xa={},Rs={};function On(v,H,J){v.L=1,v.v=rs(un(H)),v.m=J,v.P=!0,ei(v,null)}function ei(v,H){v.F=Date.now(),Zi(v),v.A=un(v.v);var J=v.A,ne=v.R;Array.isArray(ne)||(ne=[String(ne)]),Ca(J.i,"t",ne),v.C=0,J=v.j.J,v.h=new _r,v.g=No(v.j,J?H:null,!v.m),0<v.O&&(v.M=new It(g(v.Y,v,v.g),v.O)),H=v.U,J=v.g,ne=v.ca;var me="readystatechange";Array.isArray(me)||(me&&(or[0]=me.toString()),me=or);for(var Ce=0;Ce<me.length;Ce++){var je=Ve(J,me[Ce],ne||H.handleEvent,!1,H.h||H);if(!je)break;H.g[je.key]=je}H=v.H?w(v.H):{},v.m?(v.u||(v.u="POST"),H["Content-Type"]="application/x-www-form-urlencoded",v.g.ea(v.A,v.u,v.m,H)):(v.u="GET",v.g.ea(v.A,v.u,null,H)),Tr(),ga(v.i,v.u,v.A,v.l,v.R,v.m)}Yr.prototype.ca=function(v){v=v.target;const H=this.M;H&&Cn(v)==3?H.j():this.Y(v)},Yr.prototype.Y=function(v){try{if(v==this.g)e:{const Pr=Cn(this.g);var H=this.g.Ba();const li=this.g.Z();if(!(3>Pr)&&(Pr!=3||this.g&&(this.h.h||this.g.oa()||bo(this.g)))){this.J||Pr!=4||H==7||(H==8||0>=li?Tr(3):Tr(2)),Si(this);var J=this.g.Z();this.X=J;t:if(Eo(this)){var ne=bo(this.g);v="";var me=ne.length,Ce=Cn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fr(this),jn(this);var je="";break t}this.h.i=new o.TextDecoder}for(H=0;H<me;H++)this.h.h=!0,v+=this.h.i.decode(ne[H],{stream:!(Ce&&H==me-1)});ne.length=0,this.h.g+=v,this.C=0,je=this.h.g}else je=this.g.oa();if(this.o=J==200,jl(this.i,this.u,this.A,this.l,this.R,Pr,J),this.o){if(this.T&&!this.K){t:{if(this.g){var Dt,wr=this.g;if((Dt=wr.g?wr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(Dt)){var kt=Dt;break t}}kt=null}if(J=kt)Ti(this.i,this.l,J,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ji(this,J);else{this.o=!1,this.s=3,hr(12),Fr(this),jn(this);break e}}if(this.P){J=!0;let Ur;for(;!this.J&&this.C<je.length;)if(Ur=vo(this,je),Ur==Rs){Pr==4&&(this.s=4,hr(14),J=!1),Ti(this.i,this.l,null,"[Incomplete Response]");break}else if(Ur==xa){this.s=4,hr(15),Ti(this.i,this.l,je,"[Invalid Chunk]"),J=!1;break}else Ti(this.i,this.l,Ur,null),Ji(this,Ur);if(Eo(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Pr!=4||je.length!=0||this.h.h||(this.s=1,hr(16),J=!1),this.o=this.o&&J,!J)Ti(this.i,this.l,je,"[Invalid Chunked Response]"),Fr(this),jn(this);else if(0<je.length&&!this.W){this.W=!0;var kr=this.j;kr.g==this&&kr.ba&&!kr.M&&(kr.j.info("Great, no buffering proxy detected. Bytes received: "+je.length),ds(kr),kr.M=!0,hr(11))}}else Ti(this.i,this.l,je,null),Ji(this,je);Pr==4&&Fr(this),this.o&&!this.J&&(Pr==4?Oo(this.j,this):(this.o=!1,Zi(this)))}else zl(this.g),J==400&&0<je.indexOf("Unknown SID")?(this.s=3,hr(12)):(this.s=0,hr(13)),Fr(this),jn(this)}}}catch{}finally{}};function Eo(v){return v.g?v.u=="GET"&&v.L!=2&&v.j.Ca:!1}function vo(v,H){var J=v.C,ne=H.indexOf(`
`,J);return ne==-1?Rs:(J=Number(H.substring(J,ne)),isNaN(J)?xa:(ne+=1,ne+J>H.length?Rs:(H=H.slice(ne,ne+J),v.C=ne+J,H)))}Yr.prototype.cancel=function(){this.J=!0,Fr(this)};function Zi(v){v.S=Date.now()+v.I,Ao(v,v.I)}function Ao(v,H){if(v.B!=null)throw Error("WatchDog timer not null");v.B=Cr(g(v.ba,v),H)}function Si(v){v.B&&(o.clearTimeout(v.B),v.B=null)}Yr.prototype.ba=function(){this.B=null;const v=Date.now();0<=v-this.S?(_o(this.i,this.A),this.L!=2&&(Tr(),hr(17)),Fr(this),this.s=2,jn(this)):Ao(this,this.S-v)};function jn(v){v.j.G==0||v.J||Oo(v.j,v)}function Fr(v){Si(v);var H=v.M;H&&typeof H.ma=="function"&&H.ma(),v.M=null,ur(v.U),v.g&&(H=v.g,v.g=null,H.abort(),H.ma())}function Ji(v,H){try{var J=v.j;if(J.G!=0&&(J.g==v||ya(J.h,v))){if(!v.K&&ya(J.h,v)&&J.G==3){try{var ne=J.Da.g.parse(H)}catch{ne=null}if(Array.isArray(ne)&&ne.length==3){var me=ne;if(me[0]==0){e:if(!J.u){if(J.g)if(J.g.F+3e3<v.F)Fs(J),Ls(J);else break e;wa(J),hr(18)}}else J.za=me[1],0<J.za-J.T&&37500>me[2]&&J.F&&J.v==0&&!J.C&&(J.C=Cr(g(J.Za,J),6e3));if(1>=Ps(J.h)&&J.ca){try{J.ca()}catch{}J.ca=void 0}}else oi(J,11)}else if((v.K||J.g==v)&&Fs(J),!b(H))for(me=J.Da.g.parse(H),H=0;H<me.length;H++){let kt=me[H];if(J.T=kt[0],kt=kt[1],J.G==2)if(kt[0]=="c"){J.K=kt[1],J.ia=kt[2];const kr=kt[3];kr!=null&&(J.la=kr,J.j.info("VER="+J.la));const Pr=kt[4];Pr!=null&&(J.Aa=Pr,J.j.info("SVER="+J.Aa));const li=kt[5];li!=null&&typeof li=="number"&&0<li&&(ne=1.5*li,J.L=ne,J.j.info("backChannelRequestTimeoutMs_="+ne)),ne=J;const Ur=v.g;if(Ur){const Wn=Ur.g?Ur.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Wn){var Ce=ne.h;Ce.g||Wn.indexOf("spdy")==-1&&Wn.indexOf("quic")==-1&&Wn.indexOf("h2")==-1||(Ce.j=Ce.l,Ce.g=new Set,Ce.h&&(Ds(Ce,Ce.h),Ce.h=null))}if(ne.D){const Da=Ur.g?Ur.g.getResponseHeader("X-HTTP-Session-Id"):null;Da&&(ne.ya=Da,er(ne.I,ne.D,Da))}}J.G=3,J.l&&J.l.ua(),J.ba&&(J.R=Date.now()-v.F,J.j.info("Handshake RTT: "+J.R+"ms")),ne=J;var je=v;if(ne.qa=ko(ne,ne.J?ne.ia:null,ne.W),je.K){qr(ne.h,je);var Dt=je,wr=ne.L;wr&&(Dt.I=wr),Dt.B&&(Si(Dt),Zi(Dt)),ne.g=je}else Po(ne);0<J.i.length&&js(J)}else kt[0]!="stop"&&kt[0]!="close"||oi(J,7);else J.G==3&&(kt[0]=="stop"||kt[0]=="close"?kt[0]=="stop"?oi(J,7):ba(J):kt[0]!="noop"&&J.l&&J.l.ta(kt),J.v=0)}}Tr(4)}catch{}}var To=class{constructor(v,H){this.g=v,this.map=H}};function ti(v){this.l=v||10,o.PerformanceNavigationTiming?(v=o.performance.getEntriesByType("navigation"),v=0<v.length&&(v[0].nextHopProtocol=="hq"||v[0].nextHopProtocol=="h2")):v=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=v?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ws(v){return v.h?!0:v.g?v.g.size>=v.j:!1}function Ps(v){return v.h?1:v.g?v.g.size:0}function ya(v,H){return v.h?v.h==H:v.g?v.g.has(H):!1}function Ds(v,H){v.g?v.g.add(H):v.h=H}function qr(v,H){v.h&&v.h==H?v.h=null:v.g&&v.g.has(H)&&v.g.delete(H)}ti.prototype.cancel=function(){if(this.i=Ea(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const v of this.g.values())v.cancel();this.g.clear()}};function Ea(v){if(v.h!=null)return v.i.concat(v.h.D);if(v.g!=null&&v.g.size!==0){let H=v.i;for(const J of v.g.values())H=H.concat(J.D);return H}return A(v.i)}function Fl(v){if(v.V&&typeof v.V=="function")return v.V();if(typeof Map<"u"&&v instanceof Map||typeof Set<"u"&&v instanceof Set)return Array.from(v.values());if(typeof v=="string")return v.split("");if(c(v)){for(var H=[],J=v.length,ne=0;ne<J;ne++)H.push(v[ne]);return H}H=[],J=0;for(ne in v)H[J++]=v[ne];return H}function Os(v){if(v.na&&typeof v.na=="function")return v.na();if(!v.V||typeof v.V!="function"){if(typeof Map<"u"&&v instanceof Map)return Array.from(v.keys());if(!(typeof Set<"u"&&v instanceof Set)){if(c(v)||typeof v=="string"){var H=[];v=v.length;for(var J=0;J<v;J++)H.push(J);return H}H=[],J=0;for(const ne in v)H[J++]=ne;return H}}}function va(v,H){if(v.forEach&&typeof v.forEach=="function")v.forEach(H,void 0);else if(c(v)||typeof v=="string")Array.prototype.forEach.call(v,H,void 0);else for(var J=Os(v),ne=Fl(v),me=ne.length,Ce=0;Ce<me;Ce++)H.call(void 0,ne[Ce],J&&J[Ce],v)}var es=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ul(v,H){if(v){v=v.split("&");for(var J=0;J<v.length;J++){var ne=v[J].indexOf("="),me=null;if(0<=ne){var Ce=v[J].substring(0,ne);me=v[J].substring(ne+1)}else Ce=v[J];H(Ce,me?decodeURIComponent(me.replace(/\+/g," ")):"")}}}function Sr(v){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,v instanceof Sr){this.h=v.h,ts(this,v.j),this.o=v.o,this.g=v.g,Ii(this,v.s),this.l=v.l;var H=v.i,J=new ni;J.i=H.i,H.g&&(J.g=new Map(H.g),J.h=H.h),ri(this,J),this.m=v.m}else v&&(H=String(v).match(es))?(this.h=!1,ts(this,H[1]||"",!0),this.o=vn(H[2]||""),this.g=vn(H[3]||"",!0),Ii(this,H[4]),this.l=vn(H[5]||"",!0),ri(this,H[6]||"",!0),this.m=vn(H[7]||"")):(this.h=!1,this.i=new ni(null,this.h))}Sr.prototype.toString=function(){var v=[],H=this.j;H&&v.push(ns(H,Aa,!0),":");var J=this.g;return(J||H=="file")&&(v.push("//"),(H=this.o)&&v.push(ns(H,Aa,!0),"@"),v.push(encodeURIComponent(String(J)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),J=this.s,J!=null&&v.push(":",String(J))),(J=this.l)&&(this.g&&J.charAt(0)!="/"&&v.push("/"),v.push(ns(J,J.charAt(0)=="/"?$l:Ta,!0))),(J=this.i.toString())&&v.push("?",J),(J=this.m)&&v.push("#",ns(J,Ms)),v.join("")};function un(v){return new Sr(v)}function ts(v,H,J){v.j=J?vn(H,!0):H,v.j&&(v.j=v.j.replace(/:$/,""))}function Ii(v,H){if(H){if(H=Number(H),isNaN(H)||0>H)throw Error("Bad port number "+H);v.s=H}else v.s=null}function ri(v,H,J){H instanceof ni?(v.i=H,So(v.i,v.h)):(J||(H=ns(H,Hl)),v.i=new ni(H,v.h))}function er(v,H,J){v.i.set(H,J)}function rs(v){return er(v,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),v}function vn(v,H){return v?H?decodeURI(v.replace(/%25/g,"%2525")):decodeURIComponent(v):""}function ns(v,H,J){return typeof v=="string"?(v=encodeURI(v).replace(H,Co),J&&(v=v.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v):null}function Co(v){return v=v.charCodeAt(0),"%"+(v>>4&15).toString(16)+(v&15).toString(16)}var Aa=/[#\/\?@]/g,Ta=/[#\?:]/g,$l=/[#\?]/g,Hl=/[#\?@]/g,Ms=/#/g;function ni(v,H){this.h=this.g=null,this.i=v||null,this.j=!!H}function An(v){v.g||(v.g=new Map,v.h=0,v.i&&Ul(v.i,function(H,J){v.add(decodeURIComponent(H.replace(/\+/g," ")),J)}))}r=ni.prototype,r.add=function(v,H){An(this),this.i=null,v=Fn(this,v);var J=this.g.get(v);return J||this.g.set(v,J=[]),J.push(H),this.h+=1,this};function ii(v,H){An(v),H=Fn(v,H),v.g.has(H)&&(v.i=null,v.h-=v.g.get(H).length,v.g.delete(H))}function si(v,H){return An(v),H=Fn(v,H),v.g.has(H)}r.forEach=function(v,H){An(this),this.g.forEach(function(J,ne){J.forEach(function(me){v.call(H,me,ne,this)},this)},this)},r.na=function(){An(this);const v=Array.from(this.g.values()),H=Array.from(this.g.keys()),J=[];for(let ne=0;ne<H.length;ne++){const me=v[ne];for(let Ce=0;Ce<me.length;Ce++)J.push(H[ne])}return J},r.V=function(v){An(this);let H=[];if(typeof v=="string")si(this,v)&&(H=H.concat(this.g.get(Fn(this,v))));else{v=Array.from(this.g.values());for(let J=0;J<v.length;J++)H=H.concat(v[J])}return H},r.set=function(v,H){return An(this),this.i=null,v=Fn(this,v),si(this,v)&&(this.h-=this.g.get(v).length),this.g.set(v,[H]),this.h+=1,this},r.get=function(v,H){return v?(v=this.V(v),0<v.length?String(v[0]):H):H};function Ca(v,H,J){ii(v,H),0<J.length&&(v.i=null,v.g.set(Fn(v,H),A(J)),v.h+=J.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const v=[],H=Array.from(this.g.keys());for(var J=0;J<H.length;J++){var ne=H[J];const Ce=encodeURIComponent(String(ne)),je=this.V(ne);for(ne=0;ne<je.length;ne++){var me=Ce;je[ne]!==""&&(me+="="+encodeURIComponent(String(je[ne]))),v.push(me)}}return this.i=v.join("&")};function Fn(v,H){return H=String(H),v.j&&(H=H.toLowerCase()),H}function So(v,H){H&&!v.j&&(An(v),v.i=null,v.g.forEach(function(J,ne){var me=ne.toLowerCase();ne!=me&&(ii(this,ne),Ca(this,me,J))},v)),v.j=H}function ss(v,H){const J=new En;if(o.Image){const ne=new Image;ne.onload=_(Tn,J,"TestLoadImage: loaded",!0,H,ne),ne.onerror=_(Tn,J,"TestLoadImage: error",!1,H,ne),ne.onabort=_(Tn,J,"TestLoadImage: abort",!1,H,ne),ne.ontimeout=_(Tn,J,"TestLoadImage: timeout",!1,H,ne),o.setTimeout(function(){ne.ontimeout&&ne.ontimeout()},1e4),ne.src=v}else H(!1)}function Mn(v,H){const J=new En,ne=new AbortController,me=setTimeout(()=>{ne.abort(),Tn(J,"TestPingServer: timeout",!1,H)},1e4);fetch(v,{signal:ne.signal}).then(Ce=>{clearTimeout(me),Ce.ok?Tn(J,"TestPingServer: ok",!0,H):Tn(J,"TestPingServer: server error",!1,H)}).catch(()=>{clearTimeout(me),Tn(J,"TestPingServer: error",!1,H)})}function Tn(v,H,J,ne,me){try{me&&(me.onload=null,me.onerror=null,me.onabort=null,me.ontimeout=null),ne(J)}catch{}}function as(){this.g=new rt}function Un(v,H,J){const ne=J||"";try{va(v,function(me,Ce){let je=me;h(me)&&(je=Lt(me)),H.push(ne+Ce+"="+encodeURIComponent(je))})}catch(me){throw H.push(ne+"type="+encodeURIComponent("_badmap")),me}}function bi(v){this.l=v.Ub||null,this.j=v.eb||!1}E(bi,pr),bi.prototype.g=function(){return new ai(this.l,this.j)},bi.prototype.i=function(v){return function(){return v}}({});function ai(v,H){Xe.call(this),this.D=v,this.o=H,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(ai,Xe),r=ai.prototype,r.open=function(v,H){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=v,this.A=H,this.readyState=1,Hn(this)},r.send=function(v){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const H={headers:this.u,method:this.B,credentials:this.m,cache:void 0};v&&(H.body=v),(this.D||o).fetch(new Request(this.A,H)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,$n(this)),this.readyState=0},r.Sa=function(v){if(this.g&&(this.l=v,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=v.headers,this.readyState=2,Hn(this)),this.g&&(this.readyState=3,Hn(this),this.g)))if(this.responseType==="arraybuffer")v.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in v){if(this.j=v.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Sa(this)}else v.text().then(this.Ra.bind(this),this.ga.bind(this))};function Sa(v){v.j.read().then(v.Pa.bind(v)).catch(v.ga.bind(v))}r.Pa=function(v){if(this.g){if(this.o&&v.value)this.response.push(v.value);else if(!this.o){var H=v.value?v.value:new Uint8Array(0);(H=this.v.decode(H,{stream:!v.done}))&&(this.response=this.responseText+=H)}v.done?$n(this):Hn(this),this.readyState==3&&Sa(this)}},r.Ra=function(v){this.g&&(this.response=this.responseText=v,$n(this))},r.Qa=function(v){this.g&&(this.response=v,$n(this))},r.ga=function(){this.g&&$n(this)};function $n(v){v.readyState=4,v.l=null,v.j=null,v.v=null,Hn(v)}r.setRequestHeader=function(v,H){this.u.append(v,H)},r.getResponseHeader=function(v){return this.h&&this.h.get(v.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const v=[],H=this.h.entries();for(var J=H.next();!J.done;)J=J.value,v.push(J[0]+": "+J[1]),J=H.next();return v.join(`\r
`)};function Hn(v){v.onreadystatechange&&v.onreadystatechange.call(v)}Object.defineProperty(ai.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(v){this.m=v?"include":"same-origin"}});function Ia(v){let H="";return W(v,function(J,ne){H+=ne,H+=":",H+=J,H+=`\r
`}),H}function Mr(v,H,J){e:{for(ne in J){var ne=!1;break e}ne=!0}ne||(J=Ia(J),typeof v=="string"?J!=null&&encodeURIComponent(String(J)):er(v,H,J))}function Wt(v){Xe.call(this),this.headers=new Map,this.o=v||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(Wt,Xe);var ks=/^https?$/i,os=["POST","PUT"];r=Wt.prototype,r.Ha=function(v){this.J=v},r.ea=function(v,H,J,ne){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+v);H=H?H.toUpperCase():"GET",this.D=v,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Bn.g(),this.v=this.o?yr(this.o):yr(Bn),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(H,String(v),!0),this.B=!1}catch(Ce){Io(this,Ce);return}if(v=J||"",J=new Map(this.headers),ne)if(Object.getPrototypeOf(ne)===Object.prototype)for(var me in ne)J.set(me,ne[me]);else if(typeof ne.keys=="function"&&typeof ne.get=="function")for(const Ce of ne.keys())J.set(Ce,ne.get(Ce));else throw Error("Unknown input type for opt_headers: "+String(ne));ne=Array.from(J.keys()).find(Ce=>Ce.toLowerCase()=="content-type"),me=o.FormData&&v instanceof o.FormData,!(0<=Array.prototype.indexOf.call(os,H,void 0))||ne||me||J.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ce,je]of J)this.g.setRequestHeader(Ce,je);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ls(this),this.u=!0,this.g.send(v),this.u=!1}catch(Ce){Io(this,Ce)}};function Io(v,H){v.h=!1,v.g&&(v.j=!0,v.g.abort(),v.j=!1),v.l=H,v.m=5,Ns(v),zn(v)}function Ns(v){v.A||(v.A=!0,Ke(v,"complete"),Ke(v,"error"))}r.abort=function(v){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=v||7,Ke(this,"complete"),Ke(this,"abort"),zn(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zn(this,!0)),Wt.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Vs(this):this.bb())},r.bb=function(){Vs(this)};function Vs(v){if(v.h&&typeof a<"u"&&(!v.v[1]||Cn(v)!=4||v.Z()!=2)){if(v.u&&Cn(v)==4)We(v.Ea,0,v);else if(Ke(v,"readystatechange"),Cn(v)==4){v.h=!1;try{const je=v.Z();e:switch(je){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var H=!0;break e;default:H=!1}var J;if(!(J=H)){var ne;if(ne=je===0){var me=String(v.D).match(es)[1]||null;!me&&o.self&&o.self.location&&(me=o.self.location.protocol.slice(0,-1)),ne=!ks.test(me?me.toLowerCase():"")}J=ne}if(J)Ke(v,"complete"),Ke(v,"success");else{v.m=6;try{var Ce=2<Cn(v)?v.g.statusText:""}catch{Ce=""}v.l=Ce+" ["+v.Z()+"]",Ns(v)}}finally{zn(v)}}}}function zn(v,H){if(v.g){ls(v);const J=v.g,ne=v.v[0]?()=>{}:null;v.g=null,v.v=null,H||Ke(v,"ready");try{J.onreadystatechange=ne}catch{}}}function ls(v){v.I&&(o.clearTimeout(v.I),v.I=null)}r.isActive=function(){return!!this.g};function Cn(v){return v.g?v.g.readyState:0}r.Z=function(){try{return 2<Cn(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(v){if(this.g){var H=this.g.responseText;return v&&H.indexOf(v)==0&&(H=H.substring(v.length)),Lr(H)}};function bo(v){try{if(!v.g)return null;if("response"in v.g)return v.g.response;switch(v.H){case"":case"text":return v.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in v.g)return v.g.mozResponseArrayBuffer}return null}catch{return null}}function zl(v){const H={};v=(v.g&&2<=Cn(v)&&v.g.getAllResponseHeaders()||"").split(`\r
`);for(let ne=0;ne<v.length;ne++){if(b(v[ne]))continue;var J=X(v[ne]);const me=J[0];if(J=J[1],typeof J!="string")continue;J=J.trim();const Ce=H[me]||[];H[me]=Ce,Ce.push(J)}j(H,function(ne){return ne.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function cs(v,H,J){return J&&J.internalChannelParams&&J.internalChannelParams[v]||H}function Bs(v){this.Aa=0,this.i=[],this.j=new En,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=cs("failFast",!1,v),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=cs("baseRetryDelayMs",5e3,v),this.cb=cs("retryDelaySeedMs",1e4,v),this.Wa=cs("forwardChannelMaxRetries",2,v),this.wa=cs("forwardChannelRequestTimeoutMs",2e4,v),this.pa=v&&v.xmlHttpFactory||void 0,this.Xa=v&&v.Tb||void 0,this.Ca=v&&v.useFetchStreams||!1,this.L=void 0,this.J=v&&v.supportsCrossDomainXhr||!1,this.K="",this.h=new ti(v&&v.concurrentRequestLimit),this.Da=new as,this.P=v&&v.fastHandshake||!1,this.O=v&&v.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=v&&v.Rb||!1,v&&v.xa&&this.j.xa(),v&&v.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&v&&v.detectBufferingProxy||!1,this.ja=void 0,v&&v.longPollingTimeout&&0<v.longPollingTimeout&&(this.ja=v.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Bs.prototype,r.la=8,r.G=1,r.connect=function(v,H,J,ne){hr(0),this.W=v,this.H=H||{},J&&ne!==void 0&&(this.H.OSID=J,this.H.OAID=ne),this.F=this.X,this.I=ko(this,null,this.W),js(this)};function ba(v){if(Ro(v),v.G==3){var H=v.U++,J=un(v.I);if(er(J,"SID",v.K),er(J,"RID",H),er(J,"TYPE","terminate"),us(v,J),H=new Yr(v,v.j,H),H.L=2,H.v=rs(un(J)),J=!1,o.navigator&&o.navigator.sendBeacon)try{J=o.navigator.sendBeacon(H.v.toString(),"")}catch{}!J&&o.Image&&(new Image().src=H.v,J=!0),J||(H.g=No(H.j,null),H.g.ea(H.v)),H.F=Date.now(),Zi(H)}Mo(v)}function Ls(v){v.g&&(ds(v),v.g.cancel(),v.g=null)}function Ro(v){Ls(v),v.u&&(o.clearTimeout(v.u),v.u=null),Fs(v),v.h.cancel(),v.s&&(typeof v.s=="number"&&o.clearTimeout(v.s),v.s=null)}function js(v){if(!ws(v.h)&&!v.s){v.s=!0;var H=v.Ga;se||Ae(),ce||(se(),ce=!0),ue.add(H,v),v.B=0}}function Gl(v,H){return Ps(v.h)>=v.h.j-(v.s?1:0)?!1:v.s?(v.i=H.D.concat(v.i),!0):v.G==1||v.G==2||v.B>=(v.Va?0:v.Wa)?!1:(v.s=Cr(g(v.Ga,v,H),Pa(v,v.B)),v.B++,!0)}r.Ga=function(v){if(this.s)if(this.s=null,this.G==1){if(!v){this.U=Math.floor(1e5*Math.random()),v=this.U++;const me=new Yr(this,this.j,v);let Ce=this.o;if(this.S&&(Ce?(Ce=w(Ce),K(Ce,this.S)):Ce=this.S),this.m!==null||this.O||(me.H=Ce,Ce=null),this.P)e:{for(var H=0,J=0;J<this.i.length;J++){t:{var ne=this.i[J];if("__data__"in ne.map&&(ne=ne.map.__data__,typeof ne=="string")){ne=ne.length;break t}ne=void 0}if(ne===void 0)break;if(H+=ne,4096<H){H=J;break e}if(H===4096||J===this.i.length-1){H=J+1;break e}}H=1e3}else H=1e3;H=wo(this,me,H),J=un(this.I),er(J,"RID",v),er(J,"CVER",22),this.D&&er(J,"X-HTTP-Session-Id",this.D),us(this,J),Ce&&(this.O?H="headers="+encodeURIComponent(String(Ia(Ce)))+"&"+H:this.m&&Mr(J,this.m,Ce)),Ds(this.h,me),this.Ua&&er(J,"TYPE","init"),this.P?(er(J,"$req",H),er(J,"SID","null"),me.T=!0,On(me,J,null)):On(me,J,H),this.G=2}}else this.G==3&&(v?Ra(this,v):this.i.length==0||ws(this.h)||Ra(this))};function Ra(v,H){var J;H?J=H.l:J=v.U++;const ne=un(v.I);er(ne,"SID",v.K),er(ne,"RID",J),er(ne,"AID",v.T),us(v,ne),v.m&&v.o&&Mr(ne,v.m,v.o),J=new Yr(v,v.j,J,v.B+1),v.m===null&&(J.H=v.o),H&&(v.i=H.D.concat(v.i)),H=wo(v,J,1e3),J.I=Math.round(.5*v.wa)+Math.round(.5*v.wa*Math.random()),Ds(v.h,J),On(J,ne,H)}function us(v,H){v.H&&W(v.H,function(J,ne){er(H,ne,J)}),v.l&&va({},function(J,ne){er(H,ne,J)})}function wo(v,H,J){J=Math.min(v.i.length,J);var ne=v.l?g(v.l.Na,v.l,v):null;e:{var me=v.i;let Ce=-1;for(;;){const je=["count="+J];Ce==-1?0<J?(Ce=me[0].g,je.push("ofs="+Ce)):Ce=0:je.push("ofs="+Ce);let Dt=!0;for(let wr=0;wr<J;wr++){let kt=me[wr].g;const kr=me[wr].map;if(kt-=Ce,0>kt)Ce=Math.max(0,me[wr].g-100),Dt=!1;else try{Un(kr,je,"req"+kt+"_")}catch{ne&&ne(kr)}}if(Dt){ne=je.join("&");break e}}}return v=v.i.splice(0,J),H.D=v,ne}function Po(v){if(!v.g&&!v.u){v.Y=1;var H=v.Fa;se||Ae(),ce||(se(),ce=!0),ue.add(H,v),v.v=0}}function wa(v){return v.g||v.u||3<=v.v?!1:(v.Y++,v.u=Cr(g(v.Fa,v),Pa(v,v.v)),v.v++,!0)}r.Fa=function(){if(this.u=null,Do(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var v=2*this.R;this.j.info("BP detection timer enabled: "+v),this.A=Cr(g(this.ab,this),v)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,hr(10),Ls(this),Do(this))};function ds(v){v.A!=null&&(o.clearTimeout(v.A),v.A=null)}function Do(v){v.g=new Yr(v,v.j,"rpc",v.Y),v.m===null&&(v.g.H=v.o),v.g.O=0;var H=un(v.qa);er(H,"RID","rpc"),er(H,"SID",v.K),er(H,"AID",v.T),er(H,"CI",v.F?"0":"1"),!v.F&&v.ja&&er(H,"TO",v.ja),er(H,"TYPE","xmlhttp"),us(v,H),v.m&&v.o&&Mr(H,v.m,v.o),v.L&&(v.g.I=v.L);var J=v.g;v=v.ia,J.L=1,J.v=rs(un(H)),J.m=null,J.P=!0,ei(J,v)}r.Za=function(){this.C!=null&&(this.C=null,Ls(this),wa(this),hr(19))};function Fs(v){v.C!=null&&(o.clearTimeout(v.C),v.C=null)}function Oo(v,H){var J=null;if(v.g==H){Fs(v),ds(v),v.g=null;var ne=2}else if(ya(v.h,H))J=H.D,qr(v.h,H),ne=1;else return;if(v.G!=0){if(H.o)if(ne==1){J=H.m?H.m.length:0,H=Date.now()-H.F;var me=v.B;ne=Zn(),Ke(ne,new Rr(ne,J)),js(v)}else Po(v);else if(me=H.s,me==3||me==0&&0<H.X||!(ne==1&&Gl(v,H)||ne==2&&wa(v)))switch(J&&0<J.length&&(H=v.h,H.i=H.i.concat(J)),me){case 1:oi(v,5);break;case 4:oi(v,10);break;case 3:oi(v,6);break;default:oi(v,2)}}}function Pa(v,H){let J=v.Ta+Math.floor(Math.random()*v.cb);return v.isActive()||(J*=2),J*H}function oi(v,H){if(v.j.info("Error code "+H),H==2){var J=g(v.fb,v),ne=v.Xa;const me=!ne;ne=new Sr(ne||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ts(ne,"https"),rs(ne),me?ss(ne.toString(),J):Mn(ne.toString(),J)}else hr(2);v.G=0,v.l&&v.l.sa(H),Mo(v),Ro(v)}r.fb=function(v){v?(this.j.info("Successfully pinged google.com"),hr(2)):(this.j.info("Failed to ping google.com"),hr(1))};function Mo(v){if(v.G=0,v.ka=[],v.l){const H=Ea(v.h);(H.length!=0||v.i.length!=0)&&(C(v.ka,H),C(v.ka,v.i),v.h.i.length=0,A(v.i),v.i.length=0),v.l.ra()}}function ko(v,H,J){var ne=J instanceof Sr?un(J):new Sr(J);if(ne.g!="")H&&(ne.g=H+"."+ne.g),Ii(ne,ne.s);else{var me=o.location;ne=me.protocol,H=H?H+"."+me.hostname:me.hostname,me=+me.port;var Ce=new Sr(null);ne&&ts(Ce,ne),H&&(Ce.g=H),me&&Ii(Ce,me),J&&(Ce.l=J),ne=Ce}return J=v.D,H=v.ya,J&&H&&er(ne,J,H),er(ne,"VER",v.la),us(v,ne),ne}function No(v,H,J){if(H&&!v.J)throw Error("Can't create secondary domain capable XhrIo object.");return H=v.Ca&&!v.pa?new Wt(new bi({eb:J})):new Wt(v.pa),H.Ha(v.J),H}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Vo(){}r=Vo.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Us(){}Us.prototype.g=function(v,H){return new Xr(v,H)};function Xr(v,H){Xe.call(this),this.g=new Bs(H),this.l=v,this.h=H&&H.messageUrlParams||null,v=H&&H.messageHeaders||null,H&&H.clientProtocolHeaderRequired&&(v?v["X-Client-Protocol"]="webchannel":v={"X-Client-Protocol":"webchannel"}),this.g.o=v,v=H&&H.initMessageHeaders||null,H&&H.messageContentType&&(v?v["X-WebChannel-Content-Type"]=H.messageContentType:v={"X-WebChannel-Content-Type":H.messageContentType}),H&&H.va&&(v?v["X-WebChannel-Client-Profile"]=H.va:v={"X-WebChannel-Client-Profile":H.va}),this.g.S=v,(v=H&&H.Sb)&&!b(v)&&(this.g.m=v),this.v=H&&H.supportsCrossDomainXhr||!1,this.u=H&&H.sendRawJson||!1,(H=H&&H.httpSessionIdParam)&&!b(H)&&(this.g.D=H,v=this.h,v!==null&&H in v&&(v=this.h,H in v&&delete v[H])),this.j=new Gn(this)}E(Xr,Xe),Xr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Xr.prototype.close=function(){ba(this.g)},Xr.prototype.o=function(v){var H=this.g;if(typeof v=="string"){var J={};J.__data__=v,v=J}else this.u&&(J={},J.__data__=Lt(v),v=J);H.i.push(new To(H.Ya++,v)),H.G==3&&js(H)},Xr.prototype.N=function(){this.g.l=null,delete this.j,ba(this.g),delete this.g,Xr.aa.N.call(this)};function Bo(v){Ar.call(this),v.__headers__&&(this.headers=v.__headers__,this.statusCode=v.__status__,delete v.__headers__,delete v.__status__);var H=v.__sm__;if(H){e:{for(const J in H){v=J;break e}v=void 0}(this.i=v)&&(v=this.i,H=H!==null&&v in H?H[v]:void 0),this.data=H}else this.data=v}E(Bo,Ar);function Lo(){Xi.call(this),this.status=1}E(Lo,Xi);function Gn(v){this.g=v}E(Gn,Vo),Gn.prototype.ua=function(){Ke(this.g,"a")},Gn.prototype.ta=function(v){Ke(this.g,new Bo(v))},Gn.prototype.sa=function(v){Ke(this.g,new Lo)},Gn.prototype.ra=function(){Ke(this.g,"b")},Us.prototype.createWebChannel=Us.prototype.g,Xr.prototype.send=Xr.prototype.o,Xr.prototype.open=Xr.prototype.m,Xr.prototype.close=Xr.prototype.close,createWebChannelTransport=function(){return new Us},getStatEventTarget=function(){return Zn()},Event=yn,Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ci.NO_ERROR=0,Ci.TIMEOUT=8,Ci.HTTP_ERROR=6,ErrorCode=Ci,Jn.COMPLETE="complete",EventType=Jn,jr.EventType=Wr,Wr.OPEN="a",Wr.CLOSE="b",Wr.ERROR="c",Wr.MESSAGE="d",Xe.prototype.listen=Xe.prototype.K,WebChannel=jr,Wt.prototype.listenOnce=Wt.prototype.L,Wt.prototype.getLastError=Wt.prototype.Ka,Wt.prototype.getLastErrorCode=Wt.prototype.Ba,Wt.prototype.getStatus=Wt.prototype.Z,Wt.prototype.getResponseJson=Wt.prototype.Oa,Wt.prototype.getResponseText=Wt.prototype.oa,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Ha,XhrIo=Wt}).apply(typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{});const F="@firebase/firestore",M="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class User{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User("google-credentials-uid"),User.FIRST_PARTY=new User("first-party-uid"),User.MOCK_USER=new User("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let x="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O=new Logger("@firebase/firestore");function __PRIVATE_getLogLevel(){return O.logLevel}function __PRIVATE_logDebug(r,...e){if(O.logLevel<=LogLevel.DEBUG){const t=e.map(__PRIVATE_argToString);O.debug(`Firestore (${x}): ${r}`,...t)}}function __PRIVATE_logError(r,...e){if(O.logLevel<=LogLevel.ERROR){const t=e.map(__PRIVATE_argToString);O.error(`Firestore (${x}): ${r}`,...t)}}function __PRIVATE_logWarn(r,...e){if(O.logLevel<=LogLevel.WARN){const t=e.map(__PRIVATE_argToString);O.warn(`Firestore (${x}): ${r}`,...t)}}function __PRIVATE_argToString(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fail(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,__PRIVATE__fail(r,n,t)}function __PRIVATE__fail(r,e,t){let n=`FIRESTORE (${x}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw __PRIVATE_logError(n),new Error(n)}function __PRIVATE_hardAssert(r,e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,r||__PRIVATE__fail(e,i,n)}function __PRIVATE_debugCast(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class FirestoreError extends FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Deferred{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_OAuthToken{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class __PRIVATE_EmptyAuthCredentialsProvider{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(User.UNAUTHENTICATED))}shutdown(){}}class __PRIVATE_EmulatorAuthCredentialsProvider{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class __PRIVATE_FirebaseAuthCredentialsProvider{constructor(e){this.t=e,this.currentUser=User.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){__PRIVATE_hardAssert(this.o===void 0,42304);let n=this.i;const i=c=>this.i!==n?(n=this.i,t(c)):Promise.resolve();let s=new __PRIVATE_Deferred;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new __PRIVATE_Deferred,e.enqueueRetryable(()=>i(this.currentUser))};const a=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},o=c=>{__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?o(c):(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new __PRIVATE_Deferred)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(__PRIVATE_logDebug("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(__PRIVATE_hardAssert(typeof n.accessToken=="string",31837,{l:n}),new __PRIVATE_OAuthToken(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return __PRIVATE_hardAssert(e===null||typeof e=="string",2055,{h:e}),new User(e)}}class __PRIVATE_FirstPartyToken{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=User.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class __PRIVATE_FirstPartyAuthCredentialsProvider{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new __PRIVATE_FirstPartyToken(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(User.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AppCheckToken{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class __PRIVATE_FirebaseAppCheckTokenProvider{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,_isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){__PRIVATE_hardAssert(this.o===void 0,3512);const n=s=>{s.error!=null&&__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const a=s.token!==this.m;return this.m=s.token,__PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):__PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new AppCheckToken(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(__PRIVATE_hardAssert(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new AppCheckToken(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_randomBytes(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newTextEncoder(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AutoId{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=__PRIVATE_randomBytes(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}}function __PRIVATE_primitiveComparator(r,e){return r<e?-1:r>e?1:0}function __PRIVATE_compareUtf8Strings(r,e){let t=0;for(;t<r.length&&t<e.length;){const n=r.codePointAt(t),i=e.codePointAt(t);if(n!==i){if(n<128&&i<128)return __PRIVATE_primitiveComparator(n,i);{const s=__PRIVATE_newTextEncoder(),a=__PRIVATE_compareByteArrays$1(s.encode(__PRIVATE_getUtf8SafeSubstring(r,t)),s.encode(__PRIVATE_getUtf8SafeSubstring(e,t)));return a!==0?a:__PRIVATE_primitiveComparator(n,i)}}t+=n>65535?2:1}return __PRIVATE_primitiveComparator(r.length,e.length)}function __PRIVATE_getUtf8SafeSubstring(r,e){return r.codePointAt(e)>65535?r.substring(e,e+2):r.substring(e,e+1)}function __PRIVATE_compareByteArrays$1(r,e){for(let t=0;t<r.length&&t<e.length;++t)if(r[t]!==e[t])return __PRIVATE_primitiveComparator(r[t],e[t]);return __PRIVATE_primitiveComparator(r.length,e.length)}function __PRIVATE_arrayEquals(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B$1="__name__";class BasePath{constructor(e,t,n){t===void 0?t=0:t>e.length&&fail(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&fail(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return BasePath.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof BasePath?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=BasePath.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return __PRIVATE_primitiveComparator(e.length,t.length)}static compareSegments(e,t){const n=BasePath.isNumericId(e),i=BasePath.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?BasePath.extractNumericId(e).compare(BasePath.extractNumericId(t)):__PRIVATE_compareUtf8Strings(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Integer$1.fromString(e.substring(4,e.length-2))}}class ResourcePath extends BasePath{construct(e,t,n){return new ResourcePath(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new ResourcePath(t)}static emptyPath(){return new ResourcePath([])}}const L=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class FieldPath$1 extends BasePath{construct(e,t,n){return new FieldPath$1(e,t,n)}static isValidIdentifier(e){return L.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),FieldPath$1.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===B$1}static keyField(){return new FieldPath$1([B$1])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let a=!1;for(;i<e.length;){const o=e[i];if(o==="\\"){if(i+1===e.length)throw new FirestoreError(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new FirestoreError(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new FirestoreError(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new FieldPath$1(t)}static emptyPath(){return new FieldPath$1([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentKey{constructor(e){this.path=e}static fromPath(e){return new DocumentKey(ResourcePath.fromString(e))}static fromName(e){return new DocumentKey(ResourcePath.fromString(e).popFirst(5))}static empty(){return new DocumentKey(ResourcePath.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ResourcePath.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ResourcePath.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new DocumentKey(new ResourcePath(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateNonEmptyArgument(r,e,t){if(!t)throw new FirestoreError(N.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function __PRIVATE_validateIsNotUsedTogether(r,e,t,n){if(e===!0&&n===!0)throw new FirestoreError(N.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function __PRIVATE_validateDocumentPath(r){if(!DocumentKey.isDocumentKey(r))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function __PRIVATE_validateCollectionPath(r){if(DocumentKey.isDocumentKey(r))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function __PRIVATE_isPlainObject(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}function __PRIVATE_valueDescription(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":fail(12329,{type:typeof r})}function __PRIVATE_cast(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new FirestoreError(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=__PRIVATE_valueDescription(r);throw new FirestoreError(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function __PRIVATE_validatePositiveNumber(r,e){if(e<=0)throw new FirestoreError(N.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function property(r,e){const t={typeString:r};return e&&(t.value=e),t}function __PRIVATE_validateJSON(r,e){if(!__PRIVATE_isPlainObject(r))throw new FirestoreError(N.INVALID_ARGUMENT,"JSON must be an object");let t;for(const n in e)if(e[n]){const i=e[n].typeString,s="value"in e[n]?{value:e[n].value}:void 0;if(!(n in r)){t=`JSON missing required field: '${n}'`;break}const a=r[n];if(i&&typeof a!==i){t=`JSON field '${n}' must be a ${i}.`;break}if(s!==void 0&&a!==s.value){t=`Expected '${n}' field to equal '${s.value}'`;break}}if(t)throw new FirestoreError(N.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k=-62135596800,q=1e6;class Timestamp{static now(){return Timestamp.fromMillis(Date.now())}static fromDate(e){return Timestamp.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*q);return new Timestamp(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<k)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new FirestoreError(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/q}_compareTo(e){return this.seconds===e.seconds?__PRIVATE_primitiveComparator(this.nanoseconds,e.nanoseconds):__PRIVATE_primitiveComparator(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Timestamp._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(__PRIVATE_validateJSON(e,Timestamp._jsonSchema))return new Timestamp(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-k;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Timestamp._jsonSchemaVersion="firestore/timestamp/1.0",Timestamp._jsonSchema={type:property("string",Timestamp._jsonSchemaVersion),seconds:property("number"),nanoseconds:property("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SnapshotVersion{static fromTimestamp(e){return new SnapshotVersion(e)}static min(){return new SnapshotVersion(new Timestamp(0,0))}static max(){return new SnapshotVersion(new Timestamp(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q=-1;function __PRIVATE_newIndexOffsetSuccessorFromReadTime(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=SnapshotVersion.fromTimestamp(n===1e9?new Timestamp(t+1,0):new Timestamp(t,n));return new IndexOffset(i,DocumentKey.empty(),e)}function __PRIVATE_newIndexOffsetFromDocument(r){return new IndexOffset(r.readTime,r.key,Q)}class IndexOffset{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new IndexOffset(SnapshotVersion.min(),DocumentKey.empty(),Q)}static max(){return new IndexOffset(SnapshotVersion.max(),DocumentKey.empty(),Q)}}function __PRIVATE_indexOffsetComparator(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=DocumentKey.comparator(r.documentKey,e.documentKey),t!==0?t:__PRIVATE_primitiveComparator(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class PersistenceTransaction{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function __PRIVATE_ignoreIfPrimaryLeaseLoss(r){if(r.code!==N.FAILED_PRECONDITION||r.message!==$)throw r;__PRIVATE_logDebug("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PersistencePromise{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&fail(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new PersistencePromise((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof PersistencePromise?t:PersistencePromise.resolve(t)}catch(t){return PersistencePromise.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):PersistencePromise.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):PersistencePromise.reject(t)}static resolve(e){return new PersistencePromise((t,n)=>{t(e)})}static reject(e){return new PersistencePromise((t,n)=>{n(e)})}static waitFor(e){return new PersistencePromise((t,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&t()},c=>n(c))}),a=!0,s===i&&t()})}static or(e){let t=PersistencePromise.resolve(!1);for(const n of e)t=t.next(i=>i?PersistencePromise.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new PersistencePromise((n,i)=>{const s=e.length,a=new Array(s);let o=0;for(let c=0;c<s;c++){const h=c;t(e[h]).next(f=>{a[h]=f,++o,o===s&&n(a)},f=>i(f))}})}static doWhile(e,t){return new PersistencePromise((n,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}}function __PRIVATE_getAndroidVersion(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function __PRIVATE_isIndexedDbTransactionError(r){return r.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ListenSequence{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this._e(n),this.ae=n=>t.writeSequenceNumber(n))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}__PRIVATE_ListenSequence.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G=-1;function __PRIVATE_isNullOrUndefined(r){return r==null}function __PRIVATE_isNegativeZero(r){return r===0&&1/r==-1/0}function isSafeInteger(r){return typeof r=="number"&&Number.isInteger(r)&&!__PRIVATE_isNegativeZero(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z="";function __PRIVATE_encodeResourcePath(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=__PRIVATE_encodeSeparator(e)),e=__PRIVATE_encodeSegment(r.get(t),e);return __PRIVATE_encodeSeparator(e)}function __PRIVATE_encodeSegment(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case z:t+="";break;default:t+=s}}return t}function __PRIVATE_encodeSeparator(r){return r+z+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_objectSize(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function forEach(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function isEmpty(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedMap{constructor(e,t){this.comparator=e,this.root=t||LLRBNode.EMPTY}insert(e,t){return new SortedMap(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}remove(e){return new SortedMap(this.comparator,this.root.remove(e,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new SortedMapIterator(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!1)}getReverseIterator(){return new SortedMapIterator(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!0)}}class SortedMapIterator{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class LLRBNode{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??LLRBNode.RED,this.left=i??LLRBNode.EMPTY,this.right=s??LLRBNode.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new LLRBNode(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return LLRBNode.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return LLRBNode.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw fail(43730,{key:this.key,value:this.value});if(this.right.isRed())throw fail(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw fail(27949);return e+(this.isRed()?0:1)}}LLRBNode.EMPTY=null,LLRBNode.RED=!0,LLRBNode.BLACK=!1;LLRBNode.EMPTY=new class{constructor(){this.size=0}get key(){throw fail(57766)}get value(){throw fail(16141)}get color(){throw fail(16727)}get left(){throw fail(29726)}get right(){throw fail(36894)}copy(e,t,n,i,s){return this}insert(e,t,n){return new LLRBNode(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SortedSet{constructor(e){this.comparator=e,this.data=new SortedMap(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new SortedSetIterator(this.data.getIterator())}getIteratorFrom(e){return new SortedSetIterator(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof SortedSet)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new SortedSet(this.comparator);return t.data=e,t}}class SortedSetIterator{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldMask{constructor(e){this.fields=e,e.sort(FieldPath$1.comparator)}static empty(){return new FieldMask([])}unionWith(e){let t=new SortedSet(FieldPath$1.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new FieldMask(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return __PRIVATE_arrayEquals(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_Base64DecodeError extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ByteString{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new __PRIVATE_Base64DecodeError("Invalid base64 string: "+s):s}}(e);return new ByteString(t)}static fromUint8Array(e){const t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new ByteString(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return __PRIVATE_primitiveComparator(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ByteString.EMPTY_BYTE_STRING=new ByteString("");const it=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function __PRIVATE_normalizeTimestamp(r){if(__PRIVATE_hardAssert(!!r,39018),typeof r=="string"){let e=0;const t=it.exec(r);if(__PRIVATE_hardAssert(!!t,46558,{timestamp:r}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:__PRIVATE_normalizeNumber(r.seconds),nanos:__PRIVATE_normalizeNumber(r.nanos)}}function __PRIVATE_normalizeNumber(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function __PRIVATE_normalizeByteString(r){return typeof r=="string"?ByteString.fromBase64String(r):ByteString.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const st="server_timestamp",ot="__type__",_t="__previous_value__",at="__local_write_time__";function __PRIVATE_isServerTimestamp(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[ot])===null||t===void 0?void 0:t.stringValue)===st}function __PRIVATE_getPreviousValue(r){const e=r.mapValue.fields[_t];return __PRIVATE_isServerTimestamp(e)?__PRIVATE_getPreviousValue(e):e}function __PRIVATE_getLocalWriteTime(r){const e=__PRIVATE_normalizeTimestamp(r.mapValue.fields[at].timestampValue);return new Timestamp(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DatabaseInfo{constructor(e,t,n,i,s,a,o,c,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=f}}const ut="(default)";class DatabaseId{constructor(e,t){this.projectId=e,this.database=t||ut}static empty(){return new DatabaseId("","")}get isDefaultDatabase(){return this.database===ut}isEqual(e){return e instanceof DatabaseId&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ct="__type__",lt="__max__",ht={mapValue:{}},Pt="__vector__",Tt="value";function __PRIVATE_typeOrder(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?__PRIVATE_isServerTimestamp(r)?4:__PRIVATE_isMaxValue(r)?9007199254740991:__PRIVATE_isVectorValue(r)?10:11:fail(28295,{value:r})}function __PRIVATE_valueEquals(r,e){if(r===e)return!0;const t=__PRIVATE_typeOrder(r);if(t!==__PRIVATE_typeOrder(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return __PRIVATE_getLocalWriteTime(r).isEqual(__PRIVATE_getLocalWriteTime(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const a=__PRIVATE_normalizeTimestamp(i.timestampValue),o=__PRIVATE_normalizeTimestamp(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return __PRIVATE_normalizeByteString(i.bytesValue).isEqual(__PRIVATE_normalizeByteString(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return __PRIVATE_normalizeNumber(i.geoPointValue.latitude)===__PRIVATE_normalizeNumber(s.geoPointValue.latitude)&&__PRIVATE_normalizeNumber(i.geoPointValue.longitude)===__PRIVATE_normalizeNumber(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return __PRIVATE_normalizeNumber(i.integerValue)===__PRIVATE_normalizeNumber(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const a=__PRIVATE_normalizeNumber(i.doubleValue),o=__PRIVATE_normalizeNumber(s.doubleValue);return a===o?__PRIVATE_isNegativeZero(a)===__PRIVATE_isNegativeZero(o):isNaN(a)&&isNaN(o)}return!1}(r,e);case 9:return __PRIVATE_arrayEquals(r.arrayValue.values||[],e.arrayValue.values||[],__PRIVATE_valueEquals);case 10:case 11:return function(i,s){const a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(__PRIVATE_objectSize(a)!==__PRIVATE_objectSize(o))return!1;for(const c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!__PRIVATE_valueEquals(a[c],o[c])))return!1;return!0}(r,e);default:return fail(52216,{left:r})}}function __PRIVATE_arrayValueContains(r,e){return(r.values||[]).find(t=>__PRIVATE_valueEquals(t,e))!==void 0}function __PRIVATE_valueCompare(r,e){if(r===e)return 0;const t=__PRIVATE_typeOrder(r),n=__PRIVATE_typeOrder(e);if(t!==n)return __PRIVATE_primitiveComparator(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return __PRIVATE_primitiveComparator(r.booleanValue,e.booleanValue);case 2:return function(s,a){const o=__PRIVATE_normalizeNumber(s.integerValue||s.doubleValue),c=__PRIVATE_normalizeNumber(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(r,e);case 3:return __PRIVATE_compareTimestamps(r.timestampValue,e.timestampValue);case 4:return __PRIVATE_compareTimestamps(__PRIVATE_getLocalWriteTime(r),__PRIVATE_getLocalWriteTime(e));case 5:return __PRIVATE_compareUtf8Strings(r.stringValue,e.stringValue);case 6:return function(s,a){const o=__PRIVATE_normalizeByteString(s),c=__PRIVATE_normalizeByteString(a);return o.compareTo(c)}(r.bytesValue,e.bytesValue);case 7:return function(s,a){const o=s.split("/"),c=a.split("/");for(let h=0;h<o.length&&h<c.length;h++){const f=__PRIVATE_primitiveComparator(o[h],c[h]);if(f!==0)return f}return __PRIVATE_primitiveComparator(o.length,c.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,a){const o=__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(s.latitude),__PRIVATE_normalizeNumber(a.latitude));return o!==0?o:__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(s.longitude),__PRIVATE_normalizeNumber(a.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return __PRIVATE_compareArrays(r.arrayValue,e.arrayValue);case 10:return function(s,a){var o,c,h,f;const m=s.fields||{},g=a.fields||{},_=(o=m[Tt])===null||o===void 0?void 0:o.arrayValue,E=(c=g[Tt])===null||c===void 0?void 0:c.arrayValue,A=__PRIVATE_primitiveComparator(((h=_==null?void 0:_.values)===null||h===void 0?void 0:h.length)||0,((f=E==null?void 0:E.values)===null||f===void 0?void 0:f.length)||0);return A!==0?A:__PRIVATE_compareArrays(_,E)}(r.mapValue,e.mapValue);case 11:return function(s,a){if(s===ht.mapValue&&a===ht.mapValue)return 0;if(s===ht.mapValue)return 1;if(a===ht.mapValue)return-1;const o=s.fields||{},c=Object.keys(o),h=a.fields||{},f=Object.keys(h);c.sort(),f.sort();for(let m=0;m<c.length&&m<f.length;++m){const g=__PRIVATE_compareUtf8Strings(c[m],f[m]);if(g!==0)return g;const _=__PRIVATE_valueCompare(o[c[m]],h[f[m]]);if(_!==0)return _}return __PRIVATE_primitiveComparator(c.length,f.length)}(r.mapValue,e.mapValue);default:throw fail(23264,{le:t})}}function __PRIVATE_compareTimestamps(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return __PRIVATE_primitiveComparator(r,e);const t=__PRIVATE_normalizeTimestamp(r),n=__PRIVATE_normalizeTimestamp(e),i=__PRIVATE_primitiveComparator(t.seconds,n.seconds);return i!==0?i:__PRIVATE_primitiveComparator(t.nanos,n.nanos)}function __PRIVATE_compareArrays(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=__PRIVATE_valueCompare(t[i],n[i]);if(s)return s}return __PRIVATE_primitiveComparator(t.length,n.length)}function canonicalId(r){return __PRIVATE_canonifyValue(r)}function __PRIVATE_canonifyValue(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=__PRIVATE_normalizeTimestamp(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return __PRIVATE_normalizeByteString(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return DocumentKey.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=__PRIVATE_canonifyValue(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const a of n)s?s=!1:i+=",",i+=`${a}:${__PRIVATE_canonifyValue(t.fields[a])}`;return i+"}"}(r.mapValue):fail(61005,{value:r})}function __PRIVATE_estimateByteSize(r){switch(__PRIVATE_typeOrder(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=__PRIVATE_getPreviousValue(r);return e?16+__PRIVATE_estimateByteSize(e):16;case 5:return 2*r.stringValue.length;case 6:return __PRIVATE_normalizeByteString(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+__PRIVATE_estimateByteSize(s),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return forEach(n.fields,(s,a)=>{i+=s.length+__PRIVATE_estimateByteSize(a)}),i}(r.mapValue);default:throw fail(13486,{value:r})}}function __PRIVATE_refValue(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function isInteger(r){return!!r&&"integerValue"in r}function isArray(r){return!!r&&"arrayValue"in r}function __PRIVATE_isNullValue(r){return!!r&&"nullValue"in r}function __PRIVATE_isNanValue(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function __PRIVATE_isMapValue(r){return!!r&&"mapValue"in r}function __PRIVATE_isVectorValue(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[ct])===null||t===void 0?void 0:t.stringValue)===Pt}function __PRIVATE_deepClone(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return forEach(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=__PRIVATE_deepClone(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=__PRIVATE_deepClone(r.arrayValue.values[t]);return e}return Object.assign({},r)}function __PRIVATE_isMaxValue(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===lt}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ObjectValue{constructor(e){this.value=e}static empty(){return new ObjectValue({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!__PRIVATE_isMapValue(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=__PRIVATE_deepClone(t)}setAll(e){let t=FieldPath$1.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!t.isImmediateParentOf(o)){const c=this.getFieldsMap(t);this.applyChanges(c,n,i),n={},i=[],t=o.popLast()}a?n[o.lastSegment()]=__PRIVATE_deepClone(a):i.push(o.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());__PRIVATE_isMapValue(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return __PRIVATE_valueEquals(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];__PRIVATE_isMapValue(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){forEach(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new ObjectValue(__PRIVATE_deepClone(this.value))}}function __PRIVATE_extractFieldMask(r){const e=[];return forEach(r.fields,(t,n)=>{const i=new FieldPath$1([t]);if(__PRIVATE_isMapValue(n)){const s=__PRIVATE_extractFieldMask(n.mapValue).fields;if(s.length===0)e.push(i);else for(const a of s)e.push(i.child(a))}else e.push(i)}),new FieldMask(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutableDocument{constructor(e,t,n,i,s,a,o){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new MutableDocument(e,0,SnapshotVersion.min(),SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newFoundDocument(e,t,n,i){return new MutableDocument(e,1,t,SnapshotVersion.min(),n,i,0)}static newNoDocument(e,t){return new MutableDocument(e,2,t,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),0)}static newUnknownDocument(e,t){return new MutableDocument(e,3,t,SnapshotVersion.min(),SnapshotVersion.min(),ObjectValue.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(SnapshotVersion.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ObjectValue.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ObjectValue.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=SnapshotVersion.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof MutableDocument&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new MutableDocument(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bound{constructor(e,t){this.position=e,this.inclusive=t}}function __PRIVATE_boundCompareToDocument(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],a=r.position[i];if(s.field.isKeyField()?n=DocumentKey.comparator(DocumentKey.fromName(a.referenceValue),t.key):n=__PRIVATE_valueCompare(a,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function __PRIVATE_boundEquals(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!__PRIVATE_valueEquals(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OrderBy{constructor(e,t="asc"){this.field=e,this.dir=t}}function __PRIVATE_orderByEquals(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Filter{}class FieldFilter extends Filter{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new __PRIVATE_KeyFieldFilter(e,t,n):t==="array-contains"?new __PRIVATE_ArrayContainsFilter(e,n):t==="in"?new __PRIVATE_InFilter(e,n):t==="not-in"?new __PRIVATE_NotInFilter(e,n):t==="array-contains-any"?new __PRIVATE_ArrayContainsAnyFilter(e,n):new FieldFilter(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new __PRIVATE_KeyFieldInFilter(e,n):new __PRIVATE_KeyFieldNotInFilter(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(__PRIVATE_valueCompare(t,this.value)):t!==null&&__PRIVATE_typeOrder(this.value)===__PRIVATE_typeOrder(t)&&this.matchesComparison(__PRIVATE_valueCompare(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fail(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class CompositeFilter extends Filter{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new CompositeFilter(e,t)}matches(e){return __PRIVATE_compositeFilterIsConjunction(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function __PRIVATE_compositeFilterIsConjunction(r){return r.op==="and"}function __PRIVATE_compositeFilterIsFlatConjunction(r){return __PRIVATE_compositeFilterIsFlat(r)&&__PRIVATE_compositeFilterIsConjunction(r)}function __PRIVATE_compositeFilterIsFlat(r){for(const e of r.filters)if(e instanceof CompositeFilter)return!1;return!0}function __PRIVATE_canonifyFilter(r){if(r instanceof FieldFilter)return r.field.canonicalString()+r.op.toString()+canonicalId(r.value);if(__PRIVATE_compositeFilterIsFlatConjunction(r))return r.filters.map(e=>__PRIVATE_canonifyFilter(e)).join(",");{const e=r.filters.map(t=>__PRIVATE_canonifyFilter(t)).join(",");return`${r.op}(${e})`}}function __PRIVATE_filterEquals(r,e){return r instanceof FieldFilter?function(n,i){return i instanceof FieldFilter&&n.op===i.op&&n.field.isEqual(i.field)&&__PRIVATE_valueEquals(n.value,i.value)}(r,e):r instanceof CompositeFilter?function(n,i){return i instanceof CompositeFilter&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&__PRIVATE_filterEquals(a,i.filters[o]),!0):!1}(r,e):void fail(19439)}function __PRIVATE_stringifyFilter(r){return r instanceof FieldFilter?function(t){return`${t.field.canonicalString()} ${t.op} ${canonicalId(t.value)}`}(r):r instanceof CompositeFilter?function(t){return t.op.toString()+" {"+t.getFilters().map(__PRIVATE_stringifyFilter).join(" ,")+"}"}(r):"Filter"}class __PRIVATE_KeyFieldFilter extends FieldFilter{constructor(e,t,n){super(e,t,n),this.key=DocumentKey.fromName(n.referenceValue)}matches(e){const t=DocumentKey.comparator(e.key,this.key);return this.matchesComparison(t)}}class __PRIVATE_KeyFieldInFilter extends FieldFilter{constructor(e,t){super(e,"in",t),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class __PRIVATE_KeyFieldNotInFilter extends FieldFilter{constructor(e,t){super(e,"not-in",t),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function __PRIVATE_extractDocumentKeysFromArrayValue(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>DocumentKey.fromName(n.referenceValue))}class __PRIVATE_ArrayContainsFilter extends FieldFilter{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return isArray(t)&&__PRIVATE_arrayValueContains(t.arrayValue,this.value)}}class __PRIVATE_InFilter extends FieldFilter{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&__PRIVATE_arrayValueContains(this.value.arrayValue,t)}}class __PRIVATE_NotInFilter extends FieldFilter{constructor(e,t){super(e,"not-in",t)}matches(e){if(__PRIVATE_arrayValueContains(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!__PRIVATE_arrayValueContains(this.value.arrayValue,t)}}class __PRIVATE_ArrayContainsAnyFilter extends FieldFilter{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!isArray(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>__PRIVATE_arrayValueContains(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetImpl{constructor(e,t=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.Pe=null}}function __PRIVATE_newTarget(r,e=null,t=[],n=[],i=null,s=null,a=null){return new __PRIVATE_TargetImpl(r,e,t,n,i,s,a)}function __PRIVATE_canonifyTarget(r){const e=__PRIVATE_debugCast(r);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>__PRIVATE_canonifyFilter(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),__PRIVATE_isNullOrUndefined(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>canonicalId(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>canonicalId(n)).join(",")),e.Pe=t}return e.Pe}function __PRIVATE_targetEquals(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!__PRIVATE_orderByEquals(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!__PRIVATE_filterEquals(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!__PRIVATE_boundEquals(r.startAt,e.startAt)&&__PRIVATE_boundEquals(r.endAt,e.endAt)}function __PRIVATE_targetIsDocumentTarget(r){return DocumentKey.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryImpl{constructor(e,t=null,n=[],i=[],s=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function __PRIVATE_newQuery(r,e,t,n,i,s,a,o){return new __PRIVATE_QueryImpl(r,e,t,n,i,s,a,o)}function __PRIVATE_newQueryForPath(r){return new __PRIVATE_QueryImpl(r)}function __PRIVATE_queryMatchesAllDocuments(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function __PRIVATE_isCollectionGroupQuery(r){return r.collectionGroup!==null}function __PRIVATE_queryNormalizedOrderBy(r){const e=__PRIVATE_debugCast(r);if(e.Te===null){e.Te=[];const t=new Set;for(const s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new SortedSet(FieldPath$1.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(h=>{h.isInequality()&&(o=o.add(h.field))})}),o})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new OrderBy(s,n))}),t.has(FieldPath$1.keyField().canonicalString())||e.Te.push(new OrderBy(FieldPath$1.keyField(),n))}return e.Te}function __PRIVATE_queryToTarget(r){const e=__PRIVATE_debugCast(r);return e.Ie||(e.Ie=__PRIVATE__queryToTarget(e,__PRIVATE_queryNormalizedOrderBy(r))),e.Ie}function __PRIVATE__queryToTarget(r,e){if(r.limitType==="F")return __PRIVATE_newTarget(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new OrderBy(i.field,s)});const t=r.endAt?new Bound(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Bound(r.startAt.position,r.startAt.inclusive):null;return __PRIVATE_newTarget(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function __PRIVATE_queryWithAddedFilter(r,e){const t=r.filters.concat([e]);return new __PRIVATE_QueryImpl(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function __PRIVATE_queryWithLimit(r,e,t){return new __PRIVATE_QueryImpl(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function __PRIVATE_queryEquals(r,e){return __PRIVATE_targetEquals(__PRIVATE_queryToTarget(r),__PRIVATE_queryToTarget(e))&&r.limitType===e.limitType}function __PRIVATE_canonifyQuery(r){return`${__PRIVATE_canonifyTarget(__PRIVATE_queryToTarget(r))}|lt:${r.limitType}`}function __PRIVATE_stringifyQuery(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>__PRIVATE_stringifyFilter(i)).join(", ")}]`),__PRIVATE_isNullOrUndefined(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>canonicalId(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>canonicalId(i)).join(",")),`Target(${n})`}(__PRIVATE_queryToTarget(r))}; limitType=${r.limitType})`}function __PRIVATE_queryMatches(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):DocumentKey.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of __PRIVATE_queryNormalizedOrderBy(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(a,o,c){const h=__PRIVATE_boundCompareToDocument(a,o,c);return a.inclusive?h<=0:h<0}(n.startAt,__PRIVATE_queryNormalizedOrderBy(n),i)||n.endAt&&!function(a,o,c){const h=__PRIVATE_boundCompareToDocument(a,o,c);return a.inclusive?h>=0:h>0}(n.endAt,__PRIVATE_queryNormalizedOrderBy(n),i))}(r,e)}function __PRIVATE_queryCollectionGroup(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function __PRIVATE_newQueryComparator(r){return(e,t)=>{let n=!1;for(const i of __PRIVATE_queryNormalizedOrderBy(r)){const s=__PRIVATE_compareDocs(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function __PRIVATE_compareDocs(r,e,t){const n=r.field.isKeyField()?DocumentKey.comparator(e.key,t.key):function(s,a,o){const c=a.data.field(s),h=o.data.field(s);return c!==null&&h!==null?__PRIVATE_valueCompare(c,h):fail(42886)}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return fail(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ObjectMap{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){forEach(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return isEmpty(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Et=new SortedMap(DocumentKey.comparator);function __PRIVATE_mutableDocumentMap(){return Et}const At=new SortedMap(DocumentKey.comparator);function documentMap(...r){let e=At;for(const t of r)e=e.insert(t.key,t);return e}function __PRIVATE_convertOverlayedDocumentMapToDocumentMap(r){let e=At;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function __PRIVATE_newOverlayMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newMutationMap(){return __PRIVATE_newDocumentKeyMap()}function __PRIVATE_newDocumentKeyMap(){return new ObjectMap(r=>r.toString(),(r,e)=>r.isEqual(e))}const Rt=new SortedMap(DocumentKey.comparator),Vt=new SortedSet(DocumentKey.comparator);function __PRIVATE_documentKeySet(...r){let e=Vt;for(const t of r)e=e.add(t);return e}const mt=new SortedSet(__PRIVATE_primitiveComparator);function __PRIVATE_targetIdSet(){return mt}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_toDouble(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:__PRIVATE_isNegativeZero(e)?"-0":e}}function __PRIVATE_toInteger(r){return{integerValue:""+r}}function toNumber(r,e){return isSafeInteger(e)?__PRIVATE_toInteger(e):__PRIVATE_toDouble(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TransformOperation{constructor(){this._=void 0}}function __PRIVATE_applyTransformOperationToLocalView(r,e,t){return r instanceof __PRIVATE_ServerTimestampTransform?function(i,s){const a={fields:{[ot]:{stringValue:st},[at]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&__PRIVATE_isServerTimestamp(s)&&(s=__PRIVATE_getPreviousValue(s)),s&&(a.fields[_t]=s),{mapValue:a}}(t,e):r instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(r,e):r instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(r,e):function(i,s){const a=__PRIVATE_computeTransformOperationBaseValue(i,s),o=asNumber(a)+asNumber(i.Ee);return isInteger(a)&&isInteger(i.Ee)?__PRIVATE_toInteger(o):__PRIVATE_toDouble(i.serializer,o)}(r,e)}function __PRIVATE_applyTransformOperationToRemoteDocument(r,e,t){return r instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(r,e):r instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(r,e):t}function __PRIVATE_computeTransformOperationBaseValue(r,e){return r instanceof __PRIVATE_NumericIncrementTransformOperation?function(n){return isInteger(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class __PRIVATE_ServerTimestampTransform extends TransformOperation{}class __PRIVATE_ArrayUnionTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}}function __PRIVATE_applyArrayUnionTransformOperation(r,e){const t=__PRIVATE_coercedFieldValuesArray(e);for(const n of r.elements)t.some(i=>__PRIVATE_valueEquals(i,n))||t.push(n);return{arrayValue:{values:t}}}class __PRIVATE_ArrayRemoveTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}}function __PRIVATE_applyArrayRemoveTransformOperation(r,e){let t=__PRIVATE_coercedFieldValuesArray(e);for(const n of r.elements)t=t.filter(i=>!__PRIVATE_valueEquals(i,n));return{arrayValue:{values:t}}}class __PRIVATE_NumericIncrementTransformOperation extends TransformOperation{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function asNumber(r){return __PRIVATE_normalizeNumber(r.integerValue||r.doubleValue)}function __PRIVATE_coercedFieldValuesArray(r){return isArray(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldTransform{constructor(e,t){this.field=e,this.transform=t}}function __PRIVATE_fieldTransformEquals(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof __PRIVATE_ArrayUnionTransformOperation&&i instanceof __PRIVATE_ArrayUnionTransformOperation||n instanceof __PRIVATE_ArrayRemoveTransformOperation&&i instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_arrayEquals(n.elements,i.elements,__PRIVATE_valueEquals):n instanceof __PRIVATE_NumericIncrementTransformOperation&&i instanceof __PRIVATE_NumericIncrementTransformOperation?__PRIVATE_valueEquals(n.Ee,i.Ee):n instanceof __PRIVATE_ServerTimestampTransform&&i instanceof __PRIVATE_ServerTimestampTransform}(r.transform,e.transform)}class MutationResult{constructor(e,t){this.version=e,this.transformResults=t}}class Precondition{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Precondition}static exists(e){return new Precondition(void 0,e)}static updateTime(e){return new Precondition(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function __PRIVATE_preconditionIsValidForDocument(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class Mutation{}function __PRIVATE_calculateOverlayMutation(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new __PRIVATE_DeleteMutation(r.key,Precondition.none()):new __PRIVATE_SetMutation(r.key,r.data,Precondition.none());{const t=r.data,n=ObjectValue.empty();let i=new SortedSet(FieldPath$1.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new __PRIVATE_PatchMutation(r.key,n,new FieldMask(i.toArray()),Precondition.none())}}function __PRIVATE_mutationApplyToRemoteDocument(r,e,t){r instanceof __PRIVATE_SetMutation?function(i,s,a){const o=i.value.clone(),c=__PRIVATE_serverTransformResults(i.fieldTransforms,s,a.transformResults);o.setAll(c),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(r,e,t):r instanceof __PRIVATE_PatchMutation?function(i,s,a){if(!__PRIVATE_preconditionIsValidForDocument(i.precondition,s))return void s.convertToUnknownDocument(a.version);const o=__PRIVATE_serverTransformResults(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(__PRIVATE_getPatch(i)),c.setAll(o),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(r,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function __PRIVATE_mutationApplyToLocalView(r,e,t,n){return r instanceof __PRIVATE_SetMutation?function(s,a,o,c){if(!__PRIVATE_preconditionIsValidForDocument(s.precondition,a))return o;const h=s.value.clone(),f=__PRIVATE_localTransformResults(s.fieldTransforms,c,a);return h.setAll(f),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),null}(r,e,t,n):r instanceof __PRIVATE_PatchMutation?function(s,a,o,c){if(!__PRIVATE_preconditionIsValidForDocument(s.precondition,a))return o;const h=__PRIVATE_localTransformResults(s.fieldTransforms,c,a),f=a.data;return f.setAll(__PRIVATE_getPatch(s)),f.setAll(h),a.convertToFoundDocument(a.version,f).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(r,e,t,n):function(s,a,o){return __PRIVATE_preconditionIsValidForDocument(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(r,e,t)}function __PRIVATE_mutationExtractBaseValue(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=__PRIVATE_computeTransformOperationBaseValue(n.transform,i||null);s!=null&&(t===null&&(t=ObjectValue.empty()),t.set(n.field,s))}return t||null}function __PRIVATE_mutationEquals(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&__PRIVATE_arrayEquals(n,i,(s,a)=>__PRIVATE_fieldTransformEquals(s,a))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class __PRIVATE_SetMutation extends Mutation{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class __PRIVATE_PatchMutation extends Mutation{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function __PRIVATE_getPatch(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function __PRIVATE_serverTransformResults(r,e,t){const n=new Map;__PRIVATE_hardAssert(r.length===t.length,32656,{Ae:t.length,Re:r.length});for(let i=0;i<t.length;i++){const s=r[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,__PRIVATE_applyTransformOperationToRemoteDocument(a,o,t[i]))}return n}function __PRIVATE_localTransformResults(r,e,t){const n=new Map;for(const i of r){const s=i.transform,a=t.data.field(i.field);n.set(i.field,__PRIVATE_applyTransformOperationToLocalView(s,a,e))}return n}class __PRIVATE_DeleteMutation extends Mutation{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class __PRIVATE_VerifyMutation extends Mutation{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MutationBatch{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&__PRIVATE_mutationApplyToRemoteDocument(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=__PRIVATE_mutationApplyToLocalView(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=__PRIVATE_mutationApplyToLocalView(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=__PRIVATE_newMutationMap();return this.mutations.forEach(i=>{const s=e.get(i.key),a=s.overlayedDocument;let o=this.applyToLocalView(a,s.mutatedFields);o=t.has(i.key)?null:o;const c=__PRIVATE_calculateOverlayMutation(a,o);c!==null&&n.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(SnapshotVersion.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),__PRIVATE_documentKeySet())}isEqual(e){return this.batchId===e.batchId&&__PRIVATE_arrayEquals(this.mutations,e.mutations,(t,n)=>__PRIVATE_mutationEquals(t,n))&&__PRIVATE_arrayEquals(this.baseMutations,e.baseMutations,(t,n)=>__PRIVATE_mutationEquals(t,n))}}class MutationBatchResult{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){__PRIVATE_hardAssert(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let i=function(){return Rt}();const s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new MutationBatchResult(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Overlay{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ExistenceFilter{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ft,gt;function __PRIVATE_isPermanentError(r){switch(r){case N.OK:return fail(64938);case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return fail(15467,{code:r})}}function __PRIVATE_mapCodeFromRpcCode(r){if(r===void 0)return __PRIVATE_logError("GRPC error has no .code"),N.UNKNOWN;switch(r){case ft.OK:return N.OK;case ft.CANCELLED:return N.CANCELLED;case ft.UNKNOWN:return N.UNKNOWN;case ft.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case ft.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case ft.INTERNAL:return N.INTERNAL;case ft.UNAVAILABLE:return N.UNAVAILABLE;case ft.UNAUTHENTICATED:return N.UNAUTHENTICATED;case ft.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case ft.NOT_FOUND:return N.NOT_FOUND;case ft.ALREADY_EXISTS:return N.ALREADY_EXISTS;case ft.PERMISSION_DENIED:return N.PERMISSION_DENIED;case ft.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case ft.ABORTED:return N.ABORTED;case ft.OUT_OF_RANGE:return N.OUT_OF_RANGE;case ft.UNIMPLEMENTED:return N.UNIMPLEMENTED;case ft.DATA_LOSS:return N.DATA_LOSS;default:return fail(39323,{code:r})}}(gt=ft||(ft={}))[gt.OK=0]="OK",gt[gt.CANCELLED=1]="CANCELLED",gt[gt.UNKNOWN=2]="UNKNOWN",gt[gt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gt[gt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gt[gt.NOT_FOUND=5]="NOT_FOUND",gt[gt.ALREADY_EXISTS=6]="ALREADY_EXISTS",gt[gt.PERMISSION_DENIED=7]="PERMISSION_DENIED",gt[gt.UNAUTHENTICATED=16]="UNAUTHENTICATED",gt[gt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gt[gt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gt[gt.ABORTED=10]="ABORTED",gt[gt.OUT_OF_RANGE=11]="OUT_OF_RANGE",gt[gt.UNIMPLEMENTED=12]="UNIMPLEMENTED",gt[gt.INTERNAL=13]="INTERNAL",gt[gt.UNAVAILABLE=14]="UNAVAILABLE",gt[gt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yt=new Integer$1([4294967295,4294967295],0);function __PRIVATE_getMd5HashValue(r){const e=__PRIVATE_newTextEncoder().encode(r),t=new Md5;return t.update(e),new Uint8Array(t.digest())}function __PRIVATE_get64BitUints(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Integer$1([t,n],0),new Integer$1([i,s],0)]}class BloomFilter{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new __PRIVATE_BloomFilterError(`Invalid padding: ${t}`);if(n<0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new __PRIVATE_BloomFilterError(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Integer$1.fromNumber(this.fe)}pe(e,t,n){let i=e.add(t.multiply(Integer$1.fromNumber(n)));return i.compare(yt)===1&&(i=new Integer$1([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=__PRIVATE_getMd5HashValue(e),[n,i]=__PRIVATE_get64BitUints(t);for(let s=0;s<this.hashCount;s++){const a=this.pe(n,i,s);if(!this.ye(a))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new BloomFilter(s,i,t);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.fe===0)return;const t=__PRIVATE_getMd5HashValue(e),[n,i]=__PRIVATE_get64BitUints(t);for(let s=0;s<this.hashCount;s++){const a=this.pe(n,i,s);this.we(a)}}we(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class __PRIVATE_BloomFilterError extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteEvent{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,TargetChange.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new RemoteEvent(SnapshotVersion.min(),i,new SortedMap(__PRIVATE_primitiveComparator),__PRIVATE_mutableDocumentMap(),__PRIVATE_documentKeySet())}}class TargetChange{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new TargetChange(n,t,__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet(),__PRIVATE_documentKeySet())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentWatchChange{constructor(e,t,n,i){this.Se=e,this.removedTargetIds=t,this.key=n,this.be=i}}class __PRIVATE_ExistenceFilterChange{constructor(e,t){this.targetId=e,this.De=t}}class __PRIVATE_WatchTargetChange{constructor(e,t,n=ByteString.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class __PRIVATE_TargetState{constructor(){this.ve=0,this.Ce=__PRIVATE_snapshotChangesMap(),this.Fe=ByteString.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=__PRIVATE_documentKeySet(),t=__PRIVATE_documentKeySet(),n=__PRIVATE_documentKeySet();return this.Ce.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:fail(38017,{changeType:s})}}),new TargetChange(this.Fe,this.Me,e,t,n)}ke(){this.xe=!1,this.Ce=__PRIVATE_snapshotChangesMap()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,__PRIVATE_hardAssert(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class __PRIVATE_WatchChangeAggregator{constructor(e){this.We=e,this.Ge=new Map,this.ze=__PRIVATE_mutableDocumentMap(),this.je=__PRIVATE_documentTargetMap(),this.Je=__PRIVATE_documentTargetMap(),this.He=new SortedMap(__PRIVATE_primitiveComparator)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{const n=this.tt(t);switch(e.state){case 0:this.nt(t)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),n.Be(e.resumeToken));break;default:fail(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((n,i)=>{this.nt(i)&&t(i)})}it(e){const t=e.targetId,n=e.De.count,i=this.st(t);if(i){const s=i.target;if(__PRIVATE_targetIsDocumentTarget(s))if(n===0){const a=new DocumentKey(s.path);this.Xe(t,a,MutableDocument.newNoDocument(a,SnapshotVersion.min()))}else __PRIVATE_hardAssert(n===1,20013,{expectedCount:n});else{const a=this.ot(t);if(a!==n){const o=this._t(e),c=o?this.ut(o,e,a):1;if(c!==0){this.rt(t);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,h)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let a,o;try{a=__PRIVATE_normalizeByteString(n).toUint8Array()}catch(c){if(c instanceof __PRIVATE_Base64DecodeError)return __PRIVATE_logWarn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{o=new BloomFilter(a,i,s)}catch(c){return __PRIVATE_logWarn(c instanceof __PRIVATE_BloomFilterError?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return o.fe===0?null:o}ut(e,t,n){return t.De.count===n-this.ht(e,t.targetId)?0:2}ht(e,t){const n=this.We.getRemoteKeysForTarget(t);let i=0;return n.forEach(s=>{const a=this.We.lt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(o)||(this.Xe(t,s,null),i++)}),i}Pt(e){const t=new Map;this.Ge.forEach((s,a)=>{const o=this.st(a);if(o){if(s.current&&__PRIVATE_targetIsDocumentTarget(o.target)){const c=new DocumentKey(o.target.path);this.Tt(c).has(a)||this.It(a,c)||this.Xe(a,c,MutableDocument.newNoDocument(c,e))}s.Ne&&(t.set(a,s.Le()),s.ke())}});let n=__PRIVATE_documentKeySet();this.Je.forEach((s,a)=>{let o=!0;a.forEachWhile(c=>{const h=this.st(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(s))}),this.ze.forEach((s,a)=>a.setReadTime(e));const i=new RemoteEvent(e,t,this.He,this.ze,n);return this.ze=__PRIVATE_mutableDocumentMap(),this.je=__PRIVATE_documentTargetMap(),this.Je=__PRIVATE_documentTargetMap(),this.He=new SortedMap(__PRIVATE_primitiveComparator),i}Ze(e,t){if(!this.nt(e))return;const n=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,n),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,n){if(!this.nt(e))return;const i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),n&&(this.ze=this.ze.insert(t,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new __PRIVATE_TargetState,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new SortedSet(__PRIVATE_primitiveComparator),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new SortedSet(__PRIVATE_primitiveComparator),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||__PRIVATE_logDebug("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new __PRIVATE_TargetState),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function __PRIVATE_documentTargetMap(){return new SortedMap(DocumentKey.comparator)}function __PRIVATE_snapshotChangesMap(){return new SortedMap(DocumentKey.comparator)}const wt={asc:"ASCENDING",desc:"DESCENDING"},St={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},bt={and:"AND",or:"OR"};class JsonProtoSerializer{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function __PRIVATE_toInt32Proto(r,e){return r.useProto3Json||__PRIVATE_isNullOrUndefined(e)?e:{value:e}}function toTimestamp(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function __PRIVATE_toBytes(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function __PRIVATE_toVersion(r,e){return toTimestamp(r,e.toTimestamp())}function __PRIVATE_fromVersion(r){return __PRIVATE_hardAssert(!!r,49232),SnapshotVersion.fromTimestamp(function(t){const n=__PRIVATE_normalizeTimestamp(t);return new Timestamp(n.seconds,n.nanos)}(r))}function __PRIVATE_toResourceName(r,e){return __PRIVATE_toResourcePath(r,e).canonicalString()}function __PRIVATE_toResourcePath(r,e){const t=function(i){return new ResourcePath(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function __PRIVATE_fromResourceName(r){const e=ResourcePath.fromString(r);return __PRIVATE_hardAssert(__PRIVATE_isValidResourceName(e),10190,{key:e.toString()}),e}function __PRIVATE_toName(r,e){return __PRIVATE_toResourceName(r.databaseId,e.path)}function fromName(r,e){const t=__PRIVATE_fromResourceName(e);if(t.get(1)!==r.databaseId.projectId)throw new FirestoreError(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new FirestoreError(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new DocumentKey(__PRIVATE_extractLocalPathFromResourceName(t))}function __PRIVATE_toQueryPath(r,e){return __PRIVATE_toResourceName(r.databaseId,e)}function __PRIVATE_fromQueryPath(r){const e=__PRIVATE_fromResourceName(r);return e.length===4?ResourcePath.emptyPath():__PRIVATE_extractLocalPathFromResourceName(e)}function __PRIVATE_getEncodedDatabaseId(r){return new ResourcePath(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function __PRIVATE_extractLocalPathFromResourceName(r){return __PRIVATE_hardAssert(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function __PRIVATE_toMutationDocument(r,e,t){return{name:__PRIVATE_toName(r,e),fields:t.value.mapValue.fields}}function __PRIVATE_fromWatchChange(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:fail(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(h,f){return h.useProto3Json?(__PRIVATE_hardAssert(f===void 0||typeof f=="string",58123),ByteString.fromBase64String(f||"")):(__PRIVATE_hardAssert(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),ByteString.fromUint8Array(f||new Uint8Array))}(r,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(h){const f=h.code===void 0?N.UNKNOWN:__PRIVATE_mapCodeFromRpcCode(h.code);return new FirestoreError(f,h.message||"")}(a);t=new __PRIVATE_WatchTargetChange(n,i,s,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=fromName(r,n.document.name),s=__PRIVATE_fromVersion(n.document.updateTime),a=n.document.createTime?__PRIVATE_fromVersion(n.document.createTime):SnapshotVersion.min(),o=new ObjectValue({mapValue:{fields:n.document.fields}}),c=MutableDocument.newFoundDocument(i,s,a,o),h=n.targetIds||[],f=n.removedTargetIds||[];t=new __PRIVATE_DocumentWatchChange(h,f,c.key,c)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=fromName(r,n.document),s=n.readTime?__PRIVATE_fromVersion(n.readTime):SnapshotVersion.min(),a=MutableDocument.newNoDocument(i,s),o=n.removedTargetIds||[];t=new __PRIVATE_DocumentWatchChange([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=fromName(r,n.document),s=n.removedTargetIds||[];t=new __PRIVATE_DocumentWatchChange([],s,i,null)}else{if(!("filter"in e))return fail(11601,{At:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,a=new ExistenceFilter(i,s),o=n.targetId;t=new __PRIVATE_ExistenceFilterChange(o,a)}}return t}function toMutation(r,e){let t;if(e instanceof __PRIVATE_SetMutation)t={update:__PRIVATE_toMutationDocument(r,e.key,e.value)};else if(e instanceof __PRIVATE_DeleteMutation)t={delete:__PRIVATE_toName(r,e.key)};else if(e instanceof __PRIVATE_PatchMutation)t={update:__PRIVATE_toMutationDocument(r,e.key,e.data),updateMask:__PRIVATE_toDocumentMask(e.fieldMask)};else{if(!(e instanceof __PRIVATE_VerifyMutation))return fail(16599,{Rt:e.type});t={verify:__PRIVATE_toName(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,a){const o=a.transform;if(o instanceof __PRIVATE_ServerTimestampTransform)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof __PRIVATE_ArrayUnionTransformOperation)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof __PRIVATE_ArrayRemoveTransformOperation)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof __PRIVATE_NumericIncrementTransformOperation)return{fieldPath:a.field.canonicalString(),increment:o.Ee};throw fail(20930,{transform:a.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:__PRIVATE_toVersion(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:fail(27497)}(r,e.precondition)),t}function __PRIVATE_fromWriteResults(r,e){return r&&r.length>0?(__PRIVATE_hardAssert(e!==void 0,14353),r.map(t=>function(i,s){let a=i.updateTime?__PRIVATE_fromVersion(i.updateTime):__PRIVATE_fromVersion(s);return a.isEqual(SnapshotVersion.min())&&(a=__PRIVATE_fromVersion(s)),new MutationResult(a,i.transformResults||[])}(t,e))):[]}function __PRIVATE_toDocumentsTarget(r,e){return{documents:[__PRIVATE_toQueryPath(r,e.path)]}}function __PRIVATE_toQueryTarget(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=__PRIVATE_toQueryPath(r,i);const s=function(h){if(h.length!==0)return __PRIVATE_toFilter(CompositeFilter.create(h,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const a=function(h){if(h.length!==0)return h.map(f=>function(g){return{field:__PRIVATE_toFieldPathReference(g.field),direction:__PRIVATE_toDirection(g.dir)}}(f))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=__PRIVATE_toInt32Proto(r,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{Vt:t,parent:i}}function __PRIVATE_convertQueryTargetToQuery(r){let e=__PRIVATE_fromQueryPath(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){__PRIVATE_hardAssert(n===1,65062);const f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=function(m){const g=__PRIVATE_fromFilter(m);return g instanceof CompositeFilter&&__PRIVATE_compositeFilterIsFlatConjunction(g)?g.getFilters():[g]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(g=>function(E){return new OrderBy(__PRIVATE_fromFieldPathReference(E.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(g))}(t.orderBy));let o=null;t.limit&&(o=function(m){let g;return g=typeof m=="object"?m.value:m,__PRIVATE_isNullOrUndefined(g)?null:g}(t.limit));let c=null;t.startAt&&(c=function(m){const g=!!m.before,_=m.values||[];return new Bound(_,g)}(t.startAt));let h=null;return t.endAt&&(h=function(m){const g=!m.before,_=m.values||[];return new Bound(_,g)}(t.endAt)),__PRIVATE_newQuery(e,i,a,s,o,"F",c,h)}function __PRIVATE_toListenRequestLabels(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fail(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function __PRIVATE_fromFilter(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=__PRIVATE_fromFieldPathReference(t.unaryFilter.field);return FieldFilter.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=__PRIVATE_fromFieldPathReference(t.unaryFilter.field);return FieldFilter.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=__PRIVATE_fromFieldPathReference(t.unaryFilter.field);return FieldFilter.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=__PRIVATE_fromFieldPathReference(t.unaryFilter.field);return FieldFilter.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return fail(61313);default:return fail(60726)}}(r):r.fieldFilter!==void 0?function(t){return FieldFilter.create(__PRIVATE_fromFieldPathReference(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return fail(58110);default:return fail(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return CompositeFilter.create(t.compositeFilter.filters.map(n=>__PRIVATE_fromFilter(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return fail(1026)}}(t.compositeFilter.op))}(r):fail(30097,{filter:r})}function __PRIVATE_toDirection(r){return wt[r]}function __PRIVATE_toOperatorName(r){return St[r]}function __PRIVATE_toCompositeOperatorName(r){return bt[r]}function __PRIVATE_toFieldPathReference(r){return{fieldPath:r.canonicalString()}}function __PRIVATE_fromFieldPathReference(r){return FieldPath$1.fromServerFormat(r.fieldPath)}function __PRIVATE_toFilter(r){return r instanceof FieldFilter?function(t){if(t.op==="=="){if(__PRIVATE_isNanValue(t.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(t.field),op:"IS_NAN"}};if(__PRIVATE_isNullValue(t.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(__PRIVATE_isNanValue(t.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(t.field),op:"IS_NOT_NAN"}};if(__PRIVATE_isNullValue(t.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:__PRIVATE_toFieldPathReference(t.field),op:__PRIVATE_toOperatorName(t.op),value:t.value}}}(r):r instanceof CompositeFilter?function(t){const n=t.getFilters().map(i=>__PRIVATE_toFilter(i));return n.length===1?n[0]:{compositeFilter:{op:__PRIVATE_toCompositeOperatorName(t.op),filters:n}}}(r):fail(54877,{filter:r})}function __PRIVATE_toDocumentMask(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function __PRIVATE_isValidResourceName(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TargetData{constructor(e,t,n,i,s=SnapshotVersion.min(),a=SnapshotVersion.min(),o=ByteString.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=c}withSequenceNumber(e){return new TargetData(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalSerializer{constructor(e){this.gt=e}}function __PRIVATE_fromBundledQuery(r){const e=__PRIVATE_convertQueryTargetToQuery({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?__PRIVATE_queryWithLimit(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryIndexManager{constructor(){this.Dn=new __PRIVATE_MemoryCollectionParentIndex}addToCollectionParentIndex(e,t){return this.Dn.add(t),PersistencePromise.resolve()}getCollectionParents(e,t){return PersistencePromise.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return PersistencePromise.resolve()}deleteFieldIndex(e,t){return PersistencePromise.resolve()}deleteAllFieldIndexes(e){return PersistencePromise.resolve()}createTargetIndexes(e,t){return PersistencePromise.resolve()}getDocumentsMatchingTarget(e,t){return PersistencePromise.resolve(null)}getIndexType(e,t){return PersistencePromise.resolve(0)}getFieldIndexes(e,t){return PersistencePromise.resolve([])}getNextCollectionGroupToUpdate(e){return PersistencePromise.resolve(null)}getMinOffset(e,t){return PersistencePromise.resolve(IndexOffset.min())}getMinOffsetFromCollectionGroup(e,t){return PersistencePromise.resolve(IndexOffset.min())}updateCollectionGroup(e,t,n){return PersistencePromise.resolve()}updateIndexEntries(e,t){return PersistencePromise.resolve()}}class __PRIVATE_MemoryCollectionParentIndex{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new SortedSet(ResourcePath.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new SortedSet(ResourcePath.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ft={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mt=41943040;class LruParams{static withCacheSize(e){return new LruParams(e,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */LruParams.DEFAULT_COLLECTION_PERCENTILE=10,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,LruParams.DEFAULT=new LruParams(Mt,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),LruParams.DISABLED=new LruParams(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_TargetIdGenerator{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new __PRIVATE_TargetIdGenerator(0)}static ur(){return new __PRIVATE_TargetIdGenerator(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xt="LruGarbageCollector",Ot=1048576;function __PRIVATE_bufferEntryComparator([r,e],[t,n]){const i=__PRIVATE_primitiveComparator(r,t);return i===0?__PRIVATE_primitiveComparator(e,n):i}class __PRIVATE_RollingSequenceNumberBuffer{constructor(e){this.Tr=e,this.buffer=new SortedSet(__PRIVATE_bufferEntryComparator),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();__PRIVATE_bufferEntryComparator(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class __PRIVATE_LruScheduler{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){__PRIVATE_logDebug(xt,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){__PRIVATE_isIndexedDbTransactionError(t)?__PRIVATE_logDebug(xt,"Ignoring IndexedDB error during garbage collection: ",t):await __PRIVATE_ignoreIfPrimaryLeaseLoss(t)}await this.Rr(3e5)})}}class __PRIVATE_LruGarbageCollectorImpl{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return PersistencePromise.resolve(__PRIVATE_ListenSequence.ue);const n=new __PRIVATE_RollingSequenceNumberBuffer(t);return this.Vr.forEachTarget(e,i=>n.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>n.Er(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Vr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(__PRIVATE_logDebug("LruGarbageCollector","Garbage collection skipped; disabled"),PersistencePromise.resolve(Ft)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(__PRIVATE_logDebug("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ft):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let n,i,s,a,o,c,h;const f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(__PRIVATE_logDebug("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,a=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(n=m,o=Date.now(),this.removeTargets(e,n,t))).next(m=>(s=m,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(m=>(h=Date.now(),__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-f}ms
	Determined least recently used ${i} in `+(o-a)+`ms
	Removed ${s} targets in `+(c-o)+`ms
	Removed ${m} documents in `+(h-c)+`ms
Total Duration: ${h-f}ms`),PersistencePromise.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m})))}}function __PRIVATE_newLruGarbageCollector(r,e){return new __PRIVATE_LruGarbageCollectorImpl(r,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RemoteDocumentChangeBuffer{constructor(){this.changes=new ObjectMap(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,MutableDocument.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?PersistencePromise.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OverlayedDocument{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LocalDocumentsView{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&__PRIVATE_mutationApplyToLocalView(n.mutation,i,FieldMask.empty(),Timestamp.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,__PRIVATE_documentKeySet()).next(()=>n))}getLocalViewOfDocuments(e,t,n=__PRIVATE_documentKeySet()){const i=__PRIVATE_newOverlayMap();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let a=documentMap();return s.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const n=__PRIVATE_newOverlayMap();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,__PRIVATE_documentKeySet()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{t.set(a,o)})})}computeViews(e,t,n,i){let s=__PRIVATE_mutableDocumentMap();const a=__PRIVATE_newDocumentKeyMap(),o=function(){return __PRIVATE_newDocumentKeyMap()}();return t.forEach((c,h)=>{const f=n.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof __PRIVATE_PatchMutation)?s=s.insert(h.key,h):f!==void 0?(a.set(h.key,f.mutation.getFieldMask()),__PRIVATE_mutationApplyToLocalView(f.mutation,h,f.mutation.getFieldMask(),Timestamp.now())):a.set(h.key,FieldMask.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((h,f)=>a.set(h,f)),t.forEach((h,f)=>{var m;return o.set(h,new OverlayedDocument(f,(m=a.get(h))!==null&&m!==void 0?m:null))}),o))}recalculateAndSaveOverlays(e,t){const n=__PRIVATE_newDocumentKeyMap();let i=new SortedMap((a,o)=>a-o),s=__PRIVATE_documentKeySet();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const o of a)o.keys().forEach(c=>{const h=t.get(c);if(h===null)return;let f=n.get(c)||FieldMask.empty();f=o.applyToLocalView(h,f),n.set(c,f);const m=(i.get(o.batchId)||__PRIVATE_documentKeySet()).add(c);i=i.insert(o.batchId,m)})}).next(()=>{const a=[],o=i.getReverseIterator();for(;o.hasNext();){const c=o.getNext(),h=c.key,f=c.value,m=__PRIVATE_newMutationMap();f.forEach(g=>{if(!s.has(g)){const _=__PRIVATE_calculateOverlayMutation(t.get(g),n.get(g));_!==null&&m.set(g,_),s=s.add(g)}}),a.push(this.documentOverlayCache.saveOverlays(e,h,m))}return PersistencePromise.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(a){return DocumentKey.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):__PRIVATE_isCollectionGroupQuery(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):PersistencePromise.resolve(__PRIVATE_newOverlayMap());let o=Q,c=s;return a.next(h=>PersistencePromise.forEach(h,(f,m)=>(o<m.largestBatchId&&(o=m.largestBatchId),s.get(f)?PersistencePromise.resolve():this.remoteDocumentCache.getEntry(e,f).next(g=>{c=c.insert(f,g)}))).next(()=>this.populateOverlays(e,h,s)).next(()=>this.computeViews(e,c,h,__PRIVATE_documentKeySet())).next(f=>({batchId:o,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(f)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new DocumentKey(t)).next(n=>{let i=documentMap();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let a=documentMap();return this.indexManager.getCollectionParents(e,s).next(o=>PersistencePromise.forEach(o,c=>{const h=function(m,g){return new __PRIVATE_QueryImpl(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(f=>{f.forEach((m,g)=>{a=a.insert(m,g)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(a=>{s.forEach((c,h)=>{const f=h.getKey();a.get(f)===null&&(a=a.insert(f,MutableDocument.newInvalidDocument(f)))});let o=documentMap();return a.forEach((c,h)=>{const f=s.get(c);f!==void 0&&__PRIVATE_mutationApplyToLocalView(f.mutation,h,FieldMask.empty(),Timestamp.now()),__PRIVATE_queryMatches(t,h)&&(o=o.insert(c,h))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryBundleCache{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return PersistencePromise.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,function(i){return{id:i.id,version:i.version,createTime:__PRIVATE_fromVersion(i.createTime)}}(t)),PersistencePromise.resolve()}getNamedQuery(e,t){return PersistencePromise.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,function(i){return{name:i.name,query:__PRIVATE_fromBundledQuery(i.bundledQuery),readTime:__PRIVATE_fromVersion(i.readTime)}}(t)),PersistencePromise.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryDocumentOverlayCache{constructor(){this.overlays=new SortedMap(DocumentKey.comparator),this.kr=new Map}getOverlay(e,t){return PersistencePromise.resolve(this.overlays.get(t))}getOverlays(e,t){const n=__PRIVATE_newOverlayMap();return PersistencePromise.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.wt(e,t,s)}),PersistencePromise.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.kr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(n)),PersistencePromise.resolve()}getOverlaysForCollection(e,t,n){const i=__PRIVATE_newOverlayMap(),s=t.length+1,a=new DocumentKey(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const c=o.getNext().value,h=c.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return PersistencePromise.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new SortedMap((h,f)=>h-f);const a=this.overlays.getIterator();for(;a.hasNext();){const h=a.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>n){let f=s.get(h.largestBatchId);f===null&&(f=__PRIVATE_newOverlayMap(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}const o=__PRIVATE_newOverlayMap(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((h,f)=>o.set(h,f)),!(o.size()>=i)););return PersistencePromise.resolve(o)}wt(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const a=this.kr.get(i.largestBatchId).delete(n.key);this.kr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new Overlay(t,n));let s=this.kr.get(t);s===void 0&&(s=__PRIVATE_documentKeySet(),this.kr.set(t,s)),this.kr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryGlobalsCache{constructor(){this.sessionToken=ByteString.EMPTY_BYTE_STRING}getSessionToken(e){return PersistencePromise.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,PersistencePromise.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ReferenceSet{constructor(){this.qr=new SortedSet(__PRIVATE_DocReference.Qr),this.$r=new SortedSet(__PRIVATE_DocReference.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const n=new __PRIVATE_DocReference(e,t);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.Wr(new __PRIVATE_DocReference(e,t))}Gr(e,t){e.forEach(n=>this.removeReference(n,t))}zr(e){const t=new DocumentKey(new ResourcePath([])),n=new __PRIVATE_DocReference(t,e),i=new __PRIVATE_DocReference(t,e+1),s=[];return this.$r.forEachInRange([n,i],a=>{this.Wr(a),s.push(a.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new DocumentKey(new ResourcePath([])),n=new __PRIVATE_DocReference(t,e),i=new __PRIVATE_DocReference(t,e+1);let s=__PRIVATE_documentKeySet();return this.$r.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){const t=new __PRIVATE_DocReference(e,0),n=this.qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class __PRIVATE_DocReference{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return DocumentKey.comparator(e.key,t.key)||__PRIVATE_primitiveComparator(e.Hr,t.Hr)}static Ur(e,t){return __PRIVATE_primitiveComparator(e.Hr,t.Hr)||DocumentKey.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryMutationQueue{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new SortedSet(__PRIVATE_DocReference.Qr)}checkEmpty(e){return PersistencePromise.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new MutationBatch(s,t,n,i);this.mutationQueue.push(a);for(const o of i)this.Yr=this.Yr.add(new __PRIVATE_DocReference(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return PersistencePromise.resolve(a)}lookupMutationBatch(e,t){return PersistencePromise.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.Xr(n),s=i<0?0:i;return PersistencePromise.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return PersistencePromise.resolve(this.mutationQueue.length===0?G:this.er-1)}getAllMutationBatches(e){return PersistencePromise.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new __PRIVATE_DocReference(t,0),i=new __PRIVATE_DocReference(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([n,i],a=>{const o=this.Zr(a.Hr);s.push(o)}),PersistencePromise.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new SortedSet(__PRIVATE_primitiveComparator);return t.forEach(i=>{const s=new __PRIVATE_DocReference(i,0),a=new __PRIVATE_DocReference(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,a],o=>{n=n.add(o.Hr)})}),PersistencePromise.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;DocumentKey.isDocumentKey(s)||(s=s.child(""));const a=new __PRIVATE_DocReference(new DocumentKey(s),0);let o=new SortedSet(__PRIVATE_primitiveComparator);return this.Yr.forEachWhile(c=>{const h=c.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(o=o.add(c.Hr)),!0)},a),PersistencePromise.resolve(this.ei(o))}ei(e){const t=[];return e.forEach(n=>{const i=this.Zr(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){__PRIVATE_hardAssert(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Yr;return PersistencePromise.forEach(t.mutations,i=>{const s=new __PRIVATE_DocReference(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,t){const n=new __PRIVATE_DocReference(t,0),i=this.Yr.firstAfterOrEqual(n);return PersistencePromise.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,PersistencePromise.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryRemoteDocumentCacheImpl{constructor(e){this.ni=e,this.docs=function(){return new SortedMap(DocumentKey.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,a=this.ni(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return PersistencePromise.resolve(n?n.document.mutableCopy():MutableDocument.newInvalidDocument(t))}getEntries(e,t){let n=__PRIVATE_mutableDocumentMap();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():MutableDocument.newInvalidDocument(i))}),PersistencePromise.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=__PRIVATE_mutableDocumentMap();const a=t.path,o=new DocumentKey(a.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){const{key:h,value:{document:f}}=c.getNext();if(!a.isPrefixOf(h.path))break;h.path.length>a.length+1||__PRIVATE_indexOffsetComparator(__PRIVATE_newIndexOffsetFromDocument(f),n)<=0||(i.has(f.key)||__PRIVATE_queryMatches(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return PersistencePromise.resolve(s)}getAllFromCollectionGroup(e,t,n,i){fail(9500)}ri(e,t){return PersistencePromise.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new __PRIVATE_MemoryRemoteDocumentChangeBuffer(this)}getSize(e){return PersistencePromise.resolve(this.size)}}class __PRIVATE_MemoryRemoteDocumentChangeBuffer extends RemoteDocumentChangeBuffer{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(n)}),PersistencePromise.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryTargetCache{constructor(e){this.persistence=e,this.ii=new ObjectMap(t=>__PRIVATE_canonifyTarget(t),__PRIVATE_targetEquals),this.lastRemoteSnapshotVersion=SnapshotVersion.min(),this.highestTargetId=0,this.si=0,this.oi=new __PRIVATE_ReferenceSet,this.targetCount=0,this._i=__PRIVATE_TargetIdGenerator.ar()}forEachTarget(e,t){return this.ii.forEach((n,i)=>t(i)),PersistencePromise.resolve()}getLastRemoteSnapshotVersion(e){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return PersistencePromise.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),PersistencePromise.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.si&&(this.si=t),PersistencePromise.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new __PRIVATE_TargetIdGenerator(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,PersistencePromise.resolve()}updateTargetData(e,t){return this.hr(t),PersistencePromise.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,PersistencePromise.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.ii.forEach((a,o)=>{o.sequenceNumber<=t&&n.get(o.targetId)===null&&(this.ii.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),PersistencePromise.waitFor(s).next(()=>i)}getTargetCount(e){return PersistencePromise.resolve(this.targetCount)}getTargetData(e,t){const n=this.ii.get(t)||null;return PersistencePromise.resolve(n)}addMatchingKeys(e,t,n){return this.oi.Kr(t,n),PersistencePromise.resolve()}removeMatchingKeys(e,t,n){this.oi.Gr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),PersistencePromise.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),PersistencePromise.resolve()}getMatchingKeysForTargetId(e,t){const n=this.oi.Jr(t);return PersistencePromise.resolve(n)}containsKey(e,t){return PersistencePromise.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_MemoryPersistence{constructor(e,t){this.ai={},this.overlays={},this.ui=new __PRIVATE_ListenSequence(0),this.ci=!1,this.ci=!0,this.li=new __PRIVATE_MemoryGlobalsCache,this.referenceDelegate=e(this),this.hi=new __PRIVATE_MemoryTargetCache(this),this.indexManager=new __PRIVATE_MemoryIndexManager,this.remoteDocumentCache=function(i){return new __PRIVATE_MemoryRemoteDocumentCacheImpl(i)}(n=>this.referenceDelegate.Pi(n)),this.serializer=new __PRIVATE_LocalSerializer(t),this.Ti=new __PRIVATE_MemoryBundleCache(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new __PRIVATE_MemoryDocumentOverlayCache,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ai[e.toKey()];return n||(n=new __PRIVATE_MemoryMutationQueue(t,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,n){__PRIVATE_logDebug("MemoryPersistence","Starting transaction:",e);const i=new __PRIVATE_MemoryTransaction(this.ui.next());return this.referenceDelegate.Ii(),n(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,t){return PersistencePromise.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,t)))}}class __PRIVATE_MemoryTransaction extends PersistenceTransaction{constructor(e){super(),this.currentSequenceNumber=e}}class __PRIVATE_MemoryEagerDelegate{constructor(e){this.persistence=e,this.Ai=new __PRIVATE_ReferenceSet,this.Ri=null}static Vi(e){return new __PRIVATE_MemoryEagerDelegate(e)}get mi(){if(this.Ri)return this.Ri;throw fail(60996)}addReference(e,t,n){return this.Ai.addReference(n,t),this.mi.delete(n.toString()),PersistencePromise.resolve()}removeReference(e,t,n){return this.Ai.removeReference(n,t),this.mi.add(n.toString()),PersistencePromise.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),PersistencePromise.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return PersistencePromise.forEach(this.mi,n=>{const i=DocumentKey.fromPath(n);return this.fi(e,i).next(s=>{s||t.removeEntry(i,SnapshotVersion.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(n=>{n?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return PersistencePromise.or([()=>PersistencePromise.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class __PRIVATE_MemoryLruDelegate{constructor(e,t){this.persistence=e,this.gi=new ObjectMap(n=>__PRIVATE_encodeResourcePath(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=__PRIVATE_newLruGarbageCollector(this,t)}static Vi(e,t){return new __PRIVATE_MemoryLruDelegate(e,t)}Ii(){}di(e){return PersistencePromise.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}yr(e){let t=0;return this.gr(e,n=>{t++}).next(()=>t)}gr(e,t){return PersistencePromise.forEach(this.gi,(n,i)=>this.Sr(e,n,i).next(s=>s?PersistencePromise.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,a=>this.Sr(e,a,t).next(o=>{o||(n++,s.removeEntry(a,SnapshotVersion.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),PersistencePromise.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),PersistencePromise.resolve()}removeReference(e,t,n){return this.gi.set(n,e.currentSequenceNumber),PersistencePromise.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),PersistencePromise.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=__PRIVATE_estimateByteSize(e.data.value)),t}Sr(e,t,n){return PersistencePromise.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.gi.get(t);return PersistencePromise.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_LocalViewChanges{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Is=n,this.ds=i}static Es(e,t){let n=__PRIVATE_documentKeySet(),i=__PRIVATE_documentKeySet();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new __PRIVATE_LocalViewChanges(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QueryContext{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryEngine{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return isSafari()?8:__PRIVATE_getAndroidVersion(getUA())>0?6:4}()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.ps(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.ys(e,t,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;const a=new QueryContext;return this.ws(e,t,a).next(o=>{if(s.result=o,this.Rs)return this.Ss(e,t,a,o.size)})}).next(()=>s.result)}Ss(e,t,n,i){return n.documentReadCount<this.Vs?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","SDK will not create cache indexes for query:",__PRIVATE_stringifyQuery(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),PersistencePromise.resolve()):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Query:",__PRIVATE_stringifyQuery(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.fs*i?(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","The SDK decides to create cache indexes for query:",__PRIVATE_stringifyQuery(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,__PRIVATE_queryToTarget(t))):PersistencePromise.resolve())}ps(e,t){if(__PRIVATE_queryMatchesAllDocuments(t))return PersistencePromise.resolve(null);let n=__PRIVATE_queryToTarget(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=__PRIVATE_queryWithLimit(t,null,"F"),n=__PRIVATE_queryToTarget(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const a=__PRIVATE_documentKeySet(...s);return this.gs.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{const h=this.bs(t,o);return this.Ds(t,h,a,c.readTime)?this.ps(e,__PRIVATE_queryWithLimit(t,null,"F")):this.vs(e,h,t,c)}))})))}ys(e,t,n,i){return __PRIVATE_queryMatchesAllDocuments(t)||i.isEqual(SnapshotVersion.min())?PersistencePromise.resolve(null):this.gs.getDocuments(e,n).next(s=>{const a=this.bs(t,s);return this.Ds(t,a,n,i)?PersistencePromise.resolve(null):(__PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),__PRIVATE_stringifyQuery(t)),this.vs(e,a,t,__PRIVATE_newIndexOffsetSuccessorFromReadTime(i,Q)).next(o=>o))})}bs(e,t){let n=new SortedSet(__PRIVATE_newQueryComparator(e));return t.forEach((i,s)=>{__PRIVATE_queryMatches(e,s)&&(n=n.add(s))}),n}Ds(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,t,n){return __PRIVATE_getLogLevel()<=LogLevel.DEBUG&&__PRIVATE_logDebug("QueryEngine","Using full collection scan to execute query:",__PRIVATE_stringifyQuery(t)),this.gs.getDocumentsMatchingQuery(e,t,IndexOffset.min(),n)}vs(e,t,n,i){return this.gs.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qt="LocalStore",$t=3e8;class __PRIVATE_LocalStoreImpl{constructor(e,t,n,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new SortedMap(__PRIVATE_primitiveComparator),this.Ms=new ObjectMap(s=>__PRIVATE_canonifyTarget(s),__PRIVATE_targetEquals),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LocalDocumentsView(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}}function __PRIVATE_newLocalStore(r,e,t,n){return new __PRIVATE_LocalStoreImpl(r,e,t,n)}async function __PRIVATE_localStoreHandleUserChange(r,e){const t=__PRIVATE_debugCast(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const a=[],o=[];let c=__PRIVATE_documentKeySet();for(const h of i){a.push(h.batchId);for(const f of h.mutations)c=c.add(f.key)}for(const h of s){o.push(h.batchId);for(const f of h.mutations)c=c.add(f.key)}return t.localDocuments.getDocuments(n,c).next(h=>({Bs:h,removedBatchIds:a,addedBatchIds:o}))})})}function __PRIVATE_localStoreAcknowledgeBatch(r,e){const t=__PRIVATE_debugCast(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return function(o,c,h,f){const m=h.batch,g=m.keys();let _=PersistencePromise.resolve();return g.forEach(E=>{_=_.next(()=>f.getEntry(c,E)).next(A=>{const C=h.docVersions.get(E);__PRIVATE_hardAssert(C!==null,48541),A.version.compareTo(C)<0&&(m.applyToRemoteDocument(A,h),A.isValidDocument()&&(A.setReadTime(h.commitVersion),f.addEntry(A)))})}),_.next(()=>o.mutationQueue.removeMutationBatch(c,m))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=__PRIVATE_documentKeySet();for(let h=0;h<o.mutationResults.length;++h)o.mutationResults[h].transformResults.length>0&&(c=c.add(o.batch.mutations[h].key));return c}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function __PRIVATE_localStoreGetLastRemoteSnapshotVersion(r){const e=__PRIVATE_debugCast(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function __PRIVATE_localStoreApplyRemoteEventToLocalCache(r,e){const t=__PRIVATE_debugCast(r),n=e.snapshotVersion;let i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const a=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;const o=[];e.targetChanges.forEach((f,m)=>{const g=i.get(m);if(!g)return;o.push(t.hi.removeMatchingKeys(s,f.removedDocuments,m).next(()=>t.hi.addMatchingKeys(s,f.addedDocuments,m)));let _=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?_=_.withResumeToken(ByteString.EMPTY_BYTE_STRING,SnapshotVersion.min()).withLastLimboFreeSnapshotVersion(SnapshotVersion.min()):f.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(f.resumeToken,n)),i=i.insert(m,_),function(A,C,I){return A.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-A.snapshotVersion.toMicroseconds()>=$t?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(g,_,f)&&o.push(t.hi.updateTargetData(s,_))});let c=__PRIVATE_mutableDocumentMap(),h=__PRIVATE_documentKeySet();if(e.documentUpdates.forEach(f=>{e.resolvedLimboDocuments.has(f)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))}),o.push(__PRIVATE_populateDocumentChangeBuffer(s,a,e.documentUpdates).next(f=>{c=f.Ls,h=f.ks})),!n.isEqual(SnapshotVersion.min())){const f=t.hi.getLastRemoteSnapshotVersion(s).next(m=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,n));o.push(f)}return PersistencePromise.waitFor(o).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,h)).next(()=>c)}).then(s=>(t.Fs=i,s))}function __PRIVATE_populateDocumentChangeBuffer(r,e,t){let n=__PRIVATE_documentKeySet(),i=__PRIVATE_documentKeySet();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let a=__PRIVATE_mutableDocumentMap();return t.forEach((o,c)=>{const h=s.get(o);c.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(o)),c.isNoDocument()&&c.version.isEqual(SnapshotVersion.min())?(e.removeEntry(o,c.readTime),a=a.insert(o,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(c),a=a.insert(o,c)):__PRIVATE_logDebug(Qt,"Ignoring outdated watch update for ",o,". Current version:",h.version," Watch version:",c.version)}),{Ls:a,ks:i}})}function __PRIVATE_localStoreGetNextMutationBatch(r,e){const t=__PRIVATE_debugCast(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=G),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function __PRIVATE_localStoreAllocateTarget(r,e){const t=__PRIVATE_debugCast(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.hi.getTargetData(n,e).next(s=>s?(i=s,PersistencePromise.resolve(i)):t.hi.allocateTargetId(n).next(a=>(i=new TargetData(e,a,"TargetPurposeListen",n.currentSequenceNumber),t.hi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Fs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(n.targetId,n),t.Ms.set(e,n.targetId)),n})}async function __PRIVATE_localStoreReleaseTarget(r,e,t){const n=__PRIVATE_debugCast(r),i=n.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,a=>n.persistence.referenceDelegate.removeTarget(a,i))}catch(a){if(!__PRIVATE_isIndexedDbTransactionError(a))throw a;__PRIVATE_logDebug(Qt,`Failed to update sequence numbers for target ${e}: ${a}`)}n.Fs=n.Fs.remove(e),n.Ms.delete(i.target)}function __PRIVATE_localStoreExecuteQuery(r,e,t){const n=__PRIVATE_debugCast(r);let i=SnapshotVersion.min(),s=__PRIVATE_documentKeySet();return n.persistence.runTransaction("Execute query","readwrite",a=>function(c,h,f){const m=__PRIVATE_debugCast(c),g=m.Ms.get(f);return g!==void 0?PersistencePromise.resolve(m.Fs.get(g)):m.hi.getTargetData(h,f)}(n,a,__PRIVATE_queryToTarget(e)).next(o=>{if(o)return i=o.lastLimboFreeSnapshotVersion,n.hi.getMatchingKeysForTargetId(a,o.targetId).next(c=>{s=c})}).next(()=>n.Cs.getDocumentsMatchingQuery(a,e,t?i:SnapshotVersion.min(),t?s:__PRIVATE_documentKeySet())).next(o=>(__PRIVATE_setMaxReadTime(n,__PRIVATE_queryCollectionGroup(e),o),{documents:o,qs:s})))}function __PRIVATE_setMaxReadTime(r,e,t){let n=r.xs.get(e)||SnapshotVersion.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.xs.set(e,n)}class __PRIVATE_LocalClientState{constructor(){this.activeTargetIds=__PRIVATE_targetIdSet()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class __PRIVATE_MemorySharedClientState{constructor(){this.Fo=new __PRIVATE_LocalClientState,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,n){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new __PRIVATE_LocalClientState,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_NoopConnectivityMonitor{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zt="ConnectivityMonitor";class __PRIVATE_BrowserConnectivityMonitor{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){__PRIVATE_logDebug(zt,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){__PRIVATE_logDebug(zt,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jt=null;function __PRIVATE_generateUniqueDebugId(){return jt===null?jt=function(){return 268435456+Math.round(2147483648*Math.random())}():jt++,"0x"+jt.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jt="RestConnection",Ht={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class __PRIVATE_RestConnection{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${n}/databases/${i}`,this.Ko=this.databaseId.database===ut?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Wo(e,t,n,i,s){const a=__PRIVATE_generateUniqueDebugId(),o=this.Go(e,t.toUriEncodedString());__PRIVATE_logDebug(Jt,`Sending RPC '${e}' ${a}:`,o,n);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,i,s);const{host:h}=new URL(o),f=isCloudWorkstation(h);return this.jo(e,o,c,n,f).then(m=>(__PRIVATE_logDebug(Jt,`Received RPC '${e}' ${a}: `,m),m),m=>{throw __PRIVATE_logWarn(Jt,`RPC '${e}' ${a} failed with error: `,m,"url: ",o,"request:",n),m})}Jo(e,t,n,i,s,a){return this.Wo(e,t,n,i,s)}zo(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+x}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}Go(e,t){const n=Ht[e];return`${this.$o}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_StreamBridge{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class __PRIVATE_WebChannelConnection extends __PRIVATE_RestConnection{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,n,i,s){const a=__PRIVATE_generateUniqueDebugId();return new Promise((o,c)=>{const h=new XhrIo;h.setWithCredentials(!0),h.listenOnce(EventType.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case ErrorCode.NO_ERROR:const m=h.getResponseJson();__PRIVATE_logDebug(Yt,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(m)),o(m);break;case ErrorCode.TIMEOUT:__PRIVATE_logDebug(Yt,`RPC '${e}' ${a} timed out`),c(new FirestoreError(N.DEADLINE_EXCEEDED,"Request time out"));break;case ErrorCode.HTTP_ERROR:const g=h.getStatus();if(__PRIVATE_logDebug(Yt,`RPC '${e}' ${a} failed with status:`,g,"response text:",h.getResponseText()),g>0){let _=h.getResponseJson();Array.isArray(_)&&(_=_[0]);const E=_==null?void 0:_.error;if(E&&E.status&&E.message){const A=function(I){const b=I.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(b)>=0?b:N.UNKNOWN}(E.status);c(new FirestoreError(A,E.message))}else c(new FirestoreError(N.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new FirestoreError(N.UNAVAILABLE,"Connection failed."));break;default:fail(9055,{c_:e,streamId:a,l_:h.getLastErrorCode(),h_:h.getLastError()})}}finally{__PRIVATE_logDebug(Yt,`RPC '${e}' ${a} completed.`)}});const f=JSON.stringify(i);__PRIVATE_logDebug(Yt,`RPC '${e}' ${a} sending request:`,i),h.send(t,"POST",f,n,15)})}P_(e,t,n){const i=__PRIVATE_generateUniqueDebugId(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=createWebChannelTransport(),o=getStatEventTarget(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const f=s.join("");__PRIVATE_logDebug(Yt,`Creating RPC '${e}' stream ${i}: ${f}`,c);const m=a.createWebChannel(f,c);this.T_(m);let g=!1,_=!1;const E=new __PRIVATE_StreamBridge({Ho:C=>{_?__PRIVATE_logDebug(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(g||(__PRIVATE_logDebug(Yt,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${i} sending:`,C),m.send(C))},Yo:()=>m.close()}),A=(C,I,b)=>{C.listen(I,R=>{try{b(R)}catch(V){setTimeout(()=>{throw V},0)}})};return A(m,WebChannel.EventType.OPEN,()=>{_||(__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${i} transport opened.`),E.s_())}),A(m,WebChannel.EventType.CLOSE,()=>{_||(_=!0,__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${i} transport closed`),E.__(),this.I_(m))}),A(m,WebChannel.EventType.ERROR,C=>{_||(_=!0,__PRIVATE_logWarn(Yt,`RPC '${e}' stream ${i} transport errored. Name:`,C.name,"Message:",C.message),E.__(new FirestoreError(N.UNAVAILABLE,"The operation could not be completed")))}),A(m,WebChannel.EventType.MESSAGE,C=>{var I;if(!_){const b=C.data[0];__PRIVATE_hardAssert(!!b,16349);const R=b,V=(R==null?void 0:R.error)||((I=R[0])===null||I===void 0?void 0:I.error);if(V){__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${i} received error:`,V);const U=V.status;let W=function(P){const K=ft[P];if(K!==void 0)return __PRIVATE_mapCodeFromRpcCode(K)}(U),j=V.message;W===void 0&&(W=N.INTERNAL,j="Unknown error status: "+U+" with message "+V.message),_=!0,E.__(new FirestoreError(W,j)),m.close()}else __PRIVATE_logDebug(Yt,`RPC '${e}' stream ${i} received:`,b),E.a_(b)}}),A(o,Event.STAT_EVENT,C=>{C.stat===Stat.PROXY?__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===Stat.NOPROXY&&__PRIVATE_logDebug(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.o_()},0),E}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}}function getDocument(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_newSerializer(r){return new JsonProtoSerializer(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_ExponentialBackoff{constructor(e,t,n=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=n,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-n);i>0&&__PRIVATE_logDebug("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="PersistentStream";class __PRIVATE_PersistentStream{constructor(e,t,n,i,s,a,o,c){this.Fi=e,this.w_=n,this.S_=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new __PRIVATE_ExponentialBackoff(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===N.RESOURCE_EXHAUSTED?(__PRIVATE_logError(t.toString()),__PRIVATE_logError("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.b_===t&&this.W_(n,i)},n=>{e(()=>{const i=new FirestoreError(N.UNKNOWN,"Fetching auth token failed: "+n.message);return this.G_(i)})})}W_(e,t){const n=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{n(()=>this.G_(i))}),this.stream.onMessage(i=>{n(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return __PRIVATE_logDebug(Zt,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(__PRIVATE_logDebug(Zt,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class __PRIVATE_PersistentListenStream extends __PRIVATE_PersistentStream{constructor(e,t,n,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=__PRIVATE_fromWatchChange(this.serializer,e),n=function(s){if(!("targetChange"in s))return SnapshotVersion.min();const a=s.targetChange;return a.targetIds&&a.targetIds.length?SnapshotVersion.min():a.readTime?__PRIVATE_fromVersion(a.readTime):SnapshotVersion.min()}(e);return this.listener.J_(t,n)}H_(e){const t={};t.database=__PRIVATE_getEncodedDatabaseId(this.serializer),t.addTarget=function(s,a){let o;const c=a.target;if(o=__PRIVATE_targetIsDocumentTarget(c)?{documents:__PRIVATE_toDocumentsTarget(s,c)}:{query:__PRIVATE_toQueryTarget(s,c).Vt},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=__PRIVATE_toBytes(s,a.resumeToken);const h=__PRIVATE_toInt32Proto(s,a.expectedCount);h!==null&&(o.expectedCount=h)}else if(a.snapshotVersion.compareTo(SnapshotVersion.min())>0){o.readTime=toTimestamp(s,a.snapshotVersion.toTimestamp());const h=__PRIVATE_toInt32Proto(s,a.expectedCount);h!==null&&(o.expectedCount=h)}return o}(this.serializer,e);const n=__PRIVATE_toListenRequestLabels(this.serializer,e);n&&(t.labels=n),this.k_(t)}Y_(e){const t={};t.database=__PRIVATE_getEncodedDatabaseId(this.serializer),t.removeTarget=e,this.k_(t)}}class __PRIVATE_PersistentWriteStream extends __PRIVATE_PersistentStream{constructor(e,t,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,a),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return __PRIVATE_hardAssert(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,__PRIVATE_hardAssert(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){__PRIVATE_hardAssert(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=__PRIVATE_fromWriteResults(e.writeResults,e.commitTime),n=__PRIVATE_fromVersion(e.commitTime);return this.listener.ta(n,t)}na(){const e={};e.database=__PRIVATE_getEncodedDatabaseId(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>toMutation(this.serializer,n))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Datastore{}class __PRIVATE_DatastoreImpl extends Datastore{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new FirestoreError(N.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,n,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Wo(e,__PRIVATE_toResourcePath(t,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new FirestoreError(N.UNKNOWN,s.toString())})}Jo(e,t,n,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Jo(e,__PRIVATE_toResourcePath(t,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new FirestoreError(N.UNKNOWN,a.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class __PRIVATE_OnlineStateTracker{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(__PRIVATE_logError(t),this._a=!1):__PRIVATE_logDebug("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt="RemoteStore";class __PRIVATE_RemoteStoreImpl{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(a=>{n.enqueueAndForget(async()=>{__PRIVATE_canUseNetwork(this)&&(__PRIVATE_logDebug(Xt,"Restarting streams for network reachability change."),await async function(c){const h=__PRIVATE_debugCast(c);h.Ia.add(4),await __PRIVATE_disableNetworkInternal(h),h.Aa.set("Unknown"),h.Ia.delete(4),await __PRIVATE_enableNetworkInternal(h)}(this))})}),this.Aa=new __PRIVATE_OnlineStateTracker(n,i)}}async function __PRIVATE_enableNetworkInternal(r){if(__PRIVATE_canUseNetwork(r))for(const e of r.da)await e(!0)}async function __PRIVATE_disableNetworkInternal(r){for(const e of r.da)await e(!1)}function __PRIVATE_remoteStoreListen(r,e){const t=__PRIVATE_debugCast(r);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),__PRIVATE_shouldStartWatchStream(t)?__PRIVATE_startWatchStream(t):__PRIVATE_ensureWatchStream(t).x_()&&__PRIVATE_sendWatchRequest(t,e))}function __PRIVATE_remoteStoreUnlisten(r,e){const t=__PRIVATE_debugCast(r),n=__PRIVATE_ensureWatchStream(t);t.Ta.delete(e),n.x_()&&__PRIVATE_sendUnwatchRequest(t,e),t.Ta.size===0&&(n.x_()?n.B_():__PRIVATE_canUseNetwork(t)&&t.Aa.set("Unknown"))}function __PRIVATE_sendWatchRequest(r,e){if(r.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(SnapshotVersion.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}__PRIVATE_ensureWatchStream(r).H_(e)}function __PRIVATE_sendUnwatchRequest(r,e){r.Ra.$e(e),__PRIVATE_ensureWatchStream(r).Y_(e)}function __PRIVATE_startWatchStream(r){r.Ra=new __PRIVATE_WatchChangeAggregator({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>r.Ta.get(e)||null,lt:()=>r.datastore.serializer.databaseId}),__PRIVATE_ensureWatchStream(r).start(),r.Aa.aa()}function __PRIVATE_shouldStartWatchStream(r){return __PRIVATE_canUseNetwork(r)&&!__PRIVATE_ensureWatchStream(r).M_()&&r.Ta.size>0}function __PRIVATE_canUseNetwork(r){return __PRIVATE_debugCast(r).Ia.size===0}function __PRIVATE_cleanUpWatchStreamState(r){r.Ra=void 0}async function __PRIVATE_onWatchStreamConnected(r){r.Aa.set("Online")}async function __PRIVATE_onWatchStreamOpen(r){r.Ta.forEach((e,t)=>{__PRIVATE_sendWatchRequest(r,e)})}async function __PRIVATE_onWatchStreamClose(r,e){__PRIVATE_cleanUpWatchStreamState(r),__PRIVATE_shouldStartWatchStream(r)?(r.Aa.la(e),__PRIVATE_startWatchStream(r)):r.Aa.set("Unknown")}async function __PRIVATE_onWatchStreamChange(r,e,t){if(r.Aa.set("Online"),e instanceof __PRIVATE_WatchTargetChange&&e.state===2&&e.cause)try{await async function(i,s){const a=s.cause;for(const o of s.targetIds)i.Ta.has(o)&&(await i.remoteSyncer.rejectListen(o,a),i.Ta.delete(o),i.Ra.removeTarget(o))}(r,e)}catch(n){__PRIVATE_logDebug(Xt,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await __PRIVATE_disableNetworkUntilRecovery(r,n)}else if(e instanceof __PRIVATE_DocumentWatchChange?r.Ra.Ye(e):e instanceof __PRIVATE_ExistenceFilterChange?r.Ra.it(e):r.Ra.et(e),!t.isEqual(SnapshotVersion.min()))try{const n=await __PRIVATE_localStoreGetLastRemoteSnapshotVersion(r.localStore);t.compareTo(n)>=0&&await function(s,a){const o=s.Ra.Pt(a);return o.targetChanges.forEach((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const f=s.Ta.get(h);f&&s.Ta.set(h,f.withResumeToken(c.resumeToken,a))}}),o.targetMismatches.forEach((c,h)=>{const f=s.Ta.get(c);if(!f)return;s.Ta.set(c,f.withResumeToken(ByteString.EMPTY_BYTE_STRING,f.snapshotVersion)),__PRIVATE_sendUnwatchRequest(s,c);const m=new TargetData(f.target,c,h,f.sequenceNumber);__PRIVATE_sendWatchRequest(s,m)}),s.remoteSyncer.applyRemoteEvent(o)}(r,t)}catch(n){__PRIVATE_logDebug(Xt,"Failed to raise snapshot:",n),await __PRIVATE_disableNetworkUntilRecovery(r,n)}}async function __PRIVATE_disableNetworkUntilRecovery(r,e,t){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;r.Ia.add(1),await __PRIVATE_disableNetworkInternal(r),r.Aa.set("Offline"),t||(t=()=>__PRIVATE_localStoreGetLastRemoteSnapshotVersion(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{__PRIVATE_logDebug(Xt,"Retrying IndexedDB access"),await t(),r.Ia.delete(1),await __PRIVATE_enableNetworkInternal(r)})}function __PRIVATE_executeWithRecovery(r,e){return e().catch(t=>__PRIVATE_disableNetworkUntilRecovery(r,t,e))}async function __PRIVATE_fillWritePipeline(r){const e=__PRIVATE_debugCast(r),t=__PRIVATE_ensureWriteStream(e);let n=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:G;for(;__PRIVATE_canAddToWritePipeline(e);)try{const i=await __PRIVATE_localStoreGetNextMutationBatch(e.localStore,n);if(i===null){e.Pa.length===0&&t.B_();break}n=i.batchId,__PRIVATE_addToWritePipeline(e,i)}catch(i){await __PRIVATE_disableNetworkUntilRecovery(e,i)}__PRIVATE_shouldStartWriteStream(e)&&__PRIVATE_startWriteStream(e)}function __PRIVATE_canAddToWritePipeline(r){return __PRIVATE_canUseNetwork(r)&&r.Pa.length<10}function __PRIVATE_addToWritePipeline(r,e){r.Pa.push(e);const t=__PRIVATE_ensureWriteStream(r);t.x_()&&t.Z_&&t.X_(e.mutations)}function __PRIVATE_shouldStartWriteStream(r){return __PRIVATE_canUseNetwork(r)&&!__PRIVATE_ensureWriteStream(r).M_()&&r.Pa.length>0}function __PRIVATE_startWriteStream(r){__PRIVATE_ensureWriteStream(r).start()}async function __PRIVATE_onWriteStreamOpen(r){__PRIVATE_ensureWriteStream(r).na()}async function __PRIVATE_onWriteHandshakeComplete(r){const e=__PRIVATE_ensureWriteStream(r);for(const t of r.Pa)e.X_(t.mutations)}async function __PRIVATE_onMutationResult(r,e,t){const n=r.Pa.shift(),i=MutationBatchResult.from(n,e,t);await __PRIVATE_executeWithRecovery(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await __PRIVATE_fillWritePipeline(r)}async function __PRIVATE_onWriteStreamClose(r,e){e&&__PRIVATE_ensureWriteStream(r).Z_&&await async function(n,i){if(function(a){return __PRIVATE_isPermanentError(a)&&a!==N.ABORTED}(i.code)){const s=n.Pa.shift();__PRIVATE_ensureWriteStream(n).N_(),await __PRIVATE_executeWithRecovery(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await __PRIVATE_fillWritePipeline(n)}}(r,e),__PRIVATE_shouldStartWriteStream(r)&&__PRIVATE_startWriteStream(r)}async function __PRIVATE_remoteStoreHandleCredentialChange(r,e){const t=__PRIVATE_debugCast(r);t.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug(Xt,"RemoteStore received new credentials");const n=__PRIVATE_canUseNetwork(t);t.Ia.add(3),await __PRIVATE_disableNetworkInternal(t),n&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await __PRIVATE_enableNetworkInternal(t)}async function __PRIVATE_remoteStoreApplyPrimaryState(r,e){const t=__PRIVATE_debugCast(r);e?(t.Ia.delete(2),await __PRIVATE_enableNetworkInternal(t)):e||(t.Ia.add(2),await __PRIVATE_disableNetworkInternal(t),t.Aa.set("Unknown"))}function __PRIVATE_ensureWatchStream(r){return r.Va||(r.Va=function(t,n,i){const s=__PRIVATE_debugCast(t);return s.ia(),new __PRIVATE_PersistentListenStream(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Zo:__PRIVATE_onWatchStreamConnected.bind(null,r),e_:__PRIVATE_onWatchStreamOpen.bind(null,r),n_:__PRIVATE_onWatchStreamClose.bind(null,r),J_:__PRIVATE_onWatchStreamChange.bind(null,r)}),r.da.push(async e=>{e?(r.Va.N_(),__PRIVATE_shouldStartWatchStream(r)?__PRIVATE_startWatchStream(r):r.Aa.set("Unknown")):(await r.Va.stop(),__PRIVATE_cleanUpWatchStreamState(r))})),r.Va}function __PRIVATE_ensureWriteStream(r){return r.ma||(r.ma=function(t,n,i){const s=__PRIVATE_debugCast(t);return s.ia(),new __PRIVATE_PersistentWriteStream(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{Zo:()=>Promise.resolve(),e_:__PRIVATE_onWriteStreamOpen.bind(null,r),n_:__PRIVATE_onWriteStreamClose.bind(null,r),ea:__PRIVATE_onWriteHandshakeComplete.bind(null,r),ta:__PRIVATE_onMutationResult.bind(null,r)}),r.da.push(async e=>{e?(r.ma.N_(),await __PRIVATE_fillWritePipeline(r)):(await r.ma.stop(),r.Pa.length>0&&(__PRIVATE_logDebug(Xt,`Stopping write stream with ${r.Pa.length} pending writes`),r.Pa=[]))})),r.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DelayedOperation{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new __PRIVATE_Deferred,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const a=Date.now()+n,o=new DelayedOperation(e,t,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new FirestoreError(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function __PRIVATE_wrapInUserErrorIfRecoverable(r,e){if(__PRIVATE_logError("AsyncQueue",`${e}: ${r}`),__PRIVATE_isIndexedDbTransactionError(r))return new FirestoreError(N.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSet{static emptySet(e){return new DocumentSet(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||DocumentKey.comparator(t.key,n.key):(t,n)=>DocumentKey.comparator(t.key,n.key),this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof DocumentSet)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new DocumentSet;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_DocumentChangeSet{constructor(){this.fa=new SortedMap(DocumentKey.comparator)}track(e){const t=e.doc.key,n=this.fa.get(t);n?e.type!==0&&n.type===3?this.fa=this.fa.insert(t,e):e.type===3&&n.type!==1?this.fa=this.fa.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.fa=this.fa.remove(t):e.type===1&&n.type===2?this.fa=this.fa.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):fail(63341,{At:e,ga:n}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal((t,n)=>{e.push(n)}),e}}class ViewSnapshot{constructor(e,t,n,i,s,a,o,c,h){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(e,t,n,i,s){const a=[];return t.forEach(o=>{a.push({type:0,doc:o})}),new ViewSnapshot(e,t,DocumentSet.emptySet(t),a,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&__PRIVATE_queryEquals(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_QueryListenersInfo{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class __PRIVATE_EventManagerImpl{constructor(){this.queries=__PRIVATE_newQueriesObjectMap(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,n){const i=__PRIVATE_debugCast(t),s=i.queries;i.queries=__PRIVATE_newQueriesObjectMap(),s.forEach((a,o)=>{for(const c of o.wa)c.onError(n)})})(this,new FirestoreError(N.ABORTED,"Firestore shutting down"))}}function __PRIVATE_newQueriesObjectMap(){return new ObjectMap(r=>__PRIVATE_canonifyQuery(r),__PRIVATE_queryEquals)}async function __PRIVATE_eventManagerListen(r,e){const t=__PRIVATE_debugCast(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.Sa()&&e.ba()&&(n=2):(s=new __PRIVATE_QueryListenersInfo,n=e.ba()?0:1);try{switch(n){case 0:s.ya=await t.onListen(i,!0);break;case 1:s.ya=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(a){const o=__PRIVATE_wrapInUserErrorIfRecoverable(a,`Initialization of query '${__PRIVATE_stringifyQuery(e.query)}' failed`);return void e.onError(o)}t.queries.set(i,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&__PRIVATE_raiseSnapshotsInSyncEvent(t)}async function __PRIVATE_eventManagerUnlisten(r,e){const t=__PRIVATE_debugCast(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const a=s.wa.indexOf(e);a>=0&&(s.wa.splice(a,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function __PRIVATE_eventManagerOnWatchChange(r,e){const t=__PRIVATE_debugCast(r);let n=!1;for(const i of e){const s=i.query,a=t.queries.get(s);if(a){for(const o of a.wa)o.Ca(i)&&(n=!0);a.ya=i}}n&&__PRIVATE_raiseSnapshotsInSyncEvent(t)}function __PRIVATE_eventManagerOnWatchError(r,e,t){const n=__PRIVATE_debugCast(r),i=n.queries.get(e);if(i)for(const s of i.wa)s.onError(t);n.queries.delete(e)}function __PRIVATE_raiseSnapshotsInSyncEvent(r){r.Da.forEach(e=>{e.next()})}var en,tn;(tn=en||(en={})).Fa="default",tn.Cache="cache";class __PRIVATE_QueryListener{constructor(e,t,n){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new ViewSnapshot(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const n=t!=="Offline";return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=ViewSnapshot.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==en.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AddedLimboDocument{constructor(e){this.key=e}}class __PRIVATE_RemovedLimboDocument{constructor(e){this.key=e}}class __PRIVATE_View{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=__PRIVATE_documentKeySet(),this.mutatedKeys=__PRIVATE_documentKeySet(),this.Xa=__PRIVATE_newQueryComparator(e),this.eu=new DocumentSet(this.Xa)}get tu(){return this.Ha}nu(e,t){const n=t?t.ru:new __PRIVATE_DocumentChangeSet,i=t?t.eu:this.eu;let s=t?t.mutatedKeys:this.mutatedKeys,a=i,o=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((f,m)=>{const g=i.get(f),_=__PRIVATE_queryMatches(this.query,m)?m:null,E=!!g&&this.mutatedKeys.has(g.key),A=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let C=!1;g&&_?g.data.isEqual(_.data)?E!==A&&(n.track({type:3,doc:_}),C=!0):this.iu(g,_)||(n.track({type:2,doc:_}),C=!0,(c&&this.Xa(_,c)>0||h&&this.Xa(_,h)<0)&&(o=!0)):!g&&_?(n.track({type:0,doc:_}),C=!0):g&&!_&&(n.track({type:1,doc:g}),C=!0,(c||h)&&(o=!0)),C&&(_?(a=a.add(_),s=A?s.add(f):s.delete(f)):(a=a.delete(f),s=s.delete(f)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const f=this.query.limitType==="F"?a.last():a.first();a=a.delete(f.key),s=s.delete(f.key),n.track({type:1,doc:f})}return{eu:a,ru:n,Ds:o,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const a=e.ru.pa();a.sort((f,m)=>function(_,E){const A=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fail(20277,{At:C})}};return A(_)-A(E)}(f.type,m.type)||this.Xa(f.doc,m.doc)),this.su(n),i=i!=null&&i;const o=t&&!i?this.ou():[],c=this.Za.size===0&&this.current&&!i?1:0,h=c!==this.Ya;return this.Ya=c,a.length!==0||h?{snapshot:new ViewSnapshot(this.query,e.eu,s,a,e.mutatedKeys,c===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:o}:{_u:o}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new __PRIVATE_DocumentChangeSet,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=__PRIVATE_documentKeySet(),this.eu.forEach(n=>{this.au(n.key)&&(this.Za=this.Za.add(n.key))});const t=[];return e.forEach(n=>{this.Za.has(n)||t.push(new __PRIVATE_RemovedLimboDocument(n))}),this.Za.forEach(n=>{e.has(n)||t.push(new __PRIVATE_AddedLimboDocument(n))}),t}uu(e){this.Ha=e.qs,this.Za=__PRIVATE_documentKeySet();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return ViewSnapshot.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const nn="SyncEngine";class __PRIVATE_QueryView{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class LimboResolution{constructor(e){this.key=e,this.lu=!1}}class __PRIVATE_SyncEngineImpl{constructor(e,t,n,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.hu={},this.Pu=new ObjectMap(o=>__PRIVATE_canonifyQuery(o),__PRIVATE_queryEquals),this.Tu=new Map,this.Iu=new Set,this.du=new SortedMap(DocumentKey.comparator),this.Eu=new Map,this.Au=new __PRIVATE_ReferenceSet,this.Ru={},this.Vu=new Map,this.mu=__PRIVATE_TargetIdGenerator.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function __PRIVATE_syncEngineListen(r,e,t=!0){const n=__PRIVATE_ensureWatchCallbacks(r);let i;const s=n.Pu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await __PRIVATE_allocateTargetAndMaybeListen(n,e,t,!0),i}async function __PRIVATE_triggerRemoteStoreListen(r,e){const t=__PRIVATE_ensureWatchCallbacks(r);await __PRIVATE_allocateTargetAndMaybeListen(t,e,!0,!1)}async function __PRIVATE_allocateTargetAndMaybeListen(r,e,t,n){const i=await __PRIVATE_localStoreAllocateTarget(r.localStore,__PRIVATE_queryToTarget(e)),s=i.targetId,a=r.sharedClientState.addLocalQueryTarget(s,t);let o;return n&&(o=await __PRIVATE_initializeViewAndComputeSnapshot(r,e,s,a==="current",i.resumeToken)),r.isPrimaryClient&&t&&__PRIVATE_remoteStoreListen(r.remoteStore,i),o}async function __PRIVATE_initializeViewAndComputeSnapshot(r,e,t,n,i){r.gu=(m,g,_)=>async function(A,C,I,b){let R=C.view.nu(I);R.Ds&&(R=await __PRIVATE_localStoreExecuteQuery(A.localStore,C.query,!1).then(({documents:j})=>C.view.nu(j,R)));const V=b&&b.targetChanges.get(C.targetId),U=b&&b.targetMismatches.get(C.targetId)!=null,W=C.view.applyChanges(R,A.isPrimaryClient,V,U);return __PRIVATE_updateTrackedLimbos(A,C.targetId,W._u),W.snapshot}(r,m,g,_);const s=await __PRIVATE_localStoreExecuteQuery(r.localStore,e,!0),a=new __PRIVATE_View(e,s.qs),o=a.nu(s.documents),c=TargetChange.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),h=a.applyChanges(o,r.isPrimaryClient,c);__PRIVATE_updateTrackedLimbos(r,t,h._u);const f=new __PRIVATE_QueryView(e,t,a);return r.Pu.set(e,f),r.Tu.has(t)?r.Tu.get(t).push(e):r.Tu.set(t,[e]),h.snapshot}async function __PRIVATE_syncEngineUnlisten(r,e,t){const n=__PRIVATE_debugCast(r),i=n.Pu.get(e),s=n.Tu.get(i.targetId);if(s.length>1)return n.Tu.set(i.targetId,s.filter(a=>!__PRIVATE_queryEquals(a,e))),void n.Pu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await __PRIVATE_localStoreReleaseTarget(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&__PRIVATE_remoteStoreUnlisten(n.remoteStore,i.targetId),__PRIVATE_removeAndCleanupTarget(n,i.targetId)}).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)):(__PRIVATE_removeAndCleanupTarget(n,i.targetId),await __PRIVATE_localStoreReleaseTarget(n.localStore,i.targetId,!0))}async function __PRIVATE_triggerRemoteStoreUnlisten(r,e){const t=__PRIVATE_debugCast(r),n=t.Pu.get(e),i=t.Tu.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),__PRIVATE_remoteStoreUnlisten(t.remoteStore,n.targetId))}async function __PRIVATE_syncEngineWrite(r,e,t){const n=__PRIVATE_syncEngineEnsureWriteCallbacks(r);try{const i=await function(a,o){const c=__PRIVATE_debugCast(a),h=Timestamp.now(),f=o.reduce((_,E)=>_.add(E.key),__PRIVATE_documentKeySet());let m,g;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=__PRIVATE_mutableDocumentMap(),A=__PRIVATE_documentKeySet();return c.Os.getEntries(_,f).next(C=>{E=C,E.forEach((I,b)=>{b.isValidDocument()||(A=A.add(I))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,E)).next(C=>{m=C;const I=[];for(const b of o){const R=__PRIVATE_mutationExtractBaseValue(b,m.get(b.key).overlayedDocument);R!=null&&I.push(new __PRIVATE_PatchMutation(b.key,R,__PRIVATE_extractFieldMask(R.value.mapValue),Precondition.exists(!0)))}return c.mutationQueue.addMutationBatch(_,h,I,o)}).next(C=>{g=C;const I=C.applyToLocalDocumentSet(m,A);return c.documentOverlayCache.saveOverlays(_,C.batchId,I)})}).then(()=>({batchId:g.batchId,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(m)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,c){let h=a.Ru[a.currentUser.toKey()];h||(h=new SortedMap(__PRIVATE_primitiveComparator)),h=h.insert(o,c),a.Ru[a.currentUser.toKey()]=h}(n,i.batchId,t),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(n,i.changes),await __PRIVATE_fillWritePipeline(n.remoteStore)}catch(i){const s=__PRIVATE_wrapInUserErrorIfRecoverable(i,"Failed to persist write");t.reject(s)}}async function __PRIVATE_syncEngineApplyRemoteEvent(r,e){const t=__PRIVATE_debugCast(r);try{const n=await __PRIVATE_localStoreApplyRemoteEventToLocalCache(t.localStore,e);e.targetChanges.forEach((i,s)=>{const a=t.Eu.get(s);a&&(__PRIVATE_hardAssert(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?a.lu=!0:i.modifiedDocuments.size>0?__PRIVATE_hardAssert(a.lu,14607):i.removedDocuments.size>0&&(__PRIVATE_hardAssert(a.lu,42227),a.lu=!1))}),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(t,n,e)}catch(n){await __PRIVATE_ignoreIfPrimaryLeaseLoss(n)}}function __PRIVATE_syncEngineApplyOnlineStateChange(r,e,t){const n=__PRIVATE_debugCast(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.Pu.forEach((s,a)=>{const o=a.view.va(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){const c=__PRIVATE_debugCast(a);c.onlineState=o;let h=!1;c.queries.forEach((f,m)=>{for(const g of m.wa)g.va(o)&&(h=!0)}),h&&__PRIVATE_raiseSnapshotsInSyncEvent(c)}(n.eventManager,e),i.length&&n.hu.J_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function __PRIVATE_syncEngineRejectListen(r,e,t){const n=__PRIVATE_debugCast(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Eu.get(e),s=i&&i.key;if(s){let a=new SortedMap(DocumentKey.comparator);a=a.insert(s,MutableDocument.newNoDocument(s,SnapshotVersion.min()));const o=__PRIVATE_documentKeySet().add(s),c=new RemoteEvent(SnapshotVersion.min(),new Map,new SortedMap(__PRIVATE_primitiveComparator),a,o);await __PRIVATE_syncEngineApplyRemoteEvent(n,c),n.du=n.du.remove(s),n.Eu.delete(e),__PRIVATE_pumpEnqueuedLimboResolutions(n)}else await __PRIVATE_localStoreReleaseTarget(n.localStore,e,!1).then(()=>__PRIVATE_removeAndCleanupTarget(n,e,t)).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)}async function __PRIVATE_syncEngineApplySuccessfulWrite(r,e){const t=__PRIVATE_debugCast(r),n=e.batch.batchId;try{const i=await __PRIVATE_localStoreAcknowledgeBatch(t.localStore,e);__PRIVATE_processUserCallback(t,n,null),__PRIVATE_triggerPendingWritesCallbacks(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(t,i)}catch(i){await __PRIVATE_ignoreIfPrimaryLeaseLoss(i)}}async function __PRIVATE_syncEngineRejectFailedWrite(r,e,t){const n=__PRIVATE_debugCast(r);try{const i=await function(a,o){const c=__PRIVATE_debugCast(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let f;return c.mutationQueue.lookupMutationBatch(h,o).next(m=>(__PRIVATE_hardAssert(m!==null,37113),f=m.keys(),c.mutationQueue.removeMutationBatch(h,m))).next(()=>c.mutationQueue.performConsistencyCheck(h)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(h,f,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f)).next(()=>c.localDocuments.getDocuments(h,f))})}(n.localStore,e);__PRIVATE_processUserCallback(n,e,t),__PRIVATE_triggerPendingWritesCallbacks(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(n,i)}catch(i){await __PRIVATE_ignoreIfPrimaryLeaseLoss(i)}}function __PRIVATE_triggerPendingWritesCallbacks(r,e){(r.Vu.get(e)||[]).forEach(t=>{t.resolve()}),r.Vu.delete(e)}function __PRIVATE_processUserCallback(r,e,t){const n=__PRIVATE_debugCast(r);let i=n.Ru[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Ru[n.currentUser.toKey()]=i}}function __PRIVATE_removeAndCleanupTarget(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Tu.get(e))r.Pu.delete(n),t&&r.hu.pu(n,t);r.Tu.delete(e),r.isPrimaryClient&&r.Au.zr(e).forEach(n=>{r.Au.containsKey(n)||__PRIVATE_removeLimboTarget(r,n)})}function __PRIVATE_removeLimboTarget(r,e){r.Iu.delete(e.path.canonicalString());const t=r.du.get(e);t!==null&&(__PRIVATE_remoteStoreUnlisten(r.remoteStore,t),r.du=r.du.remove(e),r.Eu.delete(t),__PRIVATE_pumpEnqueuedLimboResolutions(r))}function __PRIVATE_updateTrackedLimbos(r,e,t){for(const n of t)n instanceof __PRIVATE_AddedLimboDocument?(r.Au.addReference(n.key,e),__PRIVATE_trackLimboChange(r,n)):n instanceof __PRIVATE_RemovedLimboDocument?(__PRIVATE_logDebug(nn,"Document no longer in limbo: "+n.key),r.Au.removeReference(n.key,e),r.Au.containsKey(n.key)||__PRIVATE_removeLimboTarget(r,n.key)):fail(19791,{yu:n})}function __PRIVATE_trackLimboChange(r,e){const t=e.key,n=t.path.canonicalString();r.du.get(t)||r.Iu.has(n)||(__PRIVATE_logDebug(nn,"New document in limbo: "+t),r.Iu.add(n),__PRIVATE_pumpEnqueuedLimboResolutions(r))}function __PRIVATE_pumpEnqueuedLimboResolutions(r){for(;r.Iu.size>0&&r.du.size<r.maxConcurrentLimboResolutions;){const e=r.Iu.values().next().value;r.Iu.delete(e);const t=new DocumentKey(ResourcePath.fromString(e)),n=r.mu.next();r.Eu.set(n,new LimboResolution(t)),r.du=r.du.insert(t,n),__PRIVATE_remoteStoreListen(r.remoteStore,new TargetData(__PRIVATE_queryToTarget(__PRIVATE_newQueryForPath(t.path)),n,"TargetPurposeLimboResolution",__PRIVATE_ListenSequence.ue))}}async function __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(r,e,t){const n=__PRIVATE_debugCast(r),i=[],s=[],a=[];n.Pu.isEmpty()||(n.Pu.forEach((o,c)=>{a.push(n.gu(c,e,t).then(h=>{var f;if((h||t)&&n.isPrimaryClient){const m=h?!h.fromCache:(f=t==null?void 0:t.targetChanges.get(c.targetId))===null||f===void 0?void 0:f.current;n.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(h){i.push(h);const m=__PRIVATE_LocalViewChanges.Es(c.targetId,h);s.push(m)}}))}),await Promise.all(a),n.hu.J_(i),await async function(c,h){const f=__PRIVATE_debugCast(c);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>PersistencePromise.forEach(h,g=>PersistencePromise.forEach(g.Is,_=>f.persistence.referenceDelegate.addReference(m,g.targetId,_)).next(()=>PersistencePromise.forEach(g.ds,_=>f.persistence.referenceDelegate.removeReference(m,g.targetId,_)))))}catch(m){if(!__PRIVATE_isIndexedDbTransactionError(m))throw m;__PRIVATE_logDebug(Qt,"Failed to update sequence numbers: "+m)}for(const m of h){const g=m.targetId;if(!m.fromCache){const _=f.Fs.get(g),E=_.snapshotVersion,A=_.withLastLimboFreeSnapshotVersion(E);f.Fs=f.Fs.insert(g,A)}}}(n.localStore,s))}async function __PRIVATE_syncEngineHandleCredentialChange(r,e){const t=__PRIVATE_debugCast(r);if(!t.currentUser.isEqual(e)){__PRIVATE_logDebug(nn,"User change. New user:",e.toKey());const n=await __PRIVATE_localStoreHandleUserChange(t.localStore,e);t.currentUser=e,function(s,a){s.Vu.forEach(o=>{o.forEach(c=>{c.reject(new FirestoreError(N.CANCELLED,a))})}),s.Vu.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(t,n.Bs)}}function __PRIVATE_syncEngineGetRemoteKeysForTarget(r,e){const t=__PRIVATE_debugCast(r),n=t.Eu.get(e);if(n&&n.lu)return __PRIVATE_documentKeySet().add(n.key);{let i=__PRIVATE_documentKeySet();const s=t.Tu.get(e);if(!s)return i;for(const a of s){const o=t.Pu.get(a);i=i.unionWith(o.view.tu)}return i}}function __PRIVATE_ensureWatchCallbacks(r){const e=__PRIVATE_debugCast(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=__PRIVATE_syncEngineApplyRemoteEvent.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=__PRIVATE_syncEngineGetRemoteKeysForTarget.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=__PRIVATE_syncEngineRejectListen.bind(null,e),e.hu.J_=__PRIVATE_eventManagerOnWatchChange.bind(null,e.eventManager),e.hu.pu=__PRIVATE_eventManagerOnWatchError.bind(null,e.eventManager),e}function __PRIVATE_syncEngineEnsureWriteCallbacks(r){const e=__PRIVATE_debugCast(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=__PRIVATE_syncEngineApplySuccessfulWrite.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=__PRIVATE_syncEngineRejectFailedWrite.bind(null,e),e}class __PRIVATE_MemoryOfflineComponentProvider{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=__PRIVATE_newSerializer(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return __PRIVATE_newLocalStore(this.persistence,new __PRIVATE_QueryEngine,e.initialUser,this.serializer)}Du(e){return new __PRIVATE_MemoryPersistence(__PRIVATE_MemoryEagerDelegate.Vi,this.serializer)}bu(e){return new __PRIVATE_MemorySharedClientState}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}__PRIVATE_MemoryOfflineComponentProvider.provider={build:()=>new __PRIVATE_MemoryOfflineComponentProvider};class __PRIVATE_LruGcMemoryOfflineComponentProvider extends __PRIVATE_MemoryOfflineComponentProvider{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){__PRIVATE_hardAssert(this.persistence.referenceDelegate instanceof __PRIVATE_MemoryLruDelegate,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new __PRIVATE_LruScheduler(n,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?LruParams.withCacheSize(this.cacheSizeBytes):LruParams.DEFAULT;return new __PRIVATE_MemoryPersistence(n=>__PRIVATE_MemoryLruDelegate.Vi(n,t),this.serializer)}}class OnlineComponentProvider{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=__PRIVATE_syncEngineHandleCredentialChange.bind(null,this.syncEngine),await __PRIVATE_remoteStoreApplyPrimaryState(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new __PRIVATE_EventManagerImpl}()}createDatastore(e){const t=__PRIVATE_newSerializer(e.databaseInfo.databaseId),n=function(s){return new __PRIVATE_WebChannelConnection(s)}(e.databaseInfo);return function(s,a,o,c){return new __PRIVATE_DatastoreImpl(s,a,o,c)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,a,o){return new __PRIVATE_RemoteStoreImpl(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,t=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,t,0),function(){return __PRIVATE_BrowserConnectivityMonitor.C()?new __PRIVATE_BrowserConnectivityMonitor:new __PRIVATE_NoopConnectivityMonitor}())}createSyncEngine(e,t){return function(i,s,a,o,c,h,f){const m=new __PRIVATE_SyncEngineImpl(i,s,a,o,c,h);return f&&(m.fu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=__PRIVATE_debugCast(i);__PRIVATE_logDebug(Xt,"RemoteStore shutting down."),s.Ia.add(5),await __PRIVATE_disableNetworkInternal(s),s.Ea.shutdown(),s.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}OnlineComponentProvider.provider={build:()=>new OnlineComponentProvider};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __PRIVATE_AsyncObserver{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):__PRIVATE_logError("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn="FirestoreClient";class FirestoreClient{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=User.UNAUTHENTICATED,this.clientId=__PRIVATE_AutoId.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async a=>{__PRIVATE_logDebug(rn,"Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(__PRIVATE_logDebug(rn,"Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new __PRIVATE_Deferred;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=__PRIVATE_wrapInUserErrorIfRecoverable(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function __PRIVATE_setOfflineComponentProvider(r,e){r.asyncQueue.verifyOperationInProgress(),__PRIVATE_logDebug(rn,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await __PRIVATE_localStoreHandleUserChange(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>{__PRIVATE_logWarn("Terminating Firestore due to IndexedDb database deletion"),r.terminate().then(()=>{__PRIVATE_logDebug("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{__PRIVATE_logWarn("Terminating Firestore due to IndexedDb database deletion failed",i)})}),r._offlineComponents=e}async function __PRIVATE_setOnlineComponentProvider(r,e){r.asyncQueue.verifyOperationInProgress();const t=await __PRIVATE_ensureOfflineComponents(r);__PRIVATE_logDebug(rn,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>__PRIVATE_remoteStoreHandleCredentialChange(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>__PRIVATE_remoteStoreHandleCredentialChange(e.remoteStore,i)),r._onlineComponents=e}async function __PRIVATE_ensureOfflineComponents(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){__PRIVATE_logDebug(rn,"Using user provided OfflineComponentProvider");try{await __PRIVATE_setOfflineComponentProvider(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===N.FAILED_PRECONDITION||i.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;__PRIVATE_logWarn("Error using user provided cache. Falling back to memory cache: "+t),await __PRIVATE_setOfflineComponentProvider(r,new __PRIVATE_MemoryOfflineComponentProvider)}}else __PRIVATE_logDebug(rn,"Using default OfflineComponentProvider"),await __PRIVATE_setOfflineComponentProvider(r,new __PRIVATE_LruGcMemoryOfflineComponentProvider(void 0));return r._offlineComponents}async function __PRIVATE_ensureOnlineComponents(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(__PRIVATE_logDebug(rn,"Using user provided OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(r,r._uninitializedComponentsProvider._online)):(__PRIVATE_logDebug(rn,"Using default OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(r,new OnlineComponentProvider))),r._onlineComponents}function __PRIVATE_getSyncEngine(r){return __PRIVATE_ensureOnlineComponents(r).then(e=>e.syncEngine)}async function __PRIVATE_getEventManager(r){const e=await __PRIVATE_ensureOnlineComponents(r),t=e.eventManager;return t.onListen=__PRIVATE_syncEngineListen.bind(null,e.syncEngine),t.onUnlisten=__PRIVATE_syncEngineUnlisten.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=__PRIVATE_triggerRemoteStoreListen.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=__PRIVATE_triggerRemoteStoreUnlisten.bind(null,e.syncEngine),t}function __PRIVATE_firestoreClientGetDocumentViaSnapshotListener(r,e,t={}){const n=new __PRIVATE_Deferred;return r.asyncQueue.enqueueAndForget(async()=>function(s,a,o,c,h){const f=new __PRIVATE_AsyncObserver({next:g=>{f.Ou(),a.enqueueAndForget(()=>__PRIVATE_eventManagerUnlisten(s,m));const _=g.docs.has(o);!_&&g.fromCache?h.reject(new FirestoreError(N.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&g.fromCache&&c&&c.source==="server"?h.reject(new FirestoreError(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(g)},error:g=>h.reject(g)}),m=new __PRIVATE_QueryListener(__PRIVATE_newQueryForPath(o.path),f,{includeMetadataChanges:!0,ka:!0});return __PRIVATE_eventManagerListen(s,m)}(await __PRIVATE_getEventManager(r),r.asyncQueue,e,t,n)),n.promise}function __PRIVATE_firestoreClientGetDocumentsViaSnapshotListener(r,e,t={}){const n=new __PRIVATE_Deferred;return r.asyncQueue.enqueueAndForget(async()=>function(s,a,o,c,h){const f=new __PRIVATE_AsyncObserver({next:g=>{f.Ou(),a.enqueueAndForget(()=>__PRIVATE_eventManagerUnlisten(s,m)),g.fromCache&&c.source==="server"?h.reject(new FirestoreError(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(g)},error:g=>h.reject(g)}),m=new __PRIVATE_QueryListener(o,f,{includeMetadataChanges:!0,ka:!0});return __PRIVATE_eventManagerListen(s,m)}(await __PRIVATE_getEventManager(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_cloneLongPollingOptions(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on="firestore.googleapis.com",_n=!0;class FirestoreSettingsImpl{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new FirestoreError(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=on,this.ssl=_n}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:_n;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Mt;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ot)throw new FirestoreError(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}__PRIVATE_validateIsNotUsedTogether("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=__PRIVATE_cloneLongPollingOptions((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new FirestoreError(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Firestore$1{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FirestoreSettingsImpl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new FirestoreError(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new FirestoreError(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FirestoreSettingsImpl(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new __PRIVATE_EmptyAuthCredentialsProvider;switch(n.type){case"firstParty":return new __PRIVATE_FirstPartyAuthCredentialsProvider(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new FirestoreError(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=sn.get(t);n&&(__PRIVATE_logDebug("ComponentProvider","Removing Datastore"),sn.delete(t),n.terminate())}(this),Promise.resolve()}}function connectFirestoreEmulator(r,e,t,n={}){var i;r=__PRIVATE_cast(r,Firestore$1);const s=isCloudWorkstation(e),a=r._getSettings(),o=Object.assign(Object.assign({},a),{emulatorOptions:r._getEmulatorOptions()}),c=`${e}:${t}`;s&&(pingServer(`https://${c}`),updateEmulatorBanner("Firestore",!0)),a.host!==on&&a.host!==c&&__PRIVATE_logWarn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h=Object.assign(Object.assign({},a),{host:c,ssl:s,emulatorOptions:n});if(!deepEqual(h,o)&&(r._setSettings(h),n.mockUserToken)){let f,m;if(typeof n.mockUserToken=="string")f=n.mockUserToken,m=User.MOCK_USER;else{f=createMockUserToken(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new FirestoreError(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new User(g)}r._authCredentials=new __PRIVATE_EmulatorAuthCredentialsProvider(new __PRIVATE_OAuthToken(f,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Query{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Query(this.firestore,e,this._query)}}class DocumentReference{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new CollectionReference(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new DocumentReference(this.firestore,e,this._key)}toJSON(){return{type:DocumentReference._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(__PRIVATE_validateJSON(t,DocumentReference._jsonSchema))return new DocumentReference(e,n||null,new DocumentKey(ResourcePath.fromString(t.referencePath)))}}DocumentReference._jsonSchemaVersion="firestore/documentReference/1.0",DocumentReference._jsonSchema={type:property("string",DocumentReference._jsonSchemaVersion),referencePath:property("string")};class CollectionReference extends Query{constructor(e,t,n){super(e,t,__PRIVATE_newQueryForPath(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new DocumentReference(this.firestore,null,new DocumentKey(e))}withConverter(e){return new CollectionReference(this.firestore,e,this._path)}}function collection(r,e,...t){if(r=getModularInstance(r),__PRIVATE_validateNonEmptyArgument("collection","path",e),r instanceof Firestore$1){const n=ResourcePath.fromString(e,...t);return __PRIVATE_validateCollectionPath(n),new CollectionReference(r,null,n)}{if(!(r instanceof DocumentReference||r instanceof CollectionReference))throw new FirestoreError(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(ResourcePath.fromString(e,...t));return __PRIVATE_validateCollectionPath(n),new CollectionReference(r.firestore,null,n)}}function collectionGroup(r,e){if(r=__PRIVATE_cast(r,Firestore$1),__PRIVATE_validateNonEmptyArgument("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Query(r,null,function(n){return new __PRIVATE_QueryImpl(ResourcePath.emptyPath(),n)}(e))}function doc(r,e,...t){if(r=getModularInstance(r),arguments.length===1&&(e=__PRIVATE_AutoId.newId()),__PRIVATE_validateNonEmptyArgument("doc","path",e),r instanceof Firestore$1){const n=ResourcePath.fromString(e,...t);return __PRIVATE_validateDocumentPath(n),new DocumentReference(r,null,new DocumentKey(n))}{if(!(r instanceof DocumentReference||r instanceof CollectionReference))throw new FirestoreError(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(ResourcePath.fromString(e,...t));return __PRIVATE_validateDocumentPath(n),new DocumentReference(r.firestore,r instanceof CollectionReference?r.converter:null,new DocumentKey(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const an="AsyncQueue";class __PRIVATE_AsyncQueueImpl{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new __PRIVATE_ExponentialBackoff(this,"async_queue_retry"),this.oc=()=>{const n=getDocument();n&&__PRIVATE_logDebug(an,"Visibility state changed to "+n.visibilityState),this.F_.y_()},this._c=e;const t=getDocument();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=getDocument();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const t=new __PRIVATE_Deferred;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;__PRIVATE_logDebug(an,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const t=this._c.then(()=>(this.nc=!0,e().catch(n=>{throw this.tc=n,this.nc=!1,__PRIVATE_logError("INTERNAL UNHANDLED ERROR: ",__PRIVATE_getMessageOrStack(n)),n}).then(n=>(this.nc=!1,n))));return this._c=t,t}enqueueAfterDelay(e,t,n){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const i=DelayedOperation.createAndSchedule(this,e,t,n,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&fail(47125,{hc:__PRIVATE_getMessageOrStack(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function __PRIVATE_getMessageOrStack(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_isPartialObserver(r){return function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}class Firestore extends Firestore$1{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new __PRIVATE_AsyncQueueImpl,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new __PRIVATE_AsyncQueueImpl(e),this._firestoreClient=void 0,await e}}}function getFirestore(r,e){const t=typeof r=="object"?r:getApp(),n=typeof r=="string"?r:ut,i=_getProvider(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=getDefaultEmulatorHostnameAndPort("firestore");s&&connectFirestoreEmulator(i,...s)}return i}function ensureFirestoreConfigured(r){if(r._terminated)throw new FirestoreError(N.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||__PRIVATE_configureFirestore(r),r._firestoreClient}function __PRIVATE_configureFirestore(r){var e,t,n;const i=r._freezeSettings(),s=function(o,c,h,f){return new DatabaseInfo(o,c,h,f.host,f.ssl,f.experimentalForceLongPolling,f.experimentalAutoDetectLongPolling,__PRIVATE_cloneLongPollingOptions(f.experimentalLongPollingOptions),f.useFetchStreams,f.isUsingEmulator)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new FirestoreClient(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(o){const c=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(c),_online:c}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bytes{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bytes(ByteString.fromBase64String(e))}catch(t){throw new FirestoreError(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Bytes(ByteString.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Bytes._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(__PRIVATE_validateJSON(e,Bytes._jsonSchema))return Bytes.fromBase64String(e.bytes)}}Bytes._jsonSchemaVersion="firestore/bytes/1.0",Bytes._jsonSchema={type:property("string",Bytes._jsonSchemaVersion),bytes:property("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldPath{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new FieldPath$1(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FieldValue{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GeoPoint{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new FirestoreError(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new FirestoreError(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return __PRIVATE_primitiveComparator(this._lat,e._lat)||__PRIVATE_primitiveComparator(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:GeoPoint._jsonSchemaVersion}}static fromJSON(e){if(__PRIVATE_validateJSON(e,GeoPoint._jsonSchema))return new GeoPoint(e.latitude,e.longitude)}}GeoPoint._jsonSchemaVersion="firestore/geoPoint/1.0",GeoPoint._jsonSchema={type:property("string",GeoPoint._jsonSchemaVersion),latitude:property("number"),longitude:property("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VectorValue{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}toJSON(){return{type:VectorValue._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(__PRIVATE_validateJSON(e,VectorValue._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new VectorValue(e.vectorValues);throw new FirestoreError(N.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}VectorValue._jsonSchemaVersion="firestore/vectorValue/1.0",VectorValue._jsonSchema={type:property("string",VectorValue._jsonSchemaVersion),vectorValues:property("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn=/^__.*__$/;class ParsedSetData{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,t,this.fieldTransforms):new __PRIVATE_SetMutation(e,this.data,t,this.fieldTransforms)}}class ParsedUpdateData{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function __PRIVATE_isWrite(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fail(40011,{Ec:r})}}class __PRIVATE_ParseContextImpl{constructor(e,t,n,i,s,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new __PRIVATE_ParseContextImpl(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:n,mc:!1});return i.fc(e),i}gc(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:n,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return __PRIVATE_createError(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(__PRIVATE_isWrite(this.Ec)&&cn.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class __PRIVATE_UserDataReader{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||__PRIVATE_newSerializer(e)}Dc(e,t,n,i=!1){return new __PRIVATE_ParseContextImpl({Ec:e,methodName:t,bc:n,path:FieldPath$1.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function __PRIVATE_newUserDataReader(r){const e=r._freezeSettings(),t=__PRIVATE_newSerializer(r._databaseId);return new __PRIVATE_UserDataReader(r._databaseId,!!e.ignoreUndefinedProperties,t)}function __PRIVATE_parseSetData(r,e,t,n,i,s={}){const a=r.Dc(s.merge||s.mergeFields?2:0,e,t,i);__PRIVATE_validatePlainObject("Data must be an object, but it was:",a,n);const o=__PRIVATE_parseObject(n,a);let c,h;if(s.merge)c=new FieldMask(a.fieldMask),h=a.fieldTransforms;else if(s.mergeFields){const f=[];for(const m of s.mergeFields){const g=__PRIVATE_fieldPathFromArgument$1(e,m,t);if(!a.contains(g))throw new FirestoreError(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);__PRIVATE_fieldMaskContains(f,g)||f.push(g)}c=new FieldMask(f),h=a.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,h=a.fieldTransforms;return new ParsedSetData(new ObjectValue(o),c,h)}class __PRIVATE_DeleteFieldValueImpl extends FieldValue{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof __PRIVATE_DeleteFieldValueImpl}}class __PRIVATE_ServerTimestampFieldValueImpl extends FieldValue{_toFieldTransform(e){return new FieldTransform(e.path,new __PRIVATE_ServerTimestampTransform)}isEqual(e){return e instanceof __PRIVATE_ServerTimestampFieldValueImpl}}function __PRIVATE_parseUpdateData(r,e,t,n){const i=r.Dc(1,e,t);__PRIVATE_validatePlainObject("Data must be an object, but it was:",i,n);const s=[],a=ObjectValue.empty();forEach(n,(c,h)=>{const f=__PRIVATE_fieldPathFromDotSeparatedString(e,c,t);h=getModularInstance(h);const m=i.gc(f);if(h instanceof __PRIVATE_DeleteFieldValueImpl)s.push(f);else{const g=__PRIVATE_parseData(h,m);g!=null&&(s.push(f),a.set(f,g))}});const o=new FieldMask(s);return new ParsedUpdateData(a,o,i.fieldTransforms)}function __PRIVATE_parseUpdateVarargs(r,e,t,n,i,s){const a=r.Dc(1,e,t),o=[__PRIVATE_fieldPathFromArgument$1(e,n,t)],c=[i];if(s.length%2!=0)throw new FirestoreError(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)o.push(__PRIVATE_fieldPathFromArgument$1(e,s[g])),c.push(s[g+1]);const h=[],f=ObjectValue.empty();for(let g=o.length-1;g>=0;--g)if(!__PRIVATE_fieldMaskContains(h,o[g])){const _=o[g];let E=c[g];E=getModularInstance(E);const A=a.gc(_);if(E instanceof __PRIVATE_DeleteFieldValueImpl)h.push(_);else{const C=__PRIVATE_parseData(E,A);C!=null&&(h.push(_),f.set(_,C))}}const m=new FieldMask(h);return new ParsedUpdateData(f,m,a.fieldTransforms)}function __PRIVATE_parseQueryValue(r,e,t,n=!1){return __PRIVATE_parseData(t,r.Dc(n?4:3,e))}function __PRIVATE_parseData(r,e){if(__PRIVATE_looksLikeJsonObject(r=getModularInstance(r)))return __PRIVATE_validatePlainObject("Unsupported field value:",e,r),__PRIVATE_parseObject(r,e);if(r instanceof FieldValue)return function(n,i){if(!__PRIVATE_isWrite(i.Ec))throw i.wc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(n,i){const s=[];let a=0;for(const o of n){let c=__PRIVATE_parseData(o,i.yc(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=getModularInstance(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return toNumber(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Timestamp.fromDate(n);return{timestampValue:toTimestamp(i.serializer,s)}}if(n instanceof Timestamp){const s=new Timestamp(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:toTimestamp(i.serializer,s)}}if(n instanceof GeoPoint)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Bytes)return{bytesValue:__PRIVATE_toBytes(i.serializer,n._byteString)};if(n instanceof DocumentReference){const s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.wc(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:__PRIVATE_toResourceName(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof VectorValue)return function(a,o){return{mapValue:{fields:{[ct]:{stringValue:Pt},[Tt]:{arrayValue:{values:a.toArray().map(h=>{if(typeof h!="number")throw o.wc("VectorValues must only contain numeric values.");return __PRIVATE_toDouble(o.serializer,h)})}}}}}}(n,i);throw i.wc(`Unsupported field value: ${__PRIVATE_valueDescription(n)}`)}(r,e)}function __PRIVATE_parseObject(r,e){const t={};return isEmpty(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):forEach(r,(n,i)=>{const s=__PRIVATE_parseData(i,e.Vc(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function __PRIVATE_looksLikeJsonObject(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Timestamp||r instanceof GeoPoint||r instanceof Bytes||r instanceof DocumentReference||r instanceof FieldValue||r instanceof VectorValue)}function __PRIVATE_validatePlainObject(r,e,t){if(!__PRIVATE_looksLikeJsonObject(t)||!__PRIVATE_isPlainObject(t)){const n=__PRIVATE_valueDescription(t);throw n==="an object"?e.wc(r+" a custom object"):e.wc(r+" "+n)}}function __PRIVATE_fieldPathFromArgument$1(r,e,t){if((e=getModularInstance(e))instanceof FieldPath)return e._internalPath;if(typeof e=="string")return __PRIVATE_fieldPathFromDotSeparatedString(r,e);throw __PRIVATE_createError("Field path arguments must be of type string or ",r,!1,void 0,t)}const ln=new RegExp("[~\\*/\\[\\]]");function __PRIVATE_fieldPathFromDotSeparatedString(r,e,t){if(e.search(ln)>=0)throw __PRIVATE_createError(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new FieldPath(...e.split("."))._internalPath}catch{throw __PRIVATE_createError(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function __PRIVATE_createError(r,e,t,n,i){const s=n&&!n.isEmpty(),a=i!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${n}`),a&&(c+=` in document ${i}`),c+=")"),new FirestoreError(N.INVALID_ARGUMENT,o+r+c)}function __PRIVATE_fieldMaskContains(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DocumentSnapshot$1{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new DocumentReference(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QueryDocumentSnapshot$1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class QueryDocumentSnapshot$1 extends DocumentSnapshot$1{data(){return super.data()}}function __PRIVATE_fieldPathFromArgument(r,e){return typeof e=="string"?__PRIVATE_fieldPathFromDotSeparatedString(r,e):e instanceof FieldPath?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateHasExplicitOrderByForLimitToLast(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new FirestoreError(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class AppliableConstraint{}class QueryConstraint extends AppliableConstraint{}function query(r,e,...t){let n=[];e instanceof AppliableConstraint&&n.push(e),n=n.concat(t),function(s){const a=s.filter(c=>c instanceof QueryCompositeFilterConstraint).length,o=s.filter(c=>c instanceof QueryFieldFilterConstraint).length;if(a>1||a>0&&o>0)throw new FirestoreError(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class QueryFieldFilterConstraint extends QueryConstraint{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new QueryFieldFilterConstraint(e,t,n)}_apply(e){const t=this._parse(e);return __PRIVATE_validateNewFieldFilter(e._query,t),new Query(e.firestore,e.converter,__PRIVATE_queryWithAddedFilter(e._query,t))}_parse(e){const t=__PRIVATE_newUserDataReader(e.firestore);return function(s,a,o,c,h,f,m){let g;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){__PRIVATE_validateDisjunctiveFilterElements(m,f);const E=[];for(const A of m)E.push(__PRIVATE_parseDocumentIdValue(c,s,A));g={arrayValue:{values:E}}}else g=__PRIVATE_parseDocumentIdValue(c,s,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||__PRIVATE_validateDisjunctiveFilterElements(m,f),g=__PRIVATE_parseQueryValue(o,a,m,f==="in"||f==="not-in");return FieldFilter.create(h,f,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function where(r,e,t){const n=e,i=__PRIVATE_fieldPathFromArgument("where",r);return QueryFieldFilterConstraint._create(i,n,t)}class QueryCompositeFilterConstraint extends AppliableConstraint{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new QueryCompositeFilterConstraint(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:CompositeFilter.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i;const o=s.getFlattenedFilters();for(const c of o)__PRIVATE_validateNewFieldFilter(a,c),a=__PRIVATE_queryWithAddedFilter(a,c)}(e._query,t),new Query(e.firestore,e.converter,__PRIVATE_queryWithAddedFilter(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class QueryOrderByConstraint extends QueryConstraint{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new QueryOrderByConstraint(e,t)}_apply(e){const t=function(i,s,a){if(i.startAt!==null)throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new OrderBy(s,a)}(e._query,this._field,this._direction);return new Query(e.firestore,e.converter,function(i,s){const a=i.explicitOrderBy.concat([s]);return new __PRIVATE_QueryImpl(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function orderBy(r,e="asc"){const t=e,n=__PRIVATE_fieldPathFromArgument("orderBy",r);return QueryOrderByConstraint._create(n,t)}class QueryLimitConstraint extends QueryConstraint{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new QueryLimitConstraint(e,t,n)}_apply(e){return new Query(e.firestore,e.converter,__PRIVATE_queryWithLimit(e._query,this._limit,this._limitType))}}function limit(r){return __PRIVATE_validatePositiveNumber("limit",r),QueryLimitConstraint._create("limit",r,"F")}function __PRIVATE_parseDocumentIdValue(r,e,t){if(typeof(t=getModularInstance(t))=="string"){if(t==="")throw new FirestoreError(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!__PRIVATE_isCollectionGroupQuery(e)&&t.indexOf("/")!==-1)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(ResourcePath.fromString(t));if(!DocumentKey.isDocumentKey(n))throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return __PRIVATE_refValue(r,new DocumentKey(n))}if(t instanceof DocumentReference)return __PRIVATE_refValue(r,t._key);throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${__PRIVATE_valueDescription(t)}.`)}function __PRIVATE_validateDisjunctiveFilterElements(r,e){if(!Array.isArray(r)||r.length===0)throw new FirestoreError(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function __PRIVATE_validateNewFieldFilter(r,e){const t=function(i,s){for(const a of i)for(const o of a.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new FirestoreError(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class AbstractUserDataWriter{convertValue(e,t="none"){switch(__PRIVATE_typeOrder(e)){case 0:return null;case 1:return e.booleanValue;case 2:return __PRIVATE_normalizeNumber(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(__PRIVATE_normalizeByteString(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw fail(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return forEach(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;const s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t[Tt].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(a=>__PRIVATE_normalizeNumber(a.doubleValue));return new VectorValue(s)}convertGeoPoint(e){return new GeoPoint(__PRIVATE_normalizeNumber(e.latitude),__PRIVATE_normalizeNumber(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=__PRIVATE_getPreviousValue(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(__PRIVATE_getLocalWriteTime(e));default:return null}}convertTimestamp(e){const t=__PRIVATE_normalizeTimestamp(e);return new Timestamp(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=ResourcePath.fromString(e);__PRIVATE_hardAssert(__PRIVATE_isValidResourceName(n),9688,{name:e});const i=new DatabaseId(n.get(1),n.get(3)),s=new DocumentKey(n.popFirst(5));return i.isEqual(t)||__PRIVATE_logError(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_applyFirestoreDataConverter(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class SnapshotMetadata{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class DocumentSnapshot extends DocumentSnapshot$1{constructor(e,t,n,i,s,a){super(e,t,n,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new QueryDocumentSnapshot(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(__PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new FirestoreError(N.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=DocumentSnapshot._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}DocumentSnapshot._jsonSchemaVersion="firestore/documentSnapshot/1.0",DocumentSnapshot._jsonSchema={type:property("string",DocumentSnapshot._jsonSchemaVersion),bundleSource:property("string","DocumentSnapshot"),bundleName:property("string"),bundle:property("string")};class QueryDocumentSnapshot extends DocumentSnapshot{data(e={}){return super.data(e)}}class QuerySnapshot{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new SnapshotMetadata(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new QueryDocumentSnapshot(this._firestore,this._userDataWriter,n.key,n,new SnapshotMetadata(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new FirestoreError(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(o=>{const c=new QueryDocumentSnapshot(i._firestore,i._userDataWriter,o.doc.key,o.doc,new SnapshotMetadata(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);return o.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const c=new QueryDocumentSnapshot(i._firestore,i._userDataWriter,o.doc.key,o.doc,new SnapshotMetadata(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,f=-1;return o.type!==0&&(h=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),f=a.indexOf(o.doc.key)),{type:__PRIVATE_resultChangeType(o.type),doc:c,oldIndex:h,newIndex:f}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new FirestoreError(N.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=QuerySnapshot._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=__PRIVATE_AutoId.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),n.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function __PRIVATE_resultChangeType(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fail(61501,{type:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getDoc(r){r=__PRIVATE_cast(r,DocumentReference);const e=__PRIVATE_cast(r.firestore,Firestore);return __PRIVATE_firestoreClientGetDocumentViaSnapshotListener(ensureFirestoreConfigured(e),r._key).then(t=>__PRIVATE_convertToDocSnapshot(e,r,t))}QuerySnapshot._jsonSchemaVersion="firestore/querySnapshot/1.0",QuerySnapshot._jsonSchema={type:property("string",QuerySnapshot._jsonSchemaVersion),bundleSource:property("string","QuerySnapshot"),bundleName:property("string"),bundle:property("string")};class __PRIVATE_ExpUserDataWriter extends AbstractUserDataWriter{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bytes(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new DocumentReference(this.firestore,null,t)}}function getDocs(r){r=__PRIVATE_cast(r,Query);const e=__PRIVATE_cast(r.firestore,Firestore),t=ensureFirestoreConfigured(e),n=new __PRIVATE_ExpUserDataWriter(e);return __PRIVATE_validateHasExplicitOrderByForLimitToLast(r._query),__PRIVATE_firestoreClientGetDocumentsViaSnapshotListener(t,r._query).then(i=>new QuerySnapshot(e,n,r,i))}function setDoc(r,e,t){r=__PRIVATE_cast(r,DocumentReference);const n=__PRIVATE_cast(r.firestore,Firestore),i=__PRIVATE_applyFirestoreDataConverter(r.converter,e,t);return executeWrite(n,[__PRIVATE_parseSetData(__PRIVATE_newUserDataReader(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,Precondition.none())])}function updateDoc(r,e,t,...n){r=__PRIVATE_cast(r,DocumentReference);const i=__PRIVATE_cast(r.firestore,Firestore),s=__PRIVATE_newUserDataReader(i);let a;return a=typeof(e=getModularInstance(e))=="string"||e instanceof FieldPath?__PRIVATE_parseUpdateVarargs(s,"updateDoc",r._key,e,t,n):__PRIVATE_parseUpdateData(s,"updateDoc",r._key,e),executeWrite(i,[a.toMutation(r._key,Precondition.exists(!0))])}function deleteDoc(r){return executeWrite(__PRIVATE_cast(r.firestore,Firestore),[new __PRIVATE_DeleteMutation(r._key,Precondition.none())])}function addDoc(r,e){const t=__PRIVATE_cast(r.firestore,Firestore),n=doc(r),i=__PRIVATE_applyFirestoreDataConverter(r.converter,e);return executeWrite(t,[__PRIVATE_parseSetData(__PRIVATE_newUserDataReader(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,Precondition.exists(!1))]).then(()=>n)}function onSnapshot(r,...e){var t,n,i;r=getModularInstance(r);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||__PRIVATE_isPartialObserver(e[a])||(s=e[a++]);const o={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(__PRIVATE_isPartialObserver(e[a])){const m=e[a];e[a]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[a+1]=(n=m.error)===null||n===void 0?void 0:n.bind(m),e[a+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let c,h,f;if(r instanceof DocumentReference)h=__PRIVATE_cast(r.firestore,Firestore),f=__PRIVATE_newQueryForPath(r._key.path),c={next:m=>{e[a]&&e[a](__PRIVATE_convertToDocSnapshot(h,r,m))},error:e[a+1],complete:e[a+2]};else{const m=__PRIVATE_cast(r,Query);h=__PRIVATE_cast(m.firestore,Firestore),f=m._query;const g=new __PRIVATE_ExpUserDataWriter(h);c={next:_=>{e[a]&&e[a](new QuerySnapshot(h,g,m,_))},error:e[a+1],complete:e[a+2]},__PRIVATE_validateHasExplicitOrderByForLimitToLast(r._query)}return function(g,_,E,A){const C=new __PRIVATE_AsyncObserver(A),I=new __PRIVATE_QueryListener(_,C,E);return g.asyncQueue.enqueueAndForget(async()=>__PRIVATE_eventManagerListen(await __PRIVATE_getEventManager(g),I)),()=>{C.Ou(),g.asyncQueue.enqueueAndForget(async()=>__PRIVATE_eventManagerUnlisten(await __PRIVATE_getEventManager(g),I))}}(ensureFirestoreConfigured(h),f,o,c)}function executeWrite(r,e){return function(n,i){const s=new __PRIVATE_Deferred;return n.asyncQueue.enqueueAndForget(async()=>__PRIVATE_syncEngineWrite(await __PRIVATE_getSyncEngine(n),i,s)),s.promise}(ensureFirestoreConfigured(r),e)}function __PRIVATE_convertToDocSnapshot(r,e,t){const n=t.docs.get(e._key),i=new __PRIVATE_ExpUserDataWriter(r);return new DocumentSnapshot(r,i,e._key,n,new SnapshotMetadata(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WriteBatch{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=__PRIVATE_newUserDataReader(e)}set(e,t,n){this._verifyNotCommitted();const i=__PRIVATE_validateReference(e,this._firestore),s=__PRIVATE_applyFirestoreDataConverter(i.converter,t,n),a=__PRIVATE_parseSetData(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(a.toMutation(i._key,Precondition.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=__PRIVATE_validateReference(e,this._firestore);let a;return a=typeof(t=getModularInstance(t))=="string"||t instanceof FieldPath?__PRIVATE_parseUpdateVarargs(this._dataReader,"WriteBatch.update",s._key,t,n,i):__PRIVATE_parseUpdateData(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Precondition.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=__PRIVATE_validateReference(e,this._firestore);return this._mutations=this._mutations.concat(new __PRIVATE_DeleteMutation(t._key,Precondition.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new FirestoreError(N.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function __PRIVATE_validateReference(r,e){if((r=getModularInstance(r)).firestore!==e)throw new FirestoreError(N.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}function serverTimestamp(){return new __PRIVATE_ServerTimestampFieldValueImpl("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function writeBatch(r){return ensureFirestoreConfigured(r=__PRIVATE_cast(r,Firestore)),new WriteBatch(r,e=>executeWrite(r,e))}(function(e,t=!0){(function(i){x=i})(SDK_VERSION),_registerComponent(new Component("firestore",(n,{instanceIdentifier:i,options:s})=>{const a=n.getProvider("app").getImmediate(),o=new Firestore(new __PRIVATE_FirebaseAuthCredentialsProvider(n.getProvider("auth-internal")),new __PRIVATE_FirebaseAppCheckTokenProvider(a,n.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new FirestoreError(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new DatabaseId(h.options.projectId,f)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),registerVersion(F,M,e),registerVersion(F,M,"esm2017")})();const firebaseConfig={apiKey:"AIzaSyBg60nFX2rmrW66n3lPeXRLTfMhjlgFrEE",authDomain:"project-01-bookmemo-prod.firebaseapp.com",projectId:"project-01-bookmemo-prod",storageBucket:"project-01-bookmemo-prod.firebasestorage.app",messagingSenderId:"414976225343",appId:"1:414976225343:web:31244d8c1ffe3b6f89088a"},app=initializeApp(firebaseConfig),auth=getAuth(app),db=getFirestore(app),AuthContext=reactExports.createContext();function AuthProvider({children:r}){const[e,t]=reactExports.useState(null),[n,i]=reactExports.useState(!0);return reactExports.useEffect(()=>{const s=onAuthStateChanged(auth,a=>{t(a),i(!1)});return()=>s()},[]),jsxRuntimeExports.jsx(AuthContext.Provider,{value:{user:e,loading:n},children:r})}function useAuth(){return reactExports.useContext(AuthContext)}function Login(){const[r,e]=reactExports.useState(""),[t,n]=reactExports.useState(""),[i,s]=reactExports.useState(""),[a,o]=reactExports.useState(!1),c=useNavigate(),h=async f=>{if(f.preventDefault(),!a){o(!0),s("");try{await signInWithEmailAndPassword(auth,r,t),c("/")}catch(m){s(m.message)}finally{o(!1)}}};return jsxRuntimeExports.jsxs(Box,{component:"form",onSubmit:h,sx:{maxWidth:400,mx:"auto",mt:8},children:[jsxRuntimeExports.jsx(Typography,{variant:"h5",align:"center",gutterBottom:!0,"data-testid":"login-title",children:"ログイン"}),jsxRuntimeExports.jsx(TextField,{label:"メールアドレス",type:"email",value:r,onChange:f=>e(f.target.value),fullWidth:!0,margin:"normal",required:!0,inputProps:{"data-testid":"login-email-input"}}),jsxRuntimeExports.jsx(TextField,{label:"パスワード",type:"password",value:t,onChange:f=>n(f.target.value),fullWidth:!0,margin:"normal",required:!0,inputProps:{"data-testid":"login-password-input"}}),i&&jsxRuntimeExports.jsx(Typography,{color:"error",children:i}),jsxRuntimeExports.jsx(Button,{type:"submit",variant:"contained",fullWidth:!0,sx:{mt:2},"data-testid":"login-submit",disabled:a,children:a?"ログイン中...":"ログイン"})]})}function Signup(){const[r,e]=reactExports.useState(""),[t,n]=reactExports.useState(""),[i,s]=reactExports.useState(""),[a,o]=reactExports.useState(!1),c=async h=>{if(h.preventDefault(),!a){o(!0),s("");try{await createUserWithEmailAndPassword(auth,r,t)}catch(f){s(f.message)}finally{o(!1)}}};return jsxRuntimeExports.jsxs(Box,{component:"form",onSubmit:c,sx:{maxWidth:400,mx:"auto",mt:8},children:[jsxRuntimeExports.jsx(Typography,{variant:"h5",align:"center",gutterBottom:!0,children:"新規登録"}),jsxRuntimeExports.jsx(TextField,{label:"メールアドレス",type:"email",value:r,onChange:h=>e(h.target.value),fullWidth:!0,margin:"normal",required:!0}),jsxRuntimeExports.jsx(TextField,{label:"パスワード",type:"password",value:t,onChange:h=>n(h.target.value),fullWidth:!0,margin:"normal",required:!0}),i&&jsxRuntimeExports.jsx(Typography,{color:"error",children:i}),jsxRuntimeExports.jsx(Button,{type:"submit",variant:"contained",fullWidth:!0,sx:{mt:2},disabled:a,children:a?"登録中...":"新規登録"})]})}const BOOK_STATUS={TSUNDOKU:"tsundoku",READING:"reading",RE_READING:"re-reading",FINISHED:"finished"},ACQUISITION_TYPE={BOUGHT:"bought",BORROWED:"borrowed",GIFT:"gift",UNKNOWN:"unknown"},BOOK_STATUS_LABELS={[BOOK_STATUS.TSUNDOKU]:"積読",[BOOK_STATUS.READING]:"読書中",[BOOK_STATUS.RE_READING]:"再読中",[BOOK_STATUS.FINISHED]:"読了"},ACQUISITION_TYPE_LABELS={[ACQUISITION_TYPE.BOUGHT]:"購入",[ACQUISITION_TYPE.BORROWED]:"借り物",[ACQUISITION_TYPE.GIFT]:"プレゼント",[ACQUISITION_TYPE.UNKNOWN]:"不明"},BOOK_STATUS_COLORS={[BOOK_STATUS.TSUNDOKU]:"default",[BOOK_STATUS.READING]:"primary",[BOOK_STATUS.RE_READING]:"secondary",[BOOK_STATUS.FINISHED]:"success"},DEFAULT_BOOK_STATUS=BOOK_STATUS.TSUNDOKU,ALL_BOOK_STATUSES=[BOOK_STATUS.TSUNDOKU,BOOK_STATUS.READING,BOOK_STATUS.RE_READING,BOOK_STATUS.FINISHED],ALL_ACQUISITION_TYPES=[ACQUISITION_TYPE.BOUGHT,ACQUISITION_TYPE.BORROWED,ACQUISITION_TYPE.GIFT,ACQUISITION_TYPE.UNKNOWN],FILTER_STATUSES={ALL:"all",TSUNDOKU:BOOK_STATUS.TSUNDOKU,READING:BOOK_STATUS.READING,RE_READING:BOOK_STATUS.RE_READING,FINISHED:BOOK_STATUS.FINISHED},FILTER_LABELS={[FILTER_STATUSES.ALL]:"すべて",[FILTER_STATUSES.TSUNDOKU]:"積読",[FILTER_STATUSES.READING]:"読書中",[FILTER_STATUSES.RE_READING]:"再読中",[FILTER_STATUSES.FINISHED]:"読了"},isValidBookStatus=r=>ALL_BOOK_STATUSES.includes(r),getBookStatusLabel=r=>BOOK_STATUS_LABELS[r]||BOOK_STATUS_LABELS[DEFAULT_BOOK_STATUS],getBookStatusColor=r=>BOOK_STATUS_COLORS[r]||BOOK_STATUS_COLORS[DEFAULT_BOOK_STATUS],getAcquisitionTypeLabel=r=>ACQUISITION_TYPE_LABELS[r]||ACQUISITION_TYPE_LABELS[ACQUISITION_TYPE.UNKNOWN];function BookCard({book:r,onClick:e,testId:t}){return jsxRuntimeExports.jsx(Card,{sx:{cursor:"pointer","&:hover":{boxShadow:3},height:"100%",display:"flex",flexDirection:"column",minHeight:{xs:"140px",sm:"160px"}},onClick:e,"data-testid":t||`book-card-${r.id}`,children:jsxRuntimeExports.jsx(CardContent,{sx:{flex:1,display:"flex",flexDirection:"column",p:{xs:1.5,sm:2},"&:last-child":{pb:{xs:1.5,sm:2}}},children:jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"flex-start",gap:{xs:1.5,sm:2},height:"100%"},children:[r.coverImageUrl&&jsxRuntimeExports.jsx(CardMedia,{component:"img",sx:{width:{xs:50,sm:60},height:{xs:70,sm:80},objectFit:"cover",flexShrink:0,borderRadius:1},image:r.coverImageUrl,alt:r.title}),jsxRuntimeExports.jsxs(Box,{sx:{flex:1,minWidth:0,display:"flex",flexDirection:"column",height:"100%"},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",component:"h3",gutterBottom:!0,sx:{fontSize:{xs:"0.9rem",sm:"1rem",md:"1.1rem"},lineHeight:1.2,fontWeight:600,mb:.5,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:r.title||"タイトル未設定"}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.75rem",sm:"0.8rem",md:"0.9rem"},mb:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:r.author||"著者未設定"}),jsxRuntimeExports.jsx(Box,{sx:{mb:1},children:jsxRuntimeExports.jsx(Chip,{label:getBookStatusLabel(r.status||DEFAULT_BOOK_STATUS),color:getBookStatusColor(r.status||DEFAULT_BOOK_STATUS),size:"small",sx:{fontSize:{xs:"0.65rem",sm:"0.7rem",md:"0.75rem"},height:{xs:"18px",sm:"20px",md:"22px"},"& .MuiChip-label":{px:{xs:.5,sm:.75}}}})}),(r.publisher||r.publishedDate)&&jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"text.secondary",sx:{fontSize:{xs:"0.7rem",sm:"0.75rem",md:"0.8rem"},mb:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[r.publisher," ",r.publisher&&r.publishedDate&&"•"," ",r.publishedDate]}),jsxRuntimeExports.jsx(Box,{sx:{minHeight:{xs:"32px",sm:"36px"},mb:1,display:"flex",flexWrap:"wrap",gap:.5},children:r.tags&&r.tags.length>0?r.tags.slice(0,3).map((n,i)=>jsxRuntimeExports.jsx(Chip,{label:n,size:"small",variant:"outlined",sx:{fontSize:{xs:"0.65rem",sm:"0.7rem",md:"0.75rem"},height:{xs:"18px",sm:"20px",md:"22px"},"& .MuiChip-label":{px:{xs:.5,sm:.75}}}},i)):jsxRuntimeExports.jsx(Typography,{variant:"caption",color:"text.secondary",sx:{fontSize:{xs:"0.65rem",sm:"0.7rem",md:"0.75rem"},alignSelf:"center"},children:"タグなし"})}),jsxRuntimeExports.jsxs(Typography,{variant:"caption",color:"text.secondary",sx:{mt:"auto",fontSize:{xs:"0.65rem",sm:"0.7rem",md:"0.75rem"},fontWeight:500},children:["ステータス: ",getBookStatusLabel(r.status||DEFAULT_BOOK_STATUS)]})]})]})})})}const PageHeader=({title:r,subtitle:e,children:t})=>jsxRuntimeExports.jsxs(Paper,{elevation:0,"data-testid":"page-header",sx:{background:`
          linear-gradient(135deg, rgba(139, 69, 19, 0.9) 0%, rgba(160, 82, 45, 0.8) 100%),
          repeating-linear-gradient(
            45deg,
            transparent,
            transparent 4px,
            rgba(139, 69, 19, 0.1) 4px,
            rgba(139, 69, 19, 0.1) 8px
          ),
          linear-gradient(135deg, #8B4513 0%, #A0522D 50%, #CD853F 100%)
        `,backgroundSize:"cover, 16px 16px, cover",backgroundRepeat:"no-repeat, repeat, no-repeat",backgroundPosition:"center, center, center",borderRadius:0,mb:3,position:"relative",overflow:"hidden",borderBottom:"3px solid rgba(139, 69, 19, 0.3)"},children:[jsxRuntimeExports.jsxs(Box,{sx:{p:{xs:2,sm:3,md:4},textAlign:"center",color:"white",position:"relative",zIndex:1},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",component:"h1","data-testid":"page-header-title",sx:{fontWeight:700,fontSize:{xs:"1.5rem",sm:"2rem",md:"2.5rem"},mb:e?1:0,textShadow:"0 2px 4px rgba(0,0,0,0.7)",color:"#FFF8DC"},children:r}),e&&jsxRuntimeExports.jsx(Typography,{variant:"body1","data-testid":"page-header-subtitle",sx:{opacity:.95,fontSize:{xs:"0.9rem",sm:"1rem"},textShadow:"0 1px 2px rgba(0,0,0,0.7)",color:"#F5F5DC"},children:e}),t&&jsxRuntimeExports.jsx(Box,{sx:{mt:2},children:t})]}),jsxRuntimeExports.jsx(Box,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,background:`
            radial-gradient(circle at 30% 70%, rgba(255,255,255,0.15) 0%, transparent 40%),
            radial-gradient(circle at 70% 30%, rgba(255,255,255,0.1) 0%, transparent 30%)
          `,pointerEvents:"none"}})]}),ErrorDialogContext=React.createContext({setGlobalError:()=>{}}),CommonErrorDialog=({open:r,message:e,onClose:t})=>jsxRuntimeExports.jsxs(Dialog,{open:r,onClose:t,maxWidth:"xs",fullWidth:!0,disableEscapeKeyDown:!1,disableBackdropClick:!1,children:[jsxRuntimeExports.jsx(DialogTitle,{sx:{color:"error.main",fontWeight:"bold"},children:"エラーが発生しました"}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(Alert,{severity:"error",sx:{mb:2},children:e})}),jsxRuntimeExports.jsx(DialogActions,{sx:{justifyContent:"center",pb:2},children:jsxRuntimeExports.jsx(Button,{onClick:t,color:"error",variant:"contained",autoFocus:!0,children:"閉じる"})})]}),ErrorDialogProvider=({children:r})=>{const[e,t]=reactExports.useState(null),n=s=>{t(s)},i=()=>{t(null)};return jsxRuntimeExports.jsxs(ErrorDialogContext.Provider,{value:{setGlobalError:n},children:[r,e&&jsxRuntimeExports.jsx(CommonErrorDialog,{open:!!e,message:e,onClose:i})]})};function normalizeTag$1(r){return r?(t=>t.replace(/[Ａ-Ｚａ-ｚ０-９]/g,n=>String.fromCharCode(n.charCodeAt(0)-65248)))(String(r)).toLowerCase():""}function filterBooks(r,e,t){return Array.isArray(r)?r.filter(i=>{if(e!==FILTER_STATUSES.ALL&&(i.status||DEFAULT_BOOK_STATUS)!==e)return!1;if(!t||!String(t).trim())return!0;const s=normalizeTag$1(t);return i.title&&normalizeTag$1(i.title).includes(s)||i.author&&normalizeTag$1(i.author).includes(s)||Array.isArray(i.tags)&&i.tags.some(a=>normalizeTag$1(a).includes(s))}):[]}function computeBookStats(r,e){const t=Array.isArray(r)?r:[],n=t.length,i=s=>t.filter(a=>(a.status||DEFAULT_BOOK_STATUS)===s).length;return{total:n,tsundoku:i(BOOK_STATUS.TSUNDOKU),reading:i(BOOK_STATUS.READING),reReading:i(BOOK_STATUS.RE_READING),finished:i(BOOK_STATUS.FINISHED),filtered:Array.isArray(e)?e.length:0}}const useBookList=()=>{try{if(typeof React>"u"||!React.useState)return{allBooks:[],filteredBooks:[],stats:{total:0,tsundoku:0,reading:0,reReading:0,finished:0,filtered:0},loading:!1,error:null,filter:FILTER_STATUSES.READING,searchText:"",fetchBooks:async()=>{},handleFilterChange:()=>{},handleSearchChange:()=>{},clearSearch:()=>{},clearFilter:()=>{},normalizeTag:()=>""}}catch(V){return console.warn("React context not available in useBookList:",V),{allBooks:[],filteredBooks:[],stats:{total:0,reading:0,finished:0,filtered:0},loading:!1,error:null,filter:"reading",searchText:"",fetchBooks:async()=>{},handleFilterChange:()=>{},handleSearchChange:()=>{},clearSearch:()=>{},clearFilter:()=>{},normalizeTag:()=>""}}const{user:r}=useAuth(),e=reactExports.useContext(ErrorDialogContext),t=(e==null?void 0:e.setGlobalError)||(()=>{}),[n,i]=reactExports.useState([]),[s,a]=reactExports.useState(!0),[o,c]=reactExports.useState(null),[h,f]=reactExports.useState(FILTER_STATUSES.READING),[m,g]=reactExports.useState(""),_=reactExports.useCallback(async()=>{if(!r){i([]),a(!1);return}try{a(!0),c(null);const V=query(collection(db,"books"),where("userId","==",r.uid),orderBy("updatedAt","desc")),W=(await getDocs(V)).docs.map(j=>({id:j.id,...j.data()}));i(W)}catch(V){console.error("Error fetching books:",V),t("書籍一覧の取得に失敗しました。"),c("書籍一覧の取得に失敗しました。")}finally{a(!1)}},[r,t]),E=reactExports.useCallback((V,U)=>{f(U)},[]),A=reactExports.useCallback(V=>{g(V.target.value)},[]),C=reactExports.useCallback(()=>{g("")},[]),I=reactExports.useCallback(()=>{f(FILTER_STATUSES.READING)},[]),b=filterBooks(n,h,m),R=computeBookStats(n,b);return reactExports.useEffect(()=>{_()},[r==null?void 0:r.uid]),{allBooks:n,filteredBooks:b,stats:R,loading:s,error:o,filter:h,searchText:m,fetchBooks:_,handleFilterChange:E,handleSearchChange:A,clearSearch:C,clearFilter:I,normalizeTag:normalizeTag$1}};var define_process_env_default$2={};const isProduction=()=>typeof process<"u"&&define_process_env_default$2?!0:typeof window<"u"&&window.location?window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1":!1,getBasePath=()=>isProduction()?"/project-01-bookmemo":"",buildPath=r=>{const e=getBasePath(),t=r.startsWith("/")?r:`/${r}`;return`${e}${t}`},PATHS={MANIFEST:()=>buildPath("/manifest.webmanifest"),SW_JS:()=>buildPath("/sw.js"),VITE_SVG:()=>buildPath("/vite.svg"),PAPER_TEXTURE:()=>buildPath("/paper-texture.jpg"),ICON_192:()=>buildPath("/icons/icon-192x192.png"),ICON_512:()=>buildPath("/icons/icon-512x512.png"),APPLE_TOUCH_ICON:()=>buildPath("/icons/apple-touch-icon.png"),APPLE_TOUCH_ICON_512:()=>buildPath("/icons/apple-touch-icon-512x512.png"),ROOT:()=>buildPath("/"),ADD:()=>buildPath("/add"),SEARCH:()=>buildPath("/search"),IS_PRODUCTION:isProduction,IS_DEVELOPMENT:()=>!isProduction()},usePWA=()=>{try{if(typeof React>"u"||!React.useState)return{isOnline:!0,isInstallable:!1,isInstalled:!1,swRegistration:null,userEngagement:0,lastVisitTime:null,shouldShowInstallPrompt:!1,shouldShowManualInstallGuide:!1,registerServiceWorker:async()=>null,installApp:async()=>{},requestNotificationPermission:async()=>"denied",sendNotification:()=>null,checkForUpdates:async()=>{},clearCache:async()=>{},reloadApp:()=>{},recordInstallPromptDismiss:()=>{}}}catch(P){return console.warn("React context not available in usePWA:",P),{isOnline:!0,isInstallable:!1,isInstalled:!1,swRegistration:null,userEngagement:0,lastVisitTime:null,shouldShowInstallPrompt:!1,shouldShowManualInstallGuide:!1,registerServiceWorker:async()=>null,installApp:async()=>{},requestNotificationPermission:async()=>"denied",sendNotification:()=>null,checkForUpdates:async()=>{},clearCache:async()=>{},reloadApp:()=>{},recordInstallPromptDismiss:()=>{}}}if(!(typeof window<"u"&&typeof navigator<"u"&&"serviceWorker"in navigator&&"PushManager"in window&&!PATHS.IS_DEVELOPMENT()))return{isOnline:!0,isInstallable:!1,isInstalled:!1,swRegistration:null,userEngagement:0,lastVisitTime:null,shouldShowInstallPrompt:!1,shouldShowManualInstallGuide:!1,registerServiceWorker:async()=>null,installApp:async()=>{},requestNotificationPermission:async()=>"denied",sendNotification:()=>null,checkForUpdates:async()=>{},clearCache:async()=>{},reloadApp:()=>{},recordInstallPromptDismiss:()=>{}};const[e,t]=reactExports.useState(navigator.onLine),[n,i]=reactExports.useState(null),[s,a]=reactExports.useState(null),[o,c]=reactExports.useState(!1),[h,f]=reactExports.useState(!1),[m,g]=reactExports.useState(0),[_,E]=reactExports.useState(null);reactExports.useEffect(()=>{const P=()=>t(!0),K=()=>t(!1);return window.addEventListener("online",P),window.addEventListener("offline",K),()=>{window.removeEventListener("online",P),window.removeEventListener("offline",K)}},[]),reactExports.useEffect(()=>{if(typeof window>"u")return;const P=()=>{g(X=>X+1)},K=["click","scroll","keydown","touchstart"];return K.forEach(X=>{window.addEventListener(X,P,{passive:!0})}),()=>{K.forEach(X=>{window.removeEventListener(X,P)})}},[]),reactExports.useEffect(()=>{if(typeof localStorage>"u")return;const P=Date.now(),K=localStorage.getItem("bookmemo_last_visit");if(K){if(P-parseInt(K)>1440*60*1e3){const Y=parseInt(localStorage.getItem("bookmemo_visit_count")||"0")+1;localStorage.setItem("bookmemo_visit_count",Y.toString())}}else localStorage.setItem("bookmemo_visit_count","1");localStorage.setItem("bookmemo_last_visit",P.toString()),E(P)},[]);const A=reactExports.useCallback(async()=>{if(PATHS.IS_DEVELOPMENT())return console.log("Service Worker registration skipped in development environment"),null;try{const P=PATHS.SW_JS(),K=await navigator.serviceWorker.register(P);return i(K),console.log("Service Worker registered:",K),K.addEventListener("updatefound",()=>{const X=K.installing;X&&X.addEventListener("statechange",()=>{X.state==="installed"&&navigator.serviceWorker.controller&&console.log("New Service Worker available")})}),K}catch(P){return console.error("Service Worker registration failed:",P),console.warn("Service Worker registration failed, but app will continue without PWA features"),null}},[]);reactExports.useEffect(()=>{if(typeof window>"u"||typeof localStorage>"u")return;const P=Y=>{Y.preventDefault(),a(Y),c(!0)},K=()=>{f(!0),c(!1),a(null),console.log("PWA was installed"),localStorage.setItem("bookmemo_installed","true"),localStorage.setItem("bookmemo_install_date",Date.now().toString())};return window.addEventListener("beforeinstallprompt",P),window.addEventListener("appinstalled",K),localStorage.getItem("bookmemo_installed")==="true"&&(f(!0),c(!1)),()=>{window.removeEventListener("beforeinstallprompt",P),window.removeEventListener("appinstalled",K)}},[]);const C=reactExports.useCallback(async()=>{if(s){s.prompt();const{outcome:P}=await s.userChoice;console.log(P==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),a(null),c(!1)}},[s]),I=reactExports.useCallback(()=>{if(h||!o)return!1;const P=parseInt(localStorage.getItem("bookmemo_visit_count")||"0"),K=parseInt(localStorage.getItem("bookmemo_dismiss_count")||"0");return P>=1&&m>=5&&K<3},[h,o,m]),b=reactExports.useCallback(()=>{if(h)return!1;const P=/iPad|iPhone|iPod/.test(navigator.userAgent),K=/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent);return P&&K},[h]),R=reactExports.useCallback(()=>{if(typeof localStorage>"u")return;const P=parseInt(localStorage.getItem("bookmemo_dismiss_count")||"0")+1;localStorage.setItem("bookmemo_dismiss_count",P.toString())},[]),V=reactExports.useCallback(async()=>{if(typeof window>"u"||!("Notification"in window))return"denied";try{return await Notification.requestPermission()}catch(P){return console.warn("Notification permission request failed:",P),"denied"}},[]),U=reactExports.useCallback((P,K={})=>{if(typeof window>"u"||!("Notification"in window)||Notification.permission!=="granted")return null;try{const X=PATHS.ICON_192();return new Notification(P,{icon:X,badge:X,...K})}catch(X){return console.warn("Notification send failed:",X),null}},[]),W=reactExports.useCallback(async()=>{n&&await n.update()},[n]),j=reactExports.useCallback(async()=>{if(!(typeof window>"u"||!("caches"in window)))try{const P=await caches.keys();await Promise.all(P.map(K=>caches.delete(K)))}catch(P){console.warn("Cache clear failed:",P)}},[]),w=reactExports.useCallback(()=>{window.location.reload()},[]);return{isOnline:e,isInstallable:o,isInstalled:h,swRegistration:n,userEngagement:m,lastVisitTime:_,shouldShowInstallPrompt:I(),shouldShowManualInstallGuide:b(),registerServiceWorker:A,installApp:C,requestNotificationPermission:V,sendNotification:U,checkForUpdates:W,clearCache:j,reloadApp:w,recordInstallPromptDismiss:R}};function BookList(){const r=useNavigate(),{isInstallable:e,isInstalled:t,installApp:n,shouldShowManualInstallGuide:i}=usePWA(),{filteredBooks:s,loading:a,error:o,filter:c,searchText:h,handleFilterChange:f,handleSearchChange:m}=useBookList(),g=A=>{r(`/book/${A}`)},_=async()=>{try{await n()}catch(A){console.error("Installation failed:",A)}},E=()=>{const A=/iPad|iPhone|iPod/.test(navigator.userAgent),C=/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent);A&&C&&alert(`📱 BookMemoをホーム画面に追加する手順：

1. 共有ボタンをタップ
   Safariの下部にある「共有」ボタン（□↑）をタップ

2. 「ホーム画面に追加」を選択
   共有メニューから「ホーム画面に追加」を選択

3. 追加を確認
   「追加」をタップしてホーム画面に追加

これでBookMemoをアプリとして使用できます！`)};return a?jsxRuntimeExports.jsx("div",{children:"Loading..."}):jsxRuntimeExports.jsxs(Box,{sx:{maxWidth:1200,mx:"auto",pb:{xs:"72px",sm:"80px"}},children:[jsxRuntimeExports.jsx(PageHeader,{title:"本一覧",subtitle:"あなたの読書ライブラリ","data-testid":"book-list-header"}),jsxRuntimeExports.jsxs(Box,{sx:{px:{xs:1.5,sm:2,md:0}},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",gap:1,flexWrap:"wrap",mb:2},children:[e&&!t&&jsxRuntimeExports.jsx(Tooltip,{title:"BookMemoをアプリとしてインストール",children:jsxRuntimeExports.jsx(IconButton,{color:"primary",onClick:_,sx:{backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}},"data-testid":"pwa-install-header-button",children:jsxRuntimeExports.jsx(InstallIcon,{})})}),i&&!t&&jsxRuntimeExports.jsx(Tooltip,{title:"iPhoneでホーム画面に追加する手順を表示",children:jsxRuntimeExports.jsx(IconButton,{color:"secondary",onClick:E,sx:{backgroundColor:"secondary.main",color:"white","&:hover":{backgroundColor:"secondary.dark"}},"data-testid":"pwa-manual-install-button",children:jsxRuntimeExports.jsx(InstallIcon,{})})})]}),jsxRuntimeExports.jsx(Box,{sx:{display:"flex",justifyContent:"center",mb:3},children:jsxRuntimeExports.jsx(Button,{variant:"contained","data-testid":"book-add-button",onClick:()=>r("/add"),sx:{fontSize:{xs:"0.9rem",sm:"1rem"},py:{xs:1,sm:1.5},px:{xs:2,sm:3}},children:"本を追加"})}),jsxRuntimeExports.jsx(TextField,{label:"検索（タイトル・著者・タグ）",value:h,onChange:m,fullWidth:!0,size:"small",sx:{mb:{xs:1.5,sm:2},"& .MuiOutlinedInput-root":{fontSize:{xs:"0.9rem",sm:"1rem"}}}}),jsxRuntimeExports.jsx(Box,{sx:{borderBottom:1,borderColor:"divider",mb:{xs:1.5,sm:2},position:"sticky",top:0,zIndex:1100,backgroundColor:"background.paper"},"data-testid":"book-list-tabs-container",style:{position:"sticky",top:0,zIndex:1100},children:jsxRuntimeExports.jsxs(Tabs,{value:c,onChange:f,variant:{xs:"scrollable",sm:"standard"},scrollButtons:"auto",allowScrollButtonsMobile:!0,centered:{sm:!0},sx:{"& .MuiTab-root":{fontSize:{xs:"0.8rem",sm:"0.9rem"},minHeight:{xs:"40px",sm:"48px"},minWidth:{xs:"60px",sm:"auto"},px:{xs:1,sm:2}},"& .MuiTabs-scrollButtons":{"&.Mui-disabled":{opacity:.3}}},children:[jsxRuntimeExports.jsx(Tab,{label:FILTER_LABELS[FILTER_STATUSES.ALL],value:FILTER_STATUSES.ALL}),jsxRuntimeExports.jsx(Tab,{label:FILTER_LABELS[FILTER_STATUSES.TSUNDOKU],value:FILTER_STATUSES.TSUNDOKU}),jsxRuntimeExports.jsx(Tab,{label:FILTER_LABELS[FILTER_STATUSES.READING],value:FILTER_STATUSES.READING}),jsxRuntimeExports.jsx(Tab,{label:FILTER_LABELS[FILTER_STATUSES.RE_READING],value:FILTER_STATUSES.RE_READING}),jsxRuntimeExports.jsx(Tab,{label:FILTER_LABELS[FILTER_STATUSES.FINISHED],value:FILTER_STATUSES.FINISHED})]})}),s.length===0?jsxRuntimeExports.jsx(Box,{sx:{textAlign:"center",py:{xs:3,sm:4},px:{xs:2,sm:0}},children:jsxRuntimeExports.jsx(Typography,{variant:"body1",color:"text.secondary",sx:{fontSize:{xs:"0.9rem",sm:"1rem"}},children:"該当する本がありません"})}):jsxRuntimeExports.jsx(Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",md:"repeat(3, 1fr)",lg:"repeat(4, 1fr)"},gap:{xs:1.5,sm:2},dataTestid:"book-list-grid"},"data-testid":"book-list-grid",children:s.map(A=>jsxRuntimeExports.jsx(Box,{"data-testid":`book-grid-item-${A.id}`,children:jsxRuntimeExports.jsx(BookCard,{book:A,onClick:()=>g(A.id),testId:`book-list-card-${A.id}`})},A.id))})]})]})}const useTagHistory=(r,e)=>{const[t,n]=reactExports.useState([]),[i,s]=reactExports.useState(!1),a=reactExports.useCallback(async()=>{if(e!=null&&e.uid)try{s(!0);const h=r==="book"?"bookTagHistory":"memoTagHistory",f=query(collection(db,"users",e.uid,h),orderBy("updatedAt","desc")),m=await getDocs(f),g=[];m.forEach(_=>{const E=_.data();E.tag&&g.push(E.tag)}),n(g)}catch(h){throw console.error("タグ履歴の取得に失敗しました:",h),h}finally{s(!1)}},[e==null?void 0:e.uid,r]),o=reactExports.useCallback(async h=>{if(!(!(e!=null&&e.uid)||!h))try{const f=r==="book"?"bookTagHistory":"memoTagHistory",m=doc(db,"users",e.uid,f,h);await setDoc(m,{tag:h,updatedAt:serverTimestamp()})}catch(f){throw console.error("タグ履歴の保存に失敗しました:",f),f}},[e==null?void 0:e.uid,r]),c=reactExports.useCallback(async h=>{if(!(!(e!=null&&e.uid)||!h||h.length===0))try{const f=h.map(m=>{const g=r==="book"?"bookTagHistory":"memoTagHistory",_=doc(db,"users",e.uid,g,m);return setDoc(_,{tag:m,updatedAt:serverTimestamp()})});await Promise.all(f)}catch(f){throw console.error("タグ履歴の一括保存に失敗しました:",f),f}},[e==null?void 0:e.uid,r]);return{tagOptions:t,loading:i,fetchTagHistory:a,saveTagToHistory:o,saveTagsToHistory:c}},useBookActions=()=>{const{user:r}=useAuth(),e=reactExports.useContext(ErrorDialogContext),t=(e==null?void 0:e.setGlobalError)||(()=>{}),[n,i]=reactExports.useState(!1),[s,a]=reactExports.useState(null),{saveTagsToHistory:o}=useTagHistory("book",r),c=reactExports.useCallback(async f=>{if(!r)throw new Error("ユーザーが認証されていません。");if(!f.title)throw new Error("タイトルは必須です。");try{i(!0),a(null);let m=(f.tags||[]).filter(_=>_&&_.trim()!=="");f.inputTagValue&&!m.includes(f.inputTagValue.trim())&&(m=[...m,f.inputTagValue.trim()]),m=m.filter(_=>_&&_.trim()!=="");const g=await addDoc(collection(db,"books"),{userId:r.uid,isbn:f.isbn||"",title:f.title,author:f.author||"",publisher:f.publisher||"",publishedDate:f.publishedDate||"",coverImageUrl:f.coverImageUrl||"",tags:m,status:f.status||DEFAULT_BOOK_STATUS,acquisitionType:f.acquisitionType||"unknown",createdAt:serverTimestamp(),updatedAt:serverTimestamp()});return m.length>0&&await o(m),g.id}catch(m){console.error("Error adding book:",m);const g="書籍の追加に失敗しました: "+m.message;throw t(g),a(g),m}finally{i(!1)}},[r,t,o]),h=reactExports.useCallback(()=>{a(null)},[]);return{addBook:c,loading:n,error:s,clearError:h}},useBookSearch=()=>{const{user:r}=useAuth(),e=reactExports.useContext(ErrorDialogContext),t=(e==null?void 0:e.setGlobalError)||(()=>{}),[n,i]=reactExports.useState(!1),[s,a]=reactExports.useState(""),[o,c]=reactExports.useState(!1),h=reactExports.useCallback(async g=>{if(!g||!g.trim())return a("ISBNを入力してください"),null;a(""),i(!0),c(!0);try{const _=g.trim(),A=(await axios.get(`https://api.openbd.jp/v1/get?isbn=${_}`)).data[0];let C="",I="",b="",R="",V="",U=[];if(A&&A.summary&&(C=A.summary.title||"",I=A.summary.author||"",b=A.summary.publisher||"",R=A.summary.pubdate||"",V=A.summary.cover||"",A.summary.subject&&U.push(A.summary.subject),A.summary.ndc&&U.push(A.summary.ndc)),!V||!C)try{const j=(await axios.get(`https://www.googleapis.com/books/v1/volumes?q=isbn:${_}`)).data;if(j.items&&j.items.length>0){const w=j.items[0].volumeInfo;C||(C=w.title||""),I||(I=w.authors?w.authors.join(", "):""),b||(b=w.publisher||""),R||(R=w.publishedDate||""),!V&&w.imageLinks&&(V=w.imageLinks.thumbnail||w.imageLinks.smallThumbnail||""),w.categories&&w.categories.length>0&&(U=[...U,...w.categories])}}catch(W){console.error("Failed to fetch from Google Books API",W)}return C?{isbn:_,title:C,author:I,publisher:b,publishedDate:R,coverImageUrl:V,tags:Array.from(new Set(U))}:(t("書籍情報が見つかりませんでした"),null)}catch{const E="書籍情報の取得に失敗しました";return t(E),a(E),null}finally{i(!1)}},[t]),f=reactExports.useCallback(()=>{a(null)},[]),m=reactExports.useCallback(()=>{c(!1),a(null)},[]);return{searchBookByIsbn:h,loading:n,error:s,searchPerformed:o,clearError:f,clearSearch:m}};var define_process_env_default$1={};const useExternalBookSearch=()=>{const[searchResults,setSearchResults]=reactExports.useState([]),[loading,setLoading]=reactExports.useState(!1),[loadingStep,setLoadingStep]=reactExports.useState(""),[error,setError]=reactExports.useState(null),[searchHistory,setSearchHistory]=reactExports.useState([]),[filters,setFilters]=reactExports.useState({author:"",publisher:"",yearFrom:"",yearTo:""}),loadSearchHistory=reactExports.useCallback(()=>{try{const r=localStorage.getItem("bookSearchHistory");if(r){const e=JSON.parse(r);setSearchHistory(Array.isArray(e)?e:[])}}catch(r){console.warn("Failed to load search history:",r),setSearchHistory([])}},[]),saveSearchHistory=reactExports.useCallback(r=>{try{localStorage.setItem("bookSearchHistory",JSON.stringify(r))}catch(e){console.warn("Failed to save search history:",e)}},[]),addToSearchHistory=reactExports.useCallback((r,e)=>{if(!r||r.trim().length<2)return;const t={query:r.trim(),searchType:e,timestamp:Date.now()};setSearchHistory(n=>{const i=n.filter(a=>!(a.query===t.query&&a.searchType===t.searchType)),s=[t,...i].slice(0,10);return saveSearchHistory(s),s})},[saveSearchHistory]),removeFromSearchHistory=reactExports.useCallback(r=>{setSearchHistory(e=>{const t=e.filter((n,i)=>i!==r);return saveSearchHistory(t),t})},[saveSearchHistory]),clearSearchHistory=reactExports.useCallback(()=>{setSearchHistory([]),saveSearchHistory([])},[saveSearchHistory]),applyFilters=reactExports.useCallback(r=>!r||r.length===0?r:r.filter(e=>{if(filters.author&&e.author&&!e.author.toLowerCase().includes(filters.author.toLowerCase())||filters.publisher&&e.publisher&&!e.publisher.toLowerCase().includes(filters.publisher.toLowerCase()))return!1;if(filters.yearFrom||filters.yearTo){const t=e.publishedDate?parseInt(e.publishedDate.split("-")[0]):null;if(t){if(filters.yearFrom&&t<parseInt(filters.yearFrom)||filters.yearTo&&t>parseInt(filters.yearTo))return!1}else return!1}return!0}),[filters]),updateFilters=reactExports.useCallback(r=>{setFilters(e=>({...e,...r}))},[]),clearFilters=reactExports.useCallback(()=>{setFilters({author:"",publisher:"",yearFrom:"",yearTo:""})},[]),normalizeSearchResults=reactExports.useCallback((r,e)=>Array.isArray(r)?r.map((t,n)=>({id:`${e}-${n}`,source:e,title:t.title||"",author:t.author||"",publisher:t.publisher||"",publishedDate:t.publishedDate||"",isbn:t.isbn||"",coverImageUrl:t.coverImageUrl||"",description:t.description||"",confidence:e==="google"?.8:.6})):[],[]),searchGoogleBooks=reactExports.useCallback(async(query,searchType)=>{try{let apiKey;try{const isJestEnvironment=typeof process<"u"&&typeof jest<"u";if(isJestEnvironment)apiKey=define_process_env_default$1.VITE_GOOGLE_BOOKS_API_KEY;else try{const importMeta=eval("import.meta");importMeta&&importMeta.env?apiKey=importMeta.env.VITE_GOOGLE_BOOKS_API_KEY:apiKey=void 0}catch(r){apiKey=void 0}}catch(r){apiKey=void 0}if(!apiKey)return console.warn("Google Books API key is not configured, skipping Google Books search"),[];let searchQuery=query;searchType==="author"?searchQuery=`inauthor:${query}`:searchType==="publisher"?searchQuery=`inpublisher:${query}`:searchQuery=`intitle:${query}`;const response=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(searchQuery)}&key=${apiKey}&maxResults=10`);if(!response.ok)throw new Error(`Google Books API error: ${response.status}`);const data=await response.json();return data.items?data.items.map(r=>{var i,s,a;const e=r.volumeInfo||{},t=e.industryIdentifiers||[],n=((i=t.find(o=>o.type==="ISBN_13"))==null?void 0:i.identifier)||((s=t.find(o=>o.type==="ISBN_10"))==null?void 0:s.identifier)||"";return{title:e.title||"",author:e.authors?e.authors.join(", "):"",publisher:e.publisher||"",publishedDate:e.publishedDate||"",isbn:n,coverImageUrl:((a=e.imageLinks)==null?void 0:a.thumbnail)||"",description:e.description||""}}):[]}catch(r){throw console.error("Google Books API error:",r),r}},[]),getErrorMessage=reactExports.useCallback(r=>{const e=r.message||r.toString();return e.includes("API key")||e.includes("API key is not configured")?"検索サービスが利用できません。しばらく時間をおいて再度お試しください。":e.includes("network")||e.includes("fetch")?"インターネット接続を確認してください。":e.includes("timeout")?"検索に時間がかかっています。もう一度お試しください。":e.includes("404")||e.includes("Not Found")?"検索サービスが見つかりません。時間をおいて再度お試しください。":e.includes("429")||e.includes("Too Many Requests")?"検索回数が多すぎます。しばらく時間をおいて再度お試しください。":e.includes("500")||e.includes("Internal Server Error")?"検索サービスでエラーが発生しました。時間をおいて再度お試しください。":"検索中にエラーが発生しました。別のキーワードでお試しください。"},[]),searchBooks=reactExports.useCallback(async(r,e="title")=>{if(!r||r.trim()===""){setSearchResults([]);return}setLoading(!0),setLoadingStep("検索を開始しています..."),setError(null),setSearchResults([]);try{const t=[];let n=!1,i=null;try{setLoadingStep("Google Booksで検索中..."),console.log("Trying Google Books API for query:",r);const a=await searchGoogleBooks(r,e);if(console.log("Google Books raw results:",a),a&&a.length>0){const o=normalizeSearchResults(a,"google");console.log("Google Books normalized results:",o),t.push(...o)}}catch(a){console.warn("Google Books API failed:",a),n=!0,i=a}setLoadingStep("結果を整理中..."),console.log("Search results:",t),console.log("Results length:",t.length);const s=t.sort((a,o)=>o.confidence-a.confidence);setSearchResults(s),t.length>0&&addToSearchHistory(r,e),n&&t.length===0?setError(getErrorMessage(i)):t.length===0&&setError(e==="title"?`検索結果が見つかりませんでした。別のキーワードでお試しください。

💡 ヒント: より具体的なタイトルや著者名で検索してみてください。`:"検索結果が見つかりませんでした。別のキーワードでお試しください。")}catch(t){console.error("External book search error:",t),setError(getErrorMessage(t))}finally{setLoading(!1),setLoadingStep("")}},[getErrorMessage,addToSearchHistory]),clearSearchResults=reactExports.useCallback(()=>{setSearchResults([]),setError(null)},[]),clearError=reactExports.useCallback(()=>{setError(null)},[]),filteredResults=applyFilters(searchResults);return{searchResults,filteredResults,loading,loadingStep,error,searchBooks,clearSearchResults,clearError,searchHistory,loadSearchHistory,addToSearchHistory,removeFromSearchHistory,clearSearchHistory,filters,updateFilters,clearFilters}},ExternalBookSearch=({onBookSelect:r,onCancel:e})=>{const[t,n]=reactExports.useState("title"),[i,s]=reactExports.useState(""),[a,o]=reactExports.useState("relevance"),[c,h]=reactExports.useState(!1),{searchResults:f,filteredResults:m,loading:g,loadingStep:_,error:E,searchBooks:A,clearSearchResults:C,clearError:I,searchHistory:b,loadSearchHistory:R,removeFromSearchHistory:V,clearSearchHistory:U,filters:W,updateFilters:j,clearFilters:w}=useExternalBookSearch(),P=reactExports.useCallback((ye,he)=>{he!==null&&(n(he),C())},[C]),K=reactExports.useCallback(ye=>{s(ye.target.value),E&&I()},[E,I]),X=reactExports.useCallback(async()=>{i.trim()&&await A(i.trim(),t)},[i,t,A]),Y=reactExports.useCallback(ye=>{r(ye)},[r]),Z=reactExports.useCallback(()=>{C(),s(""),e()},[C,e]),ae=reactExports.useCallback((ye,he)=>{s(ye),n(he),h(!1),A(ye,he)},[A]),le=reactExports.useCallback(ye=>{V(ye)},[V]),ie=reactExports.useCallback(()=>{U()},[U]),se=reactExports.useCallback(()=>{c||R(),h(!c)},[c,R]),ce=reactExports.useCallback(ye=>{if(!ye||ye.length===0)return ye;const he=[...ye];switch(a){case"title":return he.sort((ke,Pe)=>ke.title.localeCompare(Pe.title,"ja"));case"author":return he.sort((ke,Pe)=>ke.author.localeCompare(Pe.author,"ja"));case"date":return he.sort((ke,Pe)=>{const Le=new Date(ke.publishedDate||"1900-01-01");return new Date(Pe.publishedDate||"1900-01-01")-Le});case"relevance":default:return he.sort((ke,Pe)=>Pe.confidence-ke.confidence)}},[a]),ue=()=>{if(g)return jsxRuntimeExports.jsxs(Box,{sx:{mt:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle2",sx:{mb:2,color:"primary.main",fontWeight:"bold",fontSize:{xs:"0.9rem",sm:"1rem"}},children:_||"検索中..."}),[...Array(3)].map((he,ke)=>jsxRuntimeExports.jsx(Card,{sx:{mb:2},children:jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",gap:2},children:[jsxRuntimeExports.jsx(Skeleton,{variant:"rectangular",width:60,height:80}),jsxRuntimeExports.jsxs(Box,{sx:{flex:1},children:[jsxRuntimeExports.jsx(Skeleton,{variant:"text",width:"80%",height:24}),jsxRuntimeExports.jsx(Skeleton,{variant:"text",width:"60%",height:20}),jsxRuntimeExports.jsx(Skeleton,{variant:"text",width:"40%",height:16})]})]})})},ke))]});if(E)return jsxRuntimeExports.jsx(Alert,{severity:"error",sx:{mt:2},action:jsxRuntimeExports.jsx(Button,{color:"inherit",size:"small",onClick:I,children:"再試行"}),children:E});if(f.length===0&&i.trim())return jsxRuntimeExports.jsxs(Box,{sx:{mt:2,textAlign:"center",py:4},children:[jsxRuntimeExports.jsxs(Typography,{variant:"body1",color:"text.secondary",children:["「",i,"」に一致する結果が見つかりませんでした。"]}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"別のキーワードをお試しください。"})]});if(f.length===0)return jsxRuntimeExports.jsxs(Box,{sx:{mt:2,textAlign:"center",py:4},children:[jsxRuntimeExports.jsx(Typography,{variant:"body1",color:"text.secondary",children:"検索キーワードを入力して検索を実行してください。"}),b&&b.length>0&&jsxRuntimeExports.jsx(Box,{sx:{mt:2},children:jsxRuntimeExports.jsx(Button,{variant:"outlined",startIcon:jsxRuntimeExports.jsx(HistoryIcon,{}),onClick:se,size:"small",children:"検索履歴を表示"})})]});const ye=ce(m||[]);return jsxRuntimeExports.jsxs(Box,{sx:{mt:2},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,flexDirection:{xs:"column",sm:"row"},gap:{xs:1,sm:0}},children:[jsxRuntimeExports.jsxs(Typography,{variant:"subtitle2",sx:{fontSize:{xs:"0.9rem",sm:"1rem"}},children:["検索結果 (",f.length,"件)"]}),jsxRuntimeExports.jsxs(FormControl,{size:"small",sx:{minWidth:120},children:[jsxRuntimeExports.jsx(InputLabel,{children:"並び替え"}),jsxRuntimeExports.jsxs(Select,{value:a,onChange:he=>o(he.target.value),label:"並び替え",children:[jsxRuntimeExports.jsx(MenuItem,{value:"relevance",children:"関連度順"}),jsxRuntimeExports.jsx(MenuItem,{value:"title",children:"タイトル順"}),jsxRuntimeExports.jsx(MenuItem,{value:"author",children:"著者順"}),jsxRuntimeExports.jsx(MenuItem,{value:"date",children:"出版日順"})]})]})]}),ye.map(he=>jsxRuntimeExports.jsx(Card,{sx:{mb:2,cursor:"pointer","&:hover":{boxShadow:3}},onClick:()=>Y(he),"data-testid":`search-result-${he.id}`,children:jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",gap:2},children:[jsxRuntimeExports.jsx(Box,{sx:{flexShrink:0},children:he.coverImageUrl?jsxRuntimeExports.jsx(CardMedia,{component:"img",image:he.coverImageUrl,alt:he.title,sx:{width:60,height:80,objectFit:"cover",borderRadius:1}}):jsxRuntimeExports.jsx(Box,{sx:{width:60,height:80,bgcolor:"grey.200",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:1},children:jsxRuntimeExports.jsx(Typography,{variant:"caption",color:"text.secondary",children:"表紙なし"})})}),jsxRuntimeExports.jsxs(Box,{sx:{flex:1,minWidth:0},children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle1",sx:{fontWeight:"bold",mb:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontSize:{xs:"0.9rem",sm:"1rem"}},children:he.title}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mb:.5,fontSize:{xs:"0.8rem",sm:"0.9rem"}},children:he.author}),jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"text.secondary",sx:{mb:1,fontSize:{xs:"0.8rem",sm:"0.9rem"}},children:[he.publisher,he.publishedDate&&` - ${he.publishedDate}`]}),jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",gap:.5,flexWrap:"wrap",mb:{xs:1,sm:1.5}},children:[jsxRuntimeExports.jsx(Chip,{label:he.source==="google"?"Google Books":"OpenBD",size:"small",color:he.source==="google"?"primary":"secondary",variant:"outlined",sx:{fontSize:{xs:"0.7rem",sm:"0.8rem"}}}),he.isbn&&jsxRuntimeExports.jsx(Chip,{label:`ISBN: ${he.isbn}`,size:"small",variant:"outlined",sx:{fontSize:{xs:"0.7rem",sm:"0.8rem"}}})]})]}),jsxRuntimeExports.jsx(Box,{sx:{flexShrink:0,alignSelf:"center",mt:{xs:1,sm:0}},children:jsxRuntimeExports.jsx(Button,{variant:"contained",size:"small",onClick:ke=>{ke.stopPropagation(),Y(he)},"data-testid":`select-book-${he.id}`,sx:{fontSize:{xs:"0.75rem",sm:"0.85rem"},minWidth:{xs:"100%",sm:"auto"}},children:"選択"})})]})})},he.id))]})},Ae=()=>f.length===0?null:jsxRuntimeExports.jsxs(Box,{sx:{mt:2,p:2,bgcolor:"grey.50",borderRadius:1},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle2",color:"text.secondary",children:"フィルター"}),jsxRuntimeExports.jsx(Button,{size:"small",onClick:w,disabled:!(W!=null&&W.author)&&!(W!=null&&W.publisher)&&!(W!=null&&W.yearFrom)&&!(W!=null&&W.yearTo),children:"クリア"})]}),jsxRuntimeExports.jsxs(Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:2,mb:2},children:[jsxRuntimeExports.jsx(TextField,{label:"著者",value:(W==null?void 0:W.author)||"",onChange:ye=>j({author:ye.target.value}),size:"small",placeholder:"著者名で絞り込み",sx:{fontSize:{xs:"0.8rem",sm:"0.9rem"}}}),jsxRuntimeExports.jsx(TextField,{label:"出版社",value:(W==null?void 0:W.publisher)||"",onChange:ye=>j({publisher:ye.target.value}),size:"small",placeholder:"出版社で絞り込み",sx:{fontSize:{xs:"0.8rem",sm:"0.9rem"}}}),jsxRuntimeExports.jsx(TextField,{label:"出版年（開始）",type:"number",value:(W==null?void 0:W.yearFrom)||"",onChange:ye=>j({yearFrom:ye.target.value}),size:"small",placeholder:"例: 2020",sx:{fontSize:{xs:"0.8rem",sm:"0.9rem"}}}),jsxRuntimeExports.jsx(TextField,{label:"出版年（終了）",type:"number",value:(W==null?void 0:W.yearTo)||"",onChange:ye=>j({yearTo:ye.target.value}),size:"small",placeholder:"例: 2024",sx:{fontSize:{xs:"0.8rem",sm:"0.9rem"}}})]}),jsxRuntimeExports.jsxs(Typography,{variant:"caption",color:"text.secondary",children:[(m==null?void 0:m.length)||0,"件の結果（全",(f==null?void 0:f.length)||0,"件中）"]})]}),Se=()=>!c||!b||b.length===0?null:jsxRuntimeExports.jsxs(Box,{sx:{mt:2},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1},children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle2",color:"text.secondary",children:"検索履歴"}),jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Button,{size:"small",onClick:ie,startIcon:jsxRuntimeExports.jsx(ClearIcon$1,{}),sx:{mr:1},children:"クリア"}),jsxRuntimeExports.jsx(Button,{size:"small",onClick:()=>h(!1),children:"閉じる"})]})]}),jsxRuntimeExports.jsx(List,{sx:{bgcolor:"background.paper",borderRadius:1},children:b.map((ye,he)=>jsxRuntimeExports.jsx(ListItem,{sx:{px:1},secondaryAction:jsxRuntimeExports.jsx(IconButton,{edge:"end",onClick:()=>le(he),size:"small",children:jsxRuntimeExports.jsx(DeleteIcon,{fontSize:"small"})}),children:jsxRuntimeExports.jsx(ListItemButton,{onClick:()=>ae(ye.query,ye.searchType),sx:{borderRadius:1},children:jsxRuntimeExports.jsx(ListItemText,{primary:ye.query,secondary:`${ye.searchType==="title"?"タイトル":ye.searchType==="author"?"著者":"出版社"}検索`})})},`${ye.query}-${ye.timestamp}`))})]});return jsxRuntimeExports.jsxs(Box,{sx:{p:{xs:1.5,sm:2},border:1,borderColor:"primary.main",borderRadius:1,bgcolor:"primary.50",mt:{xs:1.5,sm:2},maxWidth:"100%",overflow:"hidden"},"data-testid":"external-book-search",children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:{xs:1.5,sm:2},fontSize:{xs:"1rem",sm:"1.25rem"}},children:"🔍 外部検索モード"}),jsxRuntimeExports.jsx(Box,{sx:{mb:{xs:1.5,sm:2},display:"flex",justifyContent:"center"},children:jsxRuntimeExports.jsxs(ToggleButtonGroup,{value:t,exclusive:!0,onChange:P,"aria-label":"search type",size:"small",children:[jsxRuntimeExports.jsx(ToggleButton,{value:"title","aria-label":"title","data-testid":"search-type-title",children:"タイトル"}),jsxRuntimeExports.jsx(ToggleButton,{value:"author","aria-label":"author","data-testid":"search-type-author",children:"著者"}),jsxRuntimeExports.jsx(ToggleButton,{value:"publisher","aria-label":"publisher","data-testid":"search-type-publisher",children:"出版社"})]})}),jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",gap:{xs:.5,sm:1},mb:{xs:1.5,sm:2},flexDirection:{xs:"column",sm:"row"}},children:[jsxRuntimeExports.jsx(TextField,{fullWidth:!0,placeholder:`${t==="title"?"タイトル":t==="author"?"著者名":"出版社名"}を入力`,value:i,onChange:K,onKeyPress:ye=>{ye.key==="Enter"&&X()},"data-testid":"search-query-input",size:"small",sx:{"& .MuiOutlinedInput-root":{fontSize:{xs:"0.9rem",sm:"1rem"}}}}),jsxRuntimeExports.jsx(Button,{variant:"contained",onClick:X,disabled:!i.trim()||g,startIcon:g?jsxRuntimeExports.jsx(CircularProgress,{size:16}):jsxRuntimeExports.jsx(SearchIcon,{}),"data-testid":"search-button",sx:{fontSize:{xs:"0.8rem",sm:"0.9rem"},minWidth:{xs:"100%",sm:"auto"}},children:g?"検索中...":"検索"})]}),Se(),Ae(),ue(),jsxRuntimeExports.jsx(Box,{sx:{mt:{xs:2,sm:3},textAlign:"right"},children:jsxRuntimeExports.jsx(Button,{onClick:Z,"data-testid":"cancel-button",sx:{fontSize:{xs:"0.8rem",sm:"0.9rem"}},children:"← ISBN検索に戻る"})})]})};function BookForm({isbn:r="",onBookAdded:e}){const[t,n]=reactExports.useState(r),[i,s]=reactExports.useState(""),[a,o]=reactExports.useState(""),[c,h]=reactExports.useState(""),[f,m]=reactExports.useState(""),[g,_]=reactExports.useState(""),[E,A]=reactExports.useState([]),[C,I]=reactExports.useState(""),[b,R]=reactExports.useState(BOOK_STATUS.TSUNDOKU),[V,U]=reactExports.useState(ACQUISITION_TYPE.UNKNOWN),[W,j]=reactExports.useState(!1),{user:w}=useAuth(),{tagOptions:P,fetchTagHistory:K}=useTagHistory("book",w),{addBook:X,loading:Y,error:Z}=useBookActions(),{searchBookByIsbn:ae,loading:le,error:ie}=useBookSearch();reactExports.useEffect(()=>{K()},[K]),reactExports.useEffect(()=>{r&&r!==t&&(console.log("[BookForm] useEffect: propsのisbnが変化:",r),n(r),r.trim()!==""&&(console.log("[BookForm] useEffect: 自動で書籍情報取得を実行",r),se(r)))},[r,t]);const se=async he=>{const ke=he!==void 0?he:t;if(!ke||!ke.trim())return;const Pe=await ae(ke);Pe&&(s(Pe.title),o(Pe.author),h(Pe.publisher),m(Pe.publishedDate),_(Pe.coverImageUrl),A(Pe.tags))},ce=async he=>{if(he.preventDefault(),!i)return;const Pe=await X({isbn:t,title:i,author:a,publisher:c,publishedDate:f,coverImageUrl:g,tags:E,inputTagValue:C,status:b,acquisitionType:V});Pe&&e(Pe)},ue=()=>i&&!t&&!g&&!W,Ae=()=>{j(!W)},Se=he=>{s(he.title),o(he.author),h(he.publisher),m(he.publishedDate),_(he.coverImageUrl),n(he.isbn),j(!1)},ye=()=>{j(!1)};return jsxRuntimeExports.jsxs(Box,{component:"form",onSubmit:ce,sx:{mt:{xs:1,sm:2}},role:"form","data-testid":"book-form",children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:1,sm:1.5}},children:[jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(TextField,{label:"ISBN",value:t,onChange:he=>n(he.target.value),fullWidth:!0,size:"small",placeholder:"例: 9784873119485",inputProps:{"data-testid":"book-isbn-input"},sx:{"& .MuiOutlinedInput-root":{fontSize:{xs:"0.9rem",sm:"1rem"}}}})}),jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(Button,{onClick:()=>se(),variant:"outlined",disabled:le,sx:{mt:{xs:1,sm:0},height:{xs:"40px",sm:"56px"},fontSize:{xs:"0.8rem",sm:"0.9rem"}},fullWidth:!0,"data-testid":"book-fetch-button",children:le?"取得中...":"ISBNで書籍情報取得"})})]}),ue()&&jsxRuntimeExports.jsxs(Box,{sx:{mb:2,p:2,bgcolor:"grey.50",borderRadius:1},children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"💡 書籍情報が見つからない場合"}),jsxRuntimeExports.jsx(Button,{variant:"outlined",onClick:Ae,startIcon:jsxRuntimeExports.jsx("span",{children:"🔍"}),"data-testid":"external-search-button",sx:{fontSize:{xs:"0.8rem",sm:"0.9rem"}},children:"外部検索で探す"})]}),W&&jsxRuntimeExports.jsx(ExternalBookSearch,{onBookSelect:Se,onCancel:ye}),g&&jsxRuntimeExports.jsx(Box,{sx:{textAlign:"center",my:{xs:1.5,sm:2},px:{xs:1,sm:0}},children:jsxRuntimeExports.jsx("img",{src:g,alt:"表紙",style:{maxHeight:"120px",maxWidth:"100%",width:"auto",borderRadius:"4px"},"data-testid":"book-cover-image"})}),jsxRuntimeExports.jsxs(Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:{xs:1,sm:1.5},mt:{xs:.5,sm:1}},children:[jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(TextField,{label:"タイトル",value:i,onChange:he=>s(he.target.value),fullWidth:!0,required:!0,size:"small",inputProps:{"data-testid":"book-title-input"},sx:{"& .MuiOutlinedInput-root":{fontSize:{xs:"0.9rem",sm:"1rem"}}}})}),jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(TextField,{label:"著者",value:a,onChange:he=>o(he.target.value),fullWidth:!0,size:"small",inputProps:{"data-testid":"book-author-input"},sx:{"& .MuiOutlinedInput-root":{fontSize:{xs:"0.9rem",sm:"1rem"}}}})}),jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(TextField,{label:"出版社",value:c,onChange:he=>h(he.target.value),fullWidth:!0,size:"small",inputProps:{"data-testid":"book-publisher-input"},sx:{"& .MuiOutlinedInput-root":{fontSize:{xs:"0.9rem",sm:"1rem"}}}})}),jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(TextField,{label:"出版日",value:f,onChange:he=>m(he.target.value),fullWidth:!0,size:"small",inputProps:{"data-testid":"book-publishdate-input"},sx:{"& .MuiOutlinedInput-root":{fontSize:{xs:"0.9rem",sm:"1rem"}}}})})]}),jsxRuntimeExports.jsx(Box,{sx:{mt:{xs:1.5,sm:2}},children:jsxRuntimeExports.jsx(Autocomplete,{multiple:!0,freeSolo:!0,options:P,value:E,getOptionLabel:he=>typeof he=="string"?he:he.inputValue||he.tag||"",onChange:(he,ke)=>{const Pe=(ke||[]).map(Le=>{if(typeof Le=="string")return Le;if(Le&&typeof Le=="object"){if("inputValue"in Le&&Le.inputValue)return Le.inputValue;if("tag"in Le&&Le.tag)return Le.tag}return""}).filter(Boolean);A(Pe)},inputValue:C,onInputChange:(he,ke)=>I(ke),renderInput:he=>jsxRuntimeExports.jsx(TextField,{...he,label:"タグ",fullWidth:!0,size:"small",placeholder:"例: 小説,名作,技術書",inputProps:{...he.inputProps,"data-testid":"book-tags-input",style:{fontSize:"0.9rem"}},sx:{"& .MuiOutlinedInput-root":{fontSize:{xs:"0.9rem",sm:"1rem"}}}}),sx:{"& .MuiChip-root":{fontSize:{xs:"0.75rem",sm:"0.8rem"},height:{xs:"24px",sm:"28px"}}}})}),jsxRuntimeExports.jsx(Box,{sx:{mt:{xs:1.5,sm:2}},children:jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,size:"small",children:[jsxRuntimeExports.jsx(InputLabel,{id:"book-status-label",children:"ステータス"}),jsxRuntimeExports.jsx(Select,{labelId:"book-status-label",value:b,label:"ステータス",onChange:he=>R(he.target.value),"data-testid":"book-status-select",sx:{"& .MuiSelect-select":{fontSize:{xs:"0.9rem",sm:"1rem"}}},children:ALL_BOOK_STATUSES.map(he=>jsxRuntimeExports.jsx(MenuItem,{value:he,children:getBookStatusLabel(he)},he))})]})}),jsxRuntimeExports.jsx(Box,{sx:{mt:{xs:1.5,sm:2}},children:jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,size:"small",children:[jsxRuntimeExports.jsx(InputLabel,{id:"book-acquisition-type-label",children:"取得方法"}),jsxRuntimeExports.jsx(Select,{labelId:"book-acquisition-type-label",value:V,label:"取得方法",onChange:he=>U(he.target.value),"data-testid":"book-acquisition-type-select",sx:{"& .MuiSelect-select":{fontSize:{xs:"0.9rem",sm:"1rem"}}},children:ALL_ACQUISITION_TYPES.map(he=>jsxRuntimeExports.jsx(MenuItem,{value:he,children:getAcquisitionTypeLabel(he)},he))})]})}),(ie||Z)&&jsxRuntimeExports.jsx(Typography,{color:"error",sx:{mt:{xs:1.5,sm:2},fontSize:{xs:"0.8rem",sm:"0.9rem"}},"data-testid":"book-form-error",children:ie||Z}),jsxRuntimeExports.jsx(Button,{type:"submit",variant:"contained",disabled:Y,sx:{mt:{xs:2,sm:3},mb:{xs:"72px",sm:2},width:{xs:"100%",sm:"auto"},fontSize:{xs:"0.9rem",sm:"1rem"},py:{xs:1.5,sm:2}},"data-testid":"book-add-submit",children:Y?"追加中...":"本を追加"})]})}function fixProto(r,e){var t=Object.setPrototypeOf;t?t(r,e):r.__proto__=e}function fixStack(r,e){e===void 0&&(e=r.constructor);var t=Error.captureStackTrace;t&&t(r,e)}var __extends$19=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,s){i.__proto__=s}||function(i,s){for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(i[a]=s[a])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),CustomError=function(r){__extends$19(e,r);function e(t,n){var i=this.constructor,s=r.call(this,t,n)||this;return Object.defineProperty(s,"name",{value:i.name,enumerable:!1,configurable:!0}),fixProto(s,i.prototype),fixStack(s),s}return e}(Error),__extends$18=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Exception=function(r){__extends$18(e,r);function e(t){t===void 0&&(t=void 0);var n=r.call(this,t)||this;return n.message=t,n}return e.prototype.getKind=function(){var t=this.constructor;return t.kind},e.kind="Exception",e}(CustomError),__extends$17=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ArgumentException=function(r){__extends$17(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ArgumentException",e}(Exception),__extends$16=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),IllegalArgumentException=function(r){__extends$16(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IllegalArgumentException",e}(Exception),BinaryBitmap=function(){function r(e){if(this.binarizer=e,e===null)throw new IllegalArgumentException("Binarizer must be non-null.")}return r.prototype.getWidth=function(){return this.binarizer.getWidth()},r.prototype.getHeight=function(){return this.binarizer.getHeight()},r.prototype.getBlackRow=function(e,t){return this.binarizer.getBlackRow(e,t)},r.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},r.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},r.prototype.crop=function(e,t,n,i){var s=this.binarizer.getLuminanceSource().crop(e,t,n,i);return new r(this.binarizer.createBinarizer(s))},r.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},r.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new r(this.binarizer.createBinarizer(e))},r.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new r(this.binarizer.createBinarizer(e))},r.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},r}(),__extends$15=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ChecksumException=function(r){__extends$15(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind="ChecksumException",e}(Exception),Binarizer=function(){function r(e){this.source=e}return r.prototype.getLuminanceSource=function(){return this.source},r.prototype.getWidth=function(){return this.source.getWidth()},r.prototype.getHeight=function(){return this.source.getHeight()},r}(),System=function(){function r(){}return r.arraycopy=function(e,t,n,i,s){for(;s--;)n[i++]=e[t++]},r.currentTimeMillis=function(){return Date.now()},r}(),__extends$14=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),IndexOutOfBoundsException=function(r){__extends$14(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IndexOutOfBoundsException",e}(Exception),__extends$13=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ArrayIndexOutOfBoundsException=function(r){__extends$13(e,r);function e(t,n){t===void 0&&(t=void 0),n===void 0&&(n=void 0);var i=r.call(this,n)||this;return i.index=t,i.message=n,i}return e.kind="ArrayIndexOutOfBoundsException",e}(IndexOutOfBoundsException),__values$J=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Arrays=function(){function r(){}return r.fill=function(e,t){for(var n=0,i=e.length;n<i;n++)e[n]=t},r.fillWithin=function(e,t,n,i){r.rangeCheck(e.length,t,n);for(var s=t;s<n;s++)e[s]=i},r.rangeCheck=function(e,t,n){if(t>n)throw new IllegalArgumentException("fromIndex("+t+") > toIndex("+n+")");if(t<0)throw new ArrayIndexOutOfBoundsException(t);if(n>e)throw new ArrayIndexOutOfBoundsException(n)},r.asList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},r.create=function(e,t,n){var i=Array.from({length:e});return i.map(function(s){return Array.from({length:t}).fill(n)})},r.createInt32Array=function(e,t,n){var i=Array.from({length:e});return i.map(function(s){return Int32Array.from({length:t}).fill(n)})},r.equals=function(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0},r.hashCode=function(e){var t,n;if(e===null)return 0;var i=1;try{for(var s=__values$J(e),a=s.next();!a.done;a=s.next()){var o=a.value;i=31*i+o}}catch(c){t={error:c}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return i},r.fillUint8Array=function(e,t){for(var n=0;n!==e.length;n++)e[n]=t},r.copyOf=function(e,t){return e.slice(0,t)},r.copyOfUint8Array=function(e,t){if(e.length<=t){var n=new Uint8Array(t);return n.set(e),n}return e.slice(0,t)},r.copyOfRange=function(e,t,n){var i=n-t,s=new Int32Array(i);return System.arraycopy(e,t,s,0,i),s},r.binarySearch=function(e,t,n){n===void 0&&(n=r.numberComparator);for(var i=0,s=e.length-1;i<=s;){var a=s+i>>1,o=n(t,e[a]);if(o>0)i=a+1;else if(o<0)s=a-1;else return a}return-i-1},r.numberComparator=function(e,t){return e-t},r}(),Integer=function(){function r(){}return r.numberOfTrailingZeros=function(e){var t;if(e===0)return 32;var n=31;return t=e<<16,t!==0&&(n-=16,e=t),t=e<<8,t!==0&&(n-=8,e=t),t=e<<4,t!==0&&(n-=4,e=t),t=e<<2,t!==0&&(n-=2,e=t),n-(e<<1>>>31)},r.numberOfLeadingZeros=function(e){if(e===0)return 32;var t=1;return e>>>16||(t+=16,e<<=16),e>>>24||(t+=8,e<<=8),e>>>28||(t+=4,e<<=4),e>>>30||(t+=2,e<<=2),t-=e>>>31,t},r.toHexString=function(e){return e.toString(16)},r.toBinaryString=function(e){return String(parseInt(String(e),2))},r.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},r.truncDivision=function(e,t){return Math.trunc(e/t)},r.parseInt=function(e,t){return t===void 0&&(t=void 0),parseInt(e,t)},r.MIN_VALUE_32_BITS=-2147483648,r.MAX_VALUE=Number.MAX_SAFE_INTEGER,r}(),BitArray=function(){function r(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,t==null?this.bits=r.makeArray(e):this.bits=t)}return r.prototype.getSize=function(){return this.size},r.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},r.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var t=r.makeArray(e);System.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}},r.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},r.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},r.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},r.prototype.getNextSet=function(e){var t=this.size;if(e>=t)return t;var n=this.bits,i=Math.floor(e/32),s=n[i];s&=~((1<<(e&31))-1);for(var a=n.length;s===0;){if(++i===a)return t;s=n[i]}var o=i*32+Integer.numberOfTrailingZeros(s);return o>t?t:o},r.prototype.getNextUnset=function(e){var t=this.size;if(e>=t)return t;var n=this.bits,i=Math.floor(e/32),s=~n[i];s&=~((1<<(e&31))-1);for(var a=n.length;s===0;){if(++i===a)return t;s=~n[i]}var o=i*32+Integer.numberOfTrailingZeros(s);return o>t?t:o},r.prototype.setBulk=function(e,t){this.bits[Math.floor(e/32)]=t},r.prototype.setRange=function(e,t){if(t<e||e<0||t>this.size)throw new IllegalArgumentException;if(t!==e){t--;for(var n=Math.floor(e/32),i=Math.floor(t/32),s=this.bits,a=n;a<=i;a++){var o=a>n?0:e&31,c=a<i?31:t&31,h=(2<<c)-(1<<o);s[a]|=h}}},r.prototype.clear=function(){for(var e=this.bits.length,t=this.bits,n=0;n<e;n++)t[n]=0},r.prototype.isRange=function(e,t,n){if(t<e||e<0||t>this.size)throw new IllegalArgumentException;if(t===e)return!0;t--;for(var i=Math.floor(e/32),s=Math.floor(t/32),a=this.bits,o=i;o<=s;o++){var c=o>i?0:e&31,h=o<s?31:t&31,f=(2<<h)-(1<<c)&4294967295;if((a[o]&f)!==(n?f:0))return!1}return!0},r.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},r.prototype.appendBits=function(e,t){if(t<0||t>32)throw new IllegalArgumentException("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(var n=t;n>0;n--)this.appendBit((e>>n-1&1)===1)},r.prototype.appendBitArray=function(e){var t=e.size;this.ensureCapacity(this.size+t);for(var n=0;n<t;n++)this.appendBit(e.get(n))},r.prototype.xor=function(e){if(this.size!==e.size)throw new IllegalArgumentException("Sizes don't match");for(var t=this.bits,n=0,i=t.length;n<i;n++)t[n]^=e.bits[n]},r.prototype.toBytes=function(e,t,n,i){for(var s=0;s<i;s++){for(var a=0,o=0;o<8;o++)this.get(e)&&(a|=1<<7-o),e++;t[n+s]=a}},r.prototype.getBitArray=function(){return this.bits},r.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),n=t+1,i=this.bits,s=0;s<n;s++){var a=i[s];a=a>>1&1431655765|(a&1431655765)<<1,a=a>>2&858993459|(a&858993459)<<2,a=a>>4&252645135|(a&252645135)<<4,a=a>>8&16711935|(a&16711935)<<8,a=a>>16&65535|(a&65535)<<16,e[t-s]=a}if(this.size!==n*32){for(var o=n*32-this.size,c=e[0]>>>o,s=1;s<n;s++){var h=e[s];c|=h<<32-o,e[s-1]=c,c=h>>>o}e[n-1]=c}this.bits=e},r.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.size===t.size&&Arrays.equals(this.bits,t.bits)},r.prototype.hashCode=function(){return 31*this.size+Arrays.hashCode(this.bits)},r.prototype.toString=function(){for(var e="",t=0,n=this.size;t<n;t++)(t&7)===0&&(e+=" "),e+=this.get(t)?"X":".";return e},r.prototype.clone=function(){return new r(this.size,this.bits.slice())},r.prototype.toArray=function(){for(var e=[],t=0,n=this.size;t<n;t++)e.push(this.get(t));return e},r}(),DecodeHintType;(function(r){r[r.OTHER=0]="OTHER",r[r.PURE_BARCODE=1]="PURE_BARCODE",r[r.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",r[r.TRY_HARDER=3]="TRY_HARDER",r[r.CHARACTER_SET=4]="CHARACTER_SET",r[r.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",r[r.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",r[r.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",r[r.ASSUME_GS1=8]="ASSUME_GS1",r[r.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",r[r.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",r[r.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(DecodeHintType||(DecodeHintType={}));const DecodeHintType$1=DecodeHintType;var __extends$12=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),FormatException=function(r){__extends$12(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind="FormatException",e}(Exception),__values$I=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},CharacterSetValueIdentifiers;(function(r){r[r.Cp437=0]="Cp437",r[r.ISO8859_1=1]="ISO8859_1",r[r.ISO8859_2=2]="ISO8859_2",r[r.ISO8859_3=3]="ISO8859_3",r[r.ISO8859_4=4]="ISO8859_4",r[r.ISO8859_5=5]="ISO8859_5",r[r.ISO8859_6=6]="ISO8859_6",r[r.ISO8859_7=7]="ISO8859_7",r[r.ISO8859_8=8]="ISO8859_8",r[r.ISO8859_9=9]="ISO8859_9",r[r.ISO8859_10=10]="ISO8859_10",r[r.ISO8859_11=11]="ISO8859_11",r[r.ISO8859_13=12]="ISO8859_13",r[r.ISO8859_14=13]="ISO8859_14",r[r.ISO8859_15=14]="ISO8859_15",r[r.ISO8859_16=15]="ISO8859_16",r[r.SJIS=16]="SJIS",r[r.Cp1250=17]="Cp1250",r[r.Cp1251=18]="Cp1251",r[r.Cp1252=19]="Cp1252",r[r.Cp1256=20]="Cp1256",r[r.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",r[r.UTF8=22]="UTF8",r[r.ASCII=23]="ASCII",r[r.Big5=24]="Big5",r[r.GB18030=25]="GB18030",r[r.EUC_KR=26]="EUC_KR"})(CharacterSetValueIdentifiers||(CharacterSetValueIdentifiers={}));var CharacterSetECI=function(){function r(e,t,n){for(var i,s,a=[],o=3;o<arguments.length;o++)a[o-3]=arguments[o];this.valueIdentifier=e,this.name=n,typeof t=="number"?this.values=Int32Array.from([t]):this.values=t,this.otherEncodingNames=a,r.VALUE_IDENTIFIER_TO_ECI.set(e,this),r.NAME_TO_ECI.set(n,this);for(var c=this.values,h=0,f=c.length;h!==f;h++){var m=c[h];r.VALUES_TO_ECI.set(m,this)}try{for(var g=__values$I(a),_=g.next();!_.done;_=g.next()){var E=_.value;r.NAME_TO_ECI.set(E,this)}}catch(A){i={error:A}}finally{try{_&&!_.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}}return r.prototype.getValueIdentifier=function(){return this.valueIdentifier},r.prototype.getName=function(){return this.name},r.prototype.getValue=function(){return this.values[0]},r.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new FormatException("incorect value");var t=r.VALUES_TO_ECI.get(e);if(t===void 0)throw new FormatException("incorect value");return t},r.getCharacterSetECIByName=function(e){var t=r.NAME_TO_ECI.get(e);if(t===void 0)throw new FormatException("incorect value");return t},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.getName()===t.getName()},r.VALUE_IDENTIFIER_TO_ECI=new Map,r.VALUES_TO_ECI=new Map,r.NAME_TO_ECI=new Map,r.Cp437=new r(CharacterSetValueIdentifiers.Cp437,Int32Array.from([0,2]),"Cp437"),r.ISO8859_1=new r(CharacterSetValueIdentifiers.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),r.ISO8859_2=new r(CharacterSetValueIdentifiers.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),r.ISO8859_3=new r(CharacterSetValueIdentifiers.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),r.ISO8859_4=new r(CharacterSetValueIdentifiers.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),r.ISO8859_5=new r(CharacterSetValueIdentifiers.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),r.ISO8859_6=new r(CharacterSetValueIdentifiers.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),r.ISO8859_7=new r(CharacterSetValueIdentifiers.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),r.ISO8859_8=new r(CharacterSetValueIdentifiers.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),r.ISO8859_9=new r(CharacterSetValueIdentifiers.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),r.ISO8859_10=new r(CharacterSetValueIdentifiers.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),r.ISO8859_11=new r(CharacterSetValueIdentifiers.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),r.ISO8859_13=new r(CharacterSetValueIdentifiers.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),r.ISO8859_14=new r(CharacterSetValueIdentifiers.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),r.ISO8859_15=new r(CharacterSetValueIdentifiers.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),r.ISO8859_16=new r(CharacterSetValueIdentifiers.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),r.SJIS=new r(CharacterSetValueIdentifiers.SJIS,20,"SJIS","Shift_JIS"),r.Cp1250=new r(CharacterSetValueIdentifiers.Cp1250,21,"Cp1250","windows-1250"),r.Cp1251=new r(CharacterSetValueIdentifiers.Cp1251,22,"Cp1251","windows-1251"),r.Cp1252=new r(CharacterSetValueIdentifiers.Cp1252,23,"Cp1252","windows-1252"),r.Cp1256=new r(CharacterSetValueIdentifiers.Cp1256,24,"Cp1256","windows-1256"),r.UnicodeBigUnmarked=new r(CharacterSetValueIdentifiers.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),r.UTF8=new r(CharacterSetValueIdentifiers.UTF8,26,"UTF8","UTF-8"),r.ASCII=new r(CharacterSetValueIdentifiers.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),r.Big5=new r(CharacterSetValueIdentifiers.Big5,28,"Big5"),r.GB18030=new r(CharacterSetValueIdentifiers.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),r.EUC_KR=new r(CharacterSetValueIdentifiers.EUC_KR,30,"EUC_KR","EUC-KR"),r}(),__extends$11=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),UnsupportedOperationException=function(r){__extends$11(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="UnsupportedOperationException",e}(Exception),StringEncoding=function(){function r(){}return r.decode=function(e,t){var n=this.encodingName(t);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},r.shouldDecodeOnFallback=function(e){return!r.isBrowser()&&e==="ISO-8859-1"},r.encode=function(e,t){var n=this.encodingName(t);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)},r.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},r.encodingName=function(e){return typeof e=="string"?e:e.getName()},r.encodingCharacterSet=function(e){return e instanceof CharacterSetECI?e:CharacterSetECI.getCharacterSetECIByName(e)},r.decodeFallback=function(e,t){var n=this.encodingCharacterSet(t);if(r.isDecodeFallbackSupported(n)){for(var i="",s=0,a=e.length;s<a;s++){var o=e[s].toString(16);o.length<2&&(o="0"+o),i+="%"+o}return decodeURIComponent(i)}if(n.equals(CharacterSetECI.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new UnsupportedOperationException("Encoding "+this.encodingName(t)+" not supported by fallback.")},r.isDecodeFallbackSupported=function(e){return e.equals(CharacterSetECI.UTF8)||e.equals(CharacterSetECI.ISO8859_1)||e.equals(CharacterSetECI.ASCII)},r.encodeFallback=function(e){for(var t=btoa(unescape(encodeURIComponent(e))),n=t.split(""),i=[],s=0;s<n.length;s++)i.push(n[s].charCodeAt(0));return new Uint8Array(i)},r}(),StringUtils=function(){function r(){}return r.castAsNonUtf8Char=function(e,t){t===void 0&&(t=null);var n=t?t.getName():this.ISO88591;return StringEncoding.decode(new Uint8Array([e]),n)},r.guessEncoding=function(e,t){if(t!=null&&t.get(DecodeHintType$1.CHARACTER_SET)!==void 0)return t.get(DecodeHintType$1.CHARACTER_SET).toString();for(var n=e.length,i=!0,s=!0,a=!0,o=0,c=0,h=0,f=0,m=0,g=0,_=0,E=0,A=0,C=0,I=0,b=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,R=0;R<n&&(i||s||a);R++){var V=e[R]&255;a&&(o>0?(V&128)===0?a=!1:o--:(V&128)!==0&&((V&64)===0?a=!1:(o++,(V&32)===0?c++:(o++,(V&16)===0?h++:(o++,(V&8)===0?f++:a=!1))))),i&&(V>127&&V<160?i=!1:V>159&&(V<192||V===215||V===247)&&I++),s&&(m>0?V<64||V===127||V>252?s=!1:m--:V===128||V===160||V>239?s=!1:V>160&&V<224?(g++,E=0,_++,_>A&&(A=_)):V>127?(m++,_=0,E++,E>C&&(C=E)):(_=0,E=0))}return a&&o>0&&(a=!1),s&&m>0&&(s=!1),a&&(b||c+h+f>0)?r.UTF8:s&&(r.ASSUME_SHIFT_JIS||A>=3||C>=3)?r.SHIFT_JIS:i&&s?A===2&&g===2||I*10>=n?r.SHIFT_JIS:r.ISO88591:i?r.ISO88591:s?r.SHIFT_JIS:a?r.UTF8:r.PLATFORM_DEFAULT_ENCODING},r.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=-1;function s(o,c,h,f,m,g){if(o==="%%")return"%";if(t[++i]!==void 0){o=f?parseInt(f.substr(1)):void 0;var _=m?parseInt(m.substr(1)):void 0,E;switch(g){case"s":E=t[i];break;case"c":E=t[i][0];break;case"f":E=parseFloat(t[i]).toFixed(o);break;case"p":E=parseFloat(t[i]).toPrecision(o);break;case"e":E=parseFloat(t[i]).toExponential(o);break;case"x":E=parseInt(t[i]).toString(_||16);break;case"d":E=parseFloat(parseInt(t[i],_||10).toPrecision(o)).toFixed(0);break}E=typeof E=="object"?JSON.stringify(E):(+E).toString(_);for(var A=parseInt(h),C=h&&h[0]+""=="0"?"0":" ";E.length<A;)E=c!==void 0?E+C:C+E;return E}}var a=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(a,s)},r.getBytes=function(e,t){return StringEncoding.encode(e,t)},r.getCharCode=function(e,t){return t===void 0&&(t=0),e.charCodeAt(t)},r.getCharAt=function(e){return String.fromCharCode(e)},r.SHIFT_JIS=CharacterSetECI.SJIS.getName(),r.GB2312="GB2312",r.ISO88591=CharacterSetECI.ISO8859_1.getName(),r.EUC_JP="EUC_JP",r.UTF8=CharacterSetECI.UTF8.getName(),r.PLATFORM_DEFAULT_ENCODING=r.UTF8,r.ASSUME_SHIFT_JIS=!1,r}(),StringBuilder=function(){function r(e){e===void 0&&(e=""),this.value=e}return r.prototype.enableDecoding=function(e){return this.encoding=e,this},r.prototype.append=function(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=StringUtils.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},r.prototype.appendChars=function(e,t,n){for(var i=t;t<t+n;i++)this.append(e[i]);return this},r.prototype.length=function(){return this.value.length},r.prototype.charAt=function(e){return this.value.charAt(e)},r.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},r.prototype.setCharAt=function(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)},r.prototype.substring=function(e,t){return this.value.substring(e,t)},r.prototype.setLengthToZero=function(){this.value=""},r.prototype.toString=function(){return this.value},r.prototype.insert=function(e,t){this.value=this.value.substring(0,e)+t+this.value.substring(e)},r}(),BitMatrix=function(){function r(e,t,n,i){if(this.width=e,this.height=t,this.rowSize=n,this.bits=i,t==null&&(t=e),this.height=t,e<1||t<1)throw new IllegalArgumentException("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,i==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return r.parseFromBooleanArray=function(e){for(var t=e.length,n=e[0].length,i=new r(n,t),s=0;s<t;s++)for(var a=e[s],o=0;o<n;o++)a[o]&&i.set(o,s);return i},r.parseFromString=function(e,t,n){if(e===null)throw new IllegalArgumentException("stringRepresentation cannot be null");for(var i=new Array(e.length),s=0,a=0,o=-1,c=0,h=0;h<e.length;)if(e.charAt(h)===`
`||e.charAt(h)==="\r"){if(s>a){if(o===-1)o=s-a;else if(s-a!==o)throw new IllegalArgumentException("row lengths do not match");a=s,c++}h++}else if(e.substring(h,h+t.length)===t)h+=t.length,i[s]=!0,s++;else if(e.substring(h,h+n.length)===n)h+=n.length,i[s]=!1,s++;else throw new IllegalArgumentException("illegal character encountered: "+e.substring(h));if(s>a){if(o===-1)o=s-a;else if(s-a!==o)throw new IllegalArgumentException("row lengths do not match");c++}for(var f=new r(o,c),m=0;m<s;m++)i[m]&&f.set(Math.floor(m%o),Math.floor(m/o));return f},r.prototype.get=function(e,t){var n=t*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0},r.prototype.set=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295},r.prototype.unset=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)},r.prototype.flip=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295},r.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new IllegalArgumentException("input matrix dimensions do not match");for(var t=new BitArray(Math.floor(this.width/32)+1),n=this.rowSize,i=this.bits,s=0,a=this.height;s<a;s++)for(var o=s*n,c=e.getRow(s,t).getBitArray(),h=0;h<n;h++)i[o+h]^=c[h]},r.prototype.clear=function(){for(var e=this.bits,t=e.length,n=0;n<t;n++)e[n]=0},r.prototype.setRegion=function(e,t,n,i){if(t<0||e<0)throw new IllegalArgumentException("Left and top must be nonnegative");if(i<1||n<1)throw new IllegalArgumentException("Height and width must be at least 1");var s=e+n,a=t+i;if(a>this.height||s>this.width)throw new IllegalArgumentException("The region must fit inside the matrix");for(var o=this.rowSize,c=this.bits,h=t;h<a;h++)for(var f=h*o,m=e;m<s;m++)c[f+Math.floor(m/32)]|=1<<(m&31)&4294967295},r.prototype.getRow=function(e,t){t==null||t.getSize()<this.width?t=new BitArray(this.width):t.clear();for(var n=this.rowSize,i=this.bits,s=e*n,a=0;a<n;a++)t.setBulk(a*32,i[s+a]);return t},r.prototype.setRow=function(e,t){System.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},r.prototype.rotate180=function(){for(var e=this.getWidth(),t=this.getHeight(),n=new BitArray(e),i=new BitArray(e),s=0,a=Math.floor((t+1)/2);s<a;s++)n=this.getRow(s,n),i=this.getRow(t-1-s,i),n.reverse(),i.reverse(),this.setRow(s,i),this.setRow(t-1-s,n)},r.prototype.getEnclosingRectangle=function(){for(var e=this.width,t=this.height,n=this.rowSize,i=this.bits,s=e,a=t,o=-1,c=-1,h=0;h<t;h++)for(var f=0;f<n;f++){var m=i[h*n+f];if(m!==0){if(h<a&&(a=h),h>c&&(c=h),f*32<s){for(var g=0;(m<<31-g&4294967295)===0;)g++;f*32+g<s&&(s=f*32+g)}if(f*32+31>o){for(var g=31;!(m>>>g);)g--;f*32+g>o&&(o=f*32+g)}}}return o<s||c<a?null:Int32Array.from([s,a,o-s+1,c-a+1])},r.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,t=this.bits,n=0;n<t.length&&t[n]===0;)n++;if(n===t.length)return null;for(var i=n/e,s=n%e*32,a=t[n],o=0;(a<<31-o&4294967295)===0;)o++;return s+=o,Int32Array.from([s,i])},r.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,t=this.bits,n=t.length-1;n>=0&&t[n]===0;)n--;if(n<0)return null;for(var i=Math.floor(n/e),s=Math.floor(n%e)*32,a=t[n],o=31;!(a>>>o);)o--;return s+=o,Int32Array.from([s,i])},r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.getRowSize=function(){return this.rowSize},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&Arrays.equals(this.bits,t.bits)},r.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+Arrays.hashCode(this.bits),e},r.prototype.toString=function(e,t,n){return e===void 0&&(e="X "),t===void 0&&(t="  "),n===void 0&&(n=`
`),this.buildToString(e,t,n)},r.prototype.buildToString=function(e,t,n){for(var i=new StringBuilder,s=0,a=this.height;s<a;s++){for(var o=0,c=this.width;o<c;o++)i.append(this.get(o,s)?e:t);i.append(n)}return i.toString()},r.prototype.clone=function(){return new r(this.width,this.height,this.rowSize,this.bits.slice())},r}(),__extends$10=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),NotFoundException=function(r){__extends$10(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind="NotFoundException",e}(Exception),__extends$$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),GlobalHistogramBinarizer=function(r){__extends$$(e,r);function e(t){var n=r.call(this,t)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return e.prototype.getBlackRow=function(t,n){var i=this.getLuminanceSource(),s=i.getWidth();n==null||n.getSize()<s?n=new BitArray(s):n.clear(),this.initArrays(s);for(var a=i.getRow(t,this.luminances),o=this.buckets,c=0;c<s;c++)o[(a[c]&255)>>e.LUMINANCE_SHIFT]++;var h=e.estimateBlackPoint(o);if(s<3)for(var c=0;c<s;c++)(a[c]&255)<h&&n.set(c);else for(var f=a[0]&255,m=a[1]&255,c=1;c<s-1;c++){var g=a[c+1]&255;(m*4-f-g)/2<h&&n.set(c),f=m,m=g}return n},e.prototype.getBlackMatrix=function(){var t=this.getLuminanceSource(),n=t.getWidth(),i=t.getHeight(),s=new BitMatrix(n,i);this.initArrays(n);for(var a=this.buckets,o=1;o<5;o++)for(var c=Math.floor(i*o/5),h=t.getRow(c,this.luminances),f=Math.floor(n*4/5),m=Math.floor(n/5);m<f;m++){var g=h[m]&255;a[g>>e.LUMINANCE_SHIFT]++}for(var _=e.estimateBlackPoint(a),E=t.getMatrix(),o=0;o<i;o++)for(var A=o*n,m=0;m<n;m++){var g=E[A+m]&255;g<_&&s.set(m,o)}return s},e.prototype.createBinarizer=function(t){return new e(t)},e.prototype.initArrays=function(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));for(var n=this.buckets,i=0;i<e.LUMINANCE_BUCKETS;i++)n[i]=0},e.estimateBlackPoint=function(t){for(var n=t.length,i=0,s=0,a=0,o=0;o<n;o++)t[o]>a&&(s=o,a=t[o]),t[o]>i&&(i=t[o]);for(var c=0,h=0,o=0;o<n;o++){var f=o-s,m=t[o]*f*f;m>h&&(c=o,h=m)}if(s>c){var g=s;s=c,c=g}if(c-s<=n/16)throw new NotFoundException;for(var _=c-1,E=-1,o=c-1;o>s;o--){var A=o-s,m=A*A*(c-o)*(i-t[o]);m>E&&(_=o,E=m)}return _<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e}(Binarizer),__extends$_=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),HybridBinarizer=function(r){__extends$_(e,r);function e(t){var n=r.call(this,t)||this;return n.matrix=null,n}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var t=this.getLuminanceSource(),n=t.getWidth(),i=t.getHeight();if(n>=e.MINIMUM_DIMENSION&&i>=e.MINIMUM_DIMENSION){var s=t.getMatrix(),a=n>>e.BLOCK_SIZE_POWER;(n&e.BLOCK_SIZE_MASK)!==0&&a++;var o=i>>e.BLOCK_SIZE_POWER;(i&e.BLOCK_SIZE_MASK)!==0&&o++;var c=e.calculateBlackPoints(s,a,o,n,i),h=new BitMatrix(n,i);e.calculateThresholdForBlock(s,a,o,n,i,c,h),this.matrix=h}else this.matrix=r.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(t){return new e(t)},e.calculateThresholdForBlock=function(t,n,i,s,a,o,c){for(var h=a-e.BLOCK_SIZE,f=s-e.BLOCK_SIZE,m=0;m<i;m++){var g=m<<e.BLOCK_SIZE_POWER;g>h&&(g=h);for(var _=e.cap(m,2,i-3),E=0;E<n;E++){var A=E<<e.BLOCK_SIZE_POWER;A>f&&(A=f);for(var C=e.cap(E,2,n-3),I=0,b=-2;b<=2;b++){var R=o[_+b];I+=R[C-2]+R[C-1]+R[C]+R[C+1]+R[C+2]}var V=I/25;e.thresholdBlock(t,A,g,V,s,c)}}},e.cap=function(t,n,i){return t<n?n:t>i?i:t},e.thresholdBlock=function(t,n,i,s,a,o){for(var c=0,h=i*a+n;c<e.BLOCK_SIZE;c++,h+=a)for(var f=0;f<e.BLOCK_SIZE;f++)(t[h+f]&255)<=s&&o.set(n+f,i+c)},e.calculateBlackPoints=function(t,n,i,s,a){for(var o=a-e.BLOCK_SIZE,c=s-e.BLOCK_SIZE,h=new Array(i),f=0;f<i;f++){h[f]=new Int32Array(n);var m=f<<e.BLOCK_SIZE_POWER;m>o&&(m=o);for(var g=0;g<n;g++){var _=g<<e.BLOCK_SIZE_POWER;_>c&&(_=c);for(var E=0,A=255,C=0,I=0,b=m*s+_;I<e.BLOCK_SIZE;I++,b+=s){for(var R=0;R<e.BLOCK_SIZE;R++){var V=t[b+R]&255;E+=V,V<A&&(A=V),V>C&&(C=V)}if(C-A>e.MIN_DYNAMIC_RANGE)for(I++,b+=s;I<e.BLOCK_SIZE;I++,b+=s)for(var R=0;R<e.BLOCK_SIZE;R++)E+=t[b+R]&255}var U=E>>e.BLOCK_SIZE_POWER*2;if(C-A<=e.MIN_DYNAMIC_RANGE&&(U=A/2,f>0&&g>0)){var W=(h[f-1][g]+2*h[f][g-1]+h[f-1][g-1])/4;A<W&&(U=W)}h[f][g]=U}}return h},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e}(GlobalHistogramBinarizer),LuminanceSource=function(){function r(e,t){this.width=e,this.height=t}return r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.isCropSupported=function(){return!1},r.prototype.crop=function(e,t,n,i){throw new UnsupportedOperationException("This luminance source does not support cropping.")},r.prototype.isRotateSupported=function(){return!1},r.prototype.rotateCounterClockwise=function(){throw new UnsupportedOperationException("This luminance source does not support rotation by 90 degrees.")},r.prototype.rotateCounterClockwise45=function(){throw new UnsupportedOperationException("This luminance source does not support rotation by 45 degrees.")},r.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),t=new StringBuilder,n=0;n<this.height;n++){for(var i=this.getRow(n,e),s=0;s<this.width;s++){var a=i[s]&255,o=void 0;a<64?o="#":a<128?o="+":a<192?o=".":o=" ",t.append(o)}t.append(`
`)}return t.toString()},r}(),__extends$Z=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),InvertedLuminanceSource=function(r){__extends$Z(e,r);function e(t){var n=r.call(this,t.getWidth(),t.getHeight())||this;return n.delegate=t,n}return e.prototype.getRow=function(t,n){for(var i=this.delegate.getRow(t,n),s=this.getWidth(),a=0;a<s;a++)i[a]=255-(i[a]&255);return i},e.prototype.getMatrix=function(){for(var t=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),i=new Uint8ClampedArray(n),s=0;s<n;s++)i[s]=255-(t[s]&255);return i},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(t,n,i,s){return new e(this.delegate.crop(t,n,i,s))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e}(LuminanceSource),__extends$Y=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),HTMLCanvasElementLuminanceSource=function(r){__extends$Y(e,r);function e(t,n){n===void 0&&(n=!1);var i=r.call(this,t.width,t.height)||this;return i.canvas=t,i.tempCanvasElement=null,i.buffer=e.makeBufferFromCanvasImageData(t,n),i}return e.makeBufferFromCanvasImageData=function(t,n){n===void 0&&(n=!1);var i=t.getContext("2d").getImageData(0,0,t.width,t.height);return e.toGrayscaleBuffer(i.data,t.width,t.height,n)},e.toGrayscaleBuffer=function(t,n,i,s){s===void 0&&(s=!1);var a=new Uint8ClampedArray(n*i);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX||!s)for(var o=0,c=0,h=t.length;o<h;o+=4,c++){var f=void 0,m=t[o+3];if(m===0)f=255;else{var g=t[o],_=t[o+1],E=t[o+2];f=306*g+601*_+117*E+512>>10}a[c]=f}else for(var o=0,c=0,A=t.length;o<A;o+=4,c++){var f=void 0,m=t[o+3];if(m===0)f=255;else{var g=t[o],_=t[o+1],E=t[o+2];f=306*g+601*_+117*E+512>>10}a[c]=255-f}return a},e.prototype.getRow=function(t,n){if(t<0||t>=this.getHeight())throw new IllegalArgumentException("Requested row is outside the image: "+t);var i=this.getWidth(),s=t*i;return n===null?n=this.buffer.slice(s,s+i):(n.length<i&&(n=new Uint8ClampedArray(i)),n.set(this.buffer.slice(s,s+i))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,n,i,s){return r.prototype.crop.call(this,t,n,i,s),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement},e.prototype.rotate=function(t){var n=this.getTempCanvasElement(),i=n.getContext("2d"),s=t*e.DEGREE_TO_RADIANS,a=this.canvas.width,o=this.canvas.height,c=Math.ceil(Math.abs(Math.cos(s))*a+Math.abs(Math.sin(s))*o),h=Math.ceil(Math.abs(Math.sin(s))*a+Math.abs(Math.cos(s))*o);return n.width=c,n.height=h,i.translate(c/2,h/2),i.rotate(s),i.drawImage(this.canvas,a/-2,o/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.prototype.invert=function(){return new InvertedLuminanceSource(this)},e.DEGREE_TO_RADIANS=Math.PI/180,e.FRAME_INDEX=!0,e}(LuminanceSource),VideoInputDevice=function(){function r(e,t,n){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=n||void 0}return r.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},r}(),__awaiter=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(f){try{h(n.next(f))}catch(m){a(m)}}function c(f){try{h(n.throw(f))}catch(m){a(m)}}function h(f){f.done?s(f.value):i(f.value).then(o,c)}h((n=n.apply(r,e||[])).next())})},__generator=function(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(h){return function(f){return c([h,f])}}function c(h){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,i&&(s=h[0]&2?i.return:h[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,h[1])).done)return s;switch(i=0,s&&(h=[h[0]&2,s.value]),h[0]){case 0:case 1:s=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,i=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!s||h[1]>s[0]&&h[1]<s[3])){t.label=h[1];break}if(h[0]===6&&t.label<s[1]){t.label=s[1],s=h;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(h);break}s[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(r,t)}catch(f){h=[6,f],i=0}finally{n=s=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},__values$H=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},BrowserCodeReader=function(){function r(e,t,n){t===void 0&&(t=500),this.reader=e,this.timeBetweenScansMillis=t,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(r.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),r.prototype.listVideoInputDevices=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,i,s,a,o,c,h,f,m,g;return __generator(this,function(_){switch(_.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=_.sent(),t=[];try{for(n=__values$H(e),i=n.next();!i.done;i=n.next())s=i.value,a=s.kind==="video"?"videoinput":s.kind,a==="videoinput"&&(o=s.deviceId||s.id,c=s.label||"Video device "+(t.length+1),h=s.groupId,f={deviceId:o,label:c,kind:a,groupId:h},t.push(f))}catch(E){m={error:E}}finally{try{i&&!i.done&&(g=n.return)&&g.call(n)}finally{if(m)throw m.error}}return[2,t]}})})},r.prototype.getVideoInputDevices=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,this.listVideoInputDevices()];case 1:return e=t.sent(),[2,e.map(function(n){return new VideoInputDevice(n.deviceId,n.label)})]}})})},r.prototype.findDeviceById=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return t=n.sent(),t?[2,t.find(function(i){return i.deviceId===e})]:[2,null]}})})},r.prototype.decodeFromInputVideoDevice=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,t)];case 1:return[2,n.sent()]}})})},r.prototype.decodeOnceFromVideoDevice=function(e,t){return __awaiter(this,void 0,void 0,function(){var n,i;return __generator(this,function(s){switch(s.label){case 0:return this.reset(),e?n={deviceId:{exact:e}}:n={facingMode:"environment"},i={video:n},[4,this.decodeOnceFromConstraints(i,t)];case 1:return[2,s.sent()]}})})},r.prototype.decodeOnceFromConstraints=function(e,t){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(i){switch(i.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return n=i.sent(),[4,this.decodeOnceFromStream(n,t)];case 2:return[2,i.sent()]}})})},r.prototype.decodeOnceFromStream=function(e,t){return __awaiter(this,void 0,void 0,function(){var n,i;return __generator(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,t)];case 1:return n=s.sent(),[4,this.decodeOnce(n)];case 2:return i=s.sent(),[2,i]}})})},r.prototype.decodeFromInputVideoDeviceContinuously=function(e,t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:return[4,this.decodeFromVideoDevice(e,t,n)];case 1:return[2,i.sent()]}})})},r.prototype.decodeFromVideoDevice=function(e,t,n){return __awaiter(this,void 0,void 0,function(){var i,s;return __generator(this,function(a){switch(a.label){case 0:return e?i={deviceId:{exact:e}}:i={facingMode:"environment"},s={video:i},[4,this.decodeFromConstraints(s,t,n)];case 1:return[2,a.sent()]}})})},r.prototype.decodeFromConstraints=function(e,t,n){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(s){switch(s.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return i=s.sent(),[4,this.decodeFromStream(i,t,n)];case 2:return[2,s.sent()]}})})},r.prototype.decodeFromStream=function(e,t,n){return __awaiter(this,void 0,void 0,function(){var i;return __generator(this,function(s){switch(s.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,t)];case 1:return i=s.sent(),[4,this.decodeContinuously(i,n)];case 2:return[2,s.sent()]}})})},r.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},r.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},r.prototype.attachStreamToVideo=function(e,t){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(i){switch(i.label){case 0:return n=this.prepareVideoElement(t),this.addVideoSource(n,e),this.videoElement=n,this.stream=e,[4,this.playVideoOnLoadAsync(n)];case 1:return i.sent(),[2,n]}})})},r.prototype.playVideoOnLoadAsync=function(e){var t=this;return new Promise(function(n,i){return t.playVideoOnLoad(e,function(){return n()})})},r.prototype.playVideoOnLoad=function(e,t){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)},r.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},r.prototype.tryPlayVideo=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,e.play()];case 2:return t.sent(),[3,4];case 3:return t.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},r.prototype.getMediaElement=function(e,t){var n=document.getElementById(e);if(!n)throw new ArgumentException("element with id '"+e+"' not found");if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new ArgumentException("element with id '"+e+"' must be an "+t+" element");return n},r.prototype.decodeFromImage=function(e,t){if(!e&&!t)throw new ArgumentException("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)},r.prototype.decodeFromVideo=function(e,t){if(!e&&!t)throw new ArgumentException("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)},r.prototype.decodeFromVideoContinuously=function(e,t,n){if(e===void 0&&t===void 0)throw new ArgumentException("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,n):this.decodeFromVideoElementContinuously(e,n)},r.prototype.decodeFromImageElement=function(e){if(!e)throw new ArgumentException("An image element must be provided.");this.reset();var t=this.prepareImageElement(e);this.imageElement=t;var n;return this.isImageLoaded(t)?n=this.decodeOnce(t,!1,!0):n=this._decodeOnLoadImage(t),n},r.prototype.decodeFromVideoElement=function(e){var t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)},r.prototype.decodeFromVideoElementContinuously=function(e,t){var n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,t)},r.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new ArgumentException("A video element must be provided.");this.reset();var t=this.prepareVideoElement(e);return this.videoElement=t,t},r.prototype.decodeFromImageUrl=function(e){if(!e)throw new ArgumentException("An URL must be provided.");this.reset();var t=this.prepareImageElement();this.imageElement=t;var n=this._decodeOnLoadImage(t);return t.src=e,n},r.prototype.decodeFromVideoUrl=function(e){if(!e)throw new ArgumentException("An URL must be provided.");this.reset();var t=this.prepareVideoElement(),n=this.decodeFromVideoElement(t);return t.src=e,n},r.prototype.decodeFromVideoUrlContinuously=function(e,t){if(!e)throw new ArgumentException("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),i=this.decodeFromVideoElementContinuously(n,t);return n.src=e,i},r.prototype._decodeOnLoadImage=function(e){var t=this;return new Promise(function(n,i){t.imageLoadedListener=function(){return t.decodeOnce(e,!1,!0).then(n,i)},e.addEventListener("load",t.imageLoadedListener)})},r.prototype._decodeOnLoadVideo=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return t.sent(),[4,this.decodeOnce(e)];case 2:return[2,t.sent()]}})})},r.prototype._decodeOnLoadVideoContinuously=function(e,t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return n.sent(),this.decodeContinuously(e,t),[2]}})})},r.prototype.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},r.prototype.prepareImageElement=function(e){var t;return typeof e>"u"&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t},r.prototype.prepareVideoElement=function(e){var t;return!e&&typeof document<"u"&&(t=document.createElement("video"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t},r.prototype.decodeOnce=function(e,t,n){var i=this;t===void 0&&(t=!0),n===void 0&&(n=!0),this._stopAsyncDecode=!1;var s=function(a,o){if(i._stopAsyncDecode){o(new NotFoundException("Video stream has ended before any code could be detected.")),i._stopAsyncDecode=void 0;return}try{var c=i.decode(e);a(c)}catch(g){var h=t&&g instanceof NotFoundException,f=g instanceof ChecksumException||g instanceof FormatException,m=f&&n;if(h||m)return setTimeout(s,i._timeBetweenDecodingAttempts,a,o);o(g)}};return new Promise(function(a,o){return s(a,o)})},r.prototype.decodeContinuously=function(e,t){var n=this;this._stopContinuousDecode=!1;var i=function(){if(n._stopContinuousDecode){n._stopContinuousDecode=void 0;return}try{var s=n.decode(e);t(s,null),setTimeout(i,n.timeBetweenScansMillis)}catch(c){t(null,c);var a=c instanceof ChecksumException||c instanceof FormatException,o=c instanceof NotFoundException;(a||o)&&setTimeout(i,n._timeBetweenDecodingAttempts)}};i()},r.prototype.decode=function(e){var t=this.createBinaryBitmap(e);return this.decodeBitmap(t)},r.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e);var t=!1;e instanceof HTMLVideoElement?(this.drawFrameOnCanvas(e),t=!0):this.drawImageOnCanvas(e);var n=this.getCaptureCanvas(e),i=new HTMLCanvasElementLuminanceSource(n,t),s=new HybridBinarizer(i);return new BinaryBitmap(s)},r.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var t=this.getCaptureCanvas(e),n=void 0;try{n=t.getContext("2d",{willReadFrequently:!0})}catch{n=t.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},r.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas},r.prototype.drawFrameOnCanvas=function(e,t,n){t===void 0&&(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)},r.prototype.drawImageOnCanvas=function(e,t,n){t===void 0&&(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)},r.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},r.prototype.createCaptureCanvas=function(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var t=document.createElement("canvas"),n,i;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,i=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,i=e.naturalHeight||e.height)),t.style.width=n+"px",t.style.height=i+"px",t.width=n,t.height=i,t},r.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},r.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},r.prototype._destroyVideoElement=function(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},r.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},r.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},r.prototype.addVideoSource=function(e,t){try{e.srcObject=t}catch{e.src=URL.createObjectURL(t)}},r.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")},r}(),Result=function(){function r(e,t,n,i,s,a){n===void 0&&(n=t==null?0:8*t.length),a===void 0&&(a=System.currentTimeMillis()),this.text=e,this.rawBytes=t,this.numBits=n,this.resultPoints=i,this.format=s,this.timestamp=a,this.text=e,this.rawBytes=t,n==null?this.numBits=t==null?0:8*t.length:this.numBits=n,this.resultPoints=i,this.format=s,this.resultMetadata=null,a==null?this.timestamp=System.currentTimeMillis():this.timestamp=a}return r.prototype.getText=function(){return this.text},r.prototype.getRawBytes=function(){return this.rawBytes},r.prototype.getNumBits=function(){return this.numBits},r.prototype.getResultPoints=function(){return this.resultPoints},r.prototype.getBarcodeFormat=function(){return this.format},r.prototype.getResultMetadata=function(){return this.resultMetadata},r.prototype.putMetadata=function(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)},r.prototype.putAllMetadata=function(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))},r.prototype.addResultPoints=function(e){var t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){var n=new Array(t.length+e.length);System.arraycopy(t,0,n,0,t.length),System.arraycopy(e,0,n,t.length,e.length),this.resultPoints=n}},r.prototype.getTimestamp=function(){return this.timestamp},r.prototype.toString=function(){return this.text},r}(),BarcodeFormat;(function(r){r[r.AZTEC=0]="AZTEC",r[r.CODABAR=1]="CODABAR",r[r.CODE_39=2]="CODE_39",r[r.CODE_93=3]="CODE_93",r[r.CODE_128=4]="CODE_128",r[r.DATA_MATRIX=5]="DATA_MATRIX",r[r.EAN_8=6]="EAN_8",r[r.EAN_13=7]="EAN_13",r[r.ITF=8]="ITF",r[r.MAXICODE=9]="MAXICODE",r[r.PDF_417=10]="PDF_417",r[r.QR_CODE=11]="QR_CODE",r[r.RSS_14=12]="RSS_14",r[r.RSS_EXPANDED=13]="RSS_EXPANDED",r[r.UPC_A=14]="UPC_A",r[r.UPC_E=15]="UPC_E",r[r.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(BarcodeFormat||(BarcodeFormat={}));const BarcodeFormat$1=BarcodeFormat;var ResultMetadataType;(function(r){r[r.OTHER=0]="OTHER",r[r.ORIENTATION=1]="ORIENTATION",r[r.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",r[r.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",r[r.ISSUE_NUMBER=4]="ISSUE_NUMBER",r[r.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",r[r.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",r[r.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",r[r.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",r[r.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",r[r.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(ResultMetadataType||(ResultMetadataType={}));const ResultMetadataType$1=ResultMetadataType;var DecoderResult=function(){function r(e,t,n,i,s,a){s===void 0&&(s=-1),a===void 0&&(a=-1),this.rawBytes=e,this.text=t,this.byteSegments=n,this.ecLevel=i,this.structuredAppendSequenceNumber=s,this.structuredAppendParity=a,this.numBits=e==null?0:8*e.length}return r.prototype.getRawBytes=function(){return this.rawBytes},r.prototype.getNumBits=function(){return this.numBits},r.prototype.setNumBits=function(e){this.numBits=e},r.prototype.getText=function(){return this.text},r.prototype.getByteSegments=function(){return this.byteSegments},r.prototype.getECLevel=function(){return this.ecLevel},r.prototype.getErrorsCorrected=function(){return this.errorsCorrected},r.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},r.prototype.getErasures=function(){return this.erasures},r.prototype.setErasures=function(e){this.erasures=e},r.prototype.getOther=function(){return this.other},r.prototype.setOther=function(e){this.other=e},r.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},r.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},r.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},r}(),AbstractGenericGF=function(){function r(){}return r.prototype.exp=function(e){return this.expTable[e]},r.prototype.log=function(e){if(e===0)throw new IllegalArgumentException;return this.logTable[e]},r.addOrSubtract=function(e,t){return e^t},r}(),GenericGFPoly=function(){function r(e,t){if(t.length===0)throw new IllegalArgumentException;this.field=e;var n=t.length;if(n>1&&t[0]===0){for(var i=1;i<n&&t[i]===0;)i++;i===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-i),System.arraycopy(t,i,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}return r.prototype.getCoefficients=function(){return this.coefficients},r.prototype.getDegree=function(){return this.coefficients.length-1},r.prototype.isZero=function(){return this.coefficients[0]===0},r.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},r.prototype.evaluateAt=function(e){if(e===0)return this.getCoefficient(0);var t=this.coefficients,n;if(e===1){n=0;for(var i=0,s=t.length;i!==s;i++){var a=t[i];n=AbstractGenericGF.addOrSubtract(n,a)}return n}n=t[0];for(var o=t.length,c=this.field,i=1;i<o;i++)n=AbstractGenericGF.addOrSubtract(c.multiply(e,n),t[i]);return n},r.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var t=this.coefficients,n=e.coefficients;if(t.length>n.length){var i=t;t=n,n=i}var s=new Int32Array(n.length),a=n.length-t.length;System.arraycopy(n,0,s,0,a);for(var o=a;o<n.length;o++)s[o]=AbstractGenericGF.addOrSubtract(t[o-a],n[o]);return new r(this.field,s)},r.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var t=this.coefficients,n=t.length,i=e.coefficients,s=i.length,a=new Int32Array(n+s-1),o=this.field,c=0;c<n;c++)for(var h=t[c],f=0;f<s;f++)a[c+f]=AbstractGenericGF.addOrSubtract(a[c+f],o.multiply(h,i[f]));return new r(o,a)},r.prototype.multiplyScalar=function(e){if(e===0)return this.field.getZero();if(e===1)return this;for(var t=this.coefficients.length,n=this.field,i=new Int32Array(t),s=this.coefficients,a=0;a<t;a++)i[a]=n.multiply(s[a],e);return new r(n,i)},r.prototype.multiplyByMonomial=function(e,t){if(e<0)throw new IllegalArgumentException;if(t===0)return this.field.getZero();for(var n=this.coefficients,i=n.length,s=new Int32Array(i+e),a=this.field,o=0;o<i;o++)s[o]=a.multiply(n[o],t);return new r(a,s)},r.prototype.divide=function(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new IllegalArgumentException("Divide by 0");for(var t=this.field,n=t.getZero(),i=this,s=e.getCoefficient(e.getDegree()),a=t.inverse(s);i.getDegree()>=e.getDegree()&&!i.isZero();){var o=i.getDegree()-e.getDegree(),c=t.multiply(i.getCoefficient(i.getDegree()),a),h=e.multiplyByMonomial(o,c),f=t.buildMonomial(o,c);n=n.addOrSubtract(f),i=i.addOrSubtract(h)}return[n,i]},r.prototype.toString=function(){for(var e="",t=this.getDegree();t>=0;t--){var n=this.getCoefficient(t);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),t===0||n!==1){var i=this.field.log(n);i===0?e+="1":i===1?e+="a":(e+="a^",e+=i)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e},r}(),__extends$X=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ArithmeticException=function(r){__extends$X(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ArithmeticException",e}(Exception),__extends$W=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),GenericGF=function(r){__extends$W(e,r);function e(t,n,i){var s=r.call(this)||this;s.primitive=t,s.size=n,s.generatorBase=i;for(var a=new Int32Array(n),o=1,c=0;c<n;c++)a[c]=o,o*=2,o>=n&&(o^=t,o&=n-1);s.expTable=a;for(var h=new Int32Array(n),c=0;c<n-1;c++)h[a[c]]=c;return s.logTable=h,s.zero=new GenericGFPoly(s,Int32Array.from([0])),s.one=new GenericGFPoly(s,Int32Array.from([1])),s}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(t,n){if(t<0)throw new IllegalArgumentException;if(n===0)return this.zero;var i=new Int32Array(t+1);return i[0]=n,new GenericGFPoly(this,i)},e.prototype.inverse=function(t){if(t===0)throw new ArithmeticException;return this.expTable[this.size-this.logTable[t]-1]},e.prototype.multiply=function(t,n){return t===0||n===0?0:this.expTable[(this.logTable[t]+this.logTable[n])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return"GF(0x"+Integer.toHexString(this.primitive)+","+this.size+")"},e.prototype.equals=function(t){return t===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e}(AbstractGenericGF),__extends$V=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ReedSolomonException=function(r){__extends$V(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ReedSolomonException",e}(Exception),__extends$U=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),IllegalStateException=function(r){__extends$U(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IllegalStateException",e}(Exception),ReedSolomonDecoder=function(){function r(e){this.field=e}return r.prototype.decode=function(e,t){for(var n=this.field,i=new GenericGFPoly(n,e),s=new Int32Array(t),a=!0,o=0;o<t;o++){var c=i.evaluateAt(n.exp(o+n.getGeneratorBase()));s[s.length-1-o]=c,c!==0&&(a=!1)}if(!a)for(var h=new GenericGFPoly(n,s),f=this.runEuclideanAlgorithm(n.buildMonomial(t,1),h,t),m=f[0],g=f[1],_=this.findErrorLocations(m),E=this.findErrorMagnitudes(g,_),o=0;o<_.length;o++){var A=e.length-1-n.log(_[o]);if(A<0)throw new ReedSolomonException("Bad error location");e[A]=GenericGF.addOrSubtract(e[A],E[o])}},r.prototype.runEuclideanAlgorithm=function(e,t,n){if(e.getDegree()<t.getDegree()){var i=e;e=t,t=i}for(var s=this.field,a=e,o=t,c=s.getZero(),h=s.getOne();o.getDegree()>=(n/2|0);){var f=a,m=c;if(a=o,c=h,a.isZero())throw new ReedSolomonException("r_{i-1} was zero");o=f;for(var g=s.getZero(),_=a.getCoefficient(a.getDegree()),E=s.inverse(_);o.getDegree()>=a.getDegree()&&!o.isZero();){var A=o.getDegree()-a.getDegree(),C=s.multiply(o.getCoefficient(o.getDegree()),E);g=g.addOrSubtract(s.buildMonomial(A,C)),o=o.addOrSubtract(a.multiplyByMonomial(A,C))}if(h=g.multiply(c).addOrSubtract(m),o.getDegree()>=a.getDegree())throw new IllegalStateException("Division algorithm failed to reduce polynomial?")}var I=h.getCoefficient(0);if(I===0)throw new ReedSolomonException("sigmaTilde(0) was zero");var b=s.inverse(I),R=h.multiplyScalar(b),V=o.multiplyScalar(b);return[R,V]},r.prototype.findErrorLocations=function(e){var t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);for(var n=new Int32Array(t),i=0,s=this.field,a=1;a<s.getSize()&&i<t;a++)e.evaluateAt(a)===0&&(n[i]=s.inverse(a),i++);if(i!==t)throw new ReedSolomonException("Error locator degree does not match number of roots");return n},r.prototype.findErrorMagnitudes=function(e,t){for(var n=t.length,i=new Int32Array(n),s=this.field,a=0;a<n;a++){for(var o=s.inverse(t[a]),c=1,h=0;h<n;h++)if(a!==h){var f=s.multiply(t[h],o),m=(f&1)===0?f|1:f&-2;c=s.multiply(c,m)}i[a]=s.multiply(e.evaluateAt(o),s.inverse(c)),s.getGeneratorBase()!==0&&(i[a]=s.multiply(i[a],o))}return i},r}(),Table;(function(r){r[r.UPPER=0]="UPPER",r[r.LOWER=1]="LOWER",r[r.MIXED=2]="MIXED",r[r.DIGIT=3]="DIGIT",r[r.PUNCT=4]="PUNCT",r[r.BINARY=5]="BINARY"})(Table||(Table={}));var Decoder$2=function(){function r(){}return r.prototype.decode=function(e){this.ddata=e;var t=e.getBits(),n=this.extractBits(t),i=this.correctBits(n),s=r.convertBoolArrayToByteArray(i),a=r.getEncodedData(i),o=new DecoderResult(s,a,null,null);return o.setNumBits(i.length),o},r.highLevelDecode=function(e){return this.getEncodedData(e)},r.getEncodedData=function(e){for(var t=e.length,n=Table.UPPER,i=Table.UPPER,s="",a=0;a<t;)if(i===Table.BINARY){if(t-a<5)break;var o=r.readCode(e,a,5);if(a+=5,o===0){if(t-a<11)break;o=r.readCode(e,a,11)+31,a+=11}for(var c=0;c<o;c++){if(t-a<8){a=t;break}var h=r.readCode(e,a,8);s+=StringUtils.castAsNonUtf8Char(h),a+=8}i=n}else{var f=i===Table.DIGIT?4:5;if(t-a<f)break;var h=r.readCode(e,a,f);a+=f;var m=r.getCharacter(i,h);m.startsWith("CTRL_")?(n=i,i=r.getTable(m.charAt(5)),m.charAt(6)==="L"&&(n=i)):(s+=m,i=n)}return s},r.getTable=function(e){switch(e){case"L":return Table.LOWER;case"P":return Table.PUNCT;case"M":return Table.MIXED;case"D":return Table.DIGIT;case"B":return Table.BINARY;case"U":default:return Table.UPPER}},r.getCharacter=function(e,t){switch(e){case Table.UPPER:return r.UPPER_TABLE[t];case Table.LOWER:return r.LOWER_TABLE[t];case Table.MIXED:return r.MIXED_TABLE[t];case Table.PUNCT:return r.PUNCT_TABLE[t];case Table.DIGIT:return r.DIGIT_TABLE[t];default:throw new IllegalStateException("Bad table")}},r.prototype.correctBits=function(e){var t,n;this.ddata.getNbLayers()<=2?(n=6,t=GenericGF.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,t=GenericGF.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,t=GenericGF.AZTEC_DATA_10):(n=12,t=GenericGF.AZTEC_DATA_12);var i=this.ddata.getNbDatablocks(),s=e.length/n;if(s<i)throw new FormatException;for(var a=e.length%n,o=new Int32Array(s),c=0;c<s;c++,a+=n)o[c]=r.readCode(e,a,n);try{var h=new ReedSolomonDecoder(t);h.decode(o,s-i)}catch(C){throw new FormatException(C)}for(var f=(1<<n)-1,m=0,c=0;c<i;c++){var g=o[c];if(g===0||g===f)throw new FormatException;(g===1||g===f-1)&&m++}for(var _=new Array(i*n-m),E=0,c=0;c<i;c++){var g=o[c];if(g===1||g===f-1)_.fill(g>1,E,E+n-1),E+=n-1;else for(var A=n-1;A>=0;--A)_[E++]=(g&1<<A)!==0}return _},r.prototype.extractBits=function(e){var t=this.ddata.isCompact(),n=this.ddata.getNbLayers(),i=(t?11:14)+n*4,s=new Int32Array(i),a=new Array(this.totalBitsInLayer(n,t));if(t)for(var o=0;o<s.length;o++)s[o]=o;else for(var c=i+1+2*Integer.truncDivision(Integer.truncDivision(i,2)-1,15),h=i/2,f=Integer.truncDivision(c,2),o=0;o<h;o++){var m=o+Integer.truncDivision(o,15);s[h-o-1]=f-m-1,s[h+o]=f+m+1}for(var o=0,g=0;o<n;o++){for(var _=(n-o)*4+(t?9:12),E=o*2,A=i-1-E,C=0;C<_;C++)for(var I=C*2,b=0;b<2;b++)a[g+I+b]=e.get(s[E+b],s[E+C]),a[g+2*_+I+b]=e.get(s[E+C],s[A-b]),a[g+4*_+I+b]=e.get(s[A-b],s[A-C]),a[g+6*_+I+b]=e.get(s[A-C],s[E+b]);g+=_*8}return a},r.readCode=function(e,t,n){for(var i=0,s=t;s<t+n;s++)i<<=1,e[s]&&(i|=1);return i},r.readByte=function(e,t){var n=e.length-t;return n>=8?r.readCode(e,t,8):r.readCode(e,t,n)<<8-n},r.convertBoolArrayToByteArray=function(e){for(var t=new Uint8Array((e.length+7)/8),n=0;n<t.length;n++)t[n]=r.readByte(e,8*n);return t},r.prototype.totalBitsInLayer=function(e,t){return((t?88:112)+16*e)*e},r.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],r.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],r.MIXED_TABLE=["CTRL_PS"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],r.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],r.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],r}(),MathUtils=function(){function r(){}return r.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},r.distance=function(e,t,n,i){var s=e-n,a=t-i;return Math.sqrt(s*s+a*a)},r.sum=function(e){for(var t=0,n=0,i=e.length;n!==i;n++){var s=e[n];t+=s}return t},r}(),Float=function(){function r(){}return r.floatToIntBits=function(e){return e},r.MAX_VALUE=Number.MAX_SAFE_INTEGER,r}(),ResultPoint=function(){function r(e,t){this.x=e,this.y=t}return r.prototype.getX=function(){return this.x},r.prototype.getY=function(){return this.y},r.prototype.equals=function(e){if(e instanceof r){var t=e;return this.x===t.x&&this.y===t.y}return!1},r.prototype.hashCode=function(){return 31*Float.floatToIntBits(this.x)+Float.floatToIntBits(this.y)},r.prototype.toString=function(){return"("+this.x+","+this.y+")"},r.orderBestPatterns=function(e){var t=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),i=this.distance(e[0],e[2]),s,a,o;if(n>=t&&n>=i?(a=e[0],s=e[1],o=e[2]):i>=n&&i>=t?(a=e[1],s=e[0],o=e[2]):(a=e[2],s=e[0],o=e[1]),this.crossProductZ(s,a,o)<0){var c=s;s=o,o=c}e[0]=s,e[1]=a,e[2]=o},r.distance=function(e,t){return MathUtils.distance(e.x,e.y,t.x,t.y)},r.crossProductZ=function(e,t,n){var i=t.x,s=t.y;return(n.x-i)*(e.y-s)-(n.y-s)*(e.x-i)},r}(),DetectorResult=function(){function r(e,t){this.bits=e,this.points=t}return r.prototype.getBits=function(){return this.bits},r.prototype.getPoints=function(){return this.points},r}(),__extends$T=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AztecDetectorResult=function(r){__extends$T(e,r);function e(t,n,i,s,a){var o=r.call(this,t,n)||this;return o.compact=i,o.nbDatablocks=s,o.nbLayers=a,o}return e.prototype.getNbLayers=function(){return this.nbLayers},e.prototype.getNbDatablocks=function(){return this.nbDatablocks},e.prototype.isCompact=function(){return this.compact},e}(DetectorResult),WhiteRectangleDetector=function(){function r(e,t,n,i){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),t==null&&(t=r.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),i==null&&(i=e.getHeight()/2|0);var s=t/2|0;if(this.leftInit=n-s,this.rightInit=n+s,this.upInit=i-s,this.downInit=i+s,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new NotFoundException}return r.prototype.detect=function(){for(var e=this.leftInit,t=this.rightInit,n=this.upInit,i=this.downInit,s=!1,a=!0,o=!1,c=!1,h=!1,f=!1,m=!1,g=this.width,_=this.height;a;){a=!1;for(var E=!0;(E||!c)&&t<g;)E=this.containsBlackPoint(n,i,t,!1),E?(t++,a=!0,c=!0):c||t++;if(t>=g){s=!0;break}for(var A=!0;(A||!h)&&i<_;)A=this.containsBlackPoint(e,t,i,!0),A?(i++,a=!0,h=!0):h||i++;if(i>=_){s=!0;break}for(var C=!0;(C||!f)&&e>=0;)C=this.containsBlackPoint(n,i,e,!1),C?(e--,a=!0,f=!0):f||e--;if(e<0){s=!0;break}for(var I=!0;(I||!m)&&n>=0;)I=this.containsBlackPoint(e,t,n,!0),I?(n--,a=!0,m=!0):m||n--;if(n<0){s=!0;break}a&&(o=!0)}if(!s&&o){for(var b=t-e,R=null,V=1;R===null&&V<b;V++)R=this.getBlackPointOnSegment(e,i-V,e+V,i);if(R==null)throw new NotFoundException;for(var U=null,V=1;U===null&&V<b;V++)U=this.getBlackPointOnSegment(e,n+V,e+V,n);if(U==null)throw new NotFoundException;for(var W=null,V=1;W===null&&V<b;V++)W=this.getBlackPointOnSegment(t,n+V,t-V,n);if(W==null)throw new NotFoundException;for(var j=null,V=1;j===null&&V<b;V++)j=this.getBlackPointOnSegment(t,i-V,t-V,i);if(j==null)throw new NotFoundException;return this.centerEdges(j,R,W,U)}else throw new NotFoundException},r.prototype.getBlackPointOnSegment=function(e,t,n,i){for(var s=MathUtils.round(MathUtils.distance(e,t,n,i)),a=(n-e)/s,o=(i-t)/s,c=this.image,h=0;h<s;h++){var f=MathUtils.round(e+h*a),m=MathUtils.round(t+h*o);if(c.get(f,m))return new ResultPoint(f,m)}return null},r.prototype.centerEdges=function(e,t,n,i){var s=e.getX(),a=e.getY(),o=t.getX(),c=t.getY(),h=n.getX(),f=n.getY(),m=i.getX(),g=i.getY(),_=r.CORR;return s<this.width/2?[new ResultPoint(m-_,g+_),new ResultPoint(o+_,c+_),new ResultPoint(h-_,f-_),new ResultPoint(s+_,a-_)]:[new ResultPoint(m+_,g+_),new ResultPoint(o+_,c-_),new ResultPoint(h-_,f+_),new ResultPoint(s-_,a-_)]},r.prototype.containsBlackPoint=function(e,t,n,i){var s=this.image;if(i){for(var a=e;a<=t;a++)if(s.get(a,n))return!0}else for(var o=e;o<=t;o++)if(s.get(n,o))return!0;return!1},r.INIT_SIZE=10,r.CORR=1,r}(),GridSampler=function(){function r(){}return r.checkAndNudgePoints=function(e,t){for(var n=e.getWidth(),i=e.getHeight(),s=!0,a=0;a<t.length&&s;a+=2){var o=Math.floor(t[a]),c=Math.floor(t[a+1]);if(o<-1||o>n||c<-1||c>i)throw new NotFoundException;s=!1,o===-1?(t[a]=0,s=!0):o===n&&(t[a]=n-1,s=!0),c===-1?(t[a+1]=0,s=!0):c===i&&(t[a+1]=i-1,s=!0)}s=!0;for(var a=t.length-2;a>=0&&s;a-=2){var o=Math.floor(t[a]),c=Math.floor(t[a+1]);if(o<-1||o>n||c<-1||c>i)throw new NotFoundException;s=!1,o===-1?(t[a]=0,s=!0):o===n&&(t[a]=n-1,s=!0),c===-1?(t[a+1]=0,s=!0):c===i&&(t[a+1]=i-1,s=!0)}},r}(),PerspectiveTransform=function(){function r(e,t,n,i,s,a,o,c,h){this.a11=e,this.a21=t,this.a31=n,this.a12=i,this.a22=s,this.a32=a,this.a13=o,this.a23=c,this.a33=h}return r.quadrilateralToQuadrilateral=function(e,t,n,i,s,a,o,c,h,f,m,g,_,E,A,C){var I=r.quadrilateralToSquare(e,t,n,i,s,a,o,c),b=r.squareToQuadrilateral(h,f,m,g,_,E,A,C);return b.times(I)},r.prototype.transformPoints=function(e){for(var t=e.length,n=this.a11,i=this.a12,s=this.a13,a=this.a21,o=this.a22,c=this.a23,h=this.a31,f=this.a32,m=this.a33,g=0;g<t;g+=2){var _=e[g],E=e[g+1],A=s*_+c*E+m;e[g]=(n*_+a*E+h)/A,e[g+1]=(i*_+o*E+f)/A}},r.prototype.transformPointsWithValues=function(e,t){for(var n=this.a11,i=this.a12,s=this.a13,a=this.a21,o=this.a22,c=this.a23,h=this.a31,f=this.a32,m=this.a33,g=e.length,_=0;_<g;_++){var E=e[_],A=t[_],C=s*E+c*A+m;e[_]=(n*E+a*A+h)/C,t[_]=(i*E+o*A+f)/C}},r.squareToQuadrilateral=function(e,t,n,i,s,a,o,c){var h=e-n+s-o,f=t-i+a-c;if(h===0&&f===0)return new r(n-e,s-n,e,i-t,a-i,t,0,0,1);var m=n-s,g=o-s,_=i-a,E=c-a,A=m*E-g*_,C=(h*E-g*f)/A,I=(m*f-h*_)/A;return new r(n-e+C*n,o-e+I*o,e,i-t+C*i,c-t+I*c,t,C,I,1)},r.quadrilateralToSquare=function(e,t,n,i,s,a,o,c){return r.squareToQuadrilateral(e,t,n,i,s,a,o,c).buildAdjoint()},r.prototype.buildAdjoint=function(){return new r(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},r.prototype.times=function(e){return new r(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},r}(),__extends$S=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),DefaultGridSampler=function(r){__extends$S(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.sampleGrid=function(t,n,i,s,a,o,c,h,f,m,g,_,E,A,C,I,b,R,V){var U=PerspectiveTransform.quadrilateralToQuadrilateral(s,a,o,c,h,f,m,g,_,E,A,C,I,b,R,V);return this.sampleGridWithTransform(t,n,i,U)},e.prototype.sampleGridWithTransform=function(t,n,i,s){if(n<=0||i<=0)throw new NotFoundException;for(var a=new BitMatrix(n,i),o=new Float32Array(2*n),c=0;c<i;c++){for(var h=o.length,f=c+.5,m=0;m<h;m+=2)o[m]=m/2+.5,o[m+1]=f;s.transformPoints(o),GridSampler.checkAndNudgePoints(t,o);try{for(var m=0;m<h;m+=2)t.get(Math.floor(o[m]),Math.floor(o[m+1]))&&a.set(m/2,c)}catch{throw new NotFoundException}}return a},e}(GridSampler),GridSamplerInstance=function(){function r(){}return r.setGridSampler=function(e){r.gridSampler=e},r.getInstance=function(){return r.gridSampler},r.gridSampler=new DefaultGridSampler,r}(),Point=function(){function r(e,t){this.x=e,this.y=t}return r.prototype.toResultPoint=function(){return new ResultPoint(this.getX(),this.getY())},r.prototype.getX=function(){return this.x},r.prototype.getY=function(){return this.y},r}(),Detector$3=function(){function r(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return r.prototype.detect=function(){return this.detectMirror(!1)},r.prototype.detectMirror=function(e){var t=this.getMatrixCenter(),n=this.getBullsEyeCorners(t);if(e){var i=n[0];n[0]=n[2],n[2]=i}this.extractParameters(n);var s=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),a=this.getMatrixCornerPoints(n);return new AztecDetectorResult(s,a,this.compact,this.nbDataBlocks,this.nbLayers)},r.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new NotFoundException;var t=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(n,t);for(var i=0,s=0;s<4;s++){var a=n[(this.shift+s)%4];this.compact?(i<<=7,i+=a>>1&127):(i<<=10,i+=(a>>2&992)+(a>>1&31))}var o=this.getCorrectedParameterData(i,this.compact);this.compact?(this.nbLayers=(o>>6)+1,this.nbDataBlocks=(o&63)+1):(this.nbLayers=(o>>11)+1,this.nbDataBlocks=(o&2047)+1)},r.prototype.getRotation=function(e,t){var n=0;e.forEach(function(s,a,o){var c=(s>>t-2<<1)+(s&1);n=(n<<3)+c}),n=((n&1)<<11)+(n>>1);for(var i=0;i<4;i++)if(Integer.bitCount(n^this.EXPECTED_CORNER_BITS[i])<=2)return i;throw new NotFoundException},r.prototype.getCorrectedParameterData=function(e,t){var n,i;t?(n=7,i=2):(n=10,i=4);for(var s=n-i,a=new Int32Array(n),o=n-1;o>=0;--o)a[o]=e&15,e>>=4;try{var c=new ReedSolomonDecoder(GenericGF.AZTEC_PARAM);c.decode(a,s)}catch{throw new NotFoundException}for(var h=0,o=0;o<i;o++)h=(h<<4)+a[o];return h},r.prototype.getBullsEyeCorners=function(e){var t=e,n=e,i=e,s=e,a=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var o=this.getFirstDifferent(t,a,1,-1),c=this.getFirstDifferent(n,a,1,1),h=this.getFirstDifferent(i,a,-1,1),f=this.getFirstDifferent(s,a,-1,-1);if(this.nbCenterLayers>2){var m=this.distancePoint(f,o)*this.nbCenterLayers/(this.distancePoint(s,t)*(this.nbCenterLayers+2));if(m<.75||m>1.25||!this.isWhiteOrBlackRectangle(o,c,h,f))break}t=o,n=c,i=h,s=f,a=!a}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new NotFoundException;this.compact=this.nbCenterLayers===5;var g=new ResultPoint(t.getX()+.5,t.getY()-.5),_=new ResultPoint(n.getX()+.5,n.getY()+.5),E=new ResultPoint(i.getX()-.5,i.getY()+.5),A=new ResultPoint(s.getX()-.5,s.getY()-.5);return this.expandSquare([g,_,E,A],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},r.prototype.getMatrixCenter=function(){var e,t,n,i;try{var s=new WhiteRectangleDetector(this.image).detect();e=s[0],t=s[1],n=s[2],i=s[3]}catch{var a=this.image.getWidth()/2,o=this.image.getHeight()/2;e=this.getFirstDifferent(new Point(a+7,o-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Point(a+7,o+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Point(a-7,o+7),!1,-1,1).toResultPoint(),i=this.getFirstDifferent(new Point(a-7,o-7),!1,-1,-1).toResultPoint()}var c=MathUtils.round((e.getX()+i.getX()+t.getX()+n.getX())/4),h=MathUtils.round((e.getY()+i.getY()+t.getY()+n.getY())/4);try{var s=new WhiteRectangleDetector(this.image,15,c,h).detect();e=s[0],t=s[1],n=s[2],i=s[3]}catch{e=this.getFirstDifferent(new Point(c+7,h-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new Point(c+7,h+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new Point(c-7,h+7),!1,-1,1).toResultPoint(),i=this.getFirstDifferent(new Point(c-7,h-7),!1,-1,-1).toResultPoint()}return c=MathUtils.round((e.getX()+i.getX()+t.getX()+n.getX())/4),h=MathUtils.round((e.getY()+i.getY()+t.getY()+n.getY())/4),new Point(c,h)},r.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},r.prototype.sampleGrid=function(e,t,n,i,s){var a=GridSamplerInstance.getInstance(),o=this.getDimension(),c=o/2-this.nbCenterLayers,h=o/2+this.nbCenterLayers;return a.sampleGrid(e,o,o,c,c,h,c,h,h,c,h,t.getX(),t.getY(),n.getX(),n.getY(),i.getX(),i.getY(),s.getX(),s.getY())},r.prototype.sampleLine=function(e,t,n){for(var i=0,s=this.distanceResultPoint(e,t),a=s/n,o=e.getX(),c=e.getY(),h=a*(t.getX()-e.getX())/s,f=a*(t.getY()-e.getY())/s,m=0;m<n;m++)this.image.get(MathUtils.round(o+m*h),MathUtils.round(c+m*f))&&(i|=1<<n-m-1);return i},r.prototype.isWhiteOrBlackRectangle=function(e,t,n,i){var s=3;e=new Point(e.getX()-s,e.getY()+s),t=new Point(t.getX()-s,t.getY()-s),n=new Point(n.getX()+s,n.getY()-s),i=new Point(i.getX()+s,i.getY()+s);var a=this.getColor(i,e);if(a===0)return!1;var o=this.getColor(e,t);return o!==a||(o=this.getColor(t,n),o!==a)?!1:(o=this.getColor(n,i),o===a)},r.prototype.getColor=function(e,t){for(var n=this.distancePoint(e,t),i=(t.getX()-e.getX())/n,s=(t.getY()-e.getY())/n,a=0,o=e.getX(),c=e.getY(),h=this.image.get(e.getX(),e.getY()),f=Math.ceil(n),m=0;m<f;m++)o+=i,c+=s,this.image.get(MathUtils.round(o),MathUtils.round(c))!==h&&a++;var g=a/n;return g>.1&&g<.9?0:g<=.1===h?1:-1},r.prototype.getFirstDifferent=function(e,t,n,i){for(var s=e.getX()+n,a=e.getY()+i;this.isValid(s,a)&&this.image.get(s,a)===t;)s+=n,a+=i;for(s-=n,a-=i;this.isValid(s,a)&&this.image.get(s,a)===t;)s+=n;for(s-=n;this.isValid(s,a)&&this.image.get(s,a)===t;)a+=i;return a-=i,new Point(s,a)},r.prototype.expandSquare=function(e,t,n){var i=n/(2*t),s=e[0].getX()-e[2].getX(),a=e[0].getY()-e[2].getY(),o=(e[0].getX()+e[2].getX())/2,c=(e[0].getY()+e[2].getY())/2,h=new ResultPoint(o+i*s,c+i*a),f=new ResultPoint(o-i*s,c-i*a);s=e[1].getX()-e[3].getX(),a=e[1].getY()-e[3].getY(),o=(e[1].getX()+e[3].getX())/2,c=(e[1].getY()+e[3].getY())/2;var m=new ResultPoint(o+i*s,c+i*a),g=new ResultPoint(o-i*s,c-i*a),_=[h,m,f,g];return _},r.prototype.isValid=function(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()},r.prototype.isValidPoint=function(e){var t=MathUtils.round(e.getX()),n=MathUtils.round(e.getY());return this.isValid(t,n)},r.prototype.distancePoint=function(e,t){return MathUtils.distance(e.getX(),e.getY(),t.getX(),t.getY())},r.prototype.distanceResultPoint=function(e,t){return MathUtils.distance(e.getX(),e.getY(),t.getX(),t.getY())},r.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(Integer.truncDivision(this.nbLayers-4,8)+1)+15},r}(),AztecReader=function(){function r(){}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var n=null,i=new Detector$3(e.getBlackMatrix()),s=null,a=null;try{var o=i.detectMirror(!1);s=o.getPoints(),this.reportFoundResultPoints(t,s),a=new Decoder$2().decode(o)}catch(m){n=m}if(a==null)try{var o=i.detectMirror(!0);s=o.getPoints(),this.reportFoundResultPoints(t,s),a=new Decoder$2().decode(o)}catch(m){throw n??m}var c=new Result(a.getText(),a.getRawBytes(),a.getNumBits(),s,BarcodeFormat$1.AZTEC,System.currentTimeMillis()),h=a.getByteSegments();h!=null&&c.putMetadata(ResultMetadataType$1.BYTE_SEGMENTS,h);var f=a.getECLevel();return f!=null&&c.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,f),c},r.prototype.reportFoundResultPoints=function(e,t){if(e!=null){var n=e.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);n!=null&&t.forEach(function(i,s,a){n.foundPossibleResultPoint(i)})}},r.prototype.reset=function(){},r}(),__extends$R=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){__extends$R(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new AztecReader,t)||this}return e})(BrowserCodeReader);var OneDReader=function(){function r(){}return r.prototype.decode=function(e,t){try{return this.doDecode(e,t)}catch{var n=t&&t.get(DecodeHintType$1.TRY_HARDER)===!0;if(n&&e.isRotateSupported()){var i=e.rotateCounterClockwise(),s=this.doDecode(i,t),a=s.getResultMetadata(),o=270;a!==null&&a.get(ResultMetadataType$1.ORIENTATION)===!0&&(o=o+a.get(ResultMetadataType$1.ORIENTATION)%360),s.putMetadata(ResultMetadataType$1.ORIENTATION,o);var c=s.getResultPoints();if(c!==null)for(var h=i.getHeight(),f=0;f<c.length;f++)c[f]=new ResultPoint(h-c[f].getY()-1,c[f].getX());return s}else throw new NotFoundException}},r.prototype.reset=function(){},r.prototype.doDecode=function(e,t){var n=e.getWidth(),i=e.getHeight(),s=new BitArray(n),a=t&&t.get(DecodeHintType$1.TRY_HARDER)===!0,o=Math.max(1,i>>(a?8:5)),c;a?c=i:c=15;for(var h=Math.trunc(i/2),f=0;f<c;f++){var m=Math.trunc((f+1)/2),g=(f&1)===0,_=h+o*(g?m:-m);if(_<0||_>=i)break;try{s=e.getBlackRow(_,s)}catch{continue}for(var E=function(b){if(b===1&&(s.reverse(),t&&t.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK)===!0)){var R=new Map;t.forEach(function(W,j){return R.set(j,W)}),R.delete(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK),t=R}try{var V=A.decodeRow(_,s,t);if(b===1){V.putMetadata(ResultMetadataType$1.ORIENTATION,180);var U=V.getResultPoints();U!==null&&(U[0]=new ResultPoint(n-U[0].getX()-1,U[0].getY()),U[1]=new ResultPoint(n-U[1].getX()-1,U[1].getY()))}return{value:V}}catch{}},A=this,C=0;C<2;C++){var I=E(C);if(typeof I=="object")return I.value}}throw new NotFoundException},r.recordPattern=function(e,t,n){for(var i=n.length,s=0;s<i;s++)n[s]=0;var a=e.getSize();if(t>=a)throw new NotFoundException;for(var o=!e.get(t),c=0,h=t;h<a;){if(e.get(h)!==o)n[c]++;else{if(++c===i)break;n[c]=1,o=!o}h++}if(!(c===i||c===i-1&&h===a))throw new NotFoundException},r.recordPatternInReverse=function(e,t,n){for(var i=n.length,s=e.get(t);t>0&&i>=0;)e.get(--t)!==s&&(i--,s=!s);if(i>=0)throw new NotFoundException;r.recordPattern(e,t+1,n)},r.patternMatchVariance=function(e,t,n){for(var i=e.length,s=0,a=0,o=0;o<i;o++)s+=e[o],a+=t[o];if(s<a)return Number.POSITIVE_INFINITY;var c=s/a;n*=c;for(var h=0,f=0;f<i;f++){var m=e[f],g=t[f]*c,_=m>g?m-g:g-m;if(_>n)return Number.POSITIVE_INFINITY;h+=_}return h/s},r}(),__extends$Q=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Code128Reader=function(r){__extends$Q(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.findStartPattern=function(t){for(var n=t.getSize(),i=t.getNextSet(0),s=0,a=Int32Array.from([0,0,0,0,0,0]),o=i,c=!1,h=6,f=i;f<n;f++)if(t.get(f)!==c)a[s]++;else{if(s===h-1){for(var m=e.MAX_AVG_VARIANCE,g=-1,_=e.CODE_START_A;_<=e.CODE_START_C;_++){var E=OneDReader.patternMatchVariance(a,e.CODE_PATTERNS[_],e.MAX_INDIVIDUAL_VARIANCE);E<m&&(m=E,g=_)}if(g>=0&&t.isRange(Math.max(0,o-(f-o)/2),o,!1))return Int32Array.from([o,f,g]);o+=a[0]+a[1],a=a.slice(2,a.length),a[s-1]=0,a[s]=0,s--}else s++;a[s]=1,c=!c}throw new NotFoundException},e.decodeCode=function(t,n,i){OneDReader.recordPattern(t,i,n);for(var s=e.MAX_AVG_VARIANCE,a=-1,o=0;o<e.CODE_PATTERNS.length;o++){var c=e.CODE_PATTERNS[o],h=this.patternMatchVariance(n,c,e.MAX_INDIVIDUAL_VARIANCE);h<s&&(s=h,a=o)}if(a>=0)return a;throw new NotFoundException},e.prototype.decodeRow=function(t,n,i){var s=i&&i.get(DecodeHintType$1.ASSUME_GS1)===!0,a=e.findStartPattern(n),o=a[2],c=0,h=new Uint8Array(20);h[c++]=o;var f;switch(o){case e.CODE_START_A:f=e.CODE_CODE_A;break;case e.CODE_START_B:f=e.CODE_CODE_B;break;case e.CODE_START_C:f=e.CODE_CODE_C;break;default:throw new FormatException}for(var m=!1,g=!1,_="",E=a[0],A=a[1],C=Int32Array.from([0,0,0,0,0,0]),I=0,b=0,R=o,V=0,U=!0,W=!1,j=!1;!m;){var w=g;switch(g=!1,I=b,b=e.decodeCode(n,C,A),h[c++]=b,b!==e.CODE_STOP&&(U=!0),b!==e.CODE_STOP&&(V++,R+=V*b),E=A,A+=C.reduce(function(se,ce){return se+ce},0),b){case e.CODE_START_A:case e.CODE_START_B:case e.CODE_START_C:throw new FormatException}switch(f){case e.CODE_CODE_A:if(b<64)j===W?_+=String.fromCharCode(32+b):_+=String.fromCharCode(32+b+128),j=!1;else if(b<96)j===W?_+=String.fromCharCode(b-64):_+=String.fromCharCode(b+64),j=!1;else switch(b!==e.CODE_STOP&&(U=!1),b){case e.CODE_FNC_1:s&&(_.length===0?_+="]C1":_+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_A:!W&&j?(W=!0,j=!1):W&&j?(W=!1,j=!1):j=!0;break;case e.CODE_SHIFT:g=!0,f=e.CODE_CODE_B;break;case e.CODE_CODE_B:f=e.CODE_CODE_B;break;case e.CODE_CODE_C:f=e.CODE_CODE_C;break;case e.CODE_STOP:m=!0;break}break;case e.CODE_CODE_B:if(b<96)j===W?_+=String.fromCharCode(32+b):_+=String.fromCharCode(32+b+128),j=!1;else switch(b!==e.CODE_STOP&&(U=!1),b){case e.CODE_FNC_1:s&&(_.length===0?_+="]C1":_+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_B:!W&&j?(W=!0,j=!1):W&&j?(W=!1,j=!1):j=!0;break;case e.CODE_SHIFT:g=!0,f=e.CODE_CODE_A;break;case e.CODE_CODE_A:f=e.CODE_CODE_A;break;case e.CODE_CODE_C:f=e.CODE_CODE_C;break;case e.CODE_STOP:m=!0;break}break;case e.CODE_CODE_C:if(b<100)b<10&&(_+="0"),_+=b;else switch(b!==e.CODE_STOP&&(U=!1),b){case e.CODE_FNC_1:s&&(_.length===0?_+="]C1":_+="");break;case e.CODE_CODE_A:f=e.CODE_CODE_A;break;case e.CODE_CODE_B:f=e.CODE_CODE_B;break;case e.CODE_STOP:m=!0;break}break}w&&(f=f===e.CODE_CODE_A?e.CODE_CODE_B:e.CODE_CODE_A)}var P=A-E;if(A=n.getNextUnset(A),!n.isRange(A,Math.min(n.getSize(),A+(A-E)/2),!1))throw new NotFoundException;if(R-=V*I,R%103!==I)throw new ChecksumException;var K=_.length;if(K===0)throw new NotFoundException;K>0&&U&&(f===e.CODE_CODE_C?_=_.substring(0,K-2):_=_.substring(0,K-1));for(var X=(a[1]+a[0])/2,Y=E+P/2,Z=h.length,ae=new Uint8Array(Z),le=0;le<Z;le++)ae[le]=h[le];var ie=[new ResultPoint(X,t),new ResultPoint(Y,t)];return new Result(_,ae,0,ie,BarcodeFormat$1.CODE_128,new Date().getTime())},e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],e.MAX_AVG_VARIANCE=.25,e.MAX_INDIVIDUAL_VARIANCE=.7,e.CODE_SHIFT=98,e.CODE_CODE_C=99,e.CODE_CODE_B=100,e.CODE_CODE_A=101,e.CODE_FNC_1=102,e.CODE_FNC_2=97,e.CODE_FNC_3=96,e.CODE_FNC_4_A=101,e.CODE_FNC_4_B=100,e.CODE_START_A=103,e.CODE_START_B=104,e.CODE_START_C=105,e.CODE_STOP=106,e}(OneDReader),__extends$P=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$G=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Code39Reader=function(r){__extends$P(e,r);function e(t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var i=r.call(this)||this;return i.usingCheckDigit=t,i.extendedMode=n,i.decodeRowResult="",i.counters=new Int32Array(9),i}return e.prototype.decodeRow=function(t,n,i){var s,a,o,c,h=this.counters;h.fill(0),this.decodeRowResult="";var f=e.findAsteriskPattern(n,h),m=n.getNextSet(f[1]),g=n.getSize(),_,E;do{e.recordPattern(n,m,h);var A=e.toNarrowWidePattern(h);if(A<0)throw new NotFoundException;_=e.patternToChar(A),this.decodeRowResult+=_,E=m;try{for(var C=(s=void 0,__values$G(h)),I=C.next();!I.done;I=C.next()){var b=I.value;m+=b}}catch(Z){s={error:Z}}finally{try{I&&!I.done&&(a=C.return)&&a.call(C)}finally{if(s)throw s.error}}m=n.getNextSet(m)}while(_!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var R=0;try{for(var V=__values$G(h),U=V.next();!U.done;U=V.next()){var b=U.value;R+=b}}catch(Z){o={error:Z}}finally{try{U&&!U.done&&(c=V.return)&&c.call(V)}finally{if(o)throw o.error}}var W=m-E-R;if(m!==g&&W*2<R)throw new NotFoundException;if(this.usingCheckDigit){for(var j=this.decodeRowResult.length-1,w=0,P=0;P<j;P++)w+=e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(P));if(this.decodeRowResult.charAt(j)!==e.ALPHABET_STRING.charAt(w%43))throw new ChecksumException;this.decodeRowResult=this.decodeRowResult.substring(0,j)}if(this.decodeRowResult.length===0)throw new NotFoundException;var K;this.extendedMode?K=e.decodeExtended(this.decodeRowResult):K=this.decodeRowResult;var X=(f[1]+f[0])/2,Y=E+R/2;return new Result(K,null,0,[new ResultPoint(X,t),new ResultPoint(Y,t)],BarcodeFormat$1.CODE_39,new Date().getTime())},e.findAsteriskPattern=function(t,n){for(var i=t.getSize(),s=t.getNextSet(0),a=0,o=s,c=!1,h=n.length,f=s;f<i;f++)if(t.get(f)!==c)n[a]++;else{if(a===h-1){if(this.toNarrowWidePattern(n)===e.ASTERISK_ENCODING&&t.isRange(Math.max(0,o-Math.floor((f-o)/2)),o,!1))return[o,f];o+=n[0]+n[1],n.copyWithin(0,2,2+a-1),n[a-1]=0,n[a]=0,a--}else a++;n[a]=1,c=!c}throw new NotFoundException},e.toNarrowWidePattern=function(t){var n,i,s=t.length,a=0,o;do{var c=2147483647;try{for(var h=(n=void 0,__values$G(t)),f=h.next();!f.done;f=h.next()){var m=f.value;m<c&&m>a&&(c=m)}}catch(A){n={error:A}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(n)throw n.error}}a=c,o=0;for(var g=0,_=0,E=0;E<s;E++){var m=t[E];m>a&&(_|=1<<s-1-E,o++,g+=m)}if(o===3){for(var E=0;E<s&&o>0;E++){var m=t[E];if(m>a&&(o--,m*2>=g))return-1}return _}}while(o>3);return-1},e.patternToChar=function(t){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===t)return e.ALPHABET_STRING.charAt(n);if(t===e.ASTERISK_ENCODING)return"*";throw new NotFoundException},e.decodeExtended=function(t){for(var n=t.length,i="",s=0;s<n;s++){var a=t.charAt(s);if(a==="+"||a==="$"||a==="%"||a==="/"){var o=t.charAt(s+1),c="\0";switch(a){case"+":if(o>="A"&&o<="Z")c=String.fromCharCode(o.charCodeAt(0)+32);else throw new FormatException;break;case"$":if(o>="A"&&o<="Z")c=String.fromCharCode(o.charCodeAt(0)-64);else throw new FormatException;break;case"%":if(o>="A"&&o<="E")c=String.fromCharCode(o.charCodeAt(0)-38);else if(o>="F"&&o<="J")c=String.fromCharCode(o.charCodeAt(0)-11);else if(o>="K"&&o<="O")c=String.fromCharCode(o.charCodeAt(0)+16);else if(o>="P"&&o<="T")c=String.fromCharCode(o.charCodeAt(0)+43);else if(o==="U")c="\0";else if(o==="V")c="@";else if(o==="W")c="`";else if(o==="X"||o==="Y"||o==="Z")c="";else throw new FormatException;break;case"/":if(o>="A"&&o<="O")c=String.fromCharCode(o.charCodeAt(0)-32);else if(o==="Z")c=":";else throw new FormatException;break}i+=c,s++}else i+=a}return i},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],e.ASTERISK_ENCODING=148,e}(OneDReader),__extends$O=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$F=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Code93Reader=function(r){__extends$O(e,r);function e(){var t=r.call(this)||this;return t.decodeRowResult="",t.counters=new Int32Array(6),t}return e.prototype.decodeRow=function(t,n,i){var s,a,o,c,h=this.findAsteriskPattern(n),f=n.getNextSet(h[1]),m=n.getSize(),g=this.counters;g.fill(0),this.decodeRowResult="";var _,E;do{e.recordPattern(n,f,g);var A=this.toPattern(g);if(A<0)throw new NotFoundException;_=this.patternToChar(A),this.decodeRowResult+=_,E=f;try{for(var C=(s=void 0,__values$F(g)),I=C.next();!I.done;I=C.next()){var b=I.value;f+=b}}catch(P){s={error:P}}finally{try{I&&!I.done&&(a=C.return)&&a.call(C)}finally{if(s)throw s.error}}f=n.getNextSet(f)}while(_!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var R=0;try{for(var V=__values$F(g),U=V.next();!U.done;U=V.next()){var b=U.value;R+=b}}catch(P){o={error:P}}finally{try{U&&!U.done&&(c=V.return)&&c.call(V)}finally{if(o)throw o.error}}if(f===m||!n.get(f))throw new NotFoundException;if(this.decodeRowResult.length<2)throw new NotFoundException;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var W=this.decodeExtended(this.decodeRowResult),j=(h[1]+h[0])/2,w=E+R/2;return new Result(W,null,0,[new ResultPoint(j,t),new ResultPoint(w,t)],BarcodeFormat$1.CODE_93,new Date().getTime())},e.prototype.findAsteriskPattern=function(t){var n=t.getSize(),i=t.getNextSet(0);this.counters.fill(0);for(var s=this.counters,a=i,o=!1,c=s.length,h=0,f=i;f<n;f++)if(t.get(f)!==o)s[h]++;else{if(h===c-1){if(this.toPattern(s)===e.ASTERISK_ENCODING)return new Int32Array([a,f]);a+=s[0]+s[1],s.copyWithin(0,2,2+h-1),s[h-1]=0,s[h]=0,h--}else h++;s[h]=1,o=!o}throw new NotFoundException},e.prototype.toPattern=function(t){var n,i,s=0;try{for(var a=__values$F(t),o=a.next();!o.done;o=a.next()){var c=o.value;s+=c}}catch(E){n={error:E}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}for(var h=0,f=t.length,m=0;m<f;m++){var g=Math.round(t[m]*9/s);if(g<1||g>4)return-1;if((m&1)===0)for(var _=0;_<g;_++)h=h<<1|1;else h<<=g}return h},e.prototype.patternToChar=function(t){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===t)return e.ALPHABET_STRING.charAt(n);throw new NotFoundException},e.prototype.decodeExtended=function(t){for(var n=t.length,i="",s=0;s<n;s++){var a=t.charAt(s);if(a>="a"&&a<="d"){if(s>=n-1)throw new FormatException;var o=t.charAt(s+1),c="\0";switch(a){case"d":if(o>="A"&&o<="Z")c=String.fromCharCode(o.charCodeAt(0)+32);else throw new FormatException;break;case"a":if(o>="A"&&o<="Z")c=String.fromCharCode(o.charCodeAt(0)-64);else throw new FormatException;break;case"b":if(o>="A"&&o<="E")c=String.fromCharCode(o.charCodeAt(0)-38);else if(o>="F"&&o<="J")c=String.fromCharCode(o.charCodeAt(0)-11);else if(o>="K"&&o<="O")c=String.fromCharCode(o.charCodeAt(0)+16);else if(o>="P"&&o<="T")c=String.fromCharCode(o.charCodeAt(0)+43);else if(o==="U")c="\0";else if(o==="V")c="@";else if(o==="W")c="`";else if(o>="X"&&o<="Z")c="";else throw new FormatException;break;case"c":if(o>="A"&&o<="O")c=String.fromCharCode(o.charCodeAt(0)-32);else if(o==="Z")c=":";else throw new FormatException;break}i+=c,s++}else i+=a}return i},e.prototype.checkChecksums=function(t){var n=t.length;this.checkOneChecksum(t,n-2,20),this.checkOneChecksum(t,n-1,15)},e.prototype.checkOneChecksum=function(t,n,i){for(var s=1,a=0,o=n-1;o>=0;o--)a+=s*e.ALPHABET_STRING.indexOf(t.charAt(o)),++s>i&&(s=1);if(t.charAt(n)!==e.ALPHABET_STRING[a%47])throw new ChecksumException},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",e.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],e.ASTERISK_ENCODING=e.CHARACTER_ENCODINGS[47],e}(OneDReader),__extends$N=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$E=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ITFReader=function(r){__extends$N(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.narrowLineWidth=-1,t}return e.prototype.decodeRow=function(t,n,i){var s,a,o=this.decodeStart(n),c=this.decodeEnd(n),h=new StringBuilder;e.decodeMiddle(n,o[1],c[0],h);var f=h.toString(),m=null;i!=null&&(m=i.get(DecodeHintType$1.ALLOWED_LENGTHS)),m==null&&(m=e.DEFAULT_ALLOWED_LENGTHS);var g=f.length,_=!1,E=0;try{for(var A=__values$E(m),C=A.next();!C.done;C=A.next()){var I=C.value;if(g===I){_=!0;break}I>E&&(E=I)}}catch(V){s={error:V}}finally{try{C&&!C.done&&(a=A.return)&&a.call(A)}finally{if(s)throw s.error}}if(!_&&g>E&&(_=!0),!_)throw new FormatException;var b=[new ResultPoint(o[1],t),new ResultPoint(c[0],t)],R=new Result(f,null,0,b,BarcodeFormat$1.ITF,new Date().getTime());return R},e.decodeMiddle=function(t,n,i,s){var a=new Int32Array(10),o=new Int32Array(5),c=new Int32Array(5);for(a.fill(0),o.fill(0),c.fill(0);n<i;){OneDReader.recordPattern(t,n,a);for(var h=0;h<5;h++){var f=2*h;o[h]=a[f],c[h]=a[f+1]}var m=e.decodeDigit(o);s.append(m.toString()),m=this.decodeDigit(c),s.append(m.toString()),a.forEach(function(g){n+=g})}},e.prototype.decodeStart=function(t){var n=e.skipWhiteSpace(t),i=e.findGuardPattern(t,n,e.START_PATTERN);return this.narrowLineWidth=(i[1]-i[0])/4,this.validateQuietZone(t,i[0]),i},e.prototype.validateQuietZone=function(t,n){var i=this.narrowLineWidth*10;i=i<n?i:n;for(var s=n-1;i>0&&s>=0&&!t.get(s);s--)i--;if(i!==0)throw new NotFoundException},e.skipWhiteSpace=function(t){var n=t.getSize(),i=t.getNextSet(0);if(i===n)throw new NotFoundException;return i},e.prototype.decodeEnd=function(t){t.reverse();try{var n=e.skipWhiteSpace(t),i=void 0;try{i=e.findGuardPattern(t,n,e.END_PATTERN_REVERSED[0])}catch(a){a instanceof NotFoundException&&(i=e.findGuardPattern(t,n,e.END_PATTERN_REVERSED[1]))}this.validateQuietZone(t,i[0]);var s=i[0];return i[0]=t.getSize()-i[1],i[1]=t.getSize()-s,i}finally{t.reverse()}},e.findGuardPattern=function(t,n,i){var s=i.length,a=new Int32Array(s),o=t.getSize(),c=!1,h=0,f=n;a.fill(0);for(var m=n;m<o;m++)if(t.get(m)!==c)a[h]++;else{if(h===s-1){if(OneDReader.patternMatchVariance(a,i,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return[f,m];f+=a[0]+a[1],System.arraycopy(a,2,a,0,h-1),a[h-1]=0,a[h]=0,h--}else h++;a[h]=1,c=!c}throw new NotFoundException},e.decodeDigit=function(t){for(var n=e.MAX_AVG_VARIANCE,i=-1,s=e.PATTERNS.length,a=0;a<s;a++){var o=e.PATTERNS[a],c=OneDReader.patternMatchVariance(t,o,e.MAX_INDIVIDUAL_VARIANCE);c<n?(n=c,i=a):c===n&&(i=-1)}if(i>=0)return i%10;throw new NotFoundException},e.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],e.MAX_AVG_VARIANCE=.38,e.MAX_INDIVIDUAL_VARIANCE=.5,e.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],e.START_PATTERN=Int32Array.from([1,1,1,1]),e.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],e}(OneDReader),__extends$M=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AbstractUPCEANReader=function(r){__extends$M(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.decodeRowStringBuffer="",t}return e.findStartGuardPattern=function(t){for(var n=!1,i,s=0,a=Int32Array.from([0,0,0]);!n;){a=Int32Array.from([0,0,0]),i=e.findGuardPattern(t,s,!1,this.START_END_PATTERN,a);var o=i[0];s=i[1];var c=o-(s-o);c>=0&&(n=t.isRange(c,o,!1))}return i},e.checkChecksum=function(t){return e.checkStandardUPCEANChecksum(t)},e.checkStandardUPCEANChecksum=function(t){var n=t.length;if(n===0)return!1;var i=parseInt(t.charAt(n-1),10);return e.getStandardUPCEANChecksum(t.substring(0,n-1))===i},e.getStandardUPCEANChecksum=function(t){for(var n=t.length,i=0,s=n-1;s>=0;s-=2){var a=t.charAt(s).charCodeAt(0)-48;if(a<0||a>9)throw new FormatException;i+=a}i*=3;for(var s=n-2;s>=0;s-=2){var a=t.charAt(s).charCodeAt(0)-48;if(a<0||a>9)throw new FormatException;i+=a}return(1e3-i)%10},e.decodeEnd=function(t,n){return e.findGuardPattern(t,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e.findGuardPatternWithoutCounters=function(t,n,i,s){return this.findGuardPattern(t,n,i,s,new Int32Array(s.length))},e.findGuardPattern=function(t,n,i,s,a){var o=t.getSize();n=i?t.getNextUnset(n):t.getNextSet(n);for(var c=0,h=n,f=s.length,m=i,g=n;g<o;g++)if(t.get(g)!==m)a[c]++;else{if(c===f-1){if(OneDReader.patternMatchVariance(a,s,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return Int32Array.from([h,g]);h+=a[0]+a[1];for(var _=a.slice(2,a.length),E=0;E<c-1;E++)a[E]=_[E];a[c-1]=0,a[c]=0,c--}else c++;a[c]=1,m=!m}throw new NotFoundException},e.decodeDigit=function(t,n,i,s){this.recordPattern(t,i,n);for(var a=this.MAX_AVG_VARIANCE,o=-1,c=s.length,h=0;h<c;h++){var f=s[h],m=OneDReader.patternMatchVariance(n,f,e.MAX_INDIVIDUAL_VARIANCE);m<a&&(a=m,o=h)}if(o>=0)return o;throw new NotFoundException},e.MAX_AVG_VARIANCE=.48,e.MAX_INDIVIDUAL_VARIANCE=.7,e.START_END_PATTERN=Int32Array.from([1,1,1]),e.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),e.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],e}(OneDReader),__values$D=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},UPCEANExtension5Support=function(){function r(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return r.prototype.decodeRow=function(e,t,n){var i=this.decodeRowStringBuffer,s=this.decodeMiddle(t,n,i),a=i.toString(),o=r.parseExtensionString(a),c=[new ResultPoint((n[0]+n[1])/2,e),new ResultPoint(s,e)],h=new Result(a,null,0,c,BarcodeFormat$1.UPC_EAN_EXTENSION,new Date().getTime());return o!=null&&h.putAllMetadata(o),h},r.prototype.decodeMiddle=function(e,t,n){var i,s,a=this.decodeMiddleCounters;a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var o=e.getSize(),c=t[1],h=0,f=0;f<5&&c<o;f++){var m=AbstractUPCEANReader.decodeDigit(e,a,c,AbstractUPCEANReader.L_AND_G_PATTERNS);n+=String.fromCharCode(48+m%10);try{for(var g=(i=void 0,__values$D(a)),_=g.next();!_.done;_=g.next()){var E=_.value;c+=E}}catch(C){i={error:C}}finally{try{_&&!_.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}m>=10&&(h|=1<<4-f),f!==4&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==5)throw new NotFoundException;var A=this.determineCheckDigit(h);if(r.extensionChecksum(n.toString())!==A)throw new NotFoundException;return c},r.extensionChecksum=function(e){for(var t=e.length,n=0,i=t-2;i>=0;i-=2)n+=e.charAt(i).charCodeAt(0)-48;n*=3;for(var i=t-1;i>=0;i-=2)n+=e.charAt(i).charCodeAt(0)-48;return n*=3,n%10},r.prototype.determineCheckDigit=function(e){for(var t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new NotFoundException},r.parseExtensionString=function(e){if(e.length!==5)return null;var t=r.parseExtension5String(e);return t==null?null:new Map([[ResultMetadataType$1.SUGGESTED_PRICE,t]])},r.parseExtension5String=function(e){var t;switch(e.charAt(0)){case"0":t="£";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t="";break}var n=parseInt(e.substring(1)),i=(n/100).toString(),s=n%100,a=s<10?"0"+s:s.toString();return t+i+"."+a},r}(),__values$C=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},UPCEANExtension2Support=function(){function r(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return r.prototype.decodeRow=function(e,t,n){var i=this.decodeRowStringBuffer,s=this.decodeMiddle(t,n,i),a=i.toString(),o=r.parseExtensionString(a),c=[new ResultPoint((n[0]+n[1])/2,e),new ResultPoint(s,e)],h=new Result(a,null,0,c,BarcodeFormat$1.UPC_EAN_EXTENSION,new Date().getTime());return o!=null&&h.putAllMetadata(o),h},r.prototype.decodeMiddle=function(e,t,n){var i,s,a=this.decodeMiddleCounters;a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var o=e.getSize(),c=t[1],h=0,f=0;f<2&&c<o;f++){var m=AbstractUPCEANReader.decodeDigit(e,a,c,AbstractUPCEANReader.L_AND_G_PATTERNS);n+=String.fromCharCode(48+m%10);try{for(var g=(i=void 0,__values$C(a)),_=g.next();!_.done;_=g.next()){var E=_.value;c+=E}}catch(A){i={error:A}}finally{try{_&&!_.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}m>=10&&(h|=1<<1-f),f!==1&&(c=e.getNextSet(c),c=e.getNextUnset(c))}if(n.length!==2)throw new NotFoundException;if(parseInt(n.toString())%4!==h)throw new NotFoundException;return c},r.parseExtensionString=function(e){return e.length!==2?null:new Map([[ResultMetadataType$1.ISSUE_NUMBER,parseInt(e)]])},r}(),UPCEANExtensionSupport=function(){function r(){}return r.decodeRow=function(e,t,n){var i=AbstractUPCEANReader.findGuardPattern(t,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var s=new UPCEANExtension5Support;return s.decodeRow(e,t,i)}catch{var a=new UPCEANExtension2Support;return a.decodeRow(e,t,i)}},r.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),r}(),__extends$L=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),UPCEANReader=function(r){__extends$L(e,r);function e(){var t=r.call(this)||this;t.decodeRowStringBuffer="",e.L_AND_G_PATTERNS=e.L_PATTERNS.map(function(o){return Int32Array.from(o)});for(var n=10;n<20;n++){for(var i=e.L_PATTERNS[n-10],s=new Int32Array(i.length),a=0;a<i.length;a++)s[a]=i[i.length-a-1];e.L_AND_G_PATTERNS[n]=s}return t}return e.prototype.decodeRow=function(t,n,i){var s=e.findStartGuardPattern(n),a=i==null?null:i.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);if(a!=null){var o=new ResultPoint((s[0]+s[1])/2,t);a.foundPossibleResultPoint(o)}var c=this.decodeMiddle(n,s,this.decodeRowStringBuffer),h=c.rowOffset,f=c.resultString;if(a!=null){var m=new ResultPoint(h,t);a.foundPossibleResultPoint(m)}var g=e.decodeEnd(n,h);if(a!=null){var _=new ResultPoint((g[0]+g[1])/2,t);a.foundPossibleResultPoint(_)}var E=g[1],A=E+(E-g[0]);if(A>=n.getSize()||!n.isRange(E,A,!1))throw new NotFoundException;var C=f.toString();if(C.length<8)throw new FormatException;if(!e.checkChecksum(C))throw new ChecksumException;var I=(s[1]+s[0])/2,b=(g[1]+g[0])/2,R=this.getBarcodeFormat(),V=[new ResultPoint(I,t),new ResultPoint(b,t)],U=new Result(C,null,0,V,R,new Date().getTime()),W=0;try{var j=UPCEANExtensionSupport.decodeRow(t,n,g[1]);U.putMetadata(ResultMetadataType$1.UPC_EAN_EXTENSION,j.getText()),U.putAllMetadata(j.getResultMetadata()),U.addResultPoints(j.getResultPoints()),W=j.getText().length}catch{}var w=i==null?null:i.get(DecodeHintType$1.ALLOWED_EAN_EXTENSIONS);if(w!=null){var P=!1;for(var K in w)if(W.toString()===K){P=!0;break}if(!P)throw new NotFoundException}return R===BarcodeFormat$1.EAN_13||BarcodeFormat$1.UPC_A,U},e.checkChecksum=function(t){return e.checkStandardUPCEANChecksum(t)},e.checkStandardUPCEANChecksum=function(t){var n=t.length;if(n===0)return!1;var i=parseInt(t.charAt(n-1),10);return e.getStandardUPCEANChecksum(t.substring(0,n-1))===i},e.getStandardUPCEANChecksum=function(t){for(var n=t.length,i=0,s=n-1;s>=0;s-=2){var a=t.charAt(s).charCodeAt(0)-48;if(a<0||a>9)throw new FormatException;i+=a}i*=3;for(var s=n-2;s>=0;s-=2){var a=t.charAt(s).charCodeAt(0)-48;if(a<0||a>9)throw new FormatException;i+=a}return(1e3-i)%10},e.decodeEnd=function(t,n){return e.findGuardPattern(t,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e}(AbstractUPCEANReader),__extends$K=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$B=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},EAN13Reader=function(r){__extends$K(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}return e.prototype.decodeMiddle=function(t,n,i){var s,a,o,c,h=this.decodeMiddleCounters;h[0]=0,h[1]=0,h[2]=0,h[3]=0;for(var f=t.getSize(),m=n[1],g=0,_=0;_<6&&m<f;_++){var E=UPCEANReader.decodeDigit(t,h,m,UPCEANReader.L_AND_G_PATTERNS);i+=String.fromCharCode(48+E%10);try{for(var A=(s=void 0,__values$B(h)),C=A.next();!C.done;C=A.next()){var I=C.value;m+=I}}catch(U){s={error:U}}finally{try{C&&!C.done&&(a=A.return)&&a.call(A)}finally{if(s)throw s.error}}E>=10&&(g|=1<<5-_)}i=e.determineFirstDigit(i,g);var b=UPCEANReader.findGuardPattern(t,m,!0,UPCEANReader.MIDDLE_PATTERN,new Int32Array(UPCEANReader.MIDDLE_PATTERN.length).fill(0));m=b[1];for(var _=0;_<6&&m<f;_++){var E=UPCEANReader.decodeDigit(t,h,m,UPCEANReader.L_PATTERNS);i+=String.fromCharCode(48+E);try{for(var R=(o=void 0,__values$B(h)),V=R.next();!V.done;V=R.next()){var I=V.value;m+=I}}catch(j){o={error:j}}finally{try{V&&!V.done&&(c=R.return)&&c.call(R)}finally{if(o)throw o.error}}}return{rowOffset:m,resultString:i}},e.prototype.getBarcodeFormat=function(){return BarcodeFormat$1.EAN_13},e.determineFirstDigit=function(t,n){for(var i=0;i<10;i++)if(n===this.FIRST_DIGIT_ENCODINGS[i])return t=String.fromCharCode(48+i)+t,t;throw new NotFoundException},e.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],e}(UPCEANReader),__extends$J=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$A=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},EAN8Reader=function(r){__extends$J(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}return e.prototype.decodeMiddle=function(t,n,i){var s,a,o,c,h=this.decodeMiddleCounters;h[0]=0,h[1]=0,h[2]=0,h[3]=0;for(var f=t.getSize(),m=n[1],g=0;g<4&&m<f;g++){var _=UPCEANReader.decodeDigit(t,h,m,UPCEANReader.L_PATTERNS);i+=String.fromCharCode(48+_);try{for(var E=(s=void 0,__values$A(h)),A=E.next();!A.done;A=E.next()){var C=A.value;m+=C}}catch(V){s={error:V}}finally{try{A&&!A.done&&(a=E.return)&&a.call(E)}finally{if(s)throw s.error}}}var I=UPCEANReader.findGuardPattern(t,m,!0,UPCEANReader.MIDDLE_PATTERN,new Int32Array(UPCEANReader.MIDDLE_PATTERN.length).fill(0));m=I[1];for(var g=0;g<4&&m<f;g++){var _=UPCEANReader.decodeDigit(t,h,m,UPCEANReader.L_PATTERNS);i+=String.fromCharCode(48+_);try{for(var b=(o=void 0,__values$A(h)),R=b.next();!R.done;R=b.next()){var C=R.value;m+=C}}catch(W){o={error:W}}finally{try{R&&!R.done&&(c=b.return)&&c.call(b)}finally{if(o)throw o.error}}}return{rowOffset:m,resultString:i}},e.prototype.getBarcodeFormat=function(){return BarcodeFormat$1.EAN_8},e}(UPCEANReader),__extends$I=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),UPCAReader=function(r){__extends$I(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.ean13Reader=new EAN13Reader,t}return e.prototype.getBarcodeFormat=function(){return BarcodeFormat$1.UPC_A},e.prototype.decode=function(t,n){return this.maybeReturnResult(this.ean13Reader.decode(t))},e.prototype.decodeRow=function(t,n,i){return this.maybeReturnResult(this.ean13Reader.decodeRow(t,n,i))},e.prototype.decodeMiddle=function(t,n,i){return this.ean13Reader.decodeMiddle(t,n,i)},e.prototype.maybeReturnResult=function(t){var n=t.getText();if(n.charAt(0)==="0"){var i=new Result(n.substring(1),null,null,t.getResultPoints(),BarcodeFormat$1.UPC_A);return t.getResultMetadata()!=null&&i.putAllMetadata(t.getResultMetadata()),i}else throw new NotFoundException},e.prototype.reset=function(){this.ean13Reader.reset()},e}(UPCEANReader),__extends$H=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$z=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},UPCEReader=function(r){__extends$H(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=new Int32Array(4),t}return e.prototype.decodeMiddle=function(t,n,i){var s,a,o=this.decodeMiddleCounters.map(function(C){return C});o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var c=t.getSize(),h=n[1],f=0,m=0;m<6&&h<c;m++){var g=e.decodeDigit(t,o,h,e.L_AND_G_PATTERNS);i+=String.fromCharCode(48+g%10);try{for(var _=(s=void 0,__values$z(o)),E=_.next();!E.done;E=_.next()){var A=E.value;h+=A}}catch(C){s={error:C}}finally{try{E&&!E.done&&(a=_.return)&&a.call(_)}finally{if(s)throw s.error}}g>=10&&(f|=1<<5-m)}return e.determineNumSysAndCheckDigit(new StringBuilder(i),f),h},e.prototype.decodeEnd=function(t,n){return e.findGuardPatternWithoutCounters(t,n,!0,e.MIDDLE_END_PATTERN)},e.prototype.checkChecksum=function(t){return UPCEANReader.checkChecksum(e.convertUPCEtoUPCA(t))},e.determineNumSysAndCheckDigit=function(t,n){for(var i=0;i<=1;i++)for(var s=0;s<10;s++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[i][s]){t.insert(0,"0"+i),t.append("0"+s);return}throw NotFoundException.getNotFoundInstance()},e.prototype.getBarcodeFormat=function(){return BarcodeFormat$1.UPC_E},e.convertUPCEtoUPCA=function(t){var n=t.slice(1,7).split("").map(function(a){return a.charCodeAt(0)}),i=new StringBuilder;i.append(t.charAt(0));var s=n[5];switch(s){case 0:case 1:case 2:i.appendChars(n,0,2),i.append(s),i.append("0000"),i.appendChars(n,2,3);break;case 3:i.appendChars(n,0,3),i.append("00000"),i.appendChars(n,3,2);break;case 4:i.appendChars(n,0,4),i.append("00000"),i.append(n[4]);break;default:i.appendChars(n,0,5),i.append("0000"),i.append(s);break}return t.length>=8&&i.append(t.charAt(7)),i.toString()},e.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],e}(UPCEANReader),__extends$G=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$y=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},MultiFormatUPCEANReader=function(r){__extends$G(e,r);function e(t){var n=r.call(this)||this,i=t==null?null:t.get(DecodeHintType$1.POSSIBLE_FORMATS),s=[];return i!=null&&(i.indexOf(BarcodeFormat$1.EAN_13)>-1&&s.push(new EAN13Reader),i.indexOf(BarcodeFormat$1.UPC_A)>-1&&s.push(new UPCAReader),i.indexOf(BarcodeFormat$1.EAN_8)>-1&&s.push(new EAN8Reader),i.indexOf(BarcodeFormat$1.UPC_E)>-1&&s.push(new UPCEReader)),s.length===0&&(s.push(new EAN13Reader),s.push(new UPCAReader),s.push(new EAN8Reader),s.push(new UPCEReader)),n.readers=s,n}return e.prototype.decodeRow=function(t,n,i){var s,a;try{for(var o=__values$y(this.readers),c=o.next();!c.done;c=o.next()){var h=c.value;try{var f=h.decodeRow(t,n,i),m=f.getBarcodeFormat()===BarcodeFormat$1.EAN_13&&f.getText().charAt(0)==="0",g=i==null?null:i.get(DecodeHintType$1.POSSIBLE_FORMATS),_=g==null||g.includes(BarcodeFormat$1.UPC_A);if(m&&_){var E=f.getRawBytes(),A=new Result(f.getText().substring(1),E,E?E.length:null,f.getResultPoints(),BarcodeFormat$1.UPC_A);return A.putAllMetadata(f.getResultMetadata()),A}return f}catch{}}}catch(C){s={error:C}}finally{try{c&&!c.done&&(a=o.return)&&a.call(o)}finally{if(s)throw s.error}}throw new NotFoundException},e.prototype.reset=function(){var t,n;try{for(var i=__values$y(this.readers),s=i.next();!s.done;s=i.next()){var a=s.value;a.reset()}}catch(o){t={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e}(OneDReader),__extends$F=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),CodaBarReader=function(r){__extends$F(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},t}return e.prototype.decodeRow=function(t,n,i){var s=this.getValidRowData(n);if(!s)throw new NotFoundException;var a=this.codaBarDecodeRow(s.row);if(!a)throw new NotFoundException;return new Result(a,null,0,[new ResultPoint(s.left,t),new ResultPoint(s.right,t)],BarcodeFormat$1.CODABAR,new Date().getTime())},e.prototype.getValidRowData=function(t){var n=t.toArray(),i=n.indexOf(!0);if(i===-1)return null;var s=n.lastIndexOf(!0);if(s<=i)return null;n=n.slice(i,s+1);for(var a=[],o=n[0],c=1,h=1;h<n.length;h++)n[h]===o?c++:(o=n[h],a.push(c),c=1);return a.push(c),a.length<23&&(a.length+1)%8!==0?null:{row:a,left:i,right:s}},e.prototype.codaBarDecodeRow=function(t){for(var n=[],i=Math.ceil(t.reduce(function(c,h){return(c+h)/2},0));t.length>0;){var s=t.splice(0,8).splice(0,7),a=s.map(function(c){return c<i?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[a]===void 0)return null;n.push(this.CODA_BAR_CHAR_SET[a])}var o=n.join("");return this.validCodaBarString(o)?o:null},e.prototype.validCodaBarString=function(t){var n=/^[A-D].{1,}[A-D]$/;return n.test(t)},e}(OneDReader),__extends$E=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$x=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},AbstractRSSReader=function(r){__extends$E(e,r);function e(){var t=r.call(this)||this;return t.decodeFinderCounters=new Int32Array(4),t.dataCharacterCounters=new Int32Array(8),t.oddRoundingErrors=new Array(4),t.evenRoundingErrors=new Array(4),t.oddCounts=new Array(t.dataCharacterCounters.length/2),t.evenCounts=new Array(t.dataCharacterCounters.length/2),t}return e.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},e.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},e.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},e.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},e.prototype.getOddCounts=function(){return this.oddCounts},e.prototype.getEvenCounts=function(){return this.evenCounts},e.prototype.parseFinderValue=function(t,n){for(var i=0;i<n.length;i++)if(OneDReader.patternMatchVariance(t,n[i],e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return i;throw new NotFoundException},e.count=function(t){return MathUtils.sum(new Int32Array(t))},e.increment=function(t,n){for(var i=0,s=n[0],a=1;a<t.length;a++)n[a]>s&&(s=n[a],i=a);t[i]++},e.decrement=function(t,n){for(var i=0,s=n[0],a=1;a<t.length;a++)n[a]<s&&(s=n[a],i=a);t[i]--},e.isFinderPattern=function(t){var n,i,s=t[0]+t[1],a=s+t[2]+t[3],o=s/a;if(o>=e.MIN_FINDER_PATTERN_RATIO&&o<=e.MAX_FINDER_PATTERN_RATIO){var c=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER;try{for(var f=__values$x(t),m=f.next();!m.done;m=f.next()){var g=m.value;g>h&&(h=g),g<c&&(c=g)}}catch(_){n={error:_}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}return h<10*c}return!1},e.MAX_AVG_VARIANCE=.2,e.MAX_INDIVIDUAL_VARIANCE=.45,e.MIN_FINDER_PATTERN_RATIO=9.5/12,e.MAX_FINDER_PATTERN_RATIO=12.5/14,e}(OneDReader),DataCharacter=function(){function r(e,t){this.value=e,this.checksumPortion=t}return r.prototype.getValue=function(){return this.value},r.prototype.getChecksumPortion=function(){return this.checksumPortion},r.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion},r.prototype.hashCode=function(){return this.value^this.checksumPortion},r}(),FinderPattern$1=function(){function r(e,t,n,i,s){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new ResultPoint(n,s)),this.resultPoints.push(new ResultPoint(i,s))}return r.prototype.getValue=function(){return this.value},r.prototype.getStartEnd=function(){return this.startEnd},r.prototype.getResultPoints=function(){return this.resultPoints},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.prototype.hashCode=function(){return this.value},r}(),__values$w=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},RSSUtils=function(){function r(){}return r.getRSSvalue=function(e,t,n){var i,s,a=0;try{for(var o=__values$w(e),c=o.next();!c.done;c=o.next()){var h=c.value;a+=h}}catch(b){i={error:b}}finally{try{c&&!c.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}for(var f=0,m=0,g=e.length,_=0;_<g-1;_++){var E=void 0;for(E=1,m|=1<<_;E<e[_];E++,m&=~(1<<_)){var A=r.combins(a-E-1,g-_-2);if(n&&m===0&&a-E-(g-_-1)>=g-_-1&&(A-=r.combins(a-E-(g-_),g-_-2)),g-_-1>1){for(var C=0,I=a-E-(g-_-2);I>t;I--)C+=r.combins(a-E-I-1,g-_-3);A-=C*(g-1-_)}else a-E>t&&A--;f+=A}a-=E}return f},r.combins=function(e,t){var n,i;e-t>t?(i=t,n=e-t):(i=e-t,n=t);for(var s=1,a=1,o=e;o>n;o--)s*=o,a<=i&&(s/=a,a++);for(;a<=i;)s/=a,a++;return s},r}(),BitArrayBuilder=function(){function r(){}return r.buildBitArray=function(e){var t=e.length*2-1;e[e.length-1].getRightChar()==null&&(t-=1);for(var n=12*t,i=new BitArray(n),s=0,a=e[0],o=a.getRightChar().getValue(),c=11;c>=0;--c)(o&1<<c)!==0&&i.set(s),s++;for(var c=1;c<e.length;++c){for(var h=e[c],f=h.getLeftChar().getValue(),m=11;m>=0;--m)(f&1<<m)!==0&&i.set(s),s++;if(h.getRightChar()!==null)for(var g=h.getRightChar().getValue(),m=11;m>=0;--m)(g&1<<m)!==0&&i.set(s),s++}return i},r}(),BlockParsedResult=function(){function r(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}return r.prototype.getDecodedInformation=function(){return this.decodedInformation},r.prototype.isFinished=function(){return this.finished},r}(),DecodedObject=function(){function r(e){this.newPosition=e}return r.prototype.getNewPosition=function(){return this.newPosition},r}(),__extends$D=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),DecodedChar=function(r){__extends$D(e,r);function e(t,n){var i=r.call(this,t)||this;return i.value=n,i}return e.prototype.getValue=function(){return this.value},e.prototype.isFNC1=function(){return this.value===e.FNC1},e.FNC1="$",e}(DecodedObject),__extends$C=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),DecodedInformation=function(r){__extends$C(e,r);function e(t,n,i){var s=r.call(this,t)||this;return i?(s.remaining=!0,s.remainingValue=s.remainingValue):(s.remaining=!1,s.remainingValue=0),s.newString=n,s}return e.prototype.getNewString=function(){return this.newString},e.prototype.isRemaining=function(){return this.remaining},e.prototype.getRemainingValue=function(){return this.remainingValue},e}(DecodedObject),__extends$B=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),DecodedNumeric=function(r){__extends$B(e,r);function e(t,n,i){var s=r.call(this,t)||this;if(n<0||n>10||i<0||i>10)throw new FormatException;return s.firstDigit=n,s.secondDigit=i,s}return e.prototype.getFirstDigit=function(){return this.firstDigit},e.prototype.getSecondDigit=function(){return this.secondDigit},e.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},e.prototype.isFirstDigitFNC1=function(){return this.firstDigit===e.FNC1},e.prototype.isSecondDigitFNC1=function(){return this.secondDigit===e.FNC1},e.prototype.isAnyFNC1=function(){return this.firstDigit===e.FNC1||this.secondDigit===e.FNC1},e.FNC1=10,e}(DecodedObject),__values$v=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},FieldParser=function(){function r(){}return r.parseFieldsInGeneralPurpose=function(e){var t,n,i,s,a,o,c,h;if(!e)return null;if(e.length<2)throw new NotFoundException;var f=e.substring(0,2);try{for(var m=__values$v(r.TWO_DIGIT_DATA_LENGTH),g=m.next();!g.done;g=m.next()){var _=g.value;if(_[0]===f)return _[1]===r.VARIABLE_LENGTH?r.processVariableAI(2,_[2],e):r.processFixedAI(2,_[1],e)}}catch(W){t={error:W}}finally{try{g&&!g.done&&(n=m.return)&&n.call(m)}finally{if(t)throw t.error}}if(e.length<3)throw new NotFoundException;var E=e.substring(0,3);try{for(var A=__values$v(r.THREE_DIGIT_DATA_LENGTH),C=A.next();!C.done;C=A.next()){var _=C.value;if(_[0]===E)return _[1]===r.VARIABLE_LENGTH?r.processVariableAI(3,_[2],e):r.processFixedAI(3,_[1],e)}}catch(W){i={error:W}}finally{try{C&&!C.done&&(s=A.return)&&s.call(A)}finally{if(i)throw i.error}}try{for(var I=__values$v(r.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),b=I.next();!b.done;b=I.next()){var _=b.value;if(_[0]===E)return _[1]===r.VARIABLE_LENGTH?r.processVariableAI(4,_[2],e):r.processFixedAI(4,_[1],e)}}catch(W){a={error:W}}finally{try{b&&!b.done&&(o=I.return)&&o.call(I)}finally{if(a)throw a.error}}if(e.length<4)throw new NotFoundException;var R=e.substring(0,4);try{for(var V=__values$v(r.FOUR_DIGIT_DATA_LENGTH),U=V.next();!U.done;U=V.next()){var _=U.value;if(_[0]===R)return _[1]===r.VARIABLE_LENGTH?r.processVariableAI(4,_[2],e):r.processFixedAI(4,_[1],e)}}catch(W){c={error:W}}finally{try{U&&!U.done&&(h=V.return)&&h.call(V)}finally{if(c)throw c.error}}throw new NotFoundException},r.processFixedAI=function(e,t,n){if(n.length<e)throw new NotFoundException;var i=n.substring(0,e);if(n.length<e+t)throw new NotFoundException;var s=n.substring(e,e+t),a=n.substring(e+t),o="("+i+")"+s,c=r.parseFieldsInGeneralPurpose(a);return c==null?o:o+c},r.processVariableAI=function(e,t,n){var i=n.substring(0,e),s;n.length<e+t?s=n.length:s=e+t;var a=n.substring(e,s),o=n.substring(s),c="("+i+")"+a,h=r.parseFieldsInGeneralPurpose(o);return h==null?c:c+h},r.VARIABLE_LENGTH=[],r.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",r.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",r.VARIABLE_LENGTH,20],["22",r.VARIABLE_LENGTH,29],["30",r.VARIABLE_LENGTH,8],["37",r.VARIABLE_LENGTH,8],["90",r.VARIABLE_LENGTH,30],["91",r.VARIABLE_LENGTH,30],["92",r.VARIABLE_LENGTH,30],["93",r.VARIABLE_LENGTH,30],["94",r.VARIABLE_LENGTH,30],["95",r.VARIABLE_LENGTH,30],["96",r.VARIABLE_LENGTH,30],["97",r.VARIABLE_LENGTH,3],["98",r.VARIABLE_LENGTH,30],["99",r.VARIABLE_LENGTH,30]],r.THREE_DIGIT_DATA_LENGTH=[["240",r.VARIABLE_LENGTH,30],["241",r.VARIABLE_LENGTH,30],["242",r.VARIABLE_LENGTH,6],["250",r.VARIABLE_LENGTH,30],["251",r.VARIABLE_LENGTH,30],["253",r.VARIABLE_LENGTH,17],["254",r.VARIABLE_LENGTH,20],["400",r.VARIABLE_LENGTH,30],["401",r.VARIABLE_LENGTH,30],["402",17],["403",r.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",r.VARIABLE_LENGTH,20],["421",r.VARIABLE_LENGTH,15],["422",3],["423",r.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],r.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",r.VARIABLE_LENGTH,15],["391",r.VARIABLE_LENGTH,18],["392",r.VARIABLE_LENGTH,15],["393",r.VARIABLE_LENGTH,18],["703",r.VARIABLE_LENGTH,30]],r.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",r.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",r.VARIABLE_LENGTH,20],["8003",r.VARIABLE_LENGTH,30],["8004",r.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",r.VARIABLE_LENGTH,30],["8008",r.VARIABLE_LENGTH,12],["8018",18],["8020",r.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",r.VARIABLE_LENGTH,70],["8200",r.VARIABLE_LENGTH,70]],r}(),GeneralAppIdDecoder=function(){function r(e){this.buffer=new StringBuilder,this.information=e}return r.prototype.decodeAllCodes=function(e,t){var n=t,i=null;do{var s=this.decodeGeneralPurposeField(n,i),a=FieldParser.parseFieldsInGeneralPurpose(s.getNewString());if(a!=null&&e.append(a),s.isRemaining()?i=""+s.getRemainingValue():i=null,n===s.getNewPosition())break;n=s.getNewPosition()}while(!0);return e.toString()},r.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)},r.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var t=this.extractNumericValueFromBitArray(e,4);return t===0?new DecodedNumeric(this.information.getSize(),DecodedNumeric.FNC1,DecodedNumeric.FNC1):new DecodedNumeric(this.information.getSize(),t-1,DecodedNumeric.FNC1)}var n=this.extractNumericValueFromBitArray(e,7),i=(n-8)/11,s=(n-8)%11;return new DecodedNumeric(e+7,i,s)},r.prototype.extractNumericValueFromBitArray=function(e,t){return r.extractNumericValueFromBitArray(this.information,e,t)},r.extractNumericValueFromBitArray=function(e,t,n){for(var i=0,s=0;s<n;++s)e.get(t+s)&&(i|=1<<n-s-1);return i},r.prototype.decodeGeneralPurposeField=function(e,t){this.buffer.setLengthToZero(),t!=null&&this.buffer.append(t),this.current.setPosition(e);var n=this.parseBlocks();return n!=null&&n.isRemaining()?new DecodedInformation(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new DecodedInformation(this.current.getPosition(),this.buffer.toString())},r.prototype.parseBlocks=function(){var e,t;do{var n=this.current.getPosition();this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished());var i=n!==this.current.getPosition();if(!i&&!e)break}while(!e);return t.getDecodedInformation()},r.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var t=void 0;return e.isSecondDigitFNC1()?t=new DecodedInformation(this.current.getPosition(),this.buffer.toString()):t=new DecodedInformation(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new BlockParsedResult(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){var t=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new BlockParsedResult(!1)},r.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var t=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new BlockParsedResult(!1)},r.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var t=new DecodedInformation(this.current.getPosition(),this.buffer.toString());return new BlockParsedResult(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new BlockParsedResult(!1)},r.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;var i=this.extractNumericValueFromBitArray(e,8);return i>=232&&i<253},r.prototype.decodeIsoIec646=function(e){var t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new DecodedChar(e+5,DecodedChar.FNC1);if(t>=5&&t<15)return new DecodedChar(e+5,"0"+(t-5));var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new DecodedChar(e+7,""+(n+1));if(n>=90&&n<116)return new DecodedChar(e+7,""+(n+7));var i=this.extractNumericValueFromBitArray(e,8),s;switch(i){case 232:s="!";break;case 233:s='"';break;case 234:s="%";break;case 235:s="&";break;case 236:s="'";break;case 237:s="(";break;case 238:s=")";break;case 239:s="*";break;case 240:s="+";break;case 241:s=",";break;case 242:s="-";break;case 243:s=".";break;case 244:s="/";break;case 245:s=":";break;case 246:s=";";break;case 247:s="<";break;case 248:s="=";break;case 249:s=">";break;case 250:s="?";break;case 251:s="_";break;case 252:s=" ";break;default:throw new FormatException}return new DecodedChar(e+8,s)},r.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63},r.prototype.decodeAlphanumeric=function(e){var t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new DecodedChar(e+5,DecodedChar.FNC1);if(t>=5&&t<15)return new DecodedChar(e+5,"0"+(t-5));var n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new DecodedChar(e+6,""+(n+33));var i;switch(n){case 58:i="*";break;case 59:i=",";break;case 60:i="-";break;case 61:i=".";break;case 62:i="/";break;default:throw new IllegalStateException("Decoding invalid alphanumeric value: "+n)}return new DecodedChar(e+6,i)},r.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var t=0;t<5&&t+e<this.information.getSize();++t)if(t===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0},r.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0},r.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0},r}(),AbstractExpandedDecoder=function(){function r(e){this.information=e,this.generalDecoder=new GeneralAppIdDecoder(e)}return r.prototype.getInformation=function(){return this.information},r.prototype.getGeneralDecoder=function(){return this.generalDecoder},r}(),__extends$A=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AI01decoder=function(r){__extends$A(e,r);function e(t){return r.call(this,t)||this}return e.prototype.encodeCompressedGtin=function(t,n){t.append("(01)");var i=t.length();t.append("9"),this.encodeCompressedGtinWithoutAI(t,n,i)},e.prototype.encodeCompressedGtinWithoutAI=function(t,n,i){for(var s=0;s<4;++s){var a=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*s,10);a/100===0&&t.append("0"),a/10===0&&t.append("0"),t.append(a)}e.appendCheckDigit(t,i)},e.appendCheckDigit=function(t,n){for(var i=0,s=0;s<13;s++){var a=t.charAt(s+n).charCodeAt(0)-48;i+=(s&1)===0?3*a:a}i=10-i%10,i===10&&(i=0),t.append(i)},e.GTIN_SIZE=40,e}(AbstractExpandedDecoder),__extends$z=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AI01AndOtherAIs=function(r){__extends$z(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){var t=new StringBuilder;t.append("(01)");var n=t.length(),i=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE,4);return t.append(i),this.encodeCompressedGtinWithoutAI(t,e.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(t,e.HEADER_SIZE+44)},e.HEADER_SIZE=4,e}(AI01decoder),__extends$y=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AnyAIDecoder=function(r){__extends$y(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){var t=new StringBuilder;return this.getGeneralDecoder().decodeAllCodes(t,e.HEADER_SIZE)},e.HEADER_SIZE=5,e}(AbstractExpandedDecoder),__extends$x=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AI01weightDecoder=function(r){__extends$x(e,r);function e(t){return r.call(this,t)||this}return e.prototype.encodeCompressedWeight=function(t,n,i){var s=this.getGeneralDecoder().extractNumericValueFromBitArray(n,i);this.addWeightCode(t,s);for(var a=this.checkWeight(s),o=1e5,c=0;c<5;++c)a/o===0&&t.append("0"),o/=10;t.append(a)},e}(AI01decoder),__extends$w=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AI013x0xDecoder=function(r){__extends$w(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+AI01weightDecoder.GTIN_SIZE+e.WEIGHT_SIZE)throw new NotFoundException;var t=new StringBuilder;return this.encodeCompressedGtin(t,e.HEADER_SIZE),this.encodeCompressedWeight(t,e.HEADER_SIZE+AI01weightDecoder.GTIN_SIZE,e.WEIGHT_SIZE),t.toString()},e.HEADER_SIZE=5,e.WEIGHT_SIZE=15,e}(AI01weightDecoder),__extends$v=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AI013103decoder=function(r){__extends$v(e,r);function e(t){return r.call(this,t)||this}return e.prototype.addWeightCode=function(t,n){t.append("(3103)")},e.prototype.checkWeight=function(t){return t},e}(AI013x0xDecoder),__extends$u=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AI01320xDecoder=function(r){__extends$u(e,r);function e(t){return r.call(this,t)||this}return e.prototype.addWeightCode=function(t,n){n<1e4?t.append("(3202)"):t.append("(3203)")},e.prototype.checkWeight=function(t){return t<1e4?t:t-1e4},e}(AI013x0xDecoder),__extends$t=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AI01392xDecoder=function(r){__extends$t(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+AI01decoder.GTIN_SIZE)throw new NotFoundException;var t=new StringBuilder;this.encodeCompressedGtin(t,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+AI01decoder.GTIN_SIZE,e.LAST_DIGIT_SIZE);t.append("(392"),t.append(n),t.append(")");var i=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+AI01decoder.GTIN_SIZE+e.LAST_DIGIT_SIZE,null);return t.append(i.getNewString()),t.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e}(AI01decoder),__extends$s=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AI01393xDecoder=function(r){__extends$s(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+AI01decoder.GTIN_SIZE)throw new NotFoundException;var t=new StringBuilder;this.encodeCompressedGtin(t,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+AI01decoder.GTIN_SIZE,e.LAST_DIGIT_SIZE);t.append("(393"),t.append(n),t.append(")");var i=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+AI01decoder.GTIN_SIZE+e.LAST_DIGIT_SIZE,e.FIRST_THREE_DIGITS_SIZE);i/100===0&&t.append("0"),i/10===0&&t.append("0"),t.append(i);var s=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+AI01decoder.GTIN_SIZE+e.LAST_DIGIT_SIZE+e.FIRST_THREE_DIGITS_SIZE,null);return t.append(s.getNewString()),t.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e.FIRST_THREE_DIGITS_SIZE=10,e}(AI01decoder),__extends$r=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AI013x0x1xDecoder=function(r){__extends$r(e,r);function e(t,n,i){var s=r.call(this,t)||this;return s.dateCode=i,s.firstAIdigits=n,s}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE+e.DATE_SIZE)throw new NotFoundException;var t=new StringBuilder;return this.encodeCompressedGtin(t,e.HEADER_SIZE),this.encodeCompressedWeight(t,e.HEADER_SIZE+e.GTIN_SIZE,e.WEIGHT_SIZE),this.encodeCompressedDate(t,e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE),t.toString()},e.prototype.encodeCompressedDate=function(t,n){var i=this.getGeneralDecoder().extractNumericValueFromBitArray(n,e.DATE_SIZE);if(i!==38400){t.append("("),t.append(this.dateCode),t.append(")");var s=i%32;i/=32;var a=i%12+1;i/=12;var o=i;o/10===0&&t.append("0"),t.append(o),a/10===0&&t.append("0"),t.append(a),s/10===0&&t.append("0"),t.append(s)}},e.prototype.addWeightCode=function(t,n){t.append("("),t.append(this.firstAIdigits),t.append(n/1e5),t.append(")")},e.prototype.checkWeight=function(t){return t%1e5},e.HEADER_SIZE=8,e.WEIGHT_SIZE=20,e.DATE_SIZE=16,e}(AI01weightDecoder);function createDecoder(r){try{if(r.get(1))return new AI01AndOtherAIs(r);if(!r.get(2))return new AnyAIDecoder(r);var e=GeneralAppIdDecoder.extractNumericValueFromBitArray(r,1,4);switch(e){case 4:return new AI013103decoder(r);case 5:return new AI01320xDecoder(r)}var t=GeneralAppIdDecoder.extractNumericValueFromBitArray(r,1,5);switch(t){case 12:return new AI01392xDecoder(r);case 13:return new AI01393xDecoder(r)}var n=GeneralAppIdDecoder.extractNumericValueFromBitArray(r,1,7);switch(n){case 56:return new AI013x0x1xDecoder(r,"310","11");case 57:return new AI013x0x1xDecoder(r,"320","11");case 58:return new AI013x0x1xDecoder(r,"310","13");case 59:return new AI013x0x1xDecoder(r,"320","13");case 60:return new AI013x0x1xDecoder(r,"310","15");case 61:return new AI013x0x1xDecoder(r,"320","15");case 62:return new AI013x0x1xDecoder(r,"310","17");case 63:return new AI013x0x1xDecoder(r,"320","17")}}catch(i){throw console.log(i),new IllegalStateException("unknown decoder: "+r)}}var ExpandedPair=function(){function r(e,t,n,i){this.leftchar=e,this.rightchar=t,this.finderpattern=n,this.maybeLast=i}return r.prototype.mayBeLast=function(){return this.maybeLast},r.prototype.getLeftChar=function(){return this.leftchar},r.prototype.getRightChar=function(){return this.rightchar},r.prototype.getFinderPattern=function(){return this.finderpattern},r.prototype.mustBeLast=function(){return this.rightchar==null},r.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},r.equals=function(e,t){return e instanceof r?r.equalsOrNull(e.leftchar,t.leftchar)&&r.equalsOrNull(e.rightchar,t.rightchar)&&r.equalsOrNull(e.finderpattern,t.finderpattern):!1},r.equalsOrNull=function(e,t){return e===null?t===null:r.equals(e,t)},r.prototype.hashCode=function(){var e=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return e},r}(),ExpandedRow=function(){function r(e,t,n){this.pairs=e,this.rowNumber=t,this.wasReversed=n}return r.prototype.getPairs=function(){return this.pairs},r.prototype.getRowNumber=function(){return this.rowNumber},r.prototype.isReversed=function(){return this.wasReversed},r.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},r.prototype.toString=function(){return"{ "+this.pairs+" }"},r.prototype.equals=function(e,t){return e instanceof r?this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed:!1},r.prototype.checkEqualitity=function(e,t){if(!(!e||!t)){var n;return e.forEach(function(i,s){t.forEach(function(a){i.getLeftChar().getValue()===a.getLeftChar().getValue()&&i.getRightChar().getValue()===a.getRightChar().getValue()&&i.getFinderPatter().getValue()===a.getFinderPatter().getValue()&&(n=!0)})}),n}},r}(),__extends$q=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$u=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},RSSExpandedReader=function(r){__extends$q(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.pairs=new Array(e.MAX_PAIRS),t.rows=new Array,t.startEnd=[2],t}return e.prototype.decodeRow=function(t,n,i){this.pairs.length=0,this.startFromEven=!1;try{return e.constructResult(this.decodeRow2pairs(t,n))}catch{}return this.pairs.length=0,this.startFromEven=!0,e.constructResult(this.decodeRow2pairs(t,n))},e.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},e.prototype.decodeRow2pairs=function(t,n){for(var i=!1;!i;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,t))}catch(o){if(o instanceof NotFoundException){if(!this.pairs.length)throw new NotFoundException;i=!0}}if(this.checkChecksum())return this.pairs;var s;if(this.rows.length?s=!0:s=!1,this.storeRow(t,!1),s){var a=this.checkRowsBoolean(!1);if(a!=null||(a=this.checkRowsBoolean(!0),a!=null))return a}throw new NotFoundException},e.prototype.checkRowsBoolean=function(t){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,t&&(this.rows=this.rows.reverse());var n=null;try{n=this.checkRows(new Array,0)}catch(i){console.log(i)}return t&&(this.rows=this.rows.reverse()),n},e.prototype.checkRows=function(t,n){for(var i,s,a=n;a<this.rows.length;a++){var o=this.rows[a];this.pairs.length=0;try{for(var c=(i=void 0,__values$u(t)),h=c.next();!h.done;h=c.next()){var f=h.value;this.pairs.push(f.getPairs())}}catch(g){i={error:g}}finally{try{h&&!h.done&&(s=c.return)&&s.call(c)}finally{if(i)throw i.error}}if(this.pairs.push(o.getPairs()),!!e.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var m=new Array(t);m.push(o);try{return this.checkRows(m,a+1)}catch(g){console.log(g)}}}throw new NotFoundException},e.isValidSequence=function(t){var n,i;try{for(var s=__values$u(e.FINDER_PATTERN_SEQUENCES),a=s.next();!a.done;a=s.next()){var o=a.value;if(!(t.length>o.length)){for(var c=!0,h=0;h<t.length;h++)if(t[h].getFinderPattern().getValue()!==o[h]){c=!1;break}if(c)return!0}}}catch(f){n={error:f}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return!1},e.prototype.storeRow=function(t,n){for(var i=0,s=!1,a=!1;i<this.rows.length;){var o=this.rows[i];if(o.getRowNumber()>t){a=o.isEquivalent(this.pairs);break}s=o.isEquivalent(this.pairs),i++}a||s||e.isPartialRow(this.pairs,this.rows)||(this.rows.push(i,new ExpandedRow(this.pairs,t,n)),this.removePartialRows(this.pairs,this.rows))},e.prototype.removePartialRows=function(t,n){var i,s,a,o,c,h;try{for(var f=__values$u(n),m=f.next();!m.done;m=f.next()){var g=m.value;if(g.getPairs().length!==t.length){var _=!0;try{for(var E=(a=void 0,__values$u(g.getPairs())),A=E.next();!A.done;A=E.next()){var C=A.value,I=!1;try{for(var b=(c=void 0,__values$u(t)),R=b.next();!R.done;R=b.next()){var V=R.value;if(ExpandedPair.equals(C,V)){I=!0;break}}}catch(U){c={error:U}}finally{try{R&&!R.done&&(h=b.return)&&h.call(b)}finally{if(c)throw c.error}}I||(_=!1)}}catch(U){a={error:U}}finally{try{A&&!A.done&&(o=E.return)&&o.call(E)}finally{if(a)throw a.error}}}}}catch(U){i={error:U}}finally{try{m&&!m.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}},e.isPartialRow=function(t,n){var i,s,a,o,c,h;try{for(var f=__values$u(n),m=f.next();!m.done;m=f.next()){var g=m.value,_=!0;try{for(var E=(a=void 0,__values$u(t)),A=E.next();!A.done;A=E.next()){var C=A.value,I=!1;try{for(var b=(c=void 0,__values$u(g.getPairs())),R=b.next();!R.done;R=b.next()){var V=R.value;if(C.equals(V)){I=!0;break}}}catch(U){c={error:U}}finally{try{R&&!R.done&&(h=b.return)&&h.call(b)}finally{if(c)throw c.error}}if(!I){_=!1;break}}}catch(U){a={error:U}}finally{try{A&&!A.done&&(o=E.return)&&o.call(E)}finally{if(a)throw a.error}}if(_)return!0}}catch(U){i={error:U}}finally{try{m&&!m.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}return!1},e.prototype.getRows=function(){return this.rows},e.constructResult=function(t){var n=BitArrayBuilder.buildBitArray(t),i=createDecoder(n),s=i.parseInformation(),a=t[0].getFinderPattern().getResultPoints(),o=t[t.length-1].getFinderPattern().getResultPoints(),c=[a[0],a[1],o[0],o[1]];return new Result(s,null,null,c,BarcodeFormat$1.RSS_EXPANDED,null)},e.prototype.checkChecksum=function(){var t=this.pairs.get(0),n=t.getLeftChar(),i=t.getRightChar();if(i===null)return!1;for(var s=i.getChecksumPortion(),a=2,o=1;o<this.pairs.size();++o){var c=this.pairs.get(o);s+=c.getLeftChar().getChecksumPortion(),a++;var h=c.getRightChar();h!=null&&(s+=h.getChecksumPortion(),a++)}s%=211;var f=211*(a-4)+s;return f===n.getValue()},e.getNextSecondBar=function(t,n){var i;return t.get(n)?(i=t.getNextUnset(n),i=t.getNextSet(i)):(i=t.getNextSet(n),i=t.getNextUnset(i)),i},e.prototype.retrieveNextPair=function(t,n,i){var s=n.length%2===0;this.startFromEven&&(s=!s);var a,o=!0,c=-1;do this.findNextPair(t,n,c),a=this.parseFoundFinderPattern(t,i,s),a===null?c=e.getNextSecondBar(t,this.startEnd[0]):o=!1;while(o);var h=this.decodeDataCharacter(t,a,s,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new NotFoundException;var f;try{f=this.decodeDataCharacter(t,a,s,!1)}catch(m){f=null,console.log(m)}return new ExpandedPair(h,f,a,!0)},e.prototype.isEmptyPair=function(t){return t.length===0},e.prototype.findNextPair=function(t,n,i){var s=this.getDecodeFinderCounters();s[0]=0,s[1]=0,s[2]=0,s[3]=0;var a=t.getSize(),o;if(i>=0)o=i;else if(this.isEmptyPair(n))o=0;else{var c=n[n.length-1];o=c.getFinderPattern().getStartEnd()[1]}var h=n.length%2!==0;this.startFromEven&&(h=!h);for(var f=!1;o<a&&(f=!t.get(o),!!f);)o++;for(var m=0,g=o,_=o;_<a;_++)if(t.get(_)!==f)s[m]++;else{if(m===3){if(h&&e.reverseCounters(s),e.isFinderPattern(s)){this.startEnd[0]=g,this.startEnd[1]=_;return}h&&e.reverseCounters(s),g+=s[0]+s[1],s[0]=s[2],s[1]=s[3],s[2]=0,s[3]=0,m--}else m++;s[m]=1,f=!f}throw new NotFoundException},e.reverseCounters=function(t){for(var n=t.length,i=0;i<n/2;++i){var s=t[i];t[i]=t[n-i-1],t[n-i-1]=s}},e.prototype.parseFoundFinderPattern=function(t,n,i){var s,a,o;if(i){for(var c=this.startEnd[0]-1;c>=0&&!t.get(c);)c--;c++,s=this.startEnd[0]-c,a=c,o=this.startEnd[1]}else a=this.startEnd[0],o=t.getNextUnset(this.startEnd[1]+1),s=o-this.startEnd[1];var h=this.getDecodeFinderCounters();System.arraycopy(h,0,h,1,h.length-1),h[0]=s;var f;try{f=this.parseFinderValue(h,e.FINDER_PATTERNS)}catch{return null}return new FinderPattern$1(f,[a,o],a,o,n)},e.prototype.decodeDataCharacter=function(t,n,i,s){for(var a=this.getDataCharacterCounters(),o=0;o<a.length;o++)a[o]=0;if(s)e.recordPatternInReverse(t,n.getStartEnd()[0],a);else{e.recordPattern(t,n.getStartEnd()[1],a);for(var c=0,h=a.length-1;c<h;c++,h--){var f=a[c];a[c]=a[h],a[h]=f}}var m=17,g=MathUtils.sum(new Int32Array(a))/m,_=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(g-_)/_>.3)throw new NotFoundException;for(var E=this.getOddCounts(),A=this.getEvenCounts(),C=this.getOddRoundingErrors(),I=this.getEvenRoundingErrors(),c=0;c<a.length;c++){var b=1*a[c]/g,R=b+.5;if(R<1){if(b<.3)throw new NotFoundException;R=1}else if(R>8){if(b>8.7)throw new NotFoundException;R=8}var V=c/2;(c&1)===0?(E[V]=R,C[V]=b-R):(A[V]=R,I[V]=b-R)}this.adjustOddEvenCounts(m);for(var U=4*n.getValue()+(i?0:2)+(s?0:1)-1,W=0,j=0,c=E.length-1;c>=0;c--){if(e.isNotA1left(n,i,s)){var w=e.WEIGHTS[U][2*c];j+=E[c]*w}W+=E[c]}for(var P=0,c=A.length-1;c>=0;c--)if(e.isNotA1left(n,i,s)){var w=e.WEIGHTS[U][2*c+1];P+=A[c]*w}var K=j+P;if((W&1)!==0||W>13||W<4)throw new NotFoundException;var X=(13-W)/2,Y=e.SYMBOL_WIDEST[X],Z=9-Y,ae=RSSUtils.getRSSvalue(E,Y,!0),le=RSSUtils.getRSSvalue(A,Z,!1),ie=e.EVEN_TOTAL_SUBSET[X],se=e.GSUM[X],ce=ae*ie+le+se;return new DataCharacter(ce,K)},e.isNotA1left=function(t,n,i){return!(t.getValue()===0&&n&&i)},e.prototype.adjustOddEvenCounts=function(t){var n=MathUtils.sum(new Int32Array(this.getOddCounts())),i=MathUtils.sum(new Int32Array(this.getEvenCounts())),s=!1,a=!1;n>13?a=!0:n<4&&(s=!0);var o=!1,c=!1;i>13?c=!0:i<4&&(o=!0);var h=n+i-t,f=(n&1)===1,m=(i&1)===0;if(h===1)if(f){if(m)throw new NotFoundException;a=!0}else{if(!m)throw new NotFoundException;c=!0}else if(h===-1)if(f){if(m)throw new NotFoundException;s=!0}else{if(!m)throw new NotFoundException;o=!0}else if(h===0){if(f){if(!m)throw new NotFoundException;n<i?(s=!0,c=!0):(a=!0,o=!0)}else if(m)throw new NotFoundException}else throw new NotFoundException;if(s){if(a)throw new NotFoundException;e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(a&&e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(c)throw new NotFoundException;e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}c&&e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.SYMBOL_WIDEST=[7,5,4,3,1],e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],e.GSUM=[0,348,1388,2948,3988],e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],e.FINDER_PAT_A=0,e.FINDER_PAT_B=1,e.FINDER_PAT_C=2,e.FINDER_PAT_D=3,e.FINDER_PAT_E=4,e.FINDER_PAT_F=5,e.FINDER_PATTERN_SEQUENCES=[[e.FINDER_PAT_A,e.FINDER_PAT_A],[e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B],[e.FINDER_PAT_A,e.FINDER_PAT_C,e.FINDER_PAT_B,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_C],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F]],e.MAX_PAIRS=11,e}(AbstractRSSReader),__extends$p=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Pair=function(r){__extends$p(e,r);function e(t,n,i){var s=r.call(this,t,n)||this;return s.count=0,s.finderPattern=i,s}return e.prototype.getFinderPattern=function(){return this.finderPattern},e.prototype.getCount=function(){return this.count},e.prototype.incrementCount=function(){this.count++},e}(DataCharacter),__extends$o=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$t=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},RSS14Reader=function(r){__extends$o(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.possibleLeftPairs=[],t.possibleRightPairs=[],t}return e.prototype.decodeRow=function(t,n,i){var s,a,o,c,h=this.decodePair(n,!1,t,i);e.addOrTally(this.possibleLeftPairs,h),n.reverse();var f=this.decodePair(n,!0,t,i);e.addOrTally(this.possibleRightPairs,f),n.reverse();try{for(var m=__values$t(this.possibleLeftPairs),g=m.next();!g.done;g=m.next()){var _=g.value;if(_.getCount()>1)try{for(var E=(o=void 0,__values$t(this.possibleRightPairs)),A=E.next();!A.done;A=E.next()){var C=A.value;if(C.getCount()>1&&e.checkChecksum(_,C))return e.constructResult(_,C)}}catch(I){o={error:I}}finally{try{A&&!A.done&&(c=E.return)&&c.call(E)}finally{if(o)throw o.error}}}}catch(I){s={error:I}}finally{try{g&&!g.done&&(a=m.return)&&a.call(m)}finally{if(s)throw s.error}}throw new NotFoundException},e.addOrTally=function(t,n){var i,s;if(n!=null){var a=!1;try{for(var o=__values$t(t),c=o.next();!c.done;c=o.next()){var h=c.value;if(h.getValue()===n.getValue()){h.incrementCount(),a=!0;break}}}catch(f){i={error:f}}finally{try{c&&!c.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}a||t.push(n)}},e.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},e.constructResult=function(t,n){for(var i=4537077*t.getValue()+n.getValue(),s=new String(i).toString(),a=new StringBuilder,o=13-s.length;o>0;o--)a.append("0");a.append(s);for(var c=0,o=0;o<13;o++){var h=a.charAt(o).charCodeAt(0)-48;c+=(o&1)===0?3*h:h}c=10-c%10,c===10&&(c=0),a.append(c.toString());var f=t.getFinderPattern().getResultPoints(),m=n.getFinderPattern().getResultPoints();return new Result(a.toString(),null,0,[f[0],f[1],m[0],m[1]],BarcodeFormat$1.RSS_14,new Date().getTime())},e.checkChecksum=function(t,n){var i=(t.getChecksumPortion()+16*n.getChecksumPortion())%79,s=9*t.getFinderPattern().getValue()+n.getFinderPattern().getValue();return s>72&&s--,s>8&&s--,i===s},e.prototype.decodePair=function(t,n,i,s){try{var a=this.findFinderPattern(t,n),o=this.parseFoundFinderPattern(t,i,n,a),c=s==null?null:s.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);if(c!=null){var h=(a[0]+a[1])/2;n&&(h=t.getSize()-1-h),c.foundPossibleResultPoint(new ResultPoint(h,i))}var f=this.decodeDataCharacter(t,o,!0),m=this.decodeDataCharacter(t,o,!1);return new Pair(1597*f.getValue()+m.getValue(),f.getChecksumPortion()+4*m.getChecksumPortion(),o)}catch{return null}},e.prototype.decodeDataCharacter=function(t,n,i){for(var s=this.getDataCharacterCounters(),a=0;a<s.length;a++)s[a]=0;if(i)OneDReader.recordPatternInReverse(t,n.getStartEnd()[0],s);else{OneDReader.recordPattern(t,n.getStartEnd()[1]+1,s);for(var o=0,c=s.length-1;o<c;o++,c--){var h=s[o];s[o]=s[c],s[c]=h}}for(var f=i?16:15,m=MathUtils.sum(new Int32Array(s))/f,g=this.getOddCounts(),_=this.getEvenCounts(),E=this.getOddRoundingErrors(),A=this.getEvenRoundingErrors(),o=0;o<s.length;o++){var C=s[o]/m,I=Math.floor(C+.5);I<1?I=1:I>8&&(I=8);var b=Math.floor(o/2);(o&1)===0?(g[b]=I,E[b]=C-I):(_[b]=I,A[b]=C-I)}this.adjustOddEvenCounts(i,f);for(var R=0,V=0,o=g.length-1;o>=0;o--)V*=9,V+=g[o],R+=g[o];for(var U=0,W=0,o=_.length-1;o>=0;o--)U*=9,U+=_[o],W+=_[o];var j=V+3*U;if(i){if((R&1)!==0||R>12||R<4)throw new NotFoundException;var w=(12-R)/2,P=e.OUTSIDE_ODD_WIDEST[w],K=9-P,X=RSSUtils.getRSSvalue(g,P,!1),Y=RSSUtils.getRSSvalue(_,K,!0),Z=e.OUTSIDE_EVEN_TOTAL_SUBSET[w],ae=e.OUTSIDE_GSUM[w];return new DataCharacter(X*Z+Y+ae,j)}else{if((W&1)!==0||W>10||W<4)throw new NotFoundException;var w=(10-W)/2,P=e.INSIDE_ODD_WIDEST[w],K=9-P,X=RSSUtils.getRSSvalue(g,P,!0),Y=RSSUtils.getRSSvalue(_,K,!1),le=e.INSIDE_ODD_TOTAL_SUBSET[w],ae=e.INSIDE_GSUM[w];return new DataCharacter(Y*le+X+ae,j)}},e.prototype.findFinderPattern=function(t,n){var i=this.getDecodeFinderCounters();i[0]=0,i[1]=0,i[2]=0,i[3]=0;for(var s=t.getSize(),a=!1,o=0;o<s&&(a=!t.get(o),n!==a);)o++;for(var c=0,h=o,f=o;f<s;f++)if(t.get(f)!==a)i[c]++;else{if(c===3){if(AbstractRSSReader.isFinderPattern(i))return[h,f];h+=i[0]+i[1],i[0]=i[2],i[1]=i[3],i[2]=0,i[3]=0,c--}else c++;i[c]=1,a=!a}throw new NotFoundException},e.prototype.parseFoundFinderPattern=function(t,n,i,s){for(var a=t.get(s[0]),o=s[0]-1;o>=0&&a!==t.get(o);)o--;o++;var c=s[0]-o,h=this.getDecodeFinderCounters(),f=new Int32Array(h.length);System.arraycopy(h,0,f,1,h.length-1),f[0]=c;var m=this.parseFinderValue(f,e.FINDER_PATTERNS),g=o,_=s[1];return i&&(g=t.getSize()-1-g,_=t.getSize()-1-_),new FinderPattern$1(m,[o,s[1]],g,_,n)},e.prototype.adjustOddEvenCounts=function(t,n){var i=MathUtils.sum(new Int32Array(this.getOddCounts())),s=MathUtils.sum(new Int32Array(this.getEvenCounts())),a=!1,o=!1,c=!1,h=!1;t?(i>12?o=!0:i<4&&(a=!0),s>12?h=!0:s<4&&(c=!0)):(i>11?o=!0:i<5&&(a=!0),s>10?h=!0:s<4&&(c=!0));var f=i+s-n,m=(i&1)===(t?1:0),g=(s&1)===1;if(f===1)if(m){if(g)throw new NotFoundException;o=!0}else{if(!g)throw new NotFoundException;h=!0}else if(f===-1)if(m){if(g)throw new NotFoundException;a=!0}else{if(!g)throw new NotFoundException;c=!0}else if(f===0){if(m){if(!g)throw new NotFoundException;i<s?(a=!0,h=!0):(o=!0,c=!0)}else if(g)throw new NotFoundException}else throw new NotFoundException;if(a){if(o)throw new NotFoundException;AbstractRSSReader.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&AbstractRSSReader.decrement(this.getOddCounts(),this.getOddRoundingErrors()),c){if(h)throw new NotFoundException;AbstractRSSReader.increment(this.getEvenCounts(),this.getOddRoundingErrors())}h&&AbstractRSSReader.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],e.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],e.OUTSIDE_GSUM=[0,161,961,2015,2715],e.INSIDE_GSUM=[0,336,1036,1516],e.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],e.INSIDE_ODD_WIDEST=[2,4,6,8],e.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],e}(AbstractRSSReader),__extends$n=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),MultiFormatOneDReader=function(r){__extends$n(e,r);function e(t){var n=r.call(this)||this;n.readers=[];var i=t?t.get(DecodeHintType$1.POSSIBLE_FORMATS):null,s=t&&t.get(DecodeHintType$1.ASSUME_CODE_39_CHECK_DIGIT)!==void 0,a=t&&t.get(DecodeHintType$1.ENABLE_CODE_39_EXTENDED_MODE)!==void 0;return i&&((i.includes(BarcodeFormat$1.EAN_13)||i.includes(BarcodeFormat$1.UPC_A)||i.includes(BarcodeFormat$1.EAN_8)||i.includes(BarcodeFormat$1.UPC_E))&&n.readers.push(new MultiFormatUPCEANReader(t)),i.includes(BarcodeFormat$1.CODE_39)&&n.readers.push(new Code39Reader(s,a)),i.includes(BarcodeFormat$1.CODE_93)&&n.readers.push(new Code93Reader),i.includes(BarcodeFormat$1.CODE_128)&&n.readers.push(new Code128Reader),i.includes(BarcodeFormat$1.ITF)&&n.readers.push(new ITFReader),i.includes(BarcodeFormat$1.CODABAR)&&n.readers.push(new CodaBarReader),i.includes(BarcodeFormat$1.RSS_14)&&n.readers.push(new RSS14Reader),i.includes(BarcodeFormat$1.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),n.readers.push(new RSSExpandedReader))),n.readers.length===0&&(n.readers.push(new MultiFormatUPCEANReader(t)),n.readers.push(new Code39Reader),n.readers.push(new Code93Reader),n.readers.push(new MultiFormatUPCEANReader(t)),n.readers.push(new Code128Reader),n.readers.push(new ITFReader),n.readers.push(new RSS14Reader)),n}return e.prototype.decodeRow=function(t,n,i){for(var s=0;s<this.readers.length;s++)try{return this.readers[s].decodeRow(t,n,i)}catch{}throw new NotFoundException},e.prototype.reset=function(){this.readers.forEach(function(t){return t.reset()})},e}(OneDReader),__extends$m=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){__extends$m(e,r);function e(t,n){return t===void 0&&(t=500),r.call(this,new MultiFormatOneDReader(n),t,n)||this}return e})(BrowserCodeReader);var __values$s=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ECBlocks$1=function(){function r(e,t,n){this.ecCodewords=e,this.ecBlocks=[t],n&&this.ecBlocks.push(n)}return r.prototype.getECCodewords=function(){return this.ecCodewords},r.prototype.getECBlocks=function(){return this.ecBlocks},r}(),ECB$1=function(){function r(e,t){this.count=e,this.dataCodewords=t}return r.prototype.getCount=function(){return this.count},r.prototype.getDataCodewords=function(){return this.dataCodewords},r}(),Version$1=function(){function r(e,t,n,i,s,a){var o,c;this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=n,this.dataRegionSizeRows=i,this.dataRegionSizeColumns=s,this.ecBlocks=a;var h=0,f=a.getECCodewords(),m=a.getECBlocks();try{for(var g=__values$s(m),_=g.next();!_.done;_=g.next()){var E=_.value;h+=E.getCount()*(E.getDataCodewords()+f)}}catch(A){o={error:A}}finally{try{_&&!_.done&&(c=g.return)&&c.call(g)}finally{if(o)throw o.error}}this.totalCodewords=h}return r.prototype.getVersionNumber=function(){return this.versionNumber},r.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},r.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},r.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},r.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},r.prototype.getTotalCodewords=function(){return this.totalCodewords},r.prototype.getECBlocks=function(){return this.ecBlocks},r.getVersionForDimensions=function(e,t){var n,i;if((e&1)!==0||(t&1)!==0)throw new FormatException;try{for(var s=__values$s(r.VERSIONS),a=s.next();!a.done;a=s.next()){var o=a.value;if(o.symbolSizeRows===e&&o.symbolSizeColumns===t)return o}}catch(c){n={error:c}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}throw new FormatException},r.prototype.toString=function(){return""+this.versionNumber},r.buildVersions=function(){return[new r(1,10,10,8,8,new ECBlocks$1(5,new ECB$1(1,3))),new r(2,12,12,10,10,new ECBlocks$1(7,new ECB$1(1,5))),new r(3,14,14,12,12,new ECBlocks$1(10,new ECB$1(1,8))),new r(4,16,16,14,14,new ECBlocks$1(12,new ECB$1(1,12))),new r(5,18,18,16,16,new ECBlocks$1(14,new ECB$1(1,18))),new r(6,20,20,18,18,new ECBlocks$1(18,new ECB$1(1,22))),new r(7,22,22,20,20,new ECBlocks$1(20,new ECB$1(1,30))),new r(8,24,24,22,22,new ECBlocks$1(24,new ECB$1(1,36))),new r(9,26,26,24,24,new ECBlocks$1(28,new ECB$1(1,44))),new r(10,32,32,14,14,new ECBlocks$1(36,new ECB$1(1,62))),new r(11,36,36,16,16,new ECBlocks$1(42,new ECB$1(1,86))),new r(12,40,40,18,18,new ECBlocks$1(48,new ECB$1(1,114))),new r(13,44,44,20,20,new ECBlocks$1(56,new ECB$1(1,144))),new r(14,48,48,22,22,new ECBlocks$1(68,new ECB$1(1,174))),new r(15,52,52,24,24,new ECBlocks$1(42,new ECB$1(2,102))),new r(16,64,64,14,14,new ECBlocks$1(56,new ECB$1(2,140))),new r(17,72,72,16,16,new ECBlocks$1(36,new ECB$1(4,92))),new r(18,80,80,18,18,new ECBlocks$1(48,new ECB$1(4,114))),new r(19,88,88,20,20,new ECBlocks$1(56,new ECB$1(4,144))),new r(20,96,96,22,22,new ECBlocks$1(68,new ECB$1(4,174))),new r(21,104,104,24,24,new ECBlocks$1(56,new ECB$1(6,136))),new r(22,120,120,18,18,new ECBlocks$1(68,new ECB$1(6,175))),new r(23,132,132,20,20,new ECBlocks$1(62,new ECB$1(8,163))),new r(24,144,144,22,22,new ECBlocks$1(62,new ECB$1(8,156),new ECB$1(2,155))),new r(25,8,18,6,16,new ECBlocks$1(7,new ECB$1(1,5))),new r(26,8,32,6,14,new ECBlocks$1(11,new ECB$1(1,10))),new r(27,12,26,10,24,new ECBlocks$1(14,new ECB$1(1,16))),new r(28,12,36,10,16,new ECBlocks$1(18,new ECB$1(1,22))),new r(29,16,36,14,16,new ECBlocks$1(24,new ECB$1(1,32))),new r(30,16,48,14,22,new ECBlocks$1(28,new ECB$1(1,49)))]},r.VERSIONS=r.buildVersions(),r}(),BitMatrixParser$1=function(){function r(e){var t=e.getHeight();if(t<8||t>144||(t&1)!==0)throw new FormatException;this.version=r.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new BitMatrix(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return r.prototype.getVersion=function(){return this.version},r.readVersion=function(e){var t=e.getHeight(),n=e.getWidth();return Version$1.getVersionForDimensions(t,n)},r.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),t=0,n=4,i=0,s=this.mappingBitMatrix.getHeight(),a=this.mappingBitMatrix.getWidth(),o=!1,c=!1,h=!1,f=!1;do if(n===s&&i===0&&!o)e[t++]=this.readCorner1(s,a)&255,n-=2,i+=2,o=!0;else if(n===s-2&&i===0&&(a&3)!==0&&!c)e[t++]=this.readCorner2(s,a)&255,n-=2,i+=2,c=!0;else if(n===s+4&&i===2&&(a&7)===0&&!h)e[t++]=this.readCorner3(s,a)&255,n-=2,i+=2,h=!0;else if(n===s-2&&i===0&&(a&7)===4&&!f)e[t++]=this.readCorner4(s,a)&255,n-=2,i+=2,f=!0;else{do n<s&&i>=0&&!this.readMappingMatrix.get(i,n)&&(e[t++]=this.readUtah(n,i,s,a)&255),n-=2,i+=2;while(n>=0&&i<a);n+=1,i+=3;do n>=0&&i<a&&!this.readMappingMatrix.get(i,n)&&(e[t++]=this.readUtah(n,i,s,a)&255),n+=2,i-=2;while(n<s&&i>=0);n+=3,i+=1}while(n<s||i<a);if(t!==this.version.getTotalCodewords())throw new FormatException;return e},r.prototype.readModule=function(e,t,n,i){return e<0&&(e+=n,t+=4-(n+4&7)),t<0&&(t+=i,e+=4-(i+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)},r.prototype.readUtah=function(e,t,n,i){var s=0;return this.readModule(e-2,t-2,n,i)&&(s|=1),s<<=1,this.readModule(e-2,t-1,n,i)&&(s|=1),s<<=1,this.readModule(e-1,t-2,n,i)&&(s|=1),s<<=1,this.readModule(e-1,t-1,n,i)&&(s|=1),s<<=1,this.readModule(e-1,t,n,i)&&(s|=1),s<<=1,this.readModule(e,t-2,n,i)&&(s|=1),s<<=1,this.readModule(e,t-1,n,i)&&(s|=1),s<<=1,this.readModule(e,t,n,i)&&(s|=1),s},r.prototype.readCorner1=function(e,t){var n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,1,e,t)&&(n|=1),n<<=1,this.readModule(e-1,2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n},r.prototype.readCorner2=function(e,t){var n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-4,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n},r.prototype.readCorner3=function(e,t){var n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-3,e,t)&&(n|=1),n<<=1,this.readModule(1,t-2,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n},r.prototype.readCorner4=function(e,t){var n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n},r.prototype.extractDataRegion=function(e){var t=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new IllegalArgumentException("Dimension of bitMatrix must match the version size");for(var i=this.version.getDataRegionSizeRows(),s=this.version.getDataRegionSizeColumns(),a=t/i|0,o=n/s|0,c=a*i,h=o*s,f=new BitMatrix(h,c),m=0;m<a;++m)for(var g=m*i,_=0;_<o;++_)for(var E=_*s,A=0;A<i;++A)for(var C=m*(i+2)+1+A,I=g+A,b=0;b<s;++b){var R=_*(s+2)+1+b;if(e.get(R,C)){var V=E+b;f.set(V,I)}}return f},r}(),__values$r=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},DataBlock$1=function(){function r(e,t){this.numDataCodewords=e,this.codewords=t}return r.getDataBlocks=function(e,t){var n,i,s,a,o=t.getECBlocks(),c=0,h=o.getECBlocks();try{for(var f=__values$r(h),m=f.next();!m.done;m=f.next()){var g=m.value;c+=g.getCount()}}catch(ae){n={error:ae}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}var _=new Array(c),E=0;try{for(var A=__values$r(h),C=A.next();!C.done;C=A.next())for(var g=C.value,I=0;I<g.getCount();I++){var b=g.getDataCodewords(),R=o.getECCodewords()+b;_[E++]=new r(b,new Uint8Array(R))}}catch(ae){s={error:ae}}finally{try{C&&!C.done&&(a=A.return)&&a.call(A)}finally{if(s)throw s.error}}for(var V=_[0].codewords.length,U=V-o.getECCodewords(),W=U-1,j=0,I=0;I<W;I++)for(var w=0;w<E;w++)_[w].codewords[I]=e[j++];for(var P=t.getVersionNumber()===24,K=P?8:E,w=0;w<K;w++)_[w].codewords[U-1]=e[j++];for(var X=_[0].codewords.length,I=U;I<X;I++)for(var w=0;w<E;w++){var Y=P?(w+8)%E:w,Z=P&&Y>7?I-1:I;_[Y].codewords[Z]=e[j++]}if(j!==e.length)throw new IllegalArgumentException;return _},r.prototype.getNumDataCodewords=function(){return this.numDataCodewords},r.prototype.getCodewords=function(){return this.codewords},r}(),BitSource=function(){function r(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return r.prototype.getBitOffset=function(){return this.bitOffset},r.prototype.getByteOffset=function(){return this.byteOffset},r.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new IllegalArgumentException(""+e);var t=0,n=this.bitOffset,i=this.byteOffset,s=this.bytes;if(n>0){var a=8-n,o=e<a?e:a,c=a-o,h=255>>8-o<<c;t=(s[i]&h)>>c,e-=o,n+=o,n===8&&(n=0,i++)}if(e>0){for(;e>=8;)t=t<<8|s[i]&255,i++,e-=8;if(e>0){var c=8-e,h=255>>c<<c;t=t<<e|(s[i]&h)>>c,n+=e}}return this.bitOffset=n,this.byteOffset=i,t},r.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},r}(),Mode$3;(function(r){r[r.PAD_ENCODE=0]="PAD_ENCODE",r[r.ASCII_ENCODE=1]="ASCII_ENCODE",r[r.C40_ENCODE=2]="C40_ENCODE",r[r.TEXT_ENCODE=3]="TEXT_ENCODE",r[r.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",r[r.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",r[r.BASE256_ENCODE=6]="BASE256_ENCODE"})(Mode$3||(Mode$3={}));var DecodedBitStreamParser$2=function(){function r(){}return r.decode=function(e){var t=new BitSource(e),n=new StringBuilder,i=new StringBuilder,s=new Array,a=Mode$3.ASCII_ENCODE;do if(a===Mode$3.ASCII_ENCODE)a=this.decodeAsciiSegment(t,n,i);else{switch(a){case Mode$3.C40_ENCODE:this.decodeC40Segment(t,n);break;case Mode$3.TEXT_ENCODE:this.decodeTextSegment(t,n);break;case Mode$3.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,n);break;case Mode$3.EDIFACT_ENCODE:this.decodeEdifactSegment(t,n);break;case Mode$3.BASE256_ENCODE:this.decodeBase256Segment(t,n,s);break;default:throw new FormatException}a=Mode$3.ASCII_ENCODE}while(a!==Mode$3.PAD_ENCODE&&t.available()>0);return i.length()>0&&n.append(i.toString()),new DecoderResult(e,n.toString(),s.length===0?null:s,null)},r.decodeAsciiSegment=function(e,t,n){var i=!1;do{var s=e.readBits(8);if(s===0)throw new FormatException;if(s<=128)return i&&(s+=128),t.append(String.fromCharCode(s-1)),Mode$3.ASCII_ENCODE;if(s===129)return Mode$3.PAD_ENCODE;if(s<=229){var a=s-130;a<10&&t.append("0"),t.append(""+a)}else switch(s){case 230:return Mode$3.C40_ENCODE;case 231:return Mode$3.BASE256_ENCODE;case 232:t.append("");break;case 233:case 234:break;case 235:i=!0;break;case 236:t.append("[)>05"),n.insert(0,"");break;case 237:t.append("[)>06"),n.insert(0,"");break;case 238:return Mode$3.ANSIX12_ENCODE;case 239:return Mode$3.TEXT_ENCODE;case 240:return Mode$3.EDIFACT_ENCODE;case 241:break;default:if(s!==254||e.available()!==0)throw new FormatException;break}}while(e.available()>0);return Mode$3.ASCII_ENCODE},r.decodeC40Segment=function(e,t){var n=!1,i=[],s=0;do{if(e.available()===8)return;var a=e.readBits(8);if(a===254)return;this.parseTwoBytes(a,e.readBits(8),i);for(var o=0;o<3;o++){var c=i[o];switch(s){case 0:if(c<3)s=c+1;else if(c<this.C40_BASIC_SET_CHARS.length){var h=this.C40_BASIC_SET_CHARS[c];n?(t.append(String.fromCharCode(h.charCodeAt(0)+128)),n=!1):t.append(h)}else throw new FormatException;break;case 1:n?(t.append(String.fromCharCode(c+128)),n=!1):t.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.C40_SHIFT2_SET_CHARS.length){var h=this.C40_SHIFT2_SET_CHARS[c];n?(t.append(String.fromCharCode(h.charCodeAt(0)+128)),n=!1):t.append(h)}else switch(c){case 27:t.append("");break;case 30:n=!0;break;default:throw new FormatException}s=0;break;case 3:n?(t.append(String.fromCharCode(c+224)),n=!1):t.append(String.fromCharCode(c+96)),s=0;break;default:throw new FormatException}}}while(e.available()>0)},r.decodeTextSegment=function(e,t){var n=!1,i=[],s=0;do{if(e.available()===8)return;var a=e.readBits(8);if(a===254)return;this.parseTwoBytes(a,e.readBits(8),i);for(var o=0;o<3;o++){var c=i[o];switch(s){case 0:if(c<3)s=c+1;else if(c<this.TEXT_BASIC_SET_CHARS.length){var h=this.TEXT_BASIC_SET_CHARS[c];n?(t.append(String.fromCharCode(h.charCodeAt(0)+128)),n=!1):t.append(h)}else throw new FormatException;break;case 1:n?(t.append(String.fromCharCode(c+128)),n=!1):t.append(String.fromCharCode(c)),s=0;break;case 2:if(c<this.TEXT_SHIFT2_SET_CHARS.length){var h=this.TEXT_SHIFT2_SET_CHARS[c];n?(t.append(String.fromCharCode(h.charCodeAt(0)+128)),n=!1):t.append(h)}else switch(c){case 27:t.append("");break;case 30:n=!0;break;default:throw new FormatException}s=0;break;case 3:if(c<this.TEXT_SHIFT3_SET_CHARS.length){var h=this.TEXT_SHIFT3_SET_CHARS[c];n?(t.append(String.fromCharCode(h.charCodeAt(0)+128)),n=!1):t.append(h),s=0}else throw new FormatException;break;default:throw new FormatException}}}while(e.available()>0)},r.decodeAnsiX12Segment=function(e,t){var n=[];do{if(e.available()===8)return;var i=e.readBits(8);if(i===254)return;this.parseTwoBytes(i,e.readBits(8),n);for(var s=0;s<3;s++){var a=n[s];switch(a){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(a<14)t.append(String.fromCharCode(a+44));else if(a<40)t.append(String.fromCharCode(a+51));else throw new FormatException;break}}}while(e.available()>0)},r.parseTwoBytes=function(e,t,n){var i=(e<<8)+t-1,s=Math.floor(i/1600);n[0]=s,i-=s*1600,s=Math.floor(i/40),n[1]=s,n[2]=i-s*40},r.decodeEdifactSegment=function(e,t){do{if(e.available()<=16)return;for(var n=0;n<4;n++){var i=e.readBits(6);if(i===31){var s=8-e.getBitOffset();s!==8&&e.readBits(s);return}(i&32)===0&&(i|=64),t.append(String.fromCharCode(i))}}while(e.available()>0)},r.decodeBase256Segment=function(e,t,n){var i=1+e.getByteOffset(),s=this.unrandomize255State(e.readBits(8),i++),a;if(s===0?a=e.available()/8|0:s<250?a=s:a=250*(s-249)+this.unrandomize255State(e.readBits(8),i++),a<0)throw new FormatException;for(var o=new Uint8Array(a),c=0;c<a;c++){if(e.available()<8)throw new FormatException;o[c]=this.unrandomize255State(e.readBits(8),i++)}n.push(o);try{t.append(StringEncoding.decode(o,StringUtils.ISO88591))}catch(h){throw new IllegalStateException("Platform does not support required encoding: "+h.message)}},r.unrandomize255State=function(e,t){var n=149*t%255+1,i=e-n;return i>=0?i:i+256},r.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],r.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],r.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],r.TEXT_SHIFT2_SET_CHARS=r.C40_SHIFT2_SET_CHARS,r.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],r}(),__values$q=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Decoder$1=function(){function r(){this.rsDecoder=new ReedSolomonDecoder(GenericGF.DATA_MATRIX_FIELD_256)}return r.prototype.decode=function(e){var t,n,i=new BitMatrixParser$1(e),s=i.getVersion(),a=i.readCodewords(),o=DataBlock$1.getDataBlocks(a,s),c=0;try{for(var h=__values$q(o),f=h.next();!f.done;f=h.next()){var m=f.value;c+=m.getNumDataCodewords()}}catch(R){t={error:R}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(t)throw t.error}}for(var g=new Uint8Array(c),_=o.length,E=0;E<_;E++){var A=o[E],C=A.getCodewords(),I=A.getNumDataCodewords();this.correctErrors(C,I);for(var b=0;b<I;b++)g[b*_+E]=C[b]}return DecodedBitStreamParser$2.decode(g)},r.prototype.correctErrors=function(e,t){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new ChecksumException}for(var i=0;i<t;i++)e[i]=n[i]},r}(),Detector$2=function(){function r(e){this.image=e,this.rectangleDetector=new WhiteRectangleDetector(this.image)}return r.prototype.detect=function(){var e=this.rectangleDetector.detect(),t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new NotFoundException;t=this.shiftToModuleCenter(t);var n=t[0],i=t[1],s=t[2],a=t[3],o=this.transitionsBetween(n,a)+1,c=this.transitionsBetween(s,a)+1;(o&1)===1&&(o+=1),(c&1)===1&&(c+=1),4*o<7*c&&4*c<7*o&&(o=c=Math.max(o,c));var h=r.sampleGrid(this.image,n,i,s,a,o,c);return new DetectorResult(h,[n,i,s,a])},r.shiftPoint=function(e,t,n){var i=(t.getX()-e.getX())/(n+1),s=(t.getY()-e.getY())/(n+1);return new ResultPoint(e.getX()+i,e.getY()+s)},r.moveAway=function(e,t,n){var i=e.getX(),s=e.getY();return i<t?i-=1:i+=1,s<n?s-=1:s+=1,new ResultPoint(i,s)},r.prototype.detectSolid1=function(e){var t=e[0],n=e[1],i=e[3],s=e[2],a=this.transitionsBetween(t,n),o=this.transitionsBetween(n,i),c=this.transitionsBetween(i,s),h=this.transitionsBetween(s,t),f=a,m=[s,t,n,i];return f>o&&(f=o,m[0]=t,m[1]=n,m[2]=i,m[3]=s),f>c&&(f=c,m[0]=n,m[1]=i,m[2]=s,m[3]=t),f>h&&(m[0]=i,m[1]=s,m[2]=t,m[3]=n),m},r.prototype.detectSolid2=function(e){var t=e[0],n=e[1],i=e[2],s=e[3],a=this.transitionsBetween(t,s),o=r.shiftPoint(n,i,(a+1)*4),c=r.shiftPoint(i,n,(a+1)*4),h=this.transitionsBetween(o,t),f=this.transitionsBetween(c,s);return h<f?(e[0]=t,e[1]=n,e[2]=i,e[3]=s):(e[0]=n,e[1]=i,e[2]=s,e[3]=t),e},r.prototype.correctTopRight=function(e){var t=e[0],n=e[1],i=e[2],s=e[3],a=this.transitionsBetween(t,s),o=this.transitionsBetween(n,s),c=r.shiftPoint(t,n,(o+1)*4),h=r.shiftPoint(i,n,(a+1)*4);a=this.transitionsBetween(c,s),o=this.transitionsBetween(h,s);var f=new ResultPoint(s.getX()+(i.getX()-n.getX())/(a+1),s.getY()+(i.getY()-n.getY())/(a+1)),m=new ResultPoint(s.getX()+(t.getX()-n.getX())/(o+1),s.getY()+(t.getY()-n.getY())/(o+1));if(!this.isValid(f))return this.isValid(m)?m:null;if(!this.isValid(m))return f;var g=this.transitionsBetween(c,f)+this.transitionsBetween(h,f),_=this.transitionsBetween(c,m)+this.transitionsBetween(h,m);return g>_?f:m},r.prototype.shiftToModuleCenter=function(e){var t=e[0],n=e[1],i=e[2],s=e[3],a=this.transitionsBetween(t,s)+1,o=this.transitionsBetween(i,s)+1,c=r.shiftPoint(t,n,o*4),h=r.shiftPoint(i,n,a*4);a=this.transitionsBetween(c,s)+1,o=this.transitionsBetween(h,s)+1,(a&1)===1&&(a+=1),(o&1)===1&&(o+=1);var f=(t.getX()+n.getX()+i.getX()+s.getX())/4,m=(t.getY()+n.getY()+i.getY()+s.getY())/4;t=r.moveAway(t,f,m),n=r.moveAway(n,f,m),i=r.moveAway(i,f,m),s=r.moveAway(s,f,m);var g,_;return c=r.shiftPoint(t,n,o*4),c=r.shiftPoint(c,s,a*4),g=r.shiftPoint(n,t,o*4),g=r.shiftPoint(g,i,a*4),h=r.shiftPoint(i,s,o*4),h=r.shiftPoint(h,n,a*4),_=r.shiftPoint(s,i,o*4),_=r.shiftPoint(_,t,a*4),[c,g,h,_]},r.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},r.sampleGrid=function(e,t,n,i,s,a,o){var c=GridSamplerInstance.getInstance();return c.sampleGrid(e,a,o,.5,.5,a-.5,.5,a-.5,o-.5,.5,o-.5,t.getX(),t.getY(),s.getX(),s.getY(),i.getX(),i.getY(),n.getX(),n.getY())},r.prototype.transitionsBetween=function(e,t){var n=Math.trunc(e.getX()),i=Math.trunc(e.getY()),s=Math.trunc(t.getX()),a=Math.trunc(t.getY()),o=Math.abs(a-i)>Math.abs(s-n);if(o){var c=n;n=i,i=c,c=s,s=a,a=c}for(var h=Math.abs(s-n),f=Math.abs(a-i),m=-h/2,g=i<a?1:-1,_=n<s?1:-1,E=0,A=this.image.get(o?i:n,o?n:i),C=n,I=i;C!==s;C+=_){var b=this.image.get(o?I:C,o?C:I);if(b!==A&&(E++,A=b),m+=f,m>0){if(I===a)break;I+=g,m-=h}}return E},r}(),DataMatrixReader=function(){function r(){this.decoder=new Decoder$1}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var n,i;if(t!=null&&t.has(DecodeHintType$1.PURE_BARCODE)){var s=r.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(s),i=r.NO_POINTS}else{var a=new Detector$2(e.getBlackMatrix()).detect();n=this.decoder.decode(a.getBits()),i=a.getPoints()}var o=n.getRawBytes(),c=new Result(n.getText(),o,8*o.length,i,BarcodeFormat$1.DATA_MATRIX,System.currentTimeMillis()),h=n.getByteSegments();h!=null&&c.putMetadata(ResultMetadataType$1.BYTE_SEGMENTS,h);var f=n.getECLevel();return f!=null&&c.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,f),c},r.prototype.reset=function(){},r.extractPureBits=function(e){var t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t==null||n==null)throw new NotFoundException;var i=this.moduleSize(t,e),s=t[1],a=n[1],o=t[0],c=n[0],h=(c-o+1)/i,f=(a-s+1)/i;if(h<=0||f<=0)throw new NotFoundException;var m=i/2;s+=m,o+=m;for(var g=new BitMatrix(h,f),_=0;_<f;_++)for(var E=s+_*i,A=0;A<h;A++)e.get(o+A*i,E)&&g.set(A,_);return g},r.moduleSize=function(e,t){for(var n=t.getWidth(),i=e[0],s=e[1];i<n&&t.get(i,s);)i++;if(i===n)throw new NotFoundException;var a=i-e[0];if(a===0)throw new NotFoundException;return a},r.NO_POINTS=[],r}(),__extends$l=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){__extends$l(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new DataMatrixReader,t)||this}return e})(BrowserCodeReader);var ErrorCorrectionLevelValues;(function(r){r[r.L=0]="L",r[r.M=1]="M",r[r.Q=2]="Q",r[r.H=3]="H"})(ErrorCorrectionLevelValues||(ErrorCorrectionLevelValues={}));var ErrorCorrectionLevel=function(){function r(e,t,n){this.value=e,this.stringValue=t,this.bits=n,r.FOR_BITS.set(n,this),r.FOR_VALUE.set(e,this)}return r.prototype.getValue=function(){return this.value},r.prototype.getBits=function(){return this.bits},r.fromString=function(e){switch(e){case"L":return r.L;case"M":return r.M;case"Q":return r.Q;case"H":return r.H;default:throw new ArgumentException(e+"not available")}},r.prototype.toString=function(){return this.stringValue},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.forBits=function(e){if(e<0||e>=r.FOR_BITS.size)throw new IllegalArgumentException;return r.FOR_BITS.get(e)},r.FOR_BITS=new Map,r.FOR_VALUE=new Map,r.L=new r(ErrorCorrectionLevelValues.L,"L",1),r.M=new r(ErrorCorrectionLevelValues.M,"M",0),r.Q=new r(ErrorCorrectionLevelValues.Q,"Q",3),r.H=new r(ErrorCorrectionLevelValues.H,"H",2),r}(),__values$p=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},FormatInformation=function(){function r(e){this.errorCorrectionLevel=ErrorCorrectionLevel.forBits(e>>3&3),this.dataMask=e&7}return r.numBitsDiffering=function(e,t){return Integer.bitCount(e^t)},r.decodeFormatInformation=function(e,t){var n=r.doDecodeFormatInformation(e,t);return n!==null?n:r.doDecodeFormatInformation(e^r.FORMAT_INFO_MASK_QR,t^r.FORMAT_INFO_MASK_QR)},r.doDecodeFormatInformation=function(e,t){var n,i,s=Number.MAX_SAFE_INTEGER,a=0;try{for(var o=__values$p(r.FORMAT_INFO_DECODE_LOOKUP),c=o.next();!c.done;c=o.next()){var h=c.value,f=h[0];if(f===e||f===t)return new r(h[1]);var m=r.numBitsDiffering(e,f);m<s&&(a=h[1],s=m),e!==t&&(m=r.numBitsDiffering(t,f),m<s&&(a=h[1],s=m))}}catch(g){n={error:g}}finally{try{c&&!c.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}return s<=3?new r(a):null},r.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},r.prototype.getDataMask=function(){return this.dataMask},r.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask},r.FORMAT_INFO_MASK_QR=21522,r.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],r}(),__values$o=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ECBlocks=function(){function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.ecCodewordsPerBlock=e,this.ecBlocks=t}return r.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},r.prototype.getNumBlocks=function(){var e,t,n=0,i=this.ecBlocks;try{for(var s=__values$o(i),a=s.next();!a.done;a=s.next()){var o=a.value;n+=o.getCount()}}catch(c){e={error:c}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return n},r.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},r.prototype.getECBlocks=function(){return this.ecBlocks},r}(),ECB=function(){function r(e,t){this.count=e,this.dataCodewords=t}return r.prototype.getCount=function(){return this.count},r.prototype.getDataCodewords=function(){return this.dataCodewords},r}(),__values$n=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Version=function(){function r(e,t){for(var n,i,s=[],a=2;a<arguments.length;a++)s[a-2]=arguments[a];this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=s;var o=0,c=s[0].getECCodewordsPerBlock(),h=s[0].getECBlocks();try{for(var f=__values$n(h),m=f.next();!m.done;m=f.next()){var g=m.value;o+=g.getCount()*(g.getDataCodewords()+c)}}catch(_){n={error:_}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}this.totalCodewords=o}return r.prototype.getVersionNumber=function(){return this.versionNumber},r.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},r.prototype.getTotalCodewords=function(){return this.totalCodewords},r.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},r.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},r.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new FormatException;try{return this.getVersionForNumber((e-17)/4)}catch{throw new FormatException}},r.getVersionForNumber=function(e){if(e<1||e>40)throw new IllegalArgumentException;return r.VERSIONS[e-1]},r.decodeVersionInformation=function(e){for(var t=Number.MAX_SAFE_INTEGER,n=0,i=0;i<r.VERSION_DECODE_INFO.length;i++){var s=r.VERSION_DECODE_INFO[i];if(s===e)return r.getVersionForNumber(i+7);var a=FormatInformation.numBitsDiffering(e,s);a<t&&(n=i+7,t=a)}return t<=3?r.getVersionForNumber(n):null},r.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),t=new BitMatrix(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,i=0;i<n;i++)for(var s=this.alignmentPatternCenters[i]-2,a=0;a<n;a++)i===0&&(a===0||a===n-1)||i===n-1&&a===0||t.setRegion(this.alignmentPatternCenters[a]-2,s,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},r.prototype.toString=function(){return""+this.versionNumber},r.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),r.VERSIONS=[new r(1,new Int32Array(0),new ECBlocks(7,new ECB(1,19)),new ECBlocks(10,new ECB(1,16)),new ECBlocks(13,new ECB(1,13)),new ECBlocks(17,new ECB(1,9))),new r(2,Int32Array.from([6,18]),new ECBlocks(10,new ECB(1,34)),new ECBlocks(16,new ECB(1,28)),new ECBlocks(22,new ECB(1,22)),new ECBlocks(28,new ECB(1,16))),new r(3,Int32Array.from([6,22]),new ECBlocks(15,new ECB(1,55)),new ECBlocks(26,new ECB(1,44)),new ECBlocks(18,new ECB(2,17)),new ECBlocks(22,new ECB(2,13))),new r(4,Int32Array.from([6,26]),new ECBlocks(20,new ECB(1,80)),new ECBlocks(18,new ECB(2,32)),new ECBlocks(26,new ECB(2,24)),new ECBlocks(16,new ECB(4,9))),new r(5,Int32Array.from([6,30]),new ECBlocks(26,new ECB(1,108)),new ECBlocks(24,new ECB(2,43)),new ECBlocks(18,new ECB(2,15),new ECB(2,16)),new ECBlocks(22,new ECB(2,11),new ECB(2,12))),new r(6,Int32Array.from([6,34]),new ECBlocks(18,new ECB(2,68)),new ECBlocks(16,new ECB(4,27)),new ECBlocks(24,new ECB(4,19)),new ECBlocks(28,new ECB(4,15))),new r(7,Int32Array.from([6,22,38]),new ECBlocks(20,new ECB(2,78)),new ECBlocks(18,new ECB(4,31)),new ECBlocks(18,new ECB(2,14),new ECB(4,15)),new ECBlocks(26,new ECB(4,13),new ECB(1,14))),new r(8,Int32Array.from([6,24,42]),new ECBlocks(24,new ECB(2,97)),new ECBlocks(22,new ECB(2,38),new ECB(2,39)),new ECBlocks(22,new ECB(4,18),new ECB(2,19)),new ECBlocks(26,new ECB(4,14),new ECB(2,15))),new r(9,Int32Array.from([6,26,46]),new ECBlocks(30,new ECB(2,116)),new ECBlocks(22,new ECB(3,36),new ECB(2,37)),new ECBlocks(20,new ECB(4,16),new ECB(4,17)),new ECBlocks(24,new ECB(4,12),new ECB(4,13))),new r(10,Int32Array.from([6,28,50]),new ECBlocks(18,new ECB(2,68),new ECB(2,69)),new ECBlocks(26,new ECB(4,43),new ECB(1,44)),new ECBlocks(24,new ECB(6,19),new ECB(2,20)),new ECBlocks(28,new ECB(6,15),new ECB(2,16))),new r(11,Int32Array.from([6,30,54]),new ECBlocks(20,new ECB(4,81)),new ECBlocks(30,new ECB(1,50),new ECB(4,51)),new ECBlocks(28,new ECB(4,22),new ECB(4,23)),new ECBlocks(24,new ECB(3,12),new ECB(8,13))),new r(12,Int32Array.from([6,32,58]),new ECBlocks(24,new ECB(2,92),new ECB(2,93)),new ECBlocks(22,new ECB(6,36),new ECB(2,37)),new ECBlocks(26,new ECB(4,20),new ECB(6,21)),new ECBlocks(28,new ECB(7,14),new ECB(4,15))),new r(13,Int32Array.from([6,34,62]),new ECBlocks(26,new ECB(4,107)),new ECBlocks(22,new ECB(8,37),new ECB(1,38)),new ECBlocks(24,new ECB(8,20),new ECB(4,21)),new ECBlocks(22,new ECB(12,11),new ECB(4,12))),new r(14,Int32Array.from([6,26,46,66]),new ECBlocks(30,new ECB(3,115),new ECB(1,116)),new ECBlocks(24,new ECB(4,40),new ECB(5,41)),new ECBlocks(20,new ECB(11,16),new ECB(5,17)),new ECBlocks(24,new ECB(11,12),new ECB(5,13))),new r(15,Int32Array.from([6,26,48,70]),new ECBlocks(22,new ECB(5,87),new ECB(1,88)),new ECBlocks(24,new ECB(5,41),new ECB(5,42)),new ECBlocks(30,new ECB(5,24),new ECB(7,25)),new ECBlocks(24,new ECB(11,12),new ECB(7,13))),new r(16,Int32Array.from([6,26,50,74]),new ECBlocks(24,new ECB(5,98),new ECB(1,99)),new ECBlocks(28,new ECB(7,45),new ECB(3,46)),new ECBlocks(24,new ECB(15,19),new ECB(2,20)),new ECBlocks(30,new ECB(3,15),new ECB(13,16))),new r(17,Int32Array.from([6,30,54,78]),new ECBlocks(28,new ECB(1,107),new ECB(5,108)),new ECBlocks(28,new ECB(10,46),new ECB(1,47)),new ECBlocks(28,new ECB(1,22),new ECB(15,23)),new ECBlocks(28,new ECB(2,14),new ECB(17,15))),new r(18,Int32Array.from([6,30,56,82]),new ECBlocks(30,new ECB(5,120),new ECB(1,121)),new ECBlocks(26,new ECB(9,43),new ECB(4,44)),new ECBlocks(28,new ECB(17,22),new ECB(1,23)),new ECBlocks(28,new ECB(2,14),new ECB(19,15))),new r(19,Int32Array.from([6,30,58,86]),new ECBlocks(28,new ECB(3,113),new ECB(4,114)),new ECBlocks(26,new ECB(3,44),new ECB(11,45)),new ECBlocks(26,new ECB(17,21),new ECB(4,22)),new ECBlocks(26,new ECB(9,13),new ECB(16,14))),new r(20,Int32Array.from([6,34,62,90]),new ECBlocks(28,new ECB(3,107),new ECB(5,108)),new ECBlocks(26,new ECB(3,41),new ECB(13,42)),new ECBlocks(30,new ECB(15,24),new ECB(5,25)),new ECBlocks(28,new ECB(15,15),new ECB(10,16))),new r(21,Int32Array.from([6,28,50,72,94]),new ECBlocks(28,new ECB(4,116),new ECB(4,117)),new ECBlocks(26,new ECB(17,42)),new ECBlocks(28,new ECB(17,22),new ECB(6,23)),new ECBlocks(30,new ECB(19,16),new ECB(6,17))),new r(22,Int32Array.from([6,26,50,74,98]),new ECBlocks(28,new ECB(2,111),new ECB(7,112)),new ECBlocks(28,new ECB(17,46)),new ECBlocks(30,new ECB(7,24),new ECB(16,25)),new ECBlocks(24,new ECB(34,13))),new r(23,Int32Array.from([6,30,54,78,102]),new ECBlocks(30,new ECB(4,121),new ECB(5,122)),new ECBlocks(28,new ECB(4,47),new ECB(14,48)),new ECBlocks(30,new ECB(11,24),new ECB(14,25)),new ECBlocks(30,new ECB(16,15),new ECB(14,16))),new r(24,Int32Array.from([6,28,54,80,106]),new ECBlocks(30,new ECB(6,117),new ECB(4,118)),new ECBlocks(28,new ECB(6,45),new ECB(14,46)),new ECBlocks(30,new ECB(11,24),new ECB(16,25)),new ECBlocks(30,new ECB(30,16),new ECB(2,17))),new r(25,Int32Array.from([6,32,58,84,110]),new ECBlocks(26,new ECB(8,106),new ECB(4,107)),new ECBlocks(28,new ECB(8,47),new ECB(13,48)),new ECBlocks(30,new ECB(7,24),new ECB(22,25)),new ECBlocks(30,new ECB(22,15),new ECB(13,16))),new r(26,Int32Array.from([6,30,58,86,114]),new ECBlocks(28,new ECB(10,114),new ECB(2,115)),new ECBlocks(28,new ECB(19,46),new ECB(4,47)),new ECBlocks(28,new ECB(28,22),new ECB(6,23)),new ECBlocks(30,new ECB(33,16),new ECB(4,17))),new r(27,Int32Array.from([6,34,62,90,118]),new ECBlocks(30,new ECB(8,122),new ECB(4,123)),new ECBlocks(28,new ECB(22,45),new ECB(3,46)),new ECBlocks(30,new ECB(8,23),new ECB(26,24)),new ECBlocks(30,new ECB(12,15),new ECB(28,16))),new r(28,Int32Array.from([6,26,50,74,98,122]),new ECBlocks(30,new ECB(3,117),new ECB(10,118)),new ECBlocks(28,new ECB(3,45),new ECB(23,46)),new ECBlocks(30,new ECB(4,24),new ECB(31,25)),new ECBlocks(30,new ECB(11,15),new ECB(31,16))),new r(29,Int32Array.from([6,30,54,78,102,126]),new ECBlocks(30,new ECB(7,116),new ECB(7,117)),new ECBlocks(28,new ECB(21,45),new ECB(7,46)),new ECBlocks(30,new ECB(1,23),new ECB(37,24)),new ECBlocks(30,new ECB(19,15),new ECB(26,16))),new r(30,Int32Array.from([6,26,52,78,104,130]),new ECBlocks(30,new ECB(5,115),new ECB(10,116)),new ECBlocks(28,new ECB(19,47),new ECB(10,48)),new ECBlocks(30,new ECB(15,24),new ECB(25,25)),new ECBlocks(30,new ECB(23,15),new ECB(25,16))),new r(31,Int32Array.from([6,30,56,82,108,134]),new ECBlocks(30,new ECB(13,115),new ECB(3,116)),new ECBlocks(28,new ECB(2,46),new ECB(29,47)),new ECBlocks(30,new ECB(42,24),new ECB(1,25)),new ECBlocks(30,new ECB(23,15),new ECB(28,16))),new r(32,Int32Array.from([6,34,60,86,112,138]),new ECBlocks(30,new ECB(17,115)),new ECBlocks(28,new ECB(10,46),new ECB(23,47)),new ECBlocks(30,new ECB(10,24),new ECB(35,25)),new ECBlocks(30,new ECB(19,15),new ECB(35,16))),new r(33,Int32Array.from([6,30,58,86,114,142]),new ECBlocks(30,new ECB(17,115),new ECB(1,116)),new ECBlocks(28,new ECB(14,46),new ECB(21,47)),new ECBlocks(30,new ECB(29,24),new ECB(19,25)),new ECBlocks(30,new ECB(11,15),new ECB(46,16))),new r(34,Int32Array.from([6,34,62,90,118,146]),new ECBlocks(30,new ECB(13,115),new ECB(6,116)),new ECBlocks(28,new ECB(14,46),new ECB(23,47)),new ECBlocks(30,new ECB(44,24),new ECB(7,25)),new ECBlocks(30,new ECB(59,16),new ECB(1,17))),new r(35,Int32Array.from([6,30,54,78,102,126,150]),new ECBlocks(30,new ECB(12,121),new ECB(7,122)),new ECBlocks(28,new ECB(12,47),new ECB(26,48)),new ECBlocks(30,new ECB(39,24),new ECB(14,25)),new ECBlocks(30,new ECB(22,15),new ECB(41,16))),new r(36,Int32Array.from([6,24,50,76,102,128,154]),new ECBlocks(30,new ECB(6,121),new ECB(14,122)),new ECBlocks(28,new ECB(6,47),new ECB(34,48)),new ECBlocks(30,new ECB(46,24),new ECB(10,25)),new ECBlocks(30,new ECB(2,15),new ECB(64,16))),new r(37,Int32Array.from([6,28,54,80,106,132,158]),new ECBlocks(30,new ECB(17,122),new ECB(4,123)),new ECBlocks(28,new ECB(29,46),new ECB(14,47)),new ECBlocks(30,new ECB(49,24),new ECB(10,25)),new ECBlocks(30,new ECB(24,15),new ECB(46,16))),new r(38,Int32Array.from([6,32,58,84,110,136,162]),new ECBlocks(30,new ECB(4,122),new ECB(18,123)),new ECBlocks(28,new ECB(13,46),new ECB(32,47)),new ECBlocks(30,new ECB(48,24),new ECB(14,25)),new ECBlocks(30,new ECB(42,15),new ECB(32,16))),new r(39,Int32Array.from([6,26,54,82,110,138,166]),new ECBlocks(30,new ECB(20,117),new ECB(4,118)),new ECBlocks(28,new ECB(40,47),new ECB(7,48)),new ECBlocks(30,new ECB(43,24),new ECB(22,25)),new ECBlocks(30,new ECB(10,15),new ECB(67,16))),new r(40,Int32Array.from([6,30,58,86,114,142,170]),new ECBlocks(30,new ECB(19,118),new ECB(6,119)),new ECBlocks(28,new ECB(18,47),new ECB(31,48)),new ECBlocks(30,new ECB(34,24),new ECB(34,25)),new ECBlocks(30,new ECB(20,15),new ECB(61,16)))],r}(),DataMaskValues;(function(r){r[r.DATA_MASK_000=0]="DATA_MASK_000",r[r.DATA_MASK_001=1]="DATA_MASK_001",r[r.DATA_MASK_010=2]="DATA_MASK_010",r[r.DATA_MASK_011=3]="DATA_MASK_011",r[r.DATA_MASK_100=4]="DATA_MASK_100",r[r.DATA_MASK_101=5]="DATA_MASK_101",r[r.DATA_MASK_110=6]="DATA_MASK_110",r[r.DATA_MASK_111=7]="DATA_MASK_111"})(DataMaskValues||(DataMaskValues={}));var DataMask=function(){function r(e,t){this.value=e,this.isMasked=t}return r.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var i=0;i<t;i++)this.isMasked(n,i)&&e.flip(i,n)},r.values=new Map([[DataMaskValues.DATA_MASK_000,new r(DataMaskValues.DATA_MASK_000,function(e,t){return(e+t&1)===0})],[DataMaskValues.DATA_MASK_001,new r(DataMaskValues.DATA_MASK_001,function(e,t){return(e&1)===0})],[DataMaskValues.DATA_MASK_010,new r(DataMaskValues.DATA_MASK_010,function(e,t){return t%3===0})],[DataMaskValues.DATA_MASK_011,new r(DataMaskValues.DATA_MASK_011,function(e,t){return(e+t)%3===0})],[DataMaskValues.DATA_MASK_100,new r(DataMaskValues.DATA_MASK_100,function(e,t){return(Math.floor(e/2)+Math.floor(t/3)&1)===0})],[DataMaskValues.DATA_MASK_101,new r(DataMaskValues.DATA_MASK_101,function(e,t){return e*t%6===0})],[DataMaskValues.DATA_MASK_110,new r(DataMaskValues.DATA_MASK_110,function(e,t){return e*t%6<3})],[DataMaskValues.DATA_MASK_111,new r(DataMaskValues.DATA_MASK_111,function(e,t){return(e+t+e*t%3&1)===0})]]),r}(),BitMatrixParser=function(){function r(e){var t=e.getHeight();if(t<21||(t&3)!==1)throw new FormatException;this.bitMatrix=e}return r.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var e=0,t=0;t<6;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);for(var i=this.bitMatrix.getHeight(),s=0,a=i-7,n=i-1;n>=a;n--)s=this.copyBit(8,n,s);for(var t=i-8;t<i;t++)s=this.copyBit(t,8,s);if(this.parsedFormatInfo=FormatInformation.decodeFormatInformation(e,s),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new FormatException},r.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return Version.getVersionForNumber(t);for(var n=0,i=e-11,s=5;s>=0;s--)for(var a=e-9;a>=i;a--)n=this.copyBit(a,s,n);var o=Version.decodeVersionInformation(n);if(o!==null&&o.getDimensionForVersion()===e)return this.parsedVersion=o,o;n=0;for(var a=5;a>=0;a--)for(var s=e-9;s>=i;s--)n=this.copyBit(a,s,n);if(o=Version.decodeVersionInformation(n),o!==null&&o.getDimensionForVersion()===e)return this.parsedVersion=o,o;throw new FormatException},r.prototype.copyBit=function(e,t,n){var i=this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t);return i?n<<1|1:n<<1},r.prototype.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=DataMask.values.get(e.getDataMask()),i=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,i);for(var s=t.buildFunctionPattern(),a=!0,o=new Uint8Array(t.getTotalCodewords()),c=0,h=0,f=0,m=i-1;m>0;m-=2){m===6&&m--;for(var g=0;g<i;g++)for(var _=a?i-1-g:g,E=0;E<2;E++)s.get(m-E,_)||(f++,h<<=1,this.bitMatrix.get(m-E,_)&&(h|=1),f===8&&(o[c++]=h,f=0,h=0));a=!a}if(c!==t.getTotalCodewords())throw new FormatException;return o},r.prototype.remask=function(){if(this.parsedFormatInfo!==null){var e=DataMask.values.get(this.parsedFormatInfo.getDataMask()),t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}},r.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},r.prototype.mirror=function(){for(var e=this.bitMatrix,t=0,n=e.getWidth();t<n;t++)for(var i=t+1,s=e.getHeight();i<s;i++)e.get(t,i)!==e.get(i,t)&&(e.flip(i,t),e.flip(t,i))},r}(),__values$m=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},DataBlock=function(){function r(e,t){this.numDataCodewords=e,this.codewords=t}return r.getDataBlocks=function(e,t,n){var i,s,a,o;if(e.length!==t.getTotalCodewords())throw new IllegalArgumentException;var c=t.getECBlocksForLevel(n),h=0,f=c.getECBlocks();try{for(var m=__values$m(f),g=m.next();!g.done;g=m.next()){var _=g.value;h+=_.getCount()}}catch(Z){i={error:Z}}finally{try{g&&!g.done&&(s=m.return)&&s.call(m)}finally{if(i)throw i.error}}var E=new Array(h),A=0;try{for(var C=__values$m(f),I=C.next();!I.done;I=C.next())for(var _=I.value,b=0;b<_.getCount();b++){var R=_.getDataCodewords(),V=c.getECCodewordsPerBlock()+R;E[A++]=new r(R,new Uint8Array(V))}}catch(Z){a={error:Z}}finally{try{I&&!I.done&&(o=C.return)&&o.call(C)}finally{if(a)throw a.error}}for(var U=E[0].codewords.length,W=E.length-1;W>=0;){var j=E[W].codewords.length;if(j===U)break;W--}W++;for(var w=U-c.getECCodewordsPerBlock(),P=0,b=0;b<w;b++)for(var K=0;K<A;K++)E[K].codewords[b]=e[P++];for(var K=W;K<A;K++)E[K].codewords[w]=e[P++];for(var X=E[0].codewords.length,b=w;b<X;b++)for(var K=0;K<A;K++){var Y=K<W?b:b+1;E[K].codewords[Y]=e[P++]}return E},r.prototype.getNumDataCodewords=function(){return this.numDataCodewords},r.prototype.getCodewords=function(){return this.codewords},r}(),ModeValues;(function(r){r[r.TERMINATOR=0]="TERMINATOR",r[r.NUMERIC=1]="NUMERIC",r[r.ALPHANUMERIC=2]="ALPHANUMERIC",r[r.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",r[r.BYTE=4]="BYTE",r[r.ECI=5]="ECI",r[r.KANJI=6]="KANJI",r[r.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",r[r.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",r[r.HANZI=9]="HANZI"})(ModeValues||(ModeValues={}));var Mode$2=function(){function r(e,t,n,i){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=n,this.bits=i,r.FOR_BITS.set(i,this),r.FOR_VALUE.set(e,this)}return r.forBits=function(e){var t=r.FOR_BITS.get(e);if(t===void 0)throw new IllegalArgumentException;return t},r.prototype.getCharacterCountBits=function(e){var t=e.getVersionNumber(),n;return t<=9?n=0:t<=26?n=1:n=2,this.characterCountBitsForVersions[n]},r.prototype.getValue=function(){return this.value},r.prototype.getBits=function(){return this.bits},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.prototype.toString=function(){return this.stringValue},r.FOR_BITS=new Map,r.FOR_VALUE=new Map,r.TERMINATOR=new r(ModeValues.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),r.NUMERIC=new r(ModeValues.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),r.ALPHANUMERIC=new r(ModeValues.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),r.STRUCTURED_APPEND=new r(ModeValues.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),r.BYTE=new r(ModeValues.BYTE,"BYTE",Int32Array.from([8,16,16]),4),r.ECI=new r(ModeValues.ECI,"ECI",Int32Array.from([0,0,0]),7),r.KANJI=new r(ModeValues.KANJI,"KANJI",Int32Array.from([8,10,12]),8),r.FNC1_FIRST_POSITION=new r(ModeValues.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),r.FNC1_SECOND_POSITION=new r(ModeValues.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),r.HANZI=new r(ModeValues.HANZI,"HANZI",Int32Array.from([8,10,12]),13),r}(),DecodedBitStreamParser$1=function(){function r(){}return r.decode=function(e,t,n,i){var s=new BitSource(e),a=new StringBuilder,o=new Array,c=-1,h=-1;try{var f=null,m=!1,g=void 0;do{if(s.available()<4)g=Mode$2.TERMINATOR;else{var _=s.readBits(4);g=Mode$2.forBits(_)}switch(g){case Mode$2.TERMINATOR:break;case Mode$2.FNC1_FIRST_POSITION:case Mode$2.FNC1_SECOND_POSITION:m=!0;break;case Mode$2.STRUCTURED_APPEND:if(s.available()<16)throw new FormatException;c=s.readBits(8),h=s.readBits(8);break;case Mode$2.ECI:var E=r.parseECIValue(s);if(f=CharacterSetECI.getCharacterSetECIByValue(E),f===null)throw new FormatException;break;case Mode$2.HANZI:var A=s.readBits(4),C=s.readBits(g.getCharacterCountBits(t));A===r.GB2312_SUBSET&&r.decodeHanziSegment(s,a,C);break;default:var I=s.readBits(g.getCharacterCountBits(t));switch(g){case Mode$2.NUMERIC:r.decodeNumericSegment(s,a,I);break;case Mode$2.ALPHANUMERIC:r.decodeAlphanumericSegment(s,a,I,m);break;case Mode$2.BYTE:r.decodeByteSegment(s,a,I,f,o,i);break;case Mode$2.KANJI:r.decodeKanjiSegment(s,a,I);break;default:throw new FormatException}break}}while(g!==Mode$2.TERMINATOR)}catch{throw new FormatException}return new DecoderResult(e,a.toString(),o.length===0?null:o,n===null?null:n.toString(),c,h)},r.decodeHanziSegment=function(e,t,n){if(n*13>e.available())throw new FormatException;for(var i=new Uint8Array(2*n),s=0;n>0;){var a=e.readBits(13),o=a/96<<8&4294967295|a%96;o<959?o+=41377:o+=42657,i[s]=o>>8&255,i[s+1]=o&255,s+=2,n--}try{t.append(StringEncoding.decode(i,StringUtils.GB2312))}catch(c){throw new FormatException(c)}},r.decodeKanjiSegment=function(e,t,n){if(n*13>e.available())throw new FormatException;for(var i=new Uint8Array(2*n),s=0;n>0;){var a=e.readBits(13),o=a/192<<8&4294967295|a%192;o<7936?o+=33088:o+=49472,i[s]=o>>8,i[s+1]=o,s+=2,n--}try{t.append(StringEncoding.decode(i,StringUtils.SHIFT_JIS))}catch(c){throw new FormatException(c)}},r.decodeByteSegment=function(e,t,n,i,s,a){if(8*n>e.available())throw new FormatException;for(var o=new Uint8Array(n),c=0;c<n;c++)o[c]=e.readBits(8);var h;i===null?h=StringUtils.guessEncoding(o,a):h=i.getName();try{t.append(StringEncoding.decode(o,h))}catch(f){throw new FormatException(f)}s.push(o)},r.toAlphaNumericChar=function(e){if(e>=r.ALPHANUMERIC_CHARS.length)throw new FormatException;return r.ALPHANUMERIC_CHARS[e]},r.decodeAlphanumericSegment=function(e,t,n,i){for(var s=t.length();n>1;){if(e.available()<11)throw new FormatException;var a=e.readBits(11);t.append(r.toAlphaNumericChar(Math.floor(a/45))),t.append(r.toAlphaNumericChar(a%45)),n-=2}if(n===1){if(e.available()<6)throw new FormatException;t.append(r.toAlphaNumericChar(e.readBits(6)))}if(i)for(var o=s;o<t.length();o++)t.charAt(o)==="%"&&(o<t.length()-1&&t.charAt(o+1)==="%"?t.deleteCharAt(o+1):t.setCharAt(o,""))},r.decodeNumericSegment=function(e,t,n){for(;n>=3;){if(e.available()<10)throw new FormatException;var i=e.readBits(10);if(i>=1e3)throw new FormatException;t.append(r.toAlphaNumericChar(Math.floor(i/100))),t.append(r.toAlphaNumericChar(Math.floor(i/10)%10)),t.append(r.toAlphaNumericChar(i%10)),n-=3}if(n===2){if(e.available()<7)throw new FormatException;var s=e.readBits(7);if(s>=100)throw new FormatException;t.append(r.toAlphaNumericChar(Math.floor(s/10))),t.append(r.toAlphaNumericChar(s%10))}else if(n===1){if(e.available()<4)throw new FormatException;var a=e.readBits(4);if(a>=10)throw new FormatException;t.append(r.toAlphaNumericChar(a))}},r.parseECIValue=function(e){var t=e.readBits(8);if((t&128)===0)return t&127;if((t&192)===128){var n=e.readBits(8);return(t&63)<<8&4294967295|n}if((t&224)===192){var i=e.readBits(16);return(t&31)<<16&4294967295|i}throw new FormatException},r.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",r.GB2312_SUBSET=1,r}(),QRCodeDecoderMetaData=function(){function r(e){this.mirrored=e}return r.prototype.isMirrored=function(){return this.mirrored},r.prototype.applyMirroredCorrection=function(e){if(!(!this.mirrored||e===null||e.length<3)){var t=e[0];e[0]=e[2],e[2]=t}},r}(),__values$l=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Decoder=function(){function r(){this.rsDecoder=new ReedSolomonDecoder(GenericGF.QR_CODE_FIELD_256)}return r.prototype.decodeBooleanArray=function(e,t){return this.decodeBitMatrix(BitMatrix.parseFromBooleanArray(e),t)},r.prototype.decodeBitMatrix=function(e,t){var n=new BitMatrixParser(e),i=null;try{return this.decodeBitMatrixParser(n,t)}catch(a){i=a}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();var s=this.decodeBitMatrixParser(n,t);return s.setOther(new QRCodeDecoderMetaData(!0)),s}catch(a){throw i!==null?i:a}},r.prototype.decodeBitMatrixParser=function(e,t){var n,i,s,a,o=e.readVersion(),c=e.readFormatInformation().getErrorCorrectionLevel(),h=e.readCodewords(),f=DataBlock.getDataBlocks(h,o,c),m=0;try{for(var g=__values$l(f),_=g.next();!_.done;_=g.next()){var E=_.value;m+=E.getNumDataCodewords()}}catch(W){n={error:W}}finally{try{_&&!_.done&&(i=g.return)&&i.call(g)}finally{if(n)throw n.error}}var A=new Uint8Array(m),C=0;try{for(var I=__values$l(f),b=I.next();!b.done;b=I.next()){var E=b.value,R=E.getCodewords(),V=E.getNumDataCodewords();this.correctErrors(R,V);for(var U=0;U<V;U++)A[C++]=R[U]}}catch(W){s={error:W}}finally{try{b&&!b.done&&(a=I.return)&&a.call(I)}finally{if(s)throw s.error}}return DecodedBitStreamParser$1.decode(A,o,c,t)},r.prototype.correctErrors=function(e,t){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new ChecksumException}for(var i=0;i<t;i++)e[i]=n[i]},r}(),__extends$k=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),AlignmentPattern=function(r){__extends$k(e,r);function e(t,n,i){var s=r.call(this,t,n)||this;return s.estimatedModuleSize=i,s}return e.prototype.aboutEquals=function(t,n,i){if(Math.abs(n-this.getY())<=t&&Math.abs(i-this.getX())<=t){var s=Math.abs(t-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(t,n,i){var s=(this.getX()+n)/2,a=(this.getY()+t)/2,o=(this.estimatedModuleSize+i)/2;return new e(s,a,o)},e}(ResultPoint),__values$k=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},AlignmentPatternFinder=function(){function r(e,t,n,i,s,a,o){this.image=e,this.startX=t,this.startY=n,this.width=i,this.height=s,this.moduleSize=a,this.resultPointCallback=o,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return r.prototype.find=function(){for(var e=this.startX,t=this.height,n=this.width,i=e+n,s=this.startY+t/2,a=new Int32Array(3),o=this.image,c=0;c<t;c++){var h=s+((c&1)===0?Math.floor((c+1)/2):-Math.floor((c+1)/2));a[0]=0,a[1]=0,a[2]=0;for(var f=e;f<i&&!o.get(f,h);)f++;for(var m=0;f<i;){if(o.get(f,h))if(m===1)a[1]++;else if(m===2){if(this.foundPatternCross(a)){var g=this.handlePossibleCenter(a,h,f);if(g!==null)return g}a[0]=a[2],a[1]=1,a[2]=0,m=1}else a[++m]++;else m===1&&m++,a[m]++;f++}if(this.foundPatternCross(a)){var g=this.handlePossibleCenter(a,h,i);if(g!==null)return g}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new NotFoundException},r.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},r.prototype.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,i=0;i<3;i++)if(Math.abs(t-e[i])>=n)return!1;return!0},r.prototype.crossCheckVertical=function(e,t,n,i){var s=this.image,a=s.getHeight(),o=this.crossCheckStateCount;o[0]=0,o[1]=0,o[2]=0;for(var c=e;c>=0&&s.get(t,c)&&o[1]<=n;)o[1]++,c--;if(c<0||o[1]>n)return NaN;for(;c>=0&&!s.get(t,c)&&o[0]<=n;)o[0]++,c--;if(o[0]>n)return NaN;for(c=e+1;c<a&&s.get(t,c)&&o[1]<=n;)o[1]++,c++;if(c===a||o[1]>n)return NaN;for(;c<a&&!s.get(t,c)&&o[2]<=n;)o[2]++,c++;if(o[2]>n)return NaN;var h=o[0]+o[1]+o[2];return 5*Math.abs(h-i)>=2*i?NaN:this.foundPatternCross(o)?r.centerFromEnd(o,c):NaN},r.prototype.handlePossibleCenter=function(e,t,n){var i,s,a=e[0]+e[1]+e[2],o=r.centerFromEnd(e,n),c=this.crossCheckVertical(t,o,2*e[1],a);if(!isNaN(c)){var h=(e[0]+e[1]+e[2])/3;try{for(var f=__values$k(this.possibleCenters),m=f.next();!m.done;m=f.next()){var g=m.value;if(g.aboutEquals(h,c,o))return g.combineEstimate(c,o,h)}}catch(E){i={error:E}}finally{try{m&&!m.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}var _=new AlignmentPattern(o,c,h);this.possibleCenters.push(_),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(_)}return null},r}(),__extends$j=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),FinderPattern=function(r){__extends$j(e,r);function e(t,n,i,s){var a=r.call(this,t,n)||this;return a.estimatedModuleSize=i,a.count=s,s===void 0&&(a.count=1),a}return e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(t,n,i){if(Math.abs(n-this.getY())<=t&&Math.abs(i-this.getX())<=t){var s=Math.abs(t-this.estimatedModuleSize);return s<=1||s<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(t,n,i){var s=this.count+1,a=(this.count*this.getX()+n)/s,o=(this.count*this.getY()+t)/s,c=(this.count*this.estimatedModuleSize+i)/s;return new e(a,o,c,s)},e}(ResultPoint),FinderPatternInfo=function(){function r(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return r.prototype.getBottomLeft=function(){return this.bottomLeft},r.prototype.getTopLeft=function(){return this.topLeft},r.prototype.getTopRight=function(){return this.topRight},r}(),__values$j=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},FinderPatternFinder=function(){function r(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}return r.prototype.getImage=function(){return this.image},r.prototype.getPossibleCenters=function(){return this.possibleCenters},r.prototype.find=function(e){var t=e!=null&&e.get(DecodeHintType$1.TRY_HARDER)!==void 0,n=e!=null&&e.get(DecodeHintType$1.PURE_BARCODE)!==void 0,i=this.image,s=i.getHeight(),a=i.getWidth(),o=Math.floor(3*s/(4*r.MAX_MODULES));(o<r.MIN_SKIP||t)&&(o=r.MIN_SKIP);for(var c=!1,h=new Int32Array(5),f=o-1;f<s&&!c;f+=o){h[0]=0,h[1]=0,h[2]=0,h[3]=0,h[4]=0;for(var m=0,g=0;g<a;g++)if(i.get(g,f))(m&1)===1&&m++,h[m]++;else if((m&1)===0)if(m===4)if(r.foundPatternCross(h)){var _=this.handlePossibleCenter(h,f,g,n);if(_===!0)if(o=2,this.hasSkipped===!0)c=this.haveMultiplyConfirmedCenters();else{var E=this.findRowSkip();E>h[2]&&(f+=E-h[2]-o,g=a-1)}else{h[0]=h[2],h[1]=h[3],h[2]=h[4],h[3]=1,h[4]=0,m=3;continue}m=0,h[0]=0,h[1]=0,h[2]=0,h[3]=0,h[4]=0}else h[0]=h[2],h[1]=h[3],h[2]=h[4],h[3]=1,h[4]=0,m=3;else h[++m]++;else h[m]++;if(r.foundPatternCross(h)){var _=this.handlePossibleCenter(h,f,a,n);_===!0&&(o=h[0],this.hasSkipped&&(c=this.haveMultiplyConfirmedCenters()))}}var A=this.selectBestPatterns();return ResultPoint.orderBestPatterns(A),new FinderPatternInfo(A)},r.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},r.foundPatternCross=function(e){for(var t=0,n=0;n<5;n++){var i=e[n];if(i===0)return!1;t+=i}if(t<7)return!1;var s=t/7,a=s/2;return Math.abs(s-e[0])<a&&Math.abs(s-e[1])<a&&Math.abs(3*s-e[2])<3*a&&Math.abs(s-e[3])<a&&Math.abs(s-e[4])<a},r.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},r.prototype.crossCheckDiagonal=function(e,t,n,i){for(var s=this.getCrossCheckStateCount(),a=0,o=this.image;e>=a&&t>=a&&o.get(t-a,e-a);)s[2]++,a++;if(e<a||t<a)return!1;for(;e>=a&&t>=a&&!o.get(t-a,e-a)&&s[1]<=n;)s[1]++,a++;if(e<a||t<a||s[1]>n)return!1;for(;e>=a&&t>=a&&o.get(t-a,e-a)&&s[0]<=n;)s[0]++,a++;if(s[0]>n)return!1;var c=o.getHeight(),h=o.getWidth();for(a=1;e+a<c&&t+a<h&&o.get(t+a,e+a);)s[2]++,a++;if(e+a>=c||t+a>=h)return!1;for(;e+a<c&&t+a<h&&!o.get(t+a,e+a)&&s[3]<n;)s[3]++,a++;if(e+a>=c||t+a>=h||s[3]>=n)return!1;for(;e+a<c&&t+a<h&&o.get(t+a,e+a)&&s[4]<n;)s[4]++,a++;if(s[4]>=n)return!1;var f=s[0]+s[1]+s[2]+s[3]+s[4];return Math.abs(f-i)<2*i&&r.foundPatternCross(s)},r.prototype.crossCheckVertical=function(e,t,n,i){for(var s=this.image,a=s.getHeight(),o=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(t,c);)o[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(t,c)&&o[1]<=n;)o[1]++,c--;if(c<0||o[1]>n)return NaN;for(;c>=0&&s.get(t,c)&&o[0]<=n;)o[0]++,c--;if(o[0]>n)return NaN;for(c=e+1;c<a&&s.get(t,c);)o[2]++,c++;if(c===a)return NaN;for(;c<a&&!s.get(t,c)&&o[3]<n;)o[3]++,c++;if(c===a||o[3]>=n)return NaN;for(;c<a&&s.get(t,c)&&o[4]<n;)o[4]++,c++;if(o[4]>=n)return NaN;var h=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(h-i)>=2*i?NaN:r.foundPatternCross(o)?r.centerFromEnd(o,c):NaN},r.prototype.crossCheckHorizontal=function(e,t,n,i){for(var s=this.image,a=s.getWidth(),o=this.getCrossCheckStateCount(),c=e;c>=0&&s.get(c,t);)o[2]++,c--;if(c<0)return NaN;for(;c>=0&&!s.get(c,t)&&o[1]<=n;)o[1]++,c--;if(c<0||o[1]>n)return NaN;for(;c>=0&&s.get(c,t)&&o[0]<=n;)o[0]++,c--;if(o[0]>n)return NaN;for(c=e+1;c<a&&s.get(c,t);)o[2]++,c++;if(c===a)return NaN;for(;c<a&&!s.get(c,t)&&o[3]<n;)o[3]++,c++;if(c===a||o[3]>=n)return NaN;for(;c<a&&s.get(c,t)&&o[4]<n;)o[4]++,c++;if(o[4]>=n)return NaN;var h=o[0]+o[1]+o[2]+o[3]+o[4];return 5*Math.abs(h-i)>=i?NaN:r.foundPatternCross(o)?r.centerFromEnd(o,c):NaN},r.prototype.handlePossibleCenter=function(e,t,n,i){var s=e[0]+e[1]+e[2]+e[3]+e[4],a=r.centerFromEnd(e,n),o=this.crossCheckVertical(t,Math.floor(a),e[2],s);if(!isNaN(o)&&(a=this.crossCheckHorizontal(Math.floor(a),Math.floor(o),e[2],s),!isNaN(a)&&(!i||this.crossCheckDiagonal(Math.floor(o),Math.floor(a),e[2],s)))){for(var c=s/7,h=!1,f=this.possibleCenters,m=0,g=f.length;m<g;m++){var _=f[m];if(_.aboutEquals(c,o,a)){f[m]=_.combineEstimate(o,a,c),h=!0;break}}if(!h){var E=new FinderPattern(a,o,c);f.push(E),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(E)}return!0}return!1},r.prototype.findRowSkip=function(){var e,t,n=this.possibleCenters.length;if(n<=1)return 0;var i=null;try{for(var s=__values$j(this.possibleCenters),a=s.next();!a.done;a=s.next()){var o=a.value;if(o.getCount()>=r.CENTER_QUORUM)if(i==null)i=o;else return this.hasSkipped=!0,Math.floor((Math.abs(i.getX()-o.getX())-Math.abs(i.getY()-o.getY()))/2)}}catch(c){e={error:c}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return 0},r.prototype.haveMultiplyConfirmedCenters=function(){var e,t,n,i,s=0,a=0,o=this.possibleCenters.length;try{for(var c=__values$j(this.possibleCenters),h=c.next();!h.done;h=c.next()){var f=h.value;f.getCount()>=r.CENTER_QUORUM&&(s++,a+=f.getEstimatedModuleSize())}}catch(A){e={error:A}}finally{try{h&&!h.done&&(t=c.return)&&t.call(c)}finally{if(e)throw e.error}}if(s<3)return!1;var m=a/o,g=0;try{for(var _=__values$j(this.possibleCenters),E=_.next();!E.done;E=_.next()){var f=E.value;g+=Math.abs(f.getEstimatedModuleSize()-m)}}catch(A){n={error:A}}finally{try{E&&!E.done&&(i=_.return)&&i.call(_)}finally{if(n)throw n.error}}return g<=.05*a},r.prototype.selectBestPatterns=function(){var e,t,n,i,s=this.possibleCenters.length;if(s<3)throw new NotFoundException;var a=this.possibleCenters,o;if(s>3){var c=0,h=0;try{for(var f=__values$j(this.possibleCenters),m=f.next();!m.done;m=f.next()){var g=m.value,_=g.getEstimatedModuleSize();c+=_,h+=_*_}}catch(U){e={error:U}}finally{try{m&&!m.done&&(t=f.return)&&t.call(f)}finally{if(e)throw e.error}}o=c/s;var E=Math.sqrt(h/s-o*o);a.sort(function(U,W){var j=Math.abs(W.getEstimatedModuleSize()-o),w=Math.abs(U.getEstimatedModuleSize()-o);return j<w?-1:j>w?1:0});for(var A=Math.max(.2*o,E),C=0;C<a.length&&a.length>3;C++){var I=a[C];Math.abs(I.getEstimatedModuleSize()-o)>A&&(a.splice(C,1),C--)}}if(a.length>3){var c=0;try{for(var b=__values$j(a),R=b.next();!R.done;R=b.next()){var V=R.value;c+=V.getEstimatedModuleSize()}}catch(W){n={error:W}}finally{try{R&&!R.done&&(i=b.return)&&i.call(b)}finally{if(n)throw n.error}}o=c/a.length,a.sort(function(W,j){if(j.getCount()===W.getCount()){var w=Math.abs(j.getEstimatedModuleSize()-o),P=Math.abs(W.getEstimatedModuleSize()-o);return w<P?1:w>P?-1:0}else return j.getCount()-W.getCount()}),a.splice(3)}return[a[0],a[1],a[2]]},r.CENTER_QUORUM=2,r.MIN_SKIP=3,r.MAX_MODULES=57,r}(),Detector$1=function(){function r(e){this.image=e}return r.prototype.getImage=function(){return this.image},r.prototype.getResultPointCallback=function(){return this.resultPointCallback},r.prototype.detect=function(e){this.resultPointCallback=e==null?null:e.get(DecodeHintType$1.NEED_RESULT_POINT_CALLBACK);var t=new FinderPatternFinder(this.image,this.resultPointCallback),n=t.find(e);return this.processFinderPatternInfo(n)},r.prototype.processFinderPatternInfo=function(e){var t=e.getTopLeft(),n=e.getTopRight(),i=e.getBottomLeft(),s=this.calculateModuleSize(t,n,i);if(s<1)throw new NotFoundException("No pattern found in proccess finder.");var a=r.computeDimension(t,n,i,s),o=Version.getProvisionalVersionForDimension(a),c=o.getDimensionForVersion()-7,h=null;if(o.getAlignmentPatternCenters().length>0)for(var f=n.getX()-t.getX()+i.getX(),m=n.getY()-t.getY()+i.getY(),g=1-3/c,_=Math.floor(t.getX()+g*(f-t.getX())),E=Math.floor(t.getY()+g*(m-t.getY())),A=4;A<=16;A<<=1)try{h=this.findAlignmentInRegion(s,_,E,A);break}catch(R){if(!(R instanceof NotFoundException))throw R}var C=r.createTransform(t,n,i,h,a),I=r.sampleGrid(this.image,C,a),b;return h===null?b=[i,t,n]:b=[i,t,n,h],new DetectorResult(I,b)},r.createTransform=function(e,t,n,i,s){var a=s-3.5,o,c,h,f;return i!==null?(o=i.getX(),c=i.getY(),h=a-3,f=h):(o=t.getX()-e.getX()+n.getX(),c=t.getY()-e.getY()+n.getY(),h=a,f=a),PerspectiveTransform.quadrilateralToQuadrilateral(3.5,3.5,a,3.5,h,f,3.5,a,e.getX(),e.getY(),t.getX(),t.getY(),o,c,n.getX(),n.getY())},r.sampleGrid=function(e,t,n){var i=GridSamplerInstance.getInstance();return i.sampleGridWithTransform(e,n,n,t)},r.computeDimension=function(e,t,n,i){var s=MathUtils.round(ResultPoint.distance(e,t)/i),a=MathUtils.round(ResultPoint.distance(e,n)/i),o=Math.floor((s+a)/2)+7;switch(o&3){case 0:o++;break;case 2:o--;break;case 3:throw new NotFoundException("Dimensions could be not found.")}return o},r.prototype.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2},r.prototype.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),i=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?i/7:isNaN(i)?n/7:(n+i)/14},r.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,t,n,i){var s=this.sizeOfBlackWhiteBlackRun(e,t,n,i),a=1,o=e-(n-e);o<0?(a=e/(e-o),o=0):o>=this.image.getWidth()&&(a=(this.image.getWidth()-1-e)/(o-e),o=this.image.getWidth()-1);var c=Math.floor(t-(i-t)*a);return a=1,c<0?(a=t/(t-c),c=0):c>=this.image.getHeight()&&(a=(this.image.getHeight()-1-t)/(c-t),c=this.image.getHeight()-1),o=Math.floor(e+(o-e)*a),s+=this.sizeOfBlackWhiteBlackRun(e,t,o,c),s-1},r.prototype.sizeOfBlackWhiteBlackRun=function(e,t,n,i){var s=Math.abs(i-t)>Math.abs(n-e);if(s){var a=e;e=t,t=a,a=n,n=i,i=a}for(var o=Math.abs(n-e),c=Math.abs(i-t),h=-o/2,f=e<n?1:-1,m=t<i?1:-1,g=0,_=n+f,E=e,A=t;E!==_;E+=f){var C=s?A:E,I=s?E:A;if(g===1===this.image.get(C,I)){if(g===2)return MathUtils.distance(E,A,e,t);g++}if(h+=c,h>0){if(A===i)break;A+=m,h-=o}}return g===2?MathUtils.distance(n+f,i,e,t):NaN},r.prototype.findAlignmentInRegion=function(e,t,n,i){var s=Math.floor(i*e),a=Math.max(0,t-s),o=Math.min(this.image.getWidth()-1,t+s);if(o-a<e*3)throw new NotFoundException("Alignment top exceeds estimated module size.");var c=Math.max(0,n-s),h=Math.min(this.image.getHeight()-1,n+s);if(h-c<e*3)throw new NotFoundException("Alignment bottom exceeds estimated module size.");var f=new AlignmentPatternFinder(this.image,a,c,o-a,h-c,e,this.resultPointCallback);return f.find()},r}(),QRCodeReader=function(){function r(){this.decoder=new Decoder}return r.prototype.getDecoder=function(){return this.decoder},r.prototype.decode=function(e,t){var n,i;if(t!=null&&t.get(DecodeHintType$1.PURE_BARCODE)!==void 0){var s=r.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(s,t),i=r.NO_POINTS}else{var a=new Detector$1(e.getBlackMatrix()).detect(t);n=this.decoder.decodeBitMatrix(a.getBits(),t),i=a.getPoints()}n.getOther()instanceof QRCodeDecoderMetaData&&n.getOther().applyMirroredCorrection(i);var o=new Result(n.getText(),n.getRawBytes(),void 0,i,BarcodeFormat$1.QR_CODE,void 0),c=n.getByteSegments();c!==null&&o.putMetadata(ResultMetadataType$1.BYTE_SEGMENTS,c);var h=n.getECLevel();return h!==null&&o.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,h),n.hasStructuredAppend()&&(o.putMetadata(ResultMetadataType$1.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),o.putMetadata(ResultMetadataType$1.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),o},r.prototype.reset=function(){},r.extractPureBits=function(e){var t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t===null||n===null)throw new NotFoundException;var i=this.moduleSize(t,e),s=t[1],a=n[1],o=t[0],c=n[0];if(o>=c||s>=a)throw new NotFoundException;if(a-s!==c-o&&(c=o+(a-s),c>=e.getWidth()))throw new NotFoundException;var h=Math.round((c-o+1)/i),f=Math.round((a-s+1)/i);if(h<=0||f<=0)throw new NotFoundException;if(f!==h)throw new NotFoundException;var m=Math.floor(i/2);s+=m,o+=m;var g=o+Math.floor((h-1)*i)-c;if(g>0){if(g>m)throw new NotFoundException;o-=g}var _=s+Math.floor((f-1)*i)-a;if(_>0){if(_>m)throw new NotFoundException;s-=_}for(var E=new BitMatrix(h,f),A=0;A<f;A++)for(var C=s+Math.floor(A*i),I=0;I<h;I++)e.get(o+Math.floor(I*i),C)&&E.set(I,A);return E},r.moduleSize=function(e,t){for(var n=t.getHeight(),i=t.getWidth(),s=e[0],a=e[1],o=!0,c=0;s<i&&a<n;){if(o!==t.get(s,a)){if(++c===5)break;o=!o}s++,a++}if(s===i||a===n)throw new NotFoundException;return(s-e[0])/7},r.NO_POINTS=new Array,r}(),__values$i=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},PDF417Common=function(){function r(){}return r.prototype.PDF417Common=function(){},r.getBitCountSum=function(e){return MathUtils.sum(e)},r.toIntArray=function(e){var t,n;if(e==null||!e.length)return r.EMPTY_INT_ARRAY;var i=new Int32Array(e.length),s=0;try{for(var a=__values$i(e),o=a.next();!o.done;o=a.next()){var c=o.value;i[s++]=c}}catch(h){t={error:h}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return i},r.getCodeword=function(e){var t=Arrays.binarySearch(r.SYMBOL_TABLE,e&262143);return t<0?-1:(r.CODEWORD_TABLE[t]-1)%r.NUMBER_OF_CODEWORDS},r.NUMBER_OF_CODEWORDS=929,r.MAX_CODEWORDS_IN_BARCODE=r.NUMBER_OF_CODEWORDS-1,r.MIN_ROWS_IN_BARCODE=3,r.MAX_ROWS_IN_BARCODE=90,r.MODULES_IN_CODEWORD=17,r.MODULES_IN_STOP_PATTERN=18,r.BARS_IN_MODULE=8,r.EMPTY_INT_ARRAY=new Int32Array([]),r.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),r.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),r}(),PDF417DetectorResult=function(){function r(e,t){this.bits=e,this.points=t}return r.prototype.getBits=function(){return this.bits},r.prototype.getPoints=function(){return this.points},r}(),__values$h=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Detector=function(){function r(){}return r.detectMultiple=function(e,t,n){var i=e.getBlackMatrix(),s=r.detect(n,i);return s.length||(i=i.clone(),i.rotate180(),s=r.detect(n,i)),new PDF417DetectorResult(i,s)},r.detect=function(e,t){for(var n,i,s=new Array,a=0,o=0,c=!1;a<t.getHeight();){var h=r.findVertices(t,a,o);if(h[0]==null&&h[3]==null){if(!c)break;c=!1,o=0;try{for(var f=(n=void 0,__values$h(s)),m=f.next();!m.done;m=f.next()){var g=m.value;g[1]!=null&&(a=Math.trunc(Math.max(a,g[1].getY()))),g[3]!=null&&(a=Math.max(a,Math.trunc(g[3].getY())))}}catch(_){n={error:_}}finally{try{m&&!m.done&&(i=f.return)&&i.call(f)}finally{if(n)throw n.error}}a+=r.ROW_STEP;continue}if(c=!0,s.push(h),!e)break;h[2]!=null?(o=Math.trunc(h[2].getX()),a=Math.trunc(h[2].getY())):(o=Math.trunc(h[4].getX()),a=Math.trunc(h[4].getY()))}return s},r.findVertices=function(e,t,n){var i=e.getHeight(),s=e.getWidth(),a=new Array(8);return r.copyToResult(a,r.findRowsWithPattern(e,i,s,t,n,r.START_PATTERN),r.INDEXES_START_PATTERN),a[4]!=null&&(n=Math.trunc(a[4].getX()),t=Math.trunc(a[4].getY())),r.copyToResult(a,r.findRowsWithPattern(e,i,s,t,n,r.STOP_PATTERN),r.INDEXES_STOP_PATTERN),a},r.copyToResult=function(e,t,n){for(var i=0;i<n.length;i++)e[n[i]]=t[i]},r.findRowsWithPattern=function(e,t,n,i,s,a){for(var o=new Array(4),c=!1,h=new Int32Array(a.length);i<t;i+=r.ROW_STEP){var f=r.findGuardPattern(e,s,i,n,!1,a,h);if(f!=null){for(;i>0;){var m=r.findGuardPattern(e,s,--i,n,!1,a,h);if(m!=null)f=m;else{i++;break}}o[0]=new ResultPoint(f[0],i),o[1]=new ResultPoint(f[1],i),c=!0;break}}var g=i+1;if(c){for(var _=0,m=Int32Array.from([Math.trunc(o[0].getX()),Math.trunc(o[1].getX())]);g<t;g++){var f=r.findGuardPattern(e,m[0],g,n,!1,a,h);if(f!=null&&Math.abs(m[0]-f[0])<r.MAX_PATTERN_DRIFT&&Math.abs(m[1]-f[1])<r.MAX_PATTERN_DRIFT)m=f,_=0;else{if(_>r.SKIPPED_ROW_COUNT_MAX)break;_++}}g-=_+1,o[2]=new ResultPoint(m[0],g),o[3]=new ResultPoint(m[1],g)}return g-i<r.BARCODE_MIN_HEIGHT&&Arrays.fill(o,null),o},r.findGuardPattern=function(e,t,n,i,s,a,o){Arrays.fillWithin(o,0,o.length,0);for(var c=t,h=0;e.get(c,n)&&c>0&&h++<r.MAX_PIXEL_DRIFT;)c--;for(var f=c,m=0,g=a.length,_=s;f<i;f++){var E=e.get(f,n);if(E!==_)o[m]++;else{if(m===g-1){if(r.patternMatchVariance(o,a,r.MAX_INDIVIDUAL_VARIANCE)<r.MAX_AVG_VARIANCE)return new Int32Array([c,f]);c+=o[0]+o[1],System.arraycopy(o,2,o,0,m-1),o[m-1]=0,o[m]=0,m--}else m++;o[m]=1,_=!_}}return m===g-1&&r.patternMatchVariance(o,a,r.MAX_INDIVIDUAL_VARIANCE)<r.MAX_AVG_VARIANCE?new Int32Array([c,f-1]):null},r.patternMatchVariance=function(e,t,n){for(var i=e.length,s=0,a=0,o=0;o<i;o++)s+=e[o],a+=t[o];if(s<a)return 1/0;var c=s/a;n*=c;for(var h=0,f=0;f<i;f++){var m=e[f],g=t[f]*c,_=m>g?m-g:g-m;if(_>n)return 1/0;h+=_}return h/s},r.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),r.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),r.MAX_AVG_VARIANCE=.42,r.MAX_INDIVIDUAL_VARIANCE=.8,r.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),r.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),r.MAX_PIXEL_DRIFT=3,r.MAX_PATTERN_DRIFT=5,r.SKIPPED_ROW_COUNT_MAX=25,r.ROW_STEP=5,r.BARCODE_MIN_HEIGHT=10,r}(),__values$g=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ModulusPoly=function(){function r(e,t){if(t.length===0)throw new IllegalArgumentException;this.field=e;var n=t.length;if(n>1&&t[0]===0){for(var i=1;i<n&&t[i]===0;)i++;i===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-i),System.arraycopy(t,i,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}return r.prototype.getCoefficients=function(){return this.coefficients},r.prototype.getDegree=function(){return this.coefficients.length-1},r.prototype.isZero=function(){return this.coefficients[0]===0},r.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},r.prototype.evaluateAt=function(e){var t,n;if(e===0)return this.getCoefficient(0);if(e===1){var i=0;try{for(var s=__values$g(this.coefficients),a=s.next();!a.done;a=s.next()){var o=a.value;i=this.field.add(i,o)}}catch(m){t={error:m}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return i}for(var c=this.coefficients[0],h=this.coefficients.length,f=1;f<h;f++)c=this.field.add(this.field.multiply(e,c),this.coefficients[f]);return c},r.prototype.add=function(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;var t=this.coefficients,n=e.coefficients;if(t.length>n.length){var i=t;t=n,n=i}var s=new Int32Array(n.length),a=n.length-t.length;System.arraycopy(n,0,s,0,a);for(var o=a;o<n.length;o++)s[o]=this.field.add(t[o-a],n[o]);return new r(this.field,s)},r.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},r.prototype.multiply=function(e){return e instanceof r?this.multiplyOther(e):this.multiplyScalar(e)},r.prototype.multiplyOther=function(e){if(!this.field.equals(e.field))throw new IllegalArgumentException("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new r(this.field,new Int32Array([0]));for(var t=this.coefficients,n=t.length,i=e.coefficients,s=i.length,a=new Int32Array(n+s-1),o=0;o<n;o++)for(var c=t[o],h=0;h<s;h++)a[o+h]=this.field.add(a[o+h],this.field.multiply(c,i[h]));return new r(this.field,a)},r.prototype.negative=function(){for(var e=this.coefficients.length,t=new Int32Array(e),n=0;n<e;n++)t[n]=this.field.subtract(0,this.coefficients[n]);return new r(this.field,t)},r.prototype.multiplyScalar=function(e){if(e===0)return new r(this.field,new Int32Array([0]));if(e===1)return this;for(var t=this.coefficients.length,n=new Int32Array(t),i=0;i<t;i++)n[i]=this.field.multiply(this.coefficients[i],e);return new r(this.field,n)},r.prototype.multiplyByMonomial=function(e,t){if(e<0)throw new IllegalArgumentException;if(t===0)return new r(this.field,new Int32Array([0]));for(var n=this.coefficients.length,i=new Int32Array(n+e),s=0;s<n;s++)i[s]=this.field.multiply(this.coefficients[s],t);return new r(this.field,i)},r.prototype.toString=function(){for(var e=new StringBuilder,t=this.getDegree();t>=0;t--){var n=this.getCoefficient(t);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(t===0||n!==1)&&e.append(n),t!==0&&(t===1?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()},r}(),ModulusBase=function(){function r(){}return r.prototype.add=function(e,t){return(e+t)%this.modulus},r.prototype.subtract=function(e,t){return(this.modulus+e-t)%this.modulus},r.prototype.exp=function(e){return this.expTable[e]},r.prototype.log=function(e){if(e===0)throw new IllegalArgumentException;return this.logTable[e]},r.prototype.inverse=function(e){if(e===0)throw new ArithmeticException;return this.expTable[this.modulus-this.logTable[e]-1]},r.prototype.multiply=function(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]},r.prototype.getSize=function(){return this.modulus},r.prototype.equals=function(e){return e===this},r}(),__extends$i=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ModulusGF=function(r){__extends$i(e,r);function e(t,n){var i=r.call(this)||this;i.modulus=t,i.expTable=new Int32Array(t),i.logTable=new Int32Array(t);for(var s=1,a=0;a<t;a++)i.expTable[a]=s,s=s*n%t;for(var a=0;a<t-1;a++)i.logTable[i.expTable[a]]=a;return i.zero=new ModulusPoly(i,new Int32Array([0])),i.one=new ModulusPoly(i,new Int32Array([1])),i}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(t,n){if(t<0)throw new IllegalArgumentException;if(n===0)return this.zero;var i=new Int32Array(t+1);return i[0]=n,new ModulusPoly(this,i)},e.PDF417_GF=new e(PDF417Common.NUMBER_OF_CODEWORDS,3),e}(ModulusBase),__values$f=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ErrorCorrection=function(){function r(){this.field=ModulusGF.PDF417_GF}return r.prototype.decode=function(e,t,n){for(var i,s,a=new ModulusPoly(this.field,e),o=new Int32Array(t),c=!1,h=t;h>0;h--){var f=a.evaluateAt(this.field.exp(h));o[t-h]=f,f!==0&&(c=!0)}if(!c)return 0;var m=this.field.getOne();if(n!=null)try{for(var g=__values$f(n),_=g.next();!_.done;_=g.next()){var E=_.value,A=this.field.exp(e.length-1-E),C=new ModulusPoly(this.field,new Int32Array([this.field.subtract(0,A),1]));m=m.multiply(C)}}catch(w){i={error:w}}finally{try{_&&!_.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}for(var I=new ModulusPoly(this.field,o),b=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),I,t),R=b[0],V=b[1],U=this.findErrorLocations(R),W=this.findErrorMagnitudes(V,R,U),h=0;h<U.length;h++){var j=e.length-1-this.field.log(U[h]);if(j<0)throw ChecksumException.getChecksumInstance();e[j]=this.field.subtract(e[j],W[h])}return U.length},r.prototype.runEuclideanAlgorithm=function(e,t,n){if(e.getDegree()<t.getDegree()){var i=e;e=t,t=i}for(var s=e,a=t,o=this.field.getZero(),c=this.field.getOne();a.getDegree()>=Math.round(n/2);){var h=s,f=o;if(s=a,o=c,s.isZero())throw ChecksumException.getChecksumInstance();a=h;for(var m=this.field.getZero(),g=s.getCoefficient(s.getDegree()),_=this.field.inverse(g);a.getDegree()>=s.getDegree()&&!a.isZero();){var E=a.getDegree()-s.getDegree(),A=this.field.multiply(a.getCoefficient(a.getDegree()),_);m=m.add(this.field.buildMonomial(E,A)),a=a.subtract(s.multiplyByMonomial(E,A))}c=m.multiply(o).subtract(f).negative()}var C=c.getCoefficient(0);if(C===0)throw ChecksumException.getChecksumInstance();var I=this.field.inverse(C),b=c.multiply(I),R=a.multiply(I);return[b,R]},r.prototype.findErrorLocations=function(e){for(var t=e.getDegree(),n=new Int32Array(t),i=0,s=1;s<this.field.getSize()&&i<t;s++)e.evaluateAt(s)===0&&(n[i]=this.field.inverse(s),i++);if(i!==t)throw ChecksumException.getChecksumInstance();return n},r.prototype.findErrorMagnitudes=function(e,t,n){for(var i=t.getDegree(),s=new Int32Array(i),a=1;a<=i;a++)s[i-a]=this.field.multiply(a,t.getCoefficient(a));for(var o=new ModulusPoly(this.field,s),c=n.length,h=new Int32Array(c),a=0;a<c;a++){var f=this.field.inverse(n[a]),m=this.field.subtract(0,e.evaluateAt(f)),g=this.field.inverse(o.evaluateAt(f));h[a]=this.field.multiply(m,g)}return h},r}(),BoundingBox=function(){function r(e,t,n,i,s){e instanceof r?this.constructor_2(e):this.constructor_1(e,t,n,i,s)}return r.prototype.constructor_1=function(e,t,n,i,s){var a=t==null||n==null,o=i==null||s==null;if(a&&o)throw new NotFoundException;a?(t=new ResultPoint(0,i.getY()),n=new ResultPoint(0,s.getY())):o&&(i=new ResultPoint(e.getWidth()-1,t.getY()),s=new ResultPoint(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=t,this.bottomLeft=n,this.topRight=i,this.bottomRight=s,this.minX=Math.trunc(Math.min(t.getX(),n.getX())),this.maxX=Math.trunc(Math.max(i.getX(),s.getX())),this.minY=Math.trunc(Math.min(t.getY(),i.getY())),this.maxY=Math.trunc(Math.max(n.getY(),s.getY()))},r.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},r.merge=function(e,t){return e==null?t:t==null?e:new r(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)},r.prototype.addMissingRows=function(e,t,n){var i=this.topLeft,s=this.bottomLeft,a=this.topRight,o=this.bottomRight;if(e>0){var c=n?this.topLeft:this.topRight,h=Math.trunc(c.getY()-e);h<0&&(h=0);var f=new ResultPoint(c.getX(),h);n?i=f:a=f}if(t>0){var m=n?this.bottomLeft:this.bottomRight,g=Math.trunc(m.getY()+t);g>=this.image.getHeight()&&(g=this.image.getHeight()-1);var _=new ResultPoint(m.getX(),g);n?s=_:o=_}return new r(this.image,i,s,a,o)},r.prototype.getMinX=function(){return this.minX},r.prototype.getMaxX=function(){return this.maxX},r.prototype.getMinY=function(){return this.minY},r.prototype.getMaxY=function(){return this.maxY},r.prototype.getTopLeft=function(){return this.topLeft},r.prototype.getTopRight=function(){return this.topRight},r.prototype.getBottomLeft=function(){return this.bottomLeft},r.prototype.getBottomRight=function(){return this.bottomRight},r}(),BarcodeMetadata=function(){function r(e,t,n,i){this.columnCount=e,this.errorCorrectionLevel=i,this.rowCountUpperPart=t,this.rowCountLowerPart=n,this.rowCount=t+n}return r.prototype.getColumnCount=function(){return this.columnCount},r.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},r.prototype.getRowCount=function(){return this.rowCount},r.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},r.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},r}(),Formatter=function(){function r(){this.buffer=""}return r.form=function(e,t){var n=-1;function i(a,o,c,h,f,m){if(a==="%%")return"%";if(t[++n]!==void 0){a=h?parseInt(h.substr(1)):void 0;var g=f?parseInt(f.substr(1)):void 0,_;switch(m){case"s":_=t[n];break;case"c":_=t[n][0];break;case"f":_=parseFloat(t[n]).toFixed(a);break;case"p":_=parseFloat(t[n]).toPrecision(a);break;case"e":_=parseFloat(t[n]).toExponential(a);break;case"x":_=parseInt(t[n]).toString(g||16);break;case"d":_=parseFloat(parseInt(t[n],g||10).toPrecision(a)).toFixed(0);break}_=typeof _=="object"?JSON.stringify(_):(+_).toString(g);for(var E=parseInt(c),A=c&&c[0]+""=="0"?"0":" ";_.length<E;)_=o!==void 0?_+A:A+_;return _}}var s=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(s,i)},r.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.buffer+=r.form(e,t)},r.prototype.toString=function(){return this.buffer},r}(),__values$e=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},DetectionResultColumn=function(){function r(e){this.boundingBox=new BoundingBox(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return r.prototype.getCodewordNearby=function(e){var t=this.getCodeword(e);if(t!=null)return t;for(var n=1;n<r.MAX_NEARBY_DISTANCE;n++){var i=this.imageRowToCodewordIndex(e)-n;if(i>=0&&(t=this.codewords[i],t!=null)||(i=this.imageRowToCodewordIndex(e)+n,i<this.codewords.length&&(t=this.codewords[i],t!=null)))return t}return null},r.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},r.prototype.setCodeword=function(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t},r.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},r.prototype.getBoundingBox=function(){return this.boundingBox},r.prototype.getCodewords=function(){return this.codewords},r.prototype.toString=function(){var e,t,n=new Formatter,i=0;try{for(var s=__values$e(this.codewords),a=s.next();!a.done;a=s.next()){var o=a.value;if(o==null){n.format("%3d:    |   %n",i++);continue}n.format("%3d: %3d|%3d%n",i++,o.getRowNumber(),o.getValue())}}catch(c){e={error:c}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return n.toString()},r.MAX_NEARBY_DISTANCE=5,r}(),__values$d=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},__read$1=function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s},BarcodeValue=function(){function r(){this.values=new Map}return r.prototype.setValue=function(e){e=Math.trunc(e);var t=this.values.get(e);t==null&&(t=0),t++,this.values.set(e,t)},r.prototype.getValue=function(){var e,t,n=-1,i=new Array,s=function(m,g){var _={getKey:function(){return m},getValue:function(){return g}};_.getValue()>n?(n=_.getValue(),i=[],i.push(_.getKey())):_.getValue()===n&&i.push(_.getKey())};try{for(var a=__values$d(this.values.entries()),o=a.next();!o.done;o=a.next()){var c=__read$1(o.value,2),h=c[0],f=c[1];s(h,f)}}catch(m){e={error:m}}finally{try{o&&!o.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return PDF417Common.toIntArray(i)},r.prototype.getConfidence=function(e){return this.values.get(e)},r}(),__extends$h=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$c=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},DetectionResultRowIndicatorColumn=function(r){__extends$h(e,r);function e(t,n){var i=r.call(this,t)||this;return i._isLeft=n,i}return e.prototype.setRowNumbers=function(){var t,n;try{for(var i=__values$c(this.getCodewords()),s=i.next();!s.done;s=i.next()){var a=s.value;a!=null&&a.setRowNumberAsRowIndicatorColumn()}}catch(o){t={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.adjustCompleteIndicatorColumnRowNumbers=function(t){var n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,t);for(var i=this.getBoundingBox(),s=this._isLeft?i.getTopLeft():i.getTopRight(),a=this._isLeft?i.getBottomLeft():i.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.imageRowToCodewordIndex(Math.trunc(a.getY())),h=-1,f=1,m=0,g=o;g<c;g++)if(n[g]!=null){var _=n[g],E=_.getRowNumber()-h;if(E===0)m++;else if(E===1)f=Math.max(f,m),m=1,h=_.getRowNumber();else if(E<0||_.getRowNumber()>=t.getRowCount()||E>g)n[g]=null;else{var A=void 0;f>2?A=(f-2)*E:A=E;for(var C=A>=g,I=1;I<=A&&!C;I++)C=n[g-I]!=null;C?n[g]=null:(h=_.getRowNumber(),m=1)}}},e.prototype.getRowHeights=function(){var t,n,i=this.getBarcodeMetadata();if(i==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(i);var s=new Int32Array(i.getRowCount());try{for(var a=__values$c(this.getCodewords()),o=a.next();!o.done;o=a.next()){var c=o.value;if(c!=null){var h=c.getRowNumber();if(h>=s.length)continue;s[h]++}}}catch(f){t={error:f}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return s},e.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(t){for(var n=this.getBoundingBox(),i=this._isLeft?n.getTopLeft():n.getTopRight(),s=this._isLeft?n.getBottomLeft():n.getBottomRight(),a=this.imageRowToCodewordIndex(Math.trunc(i.getY())),o=this.imageRowToCodewordIndex(Math.trunc(s.getY())),c=this.getCodewords(),h=-1,f=a;f<o;f++)if(c[f]!=null){var m=c[f];m.setRowNumberAsRowIndicatorColumn();var g=m.getRowNumber()-h;g===0||(g===1?h=m.getRowNumber():m.getRowNumber()>=t.getRowCount()?c[f]=null:h=m.getRowNumber())}},e.prototype.getBarcodeMetadata=function(){var t,n,i=this.getCodewords(),s=new BarcodeValue,a=new BarcodeValue,o=new BarcodeValue,c=new BarcodeValue;try{for(var h=__values$c(i),f=h.next();!f.done;f=h.next()){var m=f.value;if(m!=null){m.setRowNumberAsRowIndicatorColumn();var g=m.getValue()%30,_=m.getRowNumber();switch(this._isLeft||(_+=2),_%3){case 0:a.setValue(g*3+1);break;case 1:c.setValue(g/3),o.setValue(g%3);break;case 2:s.setValue(g+1);break}}}}catch(A){t={error:A}}finally{try{f&&!f.done&&(n=h.return)&&n.call(h)}finally{if(t)throw t.error}}if(s.getValue().length===0||a.getValue().length===0||o.getValue().length===0||c.getValue().length===0||s.getValue()[0]<1||a.getValue()[0]+o.getValue()[0]<PDF417Common.MIN_ROWS_IN_BARCODE||a.getValue()[0]+o.getValue()[0]>PDF417Common.MAX_ROWS_IN_BARCODE)return null;var E=new BarcodeMetadata(s.getValue()[0],a.getValue()[0],o.getValue()[0],c.getValue()[0]);return this.removeIncorrectCodewords(i,E),E},e.prototype.removeIncorrectCodewords=function(t,n){for(var i=0;i<t.length;i++){var s=t[i];if(t[i]!=null){var a=s.getValue()%30,o=s.getRowNumber();if(o>n.getRowCount()){t[i]=null;continue}switch(this._isLeft||(o+=2),o%3){case 0:a*3+1!==n.getRowCountUpperPart()&&(t[i]=null);break;case 1:(Math.trunc(a/3)!==n.getErrorCorrectionLevel()||a%3!==n.getRowCountLowerPart())&&(t[i]=null);break;case 2:a+1!==n.getColumnCount()&&(t[i]=null);break}}}},e.prototype.isLeft=function(){return this._isLeft},e.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+r.prototype.toString.call(this)},e}(DetectionResultColumn),__values$b=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},DetectionResult=function(){function r(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return r.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e=PDF417Common.MAX_CODEWORDS_IN_BARCODE,t;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns},r.prototype.adjustIndicatorColumnRowNumbers=function(e){e!=null&&e.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},r.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(e===0)return 0;for(var t=1;t<this.barcodeColumnCount+1;t++)for(var n=this.detectionResultColumns[t].getCodewords(),i=0;i<n.length;i++)n[i]!=null&&(n[i].hasValidRowNumber()||this.adjustRowNumbers(t,i,n));return e},r.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var e=this.adjustRowNumbersFromLRI();return e+this.adjustRowNumbersFromRRI()},r.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<e.length;n++)if(e[n]!=null&&t[n]!=null&&e[n].getRowNumber()===t[n].getRowNumber())for(var i=1;i<=this.barcodeColumnCount;i++){var s=this.detectionResultColumns[i].getCodewords()[n];s!=null&&(s.setRowNumber(e[n].getRowNumber()),s.hasValidRowNumber()||(this.detectionResultColumns[i].getCodewords()[n]=null))}}},r.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<t.length;n++)if(t[n]!=null)for(var i=t[n].getRowNumber(),s=0,a=this.barcodeColumnCount+1;a>0&&s<this.ADJUST_ROW_NUMBER_SKIP;a--){var o=this.detectionResultColumns[a].getCodewords()[n];o!=null&&(s=r.adjustRowNumberIfValid(i,s,o),o.hasValidRowNumber()||e++)}return e},r.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var e=0,t=this.detectionResultColumns[0].getCodewords(),n=0;n<t.length;n++)if(t[n]!=null)for(var i=t[n].getRowNumber(),s=0,a=1;a<this.barcodeColumnCount+1&&s<this.ADJUST_ROW_NUMBER_SKIP;a++){var o=this.detectionResultColumns[a].getCodewords()[n];o!=null&&(s=r.adjustRowNumberIfValid(i,s,o),o.hasValidRowNumber()||e++)}return e},r.adjustRowNumberIfValid=function(e,t,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),t=0):++t),t},r.prototype.adjustRowNumbers=function(e,t,n){var i,s;if(this.detectionResultColumns[e-1]!=null){var a=n[t],o=this.detectionResultColumns[e-1].getCodewords(),c=o;this.detectionResultColumns[e+1]!=null&&(c=this.detectionResultColumns[e+1].getCodewords());var h=new Array(14);h[2]=o[t],h[3]=c[t],t>0&&(h[0]=n[t-1],h[4]=o[t-1],h[5]=c[t-1]),t>1&&(h[8]=n[t-2],h[10]=o[t-2],h[11]=c[t-2]),t<n.length-1&&(h[1]=n[t+1],h[6]=o[t+1],h[7]=c[t+1]),t<n.length-2&&(h[9]=n[t+2],h[12]=o[t+2],h[13]=c[t+2]);try{for(var f=__values$b(h),m=f.next();!m.done;m=f.next()){var g=m.value;if(r.adjustRowNumber(a,g))return}}catch(_){i={error:_}}finally{try{m&&!m.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}}},r.adjustRowNumber=function(e,t){return t==null?!1:t.hasValidRowNumber()&&t.getBucket()===e.getBucket()?(e.setRowNumber(t.getRowNumber()),!0):!1},r.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},r.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},r.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},r.prototype.setBoundingBox=function(e){this.boundingBox=e},r.prototype.getBoundingBox=function(){return this.boundingBox},r.prototype.setDetectionResultColumn=function(e,t){this.detectionResultColumns[e]=t},r.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},r.prototype.toString=function(){var e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var t=new Formatter,n=0;n<e.getCodewords().length;n++){t.format("CW %3d:",n);for(var i=0;i<this.barcodeColumnCount+2;i++){if(this.detectionResultColumns[i]==null){t.format("    |   ");continue}var s=this.detectionResultColumns[i].getCodewords()[n];if(s==null){t.format("    |   ");continue}t.format(" %3d|%3d",s.getRowNumber(),s.getValue())}t.format("%n")}return t.toString()},r}(),Codeword=function(){function r(e,t,n,i){this.rowNumber=r.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(n),this.value=Math.trunc(i)}return r.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},r.prototype.isValidRowNumber=function(e){return e!==r.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3},r.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},r.prototype.getWidth=function(){return this.endX-this.startX},r.prototype.getStartX=function(){return this.startX},r.prototype.getEndX=function(){return this.endX},r.prototype.getBucket=function(){return this.bucket},r.prototype.getValue=function(){return this.value},r.prototype.getRowNumber=function(){return this.rowNumber},r.prototype.setRowNumber=function(e){this.rowNumber=e},r.prototype.toString=function(){return this.rowNumber+"|"+this.value},r.BARCODE_ROW_UNKNOWN=-1,r}(),PDF417CodewordDecoder=function(){function r(){}return r.initialize=function(){for(var e=0;e<PDF417Common.SYMBOL_TABLE.length;e++)for(var t=PDF417Common.SYMBOL_TABLE[e],n=t&1,i=0;i<PDF417Common.BARS_IN_MODULE;i++){for(var s=0;(t&1)===n;)s+=1,t>>=1;n=t&1,r.RATIOS_TABLE[e]||(r.RATIOS_TABLE[e]=new Array(PDF417Common.BARS_IN_MODULE)),r.RATIOS_TABLE[e][PDF417Common.BARS_IN_MODULE-i-1]=Math.fround(s/PDF417Common.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},r.getDecodedValue=function(e){var t=r.getDecodedCodewordValue(r.sampleBitCounts(e));return t!==-1?t:r.getClosestDecodedValue(e)},r.sampleBitCounts=function(e){for(var t=MathUtils.sum(e),n=new Int32Array(PDF417Common.BARS_IN_MODULE),i=0,s=0,a=0;a<PDF417Common.MODULES_IN_CODEWORD;a++){var o=t/(2*PDF417Common.MODULES_IN_CODEWORD)+a*t/PDF417Common.MODULES_IN_CODEWORD;s+e[i]<=o&&(s+=e[i],i++),n[i]++}return n},r.getDecodedCodewordValue=function(e){var t=r.getBitValue(e);return PDF417Common.getCodeword(t)===-1?-1:t},r.getBitValue=function(e){for(var t=0,n=0;n<e.length;n++)for(var i=0;i<e[n];i++)t=t<<1|(n%2===0?1:0);return Math.trunc(t)},r.getClosestDecodedValue=function(e){var t=MathUtils.sum(e),n=new Array(PDF417Common.BARS_IN_MODULE);if(t>1)for(var i=0;i<n.length;i++)n[i]=Math.fround(e[i]/t);var s=Float.MAX_VALUE,a=-1;this.bSymbolTableReady||r.initialize();for(var o=0;o<r.RATIOS_TABLE.length;o++){for(var c=0,h=r.RATIOS_TABLE[o],f=0;f<PDF417Common.BARS_IN_MODULE;f++){var m=Math.fround(h[f]-n[f]);if(c+=Math.fround(m*m),c>=s)break}c<s&&(s=c,a=PDF417Common.SYMBOL_TABLE[o])}return a},r.bSymbolTableReady=!1,r.RATIOS_TABLE=new Array(PDF417Common.SYMBOL_TABLE.length).map(function(e){return new Array(PDF417Common.BARS_IN_MODULE)}),r}(),PDF417ResultMetadata=function(){function r(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return r.prototype.getSegmentIndex=function(){return this.segmentIndex},r.prototype.setSegmentIndex=function(e){this.segmentIndex=e},r.prototype.getFileId=function(){return this.fileId},r.prototype.setFileId=function(e){this.fileId=e},r.prototype.getOptionalData=function(){return this.optionalData},r.prototype.setOptionalData=function(e){this.optionalData=e},r.prototype.isLastSegment=function(){return this.lastSegment},r.prototype.setLastSegment=function(e){this.lastSegment=e},r.prototype.getSegmentCount=function(){return this.segmentCount},r.prototype.setSegmentCount=function(e){this.segmentCount=e},r.prototype.getSender=function(){return this.sender||null},r.prototype.setSender=function(e){this.sender=e},r.prototype.getAddressee=function(){return this.addressee||null},r.prototype.setAddressee=function(e){this.addressee=e},r.prototype.getFileName=function(){return this.fileName},r.prototype.setFileName=function(e){this.fileName=e},r.prototype.getFileSize=function(){return this.fileSize},r.prototype.setFileSize=function(e){this.fileSize=e},r.prototype.getChecksum=function(){return this.checksum},r.prototype.setChecksum=function(e){this.checksum=e},r.prototype.getTimestamp=function(){return this.timestamp},r.prototype.setTimestamp=function(e){this.timestamp=e},r}(),Long=function(){function r(){}return r.parseLong=function(e,t){return t===void 0&&(t=void 0),parseInt(e,t)},r}(),__extends$g=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),NullPointerException=function(r){__extends$g(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="NullPointerException",e}(Exception),OutputStream=function(){function r(){}return r.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},r.prototype.writeBytesOffset=function(e,t,n){if(e==null)throw new NullPointerException;if(t<0||t>e.length||n<0||t+n>e.length||t+n<0)throw new IndexOutOfBoundsException;if(n===0)return;for(var i=0;i<n;i++)this.write(e[t+i])},r.prototype.flush=function(){},r.prototype.close=function(){},r}(),__extends$f=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),OutOfMemoryError=function(r){__extends$f(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e}(Exception),__extends$e=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ByteArrayOutputStream=function(r){__extends$e(e,r);function e(t){t===void 0&&(t=32);var n=r.call(this)||this;if(n.count=0,t<0)throw new IllegalArgumentException("Negative initial size: "+t);return n.buf=new Uint8Array(t),n}return e.prototype.ensureCapacity=function(t){t-this.buf.length>0&&this.grow(t)},e.prototype.grow=function(t){var n=this.buf.length,i=n<<1;if(i-t<0&&(i=t),i<0){if(t<0)throw new OutOfMemoryError;i=Integer.MAX_VALUE}this.buf=Arrays.copyOfUint8Array(this.buf,i)},e.prototype.write=function(t){this.ensureCapacity(this.count+1),this.buf[this.count]=t,this.count+=1},e.prototype.writeBytesOffset=function(t,n,i){if(n<0||n>t.length||i<0||n+i-t.length>0)throw new IndexOutOfBoundsException;this.ensureCapacity(this.count+i),System.arraycopy(t,n,this.buf,this.count,i),this.count+=i},e.prototype.writeTo=function(t){t.writeBytesOffset(this.buf,0,this.count)},e.prototype.reset=function(){this.count=0},e.prototype.toByteArray=function(){return Arrays.copyOfUint8Array(this.buf,this.count)},e.prototype.size=function(){return this.count},e.prototype.toString=function(t){return t?typeof t=="string"?this.toString_string(t):this.toString_number(t):this.toString_void()},e.prototype.toString_void=function(){return new String(this.buf).toString()},e.prototype.toString_string=function(t){return new String(this.buf).toString()},e.prototype.toString_number=function(t){return new String(this.buf).toString()},e.prototype.close=function(){},e}(OutputStream),Mode$1;(function(r){r[r.ALPHA=0]="ALPHA",r[r.LOWER=1]="LOWER",r[r.MIXED=2]="MIXED",r[r.PUNCT=3]="PUNCT",r[r.ALPHA_SHIFT=4]="ALPHA_SHIFT",r[r.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Mode$1||(Mode$1={}));function getBigIntConstructor(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var BigInteger;function createBigInt(r){if(typeof BigInteger>"u"&&(BigInteger=getBigIntConstructor()),BigInteger===null)throw new Error("BigInt is not supported!");return BigInteger(r)}function getEXP900(){var r=[];r[0]=createBigInt(1);var e=createBigInt(900);r[1]=e;for(var t=2;t<16;t++)r[t]=r[t-1]*e;return r}var DecodedBitStreamParser=function(){function r(){}return r.decode=function(e,t){var n=new StringBuilder(""),i=CharacterSetECI.ISO8859_1;n.enableDecoding(i);for(var s=1,a=e[s++],o=new PDF417ResultMetadata;s<e[0];){switch(a){case r.TEXT_COMPACTION_MODE_LATCH:s=r.textCompaction(e,s,n);break;case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:s=r.byteCompaction(a,e,i,s,n);break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s++]);break;case r.NUMERIC_COMPACTION_MODE_LATCH:s=r.numericCompaction(e,s,n);break;case r.ECI_CHARSET:CharacterSetECI.getCharacterSetECIByValue(e[s++]);break;case r.ECI_GENERAL_PURPOSE:s+=2;break;case r.ECI_USER_DEFINED:s++;break;case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:s=r.decodeMacroBlock(e,s,o);break;case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:throw new FormatException;default:s--,s=r.textCompaction(e,s,n);break}if(s<e.length)a=e[s++];else throw FormatException.getFormatInstance()}if(n.length()===0)throw FormatException.getFormatInstance();var c=new DecoderResult(null,n.toString(),null,t);return c.setOther(o),c},r.decodeMacroBlock=function(e,t,n){if(t+r.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw FormatException.getFormatInstance();for(var i=new Int32Array(r.NUMBER_OF_SEQUENCE_CODEWORDS),s=0;s<r.NUMBER_OF_SEQUENCE_CODEWORDS;s++,t++)i[s]=e[t];n.setSegmentIndex(Integer.parseInt(r.decodeBase900toBase10(i,r.NUMBER_OF_SEQUENCE_CODEWORDS)));var a=new StringBuilder;t=r.textCompaction(e,t,a),n.setFileId(a.toString());var o=-1;for(e[t]===r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(o=t+1);t<e[0];)switch(e[t]){case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t++,e[t]){case r.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var c=new StringBuilder;t=r.textCompaction(e,t+1,c),n.setFileName(c.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var h=new StringBuilder;t=r.textCompaction(e,t+1,h),n.setSender(h.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var f=new StringBuilder;t=r.textCompaction(e,t+1,f),n.setAddressee(f.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var m=new StringBuilder;t=r.numericCompaction(e,t+1,m),n.setSegmentCount(Integer.parseInt(m.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var g=new StringBuilder;t=r.numericCompaction(e,t+1,g),n.setTimestamp(Long.parseLong(g.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var _=new StringBuilder;t=r.numericCompaction(e,t+1,_),n.setChecksum(Integer.parseInt(_.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var E=new StringBuilder;t=r.numericCompaction(e,t+1,E),n.setFileSize(Long.parseLong(E.toString()));break;default:throw FormatException.getFormatInstance()}break;case r.MACRO_PDF417_TERMINATOR:t++,n.setLastSegment(!0);break;default:throw FormatException.getFormatInstance()}if(o!==-1){var A=t-o;n.isLastSegment()&&A--,n.setOptionalData(Arrays.copyOfRange(e,o,o+A))}return t},r.textCompaction=function(e,t,n){for(var i=new Int32Array((e[0]-t)*2),s=new Int32Array((e[0]-t)*2),a=0,o=!1;t<e[0]&&!o;){var c=e[t++];if(c<r.TEXT_COMPACTION_MODE_LATCH)i[a]=c/30,i[a+1]=c%30,a+=2;else switch(c){case r.TEXT_COMPACTION_MODE_LATCH:i[a++]=r.TEXT_COMPACTION_MODE_LATCH;break;case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:t--,o=!0;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i[a]=r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,c=e[t++],s[a]=c,a++;break}}return r.decodeTextCompaction(i,s,a,n),t},r.decodeTextCompaction=function(e,t,n,i){for(var s=Mode$1.ALPHA,a=Mode$1.ALPHA,o=0;o<n;){var c=e[o],h="";switch(s){case Mode$1.ALPHA:if(c<26)h=String.fromCharCode(65+c);else switch(c){case 26:h=" ";break;case r.LL:s=Mode$1.LOWER;break;case r.ML:s=Mode$1.MIXED;break;case r.PS:a=s,s=Mode$1.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(t[o]);break;case r.TEXT_COMPACTION_MODE_LATCH:s=Mode$1.ALPHA;break}break;case Mode$1.LOWER:if(c<26)h=String.fromCharCode(97+c);else switch(c){case 26:h=" ";break;case r.AS:a=s,s=Mode$1.ALPHA_SHIFT;break;case r.ML:s=Mode$1.MIXED;break;case r.PS:a=s,s=Mode$1.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(t[o]);break;case r.TEXT_COMPACTION_MODE_LATCH:s=Mode$1.ALPHA;break}break;case Mode$1.MIXED:if(c<r.PL)h=r.MIXED_CHARS[c];else switch(c){case r.PL:s=Mode$1.PUNCT;break;case 26:h=" ";break;case r.LL:s=Mode$1.LOWER;break;case r.AL:s=Mode$1.ALPHA;break;case r.PS:a=s,s=Mode$1.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(t[o]);break;case r.TEXT_COMPACTION_MODE_LATCH:s=Mode$1.ALPHA;break}break;case Mode$1.PUNCT:if(c<r.PAL)h=r.PUNCT_CHARS[c];else switch(c){case r.PAL:s=Mode$1.ALPHA;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(t[o]);break;case r.TEXT_COMPACTION_MODE_LATCH:s=Mode$1.ALPHA;break}break;case Mode$1.ALPHA_SHIFT:if(s=a,c<26)h=String.fromCharCode(65+c);else switch(c){case 26:h=" ";break;case r.TEXT_COMPACTION_MODE_LATCH:s=Mode$1.ALPHA;break}break;case Mode$1.PUNCT_SHIFT:if(s=a,c<r.PAL)h=r.PUNCT_CHARS[c];else switch(c){case r.PAL:s=Mode$1.ALPHA;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:i.append(t[o]);break;case r.TEXT_COMPACTION_MODE_LATCH:s=Mode$1.ALPHA;break}break}h!==""&&i.append(h),o++}},r.byteCompaction=function(e,t,n,i,s){var a=new ByteArrayOutputStream,o=0,c=0,h=!1;switch(e){case r.BYTE_COMPACTION_MODE_LATCH:for(var f=new Int32Array(6),m=t[i++];i<t[0]&&!h;)switch(f[o++]=m,c=900*c+m,m=t[i++],m){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:i--,h=!0;break;default:if(o%5===0&&o>0){for(var g=0;g<6;++g)a.write(Number(createBigInt(c)>>createBigInt(8*(5-g))));c=0,o=0}break}i===t[0]&&m<r.TEXT_COMPACTION_MODE_LATCH&&(f[o++]=m);for(var _=0;_<o;_++)a.write(f[_]);break;case r.BYTE_COMPACTION_MODE_LATCH_6:for(;i<t[0]&&!h;){var E=t[i++];if(E<r.TEXT_COMPACTION_MODE_LATCH)o++,c=900*c+E;else switch(E){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:i--,h=!0;break}if(o%5===0&&o>0){for(var g=0;g<6;++g)a.write(Number(createBigInt(c)>>createBigInt(8*(5-g))));c=0,o=0}}break}return s.append(StringEncoding.decode(a.toByteArray(),n)),i},r.numericCompaction=function(e,t,n){for(var i=0,s=!1,a=new Int32Array(r.MAX_NUMERIC_CODEWORDS);t<e[0]&&!s;){var o=e[t++];if(t===e[0]&&(s=!0),o<r.TEXT_COMPACTION_MODE_LATCH)a[i]=o,i++;else switch(o){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:t--,s=!0;break}(i%r.MAX_NUMERIC_CODEWORDS===0||o===r.NUMERIC_COMPACTION_MODE_LATCH||s)&&i>0&&(n.append(r.decodeBase900toBase10(a,i)),i=0)}return t},r.decodeBase900toBase10=function(e,t){for(var n=createBigInt(0),i=0;i<t;i++)n+=r.EXP900[t-i-1]*createBigInt(e[i]);var s=n.toString();if(s.charAt(0)!=="1")throw new FormatException;return s.substring(1)},r.TEXT_COMPACTION_MODE_LATCH=900,r.BYTE_COMPACTION_MODE_LATCH=901,r.NUMERIC_COMPACTION_MODE_LATCH=902,r.BYTE_COMPACTION_MODE_LATCH_6=924,r.ECI_USER_DEFINED=925,r.ECI_GENERAL_PURPOSE=926,r.ECI_CHARSET=927,r.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,r.MACRO_PDF417_TERMINATOR=922,r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,r.MAX_NUMERIC_CODEWORDS=15,r.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,r.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,r.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,r.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,r.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,r.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,r.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,r.PL=25,r.LL=27,r.AS=27,r.ML=28,r.AL=28,r.PS=29,r.PAL=29,r.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,r.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",r.EXP900=getBigIntConstructor()?getEXP900():[],r.NUMBER_OF_SEQUENCE_CODEWORDS=2,r}(),__values$a=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},PDF417ScanningDecoder=function(){function r(){}return r.decode=function(e,t,n,i,s,a,o){for(var c=new BoundingBox(e,t,n,i,s),h=null,f=null,m,g=!0;;g=!1){if(t!=null&&(h=r.getRowIndicatorColumn(e,c,t,!0,a,o)),i!=null&&(f=r.getRowIndicatorColumn(e,c,i,!1,a,o)),m=r.merge(h,f),m==null)throw NotFoundException.getNotFoundInstance();var _=m.getBoundingBox();if(g&&_!=null&&(_.getMinY()<c.getMinY()||_.getMaxY()>c.getMaxY()))c=_;else break}m.setBoundingBox(c);var E=m.getBarcodeColumnCount()+1;m.setDetectionResultColumn(0,h),m.setDetectionResultColumn(E,f);for(var A=h!=null,C=1;C<=E;C++){var I=A?C:E-C;if(m.getDetectionResultColumn(I)===void 0){var b=void 0;I===0||I===E?b=new DetectionResultRowIndicatorColumn(c,I===0):b=new DetectionResultColumn(c),m.setDetectionResultColumn(I,b);for(var R=-1,V=R,U=c.getMinY();U<=c.getMaxY();U++){if(R=r.getStartColumn(m,I,U,A),R<0||R>c.getMaxX()){if(V===-1)continue;R=V}var W=r.detectCodeword(e,c.getMinX(),c.getMaxX(),A,R,U,a,o);W!=null&&(b.setCodeword(U,W),V=R,a=Math.min(a,W.getWidth()),o=Math.max(o,W.getWidth()))}}}return r.createDecoderResult(m)},r.merge=function(e,t){if(e==null&&t==null)return null;var n=r.getBarcodeMetadata(e,t);if(n==null)return null;var i=BoundingBox.merge(r.adjustBoundingBox(e),r.adjustBoundingBox(t));return new DetectionResult(n,i)},r.adjustBoundingBox=function(e){var t,n;if(e==null)return null;var i=e.getRowHeights();if(i==null)return null;var s=r.getMax(i),a=0;try{for(var o=__values$a(i),c=o.next();!c.done;c=o.next()){var h=c.value;if(a+=s-h,h>0)break}}catch(_){t={error:_}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}for(var f=e.getCodewords(),m=0;a>0&&f[m]==null;m++)a--;for(var g=0,m=i.length-1;m>=0&&(g+=s-i[m],!(i[m]>0));m--);for(var m=f.length-1;g>0&&f[m]==null;m--)g--;return e.getBoundingBox().addMissingRows(a,g,e.isLeft())},r.getMax=function(e){var t,n,i=-1;try{for(var s=__values$a(e),a=s.next();!a.done;a=s.next()){var o=a.value;i=Math.max(i,o)}}catch(c){t={error:c}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return i},r.getBarcodeMetadata=function(e,t){var n;if(e==null||(n=e.getBarcodeMetadata())==null)return t==null?null:t.getBarcodeMetadata();var i;return t==null||(i=t.getBarcodeMetadata())==null?n:n.getColumnCount()!==i.getColumnCount()&&n.getErrorCorrectionLevel()!==i.getErrorCorrectionLevel()&&n.getRowCount()!==i.getRowCount()?null:n},r.getRowIndicatorColumn=function(e,t,n,i,s,a){for(var o=new DetectionResultRowIndicatorColumn(t,i),c=0;c<2;c++)for(var h=c===0?1:-1,f=Math.trunc(Math.trunc(n.getX())),m=Math.trunc(Math.trunc(n.getY()));m<=t.getMaxY()&&m>=t.getMinY();m+=h){var g=r.detectCodeword(e,0,e.getWidth(),i,f,m,s,a);g!=null&&(o.setCodeword(m,g),i?f=g.getStartX():f=g.getEndX())}return o},r.adjustCodewordCount=function(e,t){var n=t[0][1],i=n.getValue(),s=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-r.getNumberOfECCodeWords(e.getBarcodeECLevel());if(i.length===0){if(s<1||s>PDF417Common.MAX_CODEWORDS_IN_BARCODE)throw NotFoundException.getNotFoundInstance();n.setValue(s)}else i[0]!==s&&n.setValue(s)},r.createDecoderResult=function(e){var t=r.createBarcodeMatrix(e);r.adjustCodewordCount(e,t);for(var n=new Array,i=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),s=[],a=new Array,o=0;o<e.getBarcodeRowCount();o++)for(var c=0;c<e.getBarcodeColumnCount();c++){var h=t[o][c+1].getValue(),f=o*e.getBarcodeColumnCount()+c;h.length===0?n.push(f):h.length===1?i[f]=h[0]:(a.push(f),s.push(h))}for(var m=new Array(s.length),g=0;g<m.length;g++)m[g]=s[g];return r.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),i,PDF417Common.toIntArray(n),PDF417Common.toIntArray(a),m)},r.createDecoderResultFromAmbiguousValues=function(e,t,n,i,s){for(var a=new Int32Array(i.length),o=100;o-- >0;){for(var c=0;c<a.length;c++)t[i[c]]=s[c][a[c]];try{return r.decodeCodewords(t,e,n)}catch(f){var h=f instanceof ChecksumException;if(!h)throw f}if(a.length===0)throw ChecksumException.getChecksumInstance();for(var c=0;c<a.length;c++)if(a[c]<s[c].length-1){a[c]++;break}else if(a[c]=0,c===a.length-1)throw ChecksumException.getChecksumInstance()}throw ChecksumException.getChecksumInstance()},r.createBarcodeMatrix=function(e){for(var t,n,i,s,a=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),o=0;o<a.length;o++)for(var c=0;c<a[o].length;c++)a[o][c]=new BarcodeValue;var h=0;try{for(var f=__values$a(e.getDetectionResultColumns()),m=f.next();!m.done;m=f.next()){var g=m.value;if(g!=null)try{for(var _=(i=void 0,__values$a(g.getCodewords())),E=_.next();!E.done;E=_.next()){var A=E.value;if(A!=null){var C=A.getRowNumber();if(C>=0){if(C>=a.length)continue;a[C][h].setValue(A.getValue())}}}}catch(I){i={error:I}}finally{try{E&&!E.done&&(s=_.return)&&s.call(_)}finally{if(i)throw i.error}}h++}}catch(I){t={error:I}}finally{try{m&&!m.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}return a},r.isValidBarcodeColumn=function(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1},r.getStartColumn=function(e,t,n,i){var s,a,o=i?1:-1,c=null;if(r.isValidBarcodeColumn(e,t-o)&&(c=e.getDetectionResultColumn(t-o).getCodeword(n)),c!=null)return i?c.getEndX():c.getStartX();if(c=e.getDetectionResultColumn(t).getCodewordNearby(n),c!=null)return i?c.getStartX():c.getEndX();if(r.isValidBarcodeColumn(e,t-o)&&(c=e.getDetectionResultColumn(t-o).getCodewordNearby(n)),c!=null)return i?c.getEndX():c.getStartX();for(var h=0;r.isValidBarcodeColumn(e,t-o);){t-=o;try{for(var f=(s=void 0,__values$a(e.getDetectionResultColumn(t).getCodewords())),m=f.next();!m.done;m=f.next()){var g=m.value;if(g!=null)return(i?g.getEndX():g.getStartX())+o*h*(g.getEndX()-g.getStartX())}}catch(_){s={error:_}}finally{try{m&&!m.done&&(a=f.return)&&a.call(f)}finally{if(s)throw s.error}}h++}return i?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()},r.detectCodeword=function(e,t,n,i,s,a,o,c){s=r.adjustCodewordStartColumn(e,t,n,i,s,a);var h=r.getModuleBitCount(e,t,n,i,s,a);if(h==null)return null;var f,m=MathUtils.sum(h);if(i)f=s+m;else{for(var g=0;g<h.length/2;g++){var _=h[g];h[g]=h[h.length-1-g],h[h.length-1-g]=_}f=s,s=f-m}if(!r.checkCodewordSkew(m,o,c))return null;var E=PDF417CodewordDecoder.getDecodedValue(h),A=PDF417Common.getCodeword(E);return A===-1?null:new Codeword(s,f,r.getCodewordBucketNumber(E),A)},r.getModuleBitCount=function(e,t,n,i,s,a){for(var o=s,c=new Int32Array(8),h=0,f=i?1:-1,m=i;(i?o<n:o>=t)&&h<c.length;)e.get(o,a)===m?(c[h]++,o+=f):(h++,m=!m);return h===c.length||o===(i?n:t)&&h===c.length-1?c:null},r.getNumberOfECCodeWords=function(e){return 2<<e},r.adjustCodewordStartColumn=function(e,t,n,i,s,a){for(var o=s,c=i?-1:1,h=0;h<2;h++){for(;(i?o>=t:o<n)&&i===e.get(o,a);){if(Math.abs(s-o)>r.CODEWORD_SKEW_SIZE)return s;o+=c}c=-c,i=!i}return o},r.checkCodewordSkew=function(e,t,n){return t-r.CODEWORD_SKEW_SIZE<=e&&e<=n+r.CODEWORD_SKEW_SIZE},r.decodeCodewords=function(e,t,n){if(e.length===0)throw FormatException.getFormatInstance();var i=1<<t+1,s=r.correctErrors(e,n,i);r.verifyCodewordCount(e,i);var a=DecodedBitStreamParser.decode(e,""+t);return a.setErrorsCorrected(s),a.setErasures(n.length),a},r.correctErrors=function(e,t,n){if(t!=null&&t.length>n/2+r.MAX_ERRORS||n<0||n>r.MAX_EC_CODEWORDS)throw ChecksumException.getChecksumInstance();return r.errorCorrection.decode(e,n,t)},r.verifyCodewordCount=function(e,t){if(e.length<4)throw FormatException.getFormatInstance();var n=e[0];if(n>e.length)throw FormatException.getFormatInstance();if(n===0)if(t<e.length)e[0]=e.length-t;else throw FormatException.getFormatInstance()},r.getBitCountForCodeword=function(e){for(var t=new Int32Array(8),n=0,i=t.length-1;!((e&1)!==n&&(n=e&1,i--,i<0));)t[i]++,e>>=1;return t},r.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},r.getCodewordBucketNumber_number=function(e){return r.getCodewordBucketNumber(r.getBitCountForCodeword(e))},r.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},r.toString=function(e){for(var t=new Formatter,n=0;n<e.length;n++){t.format("Row %2d: ",n);for(var i=0;i<e[n].length;i++){var s=e[n][i];s.getValue().length===0?t.format("        ",null):t.format("%4d(%2d)",s.getValue()[0],s.getConfidence(s.getValue()[0]))}t.format("%n")}return t.toString()},r.CODEWORD_SKEW_SIZE=2,r.MAX_ERRORS=3,r.MAX_EC_CODEWORDS=512,r.errorCorrection=new ErrorCorrection,r}(),__values$9=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},PDF417Reader=function(){function r(){}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var n=r.decode(e,t,!1);if(n==null||n.length===0||n[0]==null)throw NotFoundException.getNotFoundInstance();return n[0]},r.prototype.decodeMultiple=function(e,t){t===void 0&&(t=null);try{return r.decode(e,t,!0)}catch(n){throw n instanceof FormatException||n instanceof ChecksumException?NotFoundException.getNotFoundInstance():n}},r.decode=function(e,t,n){var i,s,a=new Array,o=Detector.detectMultiple(e,t,n);try{for(var c=__values$9(o.getPoints()),h=c.next();!h.done;h=c.next()){var f=h.value,m=PDF417ScanningDecoder.decode(o.getBits(),f[4],f[5],f[6],f[7],r.getMinCodewordWidth(f),r.getMaxCodewordWidth(f)),g=new Result(m.getText(),m.getRawBytes(),void 0,f,BarcodeFormat$1.PDF_417);g.putMetadata(ResultMetadataType$1.ERROR_CORRECTION_LEVEL,m.getECLevel());var _=m.getOther();_!=null&&g.putMetadata(ResultMetadataType$1.PDF417_EXTRA_METADATA,_),a.push(g)}}catch(E){i={error:E}}finally{try{h&&!h.done&&(s=c.return)&&s.call(c)}finally{if(i)throw i.error}}return a.map(function(E){return E})},r.getMaxWidth=function(e,t){return e==null||t==null?0:Math.trunc(Math.abs(e.getX()-t.getX()))},r.getMinWidth=function(e,t){return e==null||t==null?Integer.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))},r.getMaxCodewordWidth=function(e){return Math.floor(Math.max(Math.max(r.getMaxWidth(e[0],e[4]),r.getMaxWidth(e[6],e[2])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN),Math.max(r.getMaxWidth(e[1],e[5]),r.getMaxWidth(e[7],e[3])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN)))},r.getMinCodewordWidth=function(e){return Math.floor(Math.min(Math.min(r.getMinWidth(e[0],e[4]),r.getMinWidth(e[6],e[2])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN),Math.min(r.getMinWidth(e[1],e[5]),r.getMinWidth(e[7],e[3])*PDF417Common.MODULES_IN_CODEWORD/PDF417Common.MODULES_IN_STOP_PATTERN)))},r.prototype.reset=function(){},r}(),__extends$d=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ReaderException=function(r){__extends$d(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ReaderException",e}(Exception),__values$8=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},MultiFormatReader=function(){function r(){}return r.prototype.decode=function(e,t){return this.setHints(t),this.decodeInternal(e)},r.prototype.decodeWithState=function(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)},r.prototype.setHints=function(e){this.hints=e;var t=e!=null&&e.get(DecodeHintType$1.TRY_HARDER)!==void 0,n=e==null?null:e.get(DecodeHintType$1.POSSIBLE_FORMATS),i=new Array;if(n!=null){var s=n.some(function(a){return a===BarcodeFormat$1.UPC_A||a===BarcodeFormat$1.UPC_E||a===BarcodeFormat$1.EAN_13||a===BarcodeFormat$1.EAN_8||a===BarcodeFormat$1.CODABAR||a===BarcodeFormat$1.CODE_39||a===BarcodeFormat$1.CODE_93||a===BarcodeFormat$1.CODE_128||a===BarcodeFormat$1.ITF||a===BarcodeFormat$1.RSS_14||a===BarcodeFormat$1.RSS_EXPANDED});s&&!t&&i.push(new MultiFormatOneDReader(e)),n.includes(BarcodeFormat$1.QR_CODE)&&i.push(new QRCodeReader),n.includes(BarcodeFormat$1.DATA_MATRIX)&&i.push(new DataMatrixReader),n.includes(BarcodeFormat$1.AZTEC)&&i.push(new AztecReader),n.includes(BarcodeFormat$1.PDF_417)&&i.push(new PDF417Reader),s&&t&&i.push(new MultiFormatOneDReader(e))}i.length===0&&(t||i.push(new MultiFormatOneDReader(e)),i.push(new QRCodeReader),i.push(new DataMatrixReader),i.push(new AztecReader),i.push(new PDF417Reader),t&&i.push(new MultiFormatOneDReader(e))),this.readers=i},r.prototype.reset=function(){var e,t;if(this.readers!==null)try{for(var n=__values$8(this.readers),i=n.next();!i.done;i=n.next()){var s=i.value;s.reset()}}catch(a){e={error:a}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},r.prototype.decodeInternal=function(e){var t,n;if(this.readers===null)throw new ReaderException("No readers where selected, nothing can be read.");try{for(var i=__values$8(this.readers),s=i.next();!s.done;s=i.next()){var a=s.value;try{return a.decode(e,this.hints)}catch(o){if(o instanceof ReaderException)continue}}}catch(o){t={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}throw new NotFoundException("No MultiFormat Readers were able to detect the code.")},r}(),__extends$c=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),BrowserMultiFormatReader=function(r){__extends$c(e,r);function e(t,n){t===void 0&&(t=null),n===void 0&&(n=500);var i=this,s=new MultiFormatReader;return s.setHints(t),i=r.call(this,s,n)||this,i}return e.prototype.decodeBitmap=function(t){return this.reader.decodeWithState(t)},e}(BrowserCodeReader),__extends$b=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){__extends$b(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new PDF417Reader,t)||this}return e})(BrowserCodeReader);var __extends$a=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){__extends$a(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new QRCodeReader,t)||this}return e})(BrowserCodeReader);var EncodeHintType;(function(r){r[r.ERROR_CORRECTION=0]="ERROR_CORRECTION",r[r.CHARACTER_SET=1]="CHARACTER_SET",r[r.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",r[r.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",r[r.MIN_SIZE=4]="MIN_SIZE",r[r.MAX_SIZE=5]="MAX_SIZE",r[r.MARGIN=6]="MARGIN",r[r.PDF417_COMPACT=7]="PDF417_COMPACT",r[r.PDF417_COMPACTION=8]="PDF417_COMPACTION",r[r.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",r[r.AZTEC_LAYERS=10]="AZTEC_LAYERS",r[r.QR_VERSION=11]="QR_VERSION",r[r.GS1_FORMAT=12]="GS1_FORMAT",r[r.FORCE_C40=13]="FORCE_C40"})(EncodeHintType||(EncodeHintType={}));const EncodeHintType$1=EncodeHintType;var ReedSolomonEncoder=function(){function r(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new GenericGFPoly(e,Int32Array.from([1])))}return r.prototype.buildGenerator=function(e){var t=this.cachedGenerators;if(e>=t.length)for(var n=t[t.length-1],i=this.field,s=t.length;s<=e;s++){var a=n.multiply(new GenericGFPoly(i,Int32Array.from([1,i.exp(s-1+i.getGeneratorBase())])));t.push(a),n=a}return t[e]},r.prototype.encode=function(e,t){if(t===0)throw new IllegalArgumentException("No error correction bytes");var n=e.length-t;if(n<=0)throw new IllegalArgumentException("No data bytes provided");var i=this.buildGenerator(t),s=new Int32Array(n);System.arraycopy(e,0,s,0,n);var a=new GenericGFPoly(this.field,s);a=a.multiplyByMonomial(t,1);for(var o=a.divide(i)[1],c=o.getCoefficients(),h=t-c.length,f=0;f<h;f++)e[n+f]=0;System.arraycopy(c,0,e,n+h,c.length)},r}(),MaskUtil=function(){function r(){}return r.applyMaskPenaltyRule1=function(e){return r.applyMaskPenaltyRule1Internal(e,!0)+r.applyMaskPenaltyRule1Internal(e,!1)},r.applyMaskPenaltyRule2=function(e){for(var t=0,n=e.getArray(),i=e.getWidth(),s=e.getHeight(),a=0;a<s-1;a++)for(var o=n[a],c=0;c<i-1;c++){var h=o[c];h===o[c+1]&&h===n[a+1][c]&&h===n[a+1][c+1]&&t++}return r.N2*t},r.applyMaskPenaltyRule3=function(e){for(var t=0,n=e.getArray(),i=e.getWidth(),s=e.getHeight(),a=0;a<s;a++)for(var o=0;o<i;o++){var c=n[a];o+6<i&&c[o]===1&&c[o+1]===0&&c[o+2]===1&&c[o+3]===1&&c[o+4]===1&&c[o+5]===0&&c[o+6]===1&&(r.isWhiteHorizontal(c,o-4,o)||r.isWhiteHorizontal(c,o+7,o+11))&&t++,a+6<s&&n[a][o]===1&&n[a+1][o]===0&&n[a+2][o]===1&&n[a+3][o]===1&&n[a+4][o]===1&&n[a+5][o]===0&&n[a+6][o]===1&&(r.isWhiteVertical(n,o,a-4,a)||r.isWhiteVertical(n,o,a+7,a+11))&&t++}return t*r.N3},r.isWhiteHorizontal=function(e,t,n){t=Math.max(t,0),n=Math.min(n,e.length);for(var i=t;i<n;i++)if(e[i]===1)return!1;return!0},r.isWhiteVertical=function(e,t,n,i){n=Math.max(n,0),i=Math.min(i,e.length);for(var s=n;s<i;s++)if(e[s][t]===1)return!1;return!0},r.applyMaskPenaltyRule4=function(e){for(var t=0,n=e.getArray(),i=e.getWidth(),s=e.getHeight(),a=0;a<s;a++)for(var o=n[a],c=0;c<i;c++)o[c]===1&&t++;var h=e.getHeight()*e.getWidth(),f=Math.floor(Math.abs(t*2-h)*10/h);return f*r.N4},r.getDataMaskBit=function(e,t,n){var i,s;switch(e){case 0:i=n+t&1;break;case 1:i=n&1;break;case 2:i=t%3;break;case 3:i=(n+t)%3;break;case 4:i=Math.floor(n/2)+Math.floor(t/3)&1;break;case 5:s=n*t,i=(s&1)+s%3;break;case 6:s=n*t,i=(s&1)+s%3&1;break;case 7:s=n*t,i=s%3+(n+t&1)&1;break;default:throw new IllegalArgumentException("Invalid mask pattern: "+e)}return i===0},r.applyMaskPenaltyRule1Internal=function(e,t){for(var n=0,i=t?e.getHeight():e.getWidth(),s=t?e.getWidth():e.getHeight(),a=e.getArray(),o=0;o<i;o++){for(var c=0,h=-1,f=0;f<s;f++){var m=t?a[o][f]:a[f][o];m===h?c++:(c>=5&&(n+=r.N1+(c-5)),c=1,h=m)}c>=5&&(n+=r.N1+(c-5))}return n},r.N1=3,r.N2=3,r.N3=40,r.N4=10,r}(),__values$7=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ByteMatrix=function(){function r(e,t){this.width=e,this.height=t;for(var n=new Array(t),i=0;i!==t;i++)n[i]=new Uint8Array(e);this.bytes=n}return r.prototype.getHeight=function(){return this.height},r.prototype.getWidth=function(){return this.width},r.prototype.get=function(e,t){return this.bytes[t][e]},r.prototype.getArray=function(){return this.bytes},r.prototype.setNumber=function(e,t,n){this.bytes[t][e]=n},r.prototype.setBoolean=function(e,t,n){this.bytes[t][e]=n?1:0},r.prototype.clear=function(e){var t,n;try{for(var i=__values$7(this.bytes),s=i.next();!s.done;s=i.next()){var a=s.value;Arrays.fill(a,e)}}catch(o){t={error:o}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;if(this.width!==t.width||this.height!==t.height)return!1;for(var n=0,i=this.height;n<i;++n)for(var s=this.bytes[n],a=t.bytes[n],o=0,c=this.width;o<c;++o)if(s[o]!==a[o])return!1;return!0},r.prototype.toString=function(){for(var e=new StringBuilder,t=0,n=this.height;t<n;++t){for(var i=this.bytes[t],s=0,a=this.width;s<a;++s)switch(i[s]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()},r}(),QRCode=function(){function r(){this.maskPattern=-1}return r.prototype.getMode=function(){return this.mode},r.prototype.getECLevel=function(){return this.ecLevel},r.prototype.getVersion=function(){return this.version},r.prototype.getMaskPattern=function(){return this.maskPattern},r.prototype.getMatrix=function(){return this.matrix},r.prototype.toString=function(){var e=new StringBuilder;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()},r.prototype.setMode=function(e){this.mode=e},r.prototype.setECLevel=function(e){this.ecLevel=e},r.prototype.setVersion=function(e){this.version=e},r.prototype.setMaskPattern=function(e){this.maskPattern=e},r.prototype.setMatrix=function(e){this.matrix=e},r.isValidMaskPattern=function(e){return e>=0&&e<r.NUM_MASK_PATTERNS},r.NUM_MASK_PATTERNS=8,r}(),__extends$9=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),WriterException=function(r){__extends$9(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="WriterException",e}(Exception),MatrixUtil=function(){function r(){}return r.clearMatrix=function(e){e.clear(255)},r.buildMatrix=function(e,t,n,i,s){r.clearMatrix(s),r.embedBasicPatterns(n,s),r.embedTypeInfo(t,i,s),r.maybeEmbedVersionInfo(n,s),r.embedDataBits(e,i,s)},r.embedBasicPatterns=function(e,t){r.embedPositionDetectionPatternsAndSeparators(t),r.embedDarkDotAtLeftBottomCorner(t),r.maybeEmbedPositionAdjustmentPatterns(e,t),r.embedTimingPatterns(t)},r.embedTypeInfo=function(e,t,n){var i=new BitArray;r.makeTypeInfoBits(e,t,i);for(var s=0,a=i.getSize();s<a;++s){var o=i.get(i.getSize()-1-s),c=r.TYPE_INFO_COORDINATES[s],h=c[0],f=c[1];if(n.setBoolean(h,f,o),s<8){var m=n.getWidth()-s-1,g=8;n.setBoolean(m,g,o)}else{var m=8,g=n.getHeight()-7+(s-8);n.setBoolean(m,g,o)}}},r.maybeEmbedVersionInfo=function(e,t){if(!(e.getVersionNumber()<7)){var n=new BitArray;r.makeVersionInfoBits(e,n);for(var i=17,s=0;s<6;++s)for(var a=0;a<3;++a){var o=n.get(i);i--,t.setBoolean(s,t.getHeight()-11+a,o),t.setBoolean(t.getHeight()-11+a,s,o)}}},r.embedDataBits=function(e,t,n){for(var i=0,s=-1,a=n.getWidth()-1,o=n.getHeight()-1;a>0;){for(a===6&&(a-=1);o>=0&&o<n.getHeight();){for(var c=0;c<2;++c){var h=a-c;if(r.isEmpty(n.get(h,o))){var f=void 0;i<e.getSize()?(f=e.get(i),++i):f=!1,t!==255&&MaskUtil.getDataMaskBit(t,h,o)&&(f=!f),n.setBoolean(h,o,f)}}o+=s}s=-s,o+=s,a-=2}if(i!==e.getSize())throw new WriterException("Not all bits consumed: "+i+"/"+e.getSize())},r.findMSBSet=function(e){return 32-Integer.numberOfLeadingZeros(e)},r.calculateBCHCode=function(e,t){if(t===0)throw new IllegalArgumentException("0 polynomial");var n=r.findMSBSet(t);for(e<<=n-1;r.findMSBSet(e)>=n;)e^=t<<r.findMSBSet(e)-n;return e},r.makeTypeInfoBits=function(e,t,n){if(!QRCode.isValidMaskPattern(t))throw new WriterException("Invalid mask pattern");var i=e.getBits()<<3|t;n.appendBits(i,5);var s=r.calculateBCHCode(i,r.TYPE_INFO_POLY);n.appendBits(s,10);var a=new BitArray;if(a.appendBits(r.TYPE_INFO_MASK_PATTERN,15),n.xor(a),n.getSize()!==15)throw new WriterException("should not happen but we got: "+n.getSize())},r.makeVersionInfoBits=function(e,t){t.appendBits(e.getVersionNumber(),6);var n=r.calculateBCHCode(e.getVersionNumber(),r.VERSION_INFO_POLY);if(t.appendBits(n,12),t.getSize()!==18)throw new WriterException("should not happen but we got: "+t.getSize())},r.isEmpty=function(e){return e===255},r.embedTimingPatterns=function(e){for(var t=8;t<e.getWidth()-8;++t){var n=(t+1)%2;r.isEmpty(e.get(t,6))&&e.setNumber(t,6,n),r.isEmpty(e.get(6,t))&&e.setNumber(6,t,n)}},r.embedDarkDotAtLeftBottomCorner=function(e){if(e.get(8,e.getHeight()-8)===0)throw new WriterException;e.setNumber(8,e.getHeight()-8,1)},r.embedHorizontalSeparationPattern=function(e,t,n){for(var i=0;i<8;++i){if(!r.isEmpty(n.get(e+i,t)))throw new WriterException;n.setNumber(e+i,t,0)}},r.embedVerticalSeparationPattern=function(e,t,n){for(var i=0;i<7;++i){if(!r.isEmpty(n.get(e,t+i)))throw new WriterException;n.setNumber(e,t+i,0)}},r.embedPositionAdjustmentPattern=function(e,t,n){for(var i=0;i<5;++i)for(var s=r.POSITION_ADJUSTMENT_PATTERN[i],a=0;a<5;++a)n.setNumber(e+a,t+i,s[a])},r.embedPositionDetectionPattern=function(e,t,n){for(var i=0;i<7;++i)for(var s=r.POSITION_DETECTION_PATTERN[i],a=0;a<7;++a)n.setNumber(e+a,t+i,s[a])},r.embedPositionDetectionPatternsAndSeparators=function(e){var t=r.POSITION_DETECTION_PATTERN[0].length;r.embedPositionDetectionPattern(0,0,e),r.embedPositionDetectionPattern(e.getWidth()-t,0,e),r.embedPositionDetectionPattern(0,e.getWidth()-t,e);var n=8;r.embedHorizontalSeparationPattern(0,n-1,e),r.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),r.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);var i=7;r.embedVerticalSeparationPattern(i,0,e),r.embedVerticalSeparationPattern(e.getHeight()-i-1,0,e),r.embedVerticalSeparationPattern(i,e.getHeight()-i,e)},r.maybeEmbedPositionAdjustmentPatterns=function(e,t){if(!(e.getVersionNumber()<2))for(var n=e.getVersionNumber()-1,i=r.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n],s=0,a=i.length;s!==a;s++){var o=i[s];if(o>=0)for(var c=0;c!==a;c++){var h=i[c];h>=0&&r.isEmpty(t.get(h,o))&&r.embedPositionAdjustmentPattern(h-2,o-2,t)}}},r.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),r.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),r.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),r.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),r.VERSION_INFO_POLY=7973,r.TYPE_INFO_POLY=1335,r.TYPE_INFO_MASK_PATTERN=21522,r}(),BlockPair=function(){function r(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}return r.prototype.getDataBytes=function(){return this.dataBytes},r.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},r}(),__values$6=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function r(){}return r.calculateMaskPenalty=function(e){return MaskUtil.applyMaskPenaltyRule1(e)+MaskUtil.applyMaskPenaltyRule2(e)+MaskUtil.applyMaskPenaltyRule3(e)+MaskUtil.applyMaskPenaltyRule4(e)},r.encode=function(e,t,n){n===void 0&&(n=null);var i=r.DEFAULT_BYTE_MODE_ENCODING,s=n!==null&&n.get(EncodeHintType$1.CHARACTER_SET)!==void 0;s&&(i=n.get(EncodeHintType$1.CHARACTER_SET).toString());var a=this.chooseMode(e,i),o=new BitArray;if(a===Mode$2.BYTE&&(s||r.DEFAULT_BYTE_MODE_ENCODING!==i)){var c=CharacterSetECI.getCharacterSetECIByName(i);c!==void 0&&this.appendECI(c,o)}this.appendModeInfo(a,o);var h=new BitArray;this.appendBytes(e,a,h,i);var f;if(n!==null&&n.get(EncodeHintType$1.QR_VERSION)!==void 0){var m=Number.parseInt(n.get(EncodeHintType$1.QR_VERSION).toString(),10);f=Version.getVersionForNumber(m);var g=this.calculateBitsNeeded(a,o,h,f);if(!this.willFit(g,f,t))throw new WriterException("Data too big for requested version")}else f=this.recommendVersion(t,a,o,h);var _=new BitArray;_.appendBitArray(o);var E=a===Mode$2.BYTE?h.getSizeInBytes():e.length;this.appendLengthInfo(E,f,a,_),_.appendBitArray(h);var A=f.getECBlocksForLevel(t),C=f.getTotalCodewords()-A.getTotalECCodewords();this.terminateBits(C,_);var I=this.interleaveWithECBytes(_,f.getTotalCodewords(),C,A.getNumBlocks()),b=new QRCode;b.setECLevel(t),b.setMode(a),b.setVersion(f);var R=f.getDimensionForVersion(),V=new ByteMatrix(R,R),U=this.chooseMaskPattern(I,t,f,V);return b.setMaskPattern(U),MatrixUtil.buildMatrix(I,t,f,U,V),b.setMatrix(V),b},r.recommendVersion=function(e,t,n,i){var s=this.calculateBitsNeeded(t,n,i,Version.getVersionForNumber(1)),a=this.chooseVersion(s,e),o=this.calculateBitsNeeded(t,n,i,a);return this.chooseVersion(o,e)},r.calculateBitsNeeded=function(e,t,n,i){return t.getSize()+e.getCharacterCountBits(i)+n.getSize()},r.getAlphanumericCode=function(e){return e<r.ALPHANUMERIC_TABLE.length?r.ALPHANUMERIC_TABLE[e]:-1},r.chooseMode=function(e,t){if(t===void 0&&(t=null),CharacterSetECI.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return Mode$2.KANJI;for(var n=!1,i=!1,s=0,a=e.length;s<a;++s){var o=e.charAt(s);if(r.isDigit(o))n=!0;else if(this.getAlphanumericCode(o.charCodeAt(0))!==-1)i=!0;else return Mode$2.BYTE}return i?Mode$2.ALPHANUMERIC:n?Mode$2.NUMERIC:Mode$2.BYTE},r.isOnlyDoubleByteKanji=function(e){var t;try{t=StringEncoding.encode(e,CharacterSetECI.SJIS)}catch{return!1}var n=t.length;if(n%2!==0)return!1;for(var i=0;i<n;i+=2){var s=t[i]&255;if((s<129||s>159)&&(s<224||s>235))return!1}return!0},r.chooseMaskPattern=function(e,t,n,i){for(var s=Number.MAX_SAFE_INTEGER,a=-1,o=0;o<QRCode.NUM_MASK_PATTERNS;o++){MatrixUtil.buildMatrix(e,t,n,o,i);var c=this.calculateMaskPenalty(i);c<s&&(s=c,a=o)}return a},r.chooseVersion=function(e,t){for(var n=1;n<=40;n++){var i=Version.getVersionForNumber(n);if(r.willFit(e,i,t))return i}throw new WriterException("Data too big")},r.willFit=function(e,t,n){var i=t.getTotalCodewords(),s=t.getECBlocksForLevel(n),a=s.getTotalECCodewords(),o=i-a,c=(e+7)/8;return o>=c},r.terminateBits=function(e,t){var n=e*8;if(t.getSize()>n)throw new WriterException("data bits cannot fit in the QR Code"+t.getSize()+" > "+n);for(var i=0;i<4&&t.getSize()<n;++i)t.appendBit(!1);var s=t.getSize()&7;if(s>0)for(var i=s;i<8;i++)t.appendBit(!1);for(var a=e-t.getSizeInBytes(),i=0;i<a;++i)t.appendBits((i&1)===0?236:17,8);if(t.getSize()!==n)throw new WriterException("Bits size does not equal capacity")},r.getNumDataBytesAndNumECBytesForBlockID=function(e,t,n,i,s,a){if(i>=n)throw new WriterException("Block ID too large");var o=e%n,c=n-o,h=Math.floor(e/n),f=h+1,m=Math.floor(t/n),g=m+1,_=h-m,E=f-g;if(_!==E)throw new WriterException("EC bytes mismatch");if(n!==c+o)throw new WriterException("RS blocks mismatch");if(e!==(m+_)*c+(g+E)*o)throw new WriterException("Total bytes mismatch");i<c?(s[0]=m,a[0]=_):(s[0]=g,a[0]=E)},r.interleaveWithECBytes=function(e,t,n,i){var s,a,o,c;if(e.getSizeInBytes()!==n)throw new WriterException("Number of bits and data bytes does not match");for(var h=0,f=0,m=0,g=new Array,_=0;_<i;++_){var E=new Int32Array(1),A=new Int32Array(1);r.getNumDataBytesAndNumECBytesForBlockID(t,n,i,_,E,A);var C=E[0],I=new Uint8Array(C);e.toBytes(8*h,I,0,C);var b=r.generateECBytes(I,A[0]);g.push(new BlockPair(I,b)),f=Math.max(f,C),m=Math.max(m,b.length),h+=E[0]}if(n!==h)throw new WriterException("Data bytes does not match offset");for(var R=new BitArray,_=0;_<f;++_)try{for(var V=(s=void 0,__values$6(g)),U=V.next();!U.done;U=V.next()){var W=U.value,I=W.getDataBytes();_<I.length&&R.appendBits(I[_],8)}}catch(K){s={error:K}}finally{try{U&&!U.done&&(a=V.return)&&a.call(V)}finally{if(s)throw s.error}}for(var _=0;_<m;++_)try{for(var j=(o=void 0,__values$6(g)),w=j.next();!w.done;w=j.next()){var W=w.value,b=W.getErrorCorrectionBytes();_<b.length&&R.appendBits(b[_],8)}}catch(K){o={error:K}}finally{try{w&&!w.done&&(c=j.return)&&c.call(j)}finally{if(o)throw o.error}}if(t!==R.getSizeInBytes())throw new WriterException("Interleaving error: "+t+" and "+R.getSizeInBytes()+" differ.");return R},r.generateECBytes=function(e,t){for(var n=e.length,i=new Int32Array(n+t),s=0;s<n;s++)i[s]=e[s]&255;new ReedSolomonEncoder(GenericGF.QR_CODE_FIELD_256).encode(i,t);for(var a=new Uint8Array(t),s=0;s<t;s++)a[s]=i[n+s];return a},r.appendModeInfo=function(e,t){t.appendBits(e.getBits(),4)},r.appendLengthInfo=function(e,t,n,i){var s=n.getCharacterCountBits(t);if(e>=1<<s)throw new WriterException(e+" is bigger than "+((1<<s)-1));i.appendBits(e,s)},r.appendBytes=function(e,t,n,i){switch(t){case Mode$2.NUMERIC:r.appendNumericBytes(e,n);break;case Mode$2.ALPHANUMERIC:r.appendAlphanumericBytes(e,n);break;case Mode$2.BYTE:r.append8BitBytes(e,n,i);break;case Mode$2.KANJI:r.appendKanjiBytes(e,n);break;default:throw new WriterException("Invalid mode: "+t)}},r.getDigit=function(e){return e.charCodeAt(0)-48},r.isDigit=function(e){var t=r.getDigit(e);return t>=0&&t<=9},r.appendNumericBytes=function(e,t){for(var n=e.length,i=0;i<n;){var s=r.getDigit(e.charAt(i));if(i+2<n){var a=r.getDigit(e.charAt(i+1)),o=r.getDigit(e.charAt(i+2));t.appendBits(s*100+a*10+o,10),i+=3}else if(i+1<n){var a=r.getDigit(e.charAt(i+1));t.appendBits(s*10+a,7),i+=2}else t.appendBits(s,4),i++}},r.appendAlphanumericBytes=function(e,t){for(var n=e.length,i=0;i<n;){var s=r.getAlphanumericCode(e.charCodeAt(i));if(s===-1)throw new WriterException;if(i+1<n){var a=r.getAlphanumericCode(e.charCodeAt(i+1));if(a===-1)throw new WriterException;t.appendBits(s*45+a,11),i+=2}else t.appendBits(s,6),i++}},r.append8BitBytes=function(e,t,n){var i;try{i=StringEncoding.encode(e,n)}catch(c){throw new WriterException(c)}for(var s=0,a=i.length;s!==a;s++){var o=i[s];t.appendBits(o,8)}},r.appendKanjiBytes=function(e,t){var n;try{n=StringEncoding.encode(e,CharacterSetECI.SJIS)}catch(m){throw new WriterException(m)}for(var i=n.length,s=0;s<i;s+=2){var a=n[s]&255,o=n[s+1]&255,c=a<<8&4294967295|o,h=-1;if(c>=33088&&c<=40956?h=c-33088:c>=57408&&c<=60351&&(h=c-49472),h===-1)throw new WriterException("Invalid byte sequence");var f=(h>>8)*192+(h&255);t.appendBits(f,13)}},r.appendECI=function(e,t){t.appendBits(Mode$2.ECI.getBits(),4),t.appendBits(e.getValue(),8)},r.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),r.DEFAULT_BYTE_MODE_ENCODING=CharacterSetECI.UTF8.getName(),r})();var __extends$8=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){__extends$8(e,r);function e(t,n,i,s,a,o,c,h){var f=r.call(this,o,c)||this;if(f.yuvData=t,f.dataWidth=n,f.dataHeight=i,f.left=s,f.top=a,s+o>n||a+c>i)throw new IllegalArgumentException("Crop rectangle does not fit within image data.");return h&&f.reverseHorizontal(o,c),f}return e.prototype.getRow=function(t,n){if(t<0||t>=this.getHeight())throw new IllegalArgumentException("Requested row is outside the image: "+t);var i=this.getWidth();(n==null||n.length<i)&&(n=new Uint8ClampedArray(i));var s=(t+this.top)*this.dataWidth+this.left;return System.arraycopy(this.yuvData,s,n,0,i),n},e.prototype.getMatrix=function(){var t=this.getWidth(),n=this.getHeight();if(t===this.dataWidth&&n===this.dataHeight)return this.yuvData;var i=t*n,s=new Uint8ClampedArray(i),a=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return System.arraycopy(this.yuvData,a,s,0,i),s;for(var o=0;o<n;o++){var c=o*t;System.arraycopy(this.yuvData,a,s,c,t),a+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,n,i,s){return new e(this.yuvData,this.dataWidth,this.dataHeight,this.left+t,this.top+n,i,s,!1)},e.prototype.renderThumbnail=function(){for(var t=this.getWidth()/e.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/e.THUMBNAIL_SCALE_FACTOR,i=new Int32Array(t*n),s=this.yuvData,a=this.top*this.dataWidth+this.left,o=0;o<n;o++){for(var c=o*t,h=0;h<t;h++){var f=s[a+h*e.THUMBNAIL_SCALE_FACTOR]&255;i[c+h]=4278190080|f*65793}a+=this.dataWidth*e.THUMBNAIL_SCALE_FACTOR}return i},e.prototype.getThumbnailWidth=function(){return this.getWidth()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.getThumbnailHeight=function(){return this.getHeight()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.reverseHorizontal=function(t,n){for(var i=this.yuvData,s=0,a=this.top*this.dataWidth+this.left;s<n;s++,a+=this.dataWidth)for(var o=a+t/2,c=a,h=a+t-1;c<o;c++,h--){var f=i[c];i[c]=i[h],i[h]=f}},e.prototype.invert=function(){return new InvertedLuminanceSource(this)},e.THUMBNAIL_SCALE_FACTOR=2,e})(LuminanceSource);var __extends$7=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){__extends$7(e,r);function e(t,n,i,s,a,o,c){var h=r.call(this,n,i)||this;if(h.dataWidth=s,h.dataHeight=a,h.left=o,h.top=c,t.BYTES_PER_ELEMENT===4){for(var f=n*i,m=new Uint8ClampedArray(f),g=0;g<f;g++){var _=t[g],E=_>>16&255,A=_>>7&510,C=_&255;m[g]=(E+A+C)/4&255}h.luminances=m}else h.luminances=t;if(s===void 0&&(h.dataWidth=n),a===void 0&&(h.dataHeight=i),o===void 0&&(h.left=0),c===void 0&&(h.top=0),h.left+n>h.dataWidth||h.top+i>h.dataHeight)throw new IllegalArgumentException("Crop rectangle does not fit within image data.");return h}return e.prototype.getRow=function(t,n){if(t<0||t>=this.getHeight())throw new IllegalArgumentException("Requested row is outside the image: "+t);var i=this.getWidth();(n==null||n.length<i)&&(n=new Uint8ClampedArray(i));var s=(t+this.top)*this.dataWidth+this.left;return System.arraycopy(this.luminances,s,n,0,i),n},e.prototype.getMatrix=function(){var t=this.getWidth(),n=this.getHeight();if(t===this.dataWidth&&n===this.dataHeight)return this.luminances;var i=t*n,s=new Uint8ClampedArray(i),a=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return System.arraycopy(this.luminances,a,s,0,i),s;for(var o=0;o<n;o++){var c=o*t;System.arraycopy(this.luminances,a,s,c,t),a+=this.dataWidth}return s},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,n,i,s){return new e(this.luminances,i,s,this.dataWidth,this.dataHeight,this.left+t,this.top+n)},e.prototype.invert=function(){return new InvertedLuminanceSource(this)},e})(LuminanceSource);var __extends$6=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Charset=function(r){__extends$6(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.forName=function(t){return this.getCharacterSetECIByName(t)},e}(CharacterSetECI),StandardCharsets=function(){function r(){}return r.ISO_8859_1=CharacterSetECI.ISO8859_1,r}(),_a,MODULO_VALUE=301,static_LOG=function(r,e){for(var t=1,n=0;n<255;n++)e[n]=t,r[t]=n,t*=2,t>=256&&(t^=MODULO_VALUE);return{LOG:r,ALOG:e}};_a=static_LOG([],[]),_a.LOG;_a.ALOG;var SymbolShapeHint;(function(r){r[r.FORCE_NONE=0]="FORCE_NONE",r[r.FORCE_SQUARE=1]="FORCE_SQUARE",r[r.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(SymbolShapeHint||(SymbolShapeHint={}));var PAD=129,LATCH_TO_C40=230,LATCH_TO_BASE256=231,UPPER_SHIFT=235,MACRO_05=236,MACRO_06=237,LATCH_TO_ANSIX12=238,LATCH_TO_TEXT=239,LATCH_TO_EDIFACT=240,C40_UNLATCH=254,X12_UNLATCH=254,MACRO_05_HEADER="[)>05",MACRO_06_HEADER="[)>06",MACRO_TRAILER="",ASCII_ENCODATION=0,C40_ENCODATION=1,TEXT_ENCODATION=2,X12_ENCODATION=3,EDIFACT_ENCODATION=4,BASE256_ENCODATION=5,ASCIIEncoder=function(){function r(){}return r.prototype.getEncodingMode=function(){return ASCII_ENCODATION},r.prototype.encode=function(e){var t=HighLevelEncoder$1.determineConsecutiveDigitCount(e.getMessage(),e.pos);if(t>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var n=e.getCurrentChar(),i=HighLevelEncoder$1.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(i!==this.getEncodingMode())switch(i){case BASE256_ENCODATION:e.writeCodeword(LATCH_TO_BASE256),e.signalEncoderChange(BASE256_ENCODATION);return;case C40_ENCODATION:e.writeCodeword(LATCH_TO_C40),e.signalEncoderChange(C40_ENCODATION);return;case X12_ENCODATION:e.writeCodeword(LATCH_TO_ANSIX12),e.signalEncoderChange(X12_ENCODATION);break;case TEXT_ENCODATION:e.writeCodeword(LATCH_TO_TEXT),e.signalEncoderChange(TEXT_ENCODATION);break;case EDIFACT_ENCODATION:e.writeCodeword(LATCH_TO_EDIFACT),e.signalEncoderChange(EDIFACT_ENCODATION);break;default:throw new Error("Illegal mode: "+i)}else HighLevelEncoder$1.isExtendedASCII(n)?(e.writeCodeword(UPPER_SHIFT),e.writeCodeword(n-128+1),e.pos++):(e.writeCodeword(n+1),e.pos++)}},r.prototype.encodeASCIIDigits=function(e,t){if(HighLevelEncoder$1.isDigit(e)&&HighLevelEncoder$1.isDigit(t)){var n=(e-48)*10+(t-48);return n+130}throw new Error("not digits: "+e+t)},r}(),Base256Encoder=function(){function r(){}return r.prototype.getEncodingMode=function(){return BASE256_ENCODATION},r.prototype.encode=function(e){var t=new StringBuilder;for(t.append(0);e.hasMoreCharacters();){var n=e.getCurrentChar();t.append(n),e.pos++;var i=HighLevelEncoder$1.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(i!==this.getEncodingMode()){e.signalEncoderChange(ASCII_ENCODATION);break}}var s=t.length()-1,a=1,o=e.getCodewordCount()+s+a;e.updateSymbolInfo(o);var c=e.getSymbolInfo().getDataCapacity()-o>0;if(e.hasMoreCharacters()||c)if(s<=249)t.setCharAt(0,StringUtils.getCharAt(s));else if(s<=1555)t.setCharAt(0,StringUtils.getCharAt(Math.floor(s/250)+249)),t.insert(1,StringUtils.getCharAt(s%250));else throw new Error("Message length not in valid ranges: "+s);for(var h=0,n=t.length();h<n;h++)e.writeCodeword(this.randomize255State(t.charAt(h).charCodeAt(0),e.getCodewordCount()+1))},r.prototype.randomize255State=function(e,t){var n=149*t%255+1,i=e+n;return i<=255?i:i-256},r}(),C40Encoder=function(){function r(){}return r.prototype.getEncodingMode=function(){return C40_ENCODATION},r.prototype.encodeMaximal=function(e){for(var t=new StringBuilder,n=0,i=e.pos,s=0;e.hasMoreCharacters();){var a=e.getCurrentChar();e.pos++,n=this.encodeChar(a,t),t.length()%3===0&&(i=e.pos,s=t.length())}if(s!==t.length()){var o=Math.floor(t.length()/3*2),c=Math.floor(e.getCodewordCount()+o+1);e.updateSymbolInfo(c);var h=e.getSymbolInfo().getDataCapacity()-c,f=Math.floor(t.length()%3);(f===2&&h!==2||f===1&&(n>3||h!==1))&&(e.pos=i)}t.length()>0&&e.writeCodeword(LATCH_TO_C40),this.handleEOD(e,t)},r.prototype.encode=function(e){for(var t=new StringBuilder;e.hasMoreCharacters();){var n=e.getCurrentChar();e.pos++;var i=this.encodeChar(n,t),s=Math.floor(t.length()/3)*2,a=e.getCodewordCount()+s;e.updateSymbolInfo(a);var o=e.getSymbolInfo().getDataCapacity()-a;if(!e.hasMoreCharacters()){var c=new StringBuilder;for(t.length()%3===2&&o!==2&&(i=this.backtrackOneCharacter(e,t,c,i));t.length()%3===1&&(i>3||o!==1);)i=this.backtrackOneCharacter(e,t,c,i);break}var h=t.length();if(h%3===0){var f=HighLevelEncoder$1.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(f!==this.getEncodingMode()){e.signalEncoderChange(ASCII_ENCODATION);break}}}this.handleEOD(e,t)},r.prototype.backtrackOneCharacter=function(e,t,n,i){var s=t.length(),a=t.toString().substring(0,s-i);t.setLengthToZero(),t.append(a),e.pos--;var o=e.getCurrentChar();return i=this.encodeChar(o,n),e.resetSymbolInfo(),i},r.prototype.writeNextTriplet=function(e,t){e.writeCodewords(this.encodeToCodewords(t.toString()));var n=t.toString().substring(3);t.setLengthToZero(),t.append(n)},r.prototype.handleEOD=function(e,t){var n=Math.floor(t.length()/3*2),i=t.length()%3,s=e.getCodewordCount()+n;e.updateSymbolInfo(s);var a=e.getSymbolInfo().getDataCapacity()-s;if(i===2){for(t.append("\0");t.length()>=3;)this.writeNextTriplet(e,t);e.hasMoreCharacters()&&e.writeCodeword(C40_UNLATCH)}else if(a===1&&i===1){for(;t.length()>=3;)this.writeNextTriplet(e,t);e.hasMoreCharacters()&&e.writeCodeword(C40_UNLATCH),e.pos--}else if(i===0){for(;t.length()>=3;)this.writeNextTriplet(e,t);(a>0||e.hasMoreCharacters())&&e.writeCodeword(C40_UNLATCH)}else throw new Error("Unexpected case. Please report!");e.signalEncoderChange(ASCII_ENCODATION)},r.prototype.encodeChar=function(e,t){if(e===32)return t.append(3),1;if(e>=48&&e<=57)return t.append(e-48+4),1;if(e>=65&&e<=90)return t.append(e-65+14),1;if(e<32)return t.append(0),t.append(e),2;if(e<=47)return t.append(1),t.append(e-33),2;if(e<=64)return t.append(1),t.append(e-58+15),2;if(e<=95)return t.append(1),t.append(e-91+22),2;if(e<=127)return t.append(2),t.append(e-96),2;t.append("1");var n=2;return n+=this.encodeChar(e-128,t),n},r.prototype.encodeToCodewords=function(e){var t=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,n=t/256,i=t%256,s=new StringBuilder;return s.append(n),s.append(i),s.toString()},r}(),EdifactEncoder=function(){function r(){}return r.prototype.getEncodingMode=function(){return EDIFACT_ENCODATION},r.prototype.encode=function(e){for(var t=new StringBuilder;e.hasMoreCharacters();){var n=e.getCurrentChar();this.encodeChar(n,t),e.pos++;var i=t.length();if(i>=4){e.writeCodewords(this.encodeToCodewords(t.toString()));var s=t.toString().substring(4);t.setLengthToZero(),t.append(s);var a=HighLevelEncoder$1.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode()){e.signalEncoderChange(ASCII_ENCODATION);break}}}t.append(StringUtils.getCharAt(31)),this.handleEOD(e,t)},r.prototype.handleEOD=function(e,t){try{var n=t.length();if(n===0)return;if(n===1){e.updateSymbolInfo();var i=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),s=e.getRemainingCharacters();if(s>i&&(e.updateSymbolInfo(e.getCodewordCount()+1),i=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),s<=i&&i<=2)return}if(n>4)throw new Error("Count must not exceed 4");var a=n-1,o=this.encodeToCodewords(t.toString()),c=!e.hasMoreCharacters(),h=c&&a<=2;if(a<=2){e.updateSymbolInfo(e.getCodewordCount()+a);var i=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount();i>=3&&(h=!1,e.updateSymbolInfo(e.getCodewordCount()+o.length))}h?(e.resetSymbolInfo(),e.pos-=a):e.writeCodewords(o)}finally{e.signalEncoderChange(ASCII_ENCODATION)}},r.prototype.encodeChar=function(e,t){e>=32&&e<=63?t.append(e):e>=64&&e<=94?t.append(StringUtils.getCharAt(e-64)):HighLevelEncoder$1.illegalCharacter(StringUtils.getCharAt(e))},r.prototype.encodeToCodewords=function(e){var t=e.length;if(t===0)throw new Error("StringBuilder must not be empty");var n=e.charAt(0).charCodeAt(0),i=t>=2?e.charAt(1).charCodeAt(0):0,s=t>=3?e.charAt(2).charCodeAt(0):0,a=t>=4?e.charAt(3).charCodeAt(0):0,o=(n<<18)+(i<<12)+(s<<6)+a,c=o>>16&255,h=o>>8&255,f=o&255,m=new StringBuilder;return m.append(c),t>=2&&m.append(h),t>=3&&m.append(f),m.toString()},r}(),__extends$5=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__values$5=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},SymbolInfo=function(){function r(e,t,n,i,s,a,o,c){o===void 0&&(o=0),c===void 0&&(c=0),this.rectangular=e,this.dataCapacity=t,this.errorCodewords=n,this.matrixWidth=i,this.matrixHeight=s,this.dataRegions=a,this.rsBlockData=o,this.rsBlockError=c}return r.lookup=function(e,t,n,i,s){var a,o;t===void 0&&(t=0),n===void 0&&(n=null),i===void 0&&(i=null),s===void 0&&(s=!0);try{for(var c=__values$5(PROD_SYMBOLS),h=c.next();!h.done;h=c.next()){var f=h.value;if(!(t===1&&f.rectangular)&&!(t===2&&!f.rectangular)&&!(n!=null&&(f.getSymbolWidth()<n.getWidth()||f.getSymbolHeight()<n.getHeight()))&&!(i!=null&&(f.getSymbolWidth()>i.getWidth()||f.getSymbolHeight()>i.getHeight()))&&e<=f.dataCapacity)return f}}catch(m){a={error:m}}finally{try{h&&!h.done&&(o=c.return)&&o.call(c)}finally{if(a)throw a.error}}if(s)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},r.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},r.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},r.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},r.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},r.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},r.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},r.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},r.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},r.prototype.getDataCapacity=function(){return this.dataCapacity},r.prototype.getErrorCodewords=function(){return this.errorCodewords},r.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},r.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},r}(),DataMatrixSymbolInfo144=function(r){__extends$5(e,r);function e(){return r.call(this,!1,1558,620,22,22,36,-1,62)||this}return e.prototype.getInterleavedBlockCount=function(){return 10},e.prototype.getDataLengthForInterleavedBlock=function(t){return t<=8?156:155},e}(SymbolInfo),PROD_SYMBOLS=[new SymbolInfo(!1,3,5,8,8,1),new SymbolInfo(!1,5,7,10,10,1),new SymbolInfo(!0,5,7,16,6,1),new SymbolInfo(!1,8,10,12,12,1),new SymbolInfo(!0,10,11,14,6,2),new SymbolInfo(!1,12,12,14,14,1),new SymbolInfo(!0,16,14,24,10,1),new SymbolInfo(!1,18,14,16,16,1),new SymbolInfo(!1,22,18,18,18,1),new SymbolInfo(!0,22,18,16,10,2),new SymbolInfo(!1,30,20,20,20,1),new SymbolInfo(!0,32,24,16,14,2),new SymbolInfo(!1,36,24,22,22,1),new SymbolInfo(!1,44,28,24,24,1),new SymbolInfo(!0,49,28,22,14,2),new SymbolInfo(!1,62,36,14,14,4),new SymbolInfo(!1,86,42,16,16,4),new SymbolInfo(!1,114,48,18,18,4),new SymbolInfo(!1,144,56,20,20,4),new SymbolInfo(!1,174,68,22,22,4),new SymbolInfo(!1,204,84,24,24,4,102,42),new SymbolInfo(!1,280,112,14,14,16,140,56),new SymbolInfo(!1,368,144,16,16,16,92,36),new SymbolInfo(!1,456,192,18,18,16,114,48),new SymbolInfo(!1,576,224,20,20,16,144,56),new SymbolInfo(!1,696,272,22,22,16,174,68),new SymbolInfo(!1,816,336,24,24,16,136,56),new SymbolInfo(!1,1050,408,18,18,36,175,68),new SymbolInfo(!1,1304,496,20,20,36,163,62),new DataMatrixSymbolInfo144],EncoderContext=function(){function r(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var t=e.split("").map(function(o){return o.charCodeAt(0)}),n=new StringBuilder,i=0,s=t.length;i<s;i++){var a=String.fromCharCode(t[i]&255);if(a==="?"&&e.charAt(i)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(a)}this.msg=n.toString(),this.shape=0,this.codewords=new StringBuilder,this.newEncoding=-1}return r.prototype.setSymbolShape=function(e){this.shape=e},r.prototype.setSizeConstraints=function(e,t){this.minSize=e,this.maxSize=t},r.prototype.getMessage=function(){return this.msg},r.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},r.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},r.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},r.prototype.getCodewords=function(){return this.codewords},r.prototype.writeCodewords=function(e){this.codewords.append(e)},r.prototype.writeCodeword=function(e){this.codewords.append(e)},r.prototype.getCodewordCount=function(){return this.codewords.length()},r.prototype.getNewEncoding=function(){return this.newEncoding},r.prototype.signalEncoderChange=function(e){this.newEncoding=e},r.prototype.resetEncoderSignal=function(){this.newEncoding=-1},r.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},r.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},r.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},r.prototype.getSymbolInfo=function(){return this.symbolInfo},r.prototype.updateSymbolInfo=function(e){e===void 0&&(e=this.getCodewordCount()),(this.symbolInfo==null||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=SymbolInfo.lookup(e,this.shape,this.minSize,this.maxSize,!0))},r.prototype.resetSymbolInfo=function(){this.symbolInfo=null},r}(),__extends$4=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),X12Encoder=function(r){__extends$4(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return X12_ENCODATION},e.prototype.encode=function(t){for(var n=new StringBuilder;t.hasMoreCharacters();){var i=t.getCurrentChar();t.pos++,this.encodeChar(i,n);var s=n.length();if(s%3===0){this.writeNextTriplet(t,n);var a=HighLevelEncoder$1.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode());if(a!==this.getEncodingMode()){t.signalEncoderChange(ASCII_ENCODATION);break}}}this.handleEOD(t,n)},e.prototype.encodeChar=function(t,n){switch(t){case 13:n.append(0);break;case 42:n.append(1);break;case 62:n.append(2);break;case 32:n.append(3);break;default:t>=48&&t<=57?n.append(t-48+4):t>=65&&t<=90?n.append(t-65+14):HighLevelEncoder$1.illegalCharacter(StringUtils.getCharAt(t));break}return 1},e.prototype.handleEOD=function(t,n){t.updateSymbolInfo();var i=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount(),s=n.length();t.pos-=s,(t.getRemainingCharacters()>1||i>1||t.getRemainingCharacters()!==i)&&t.writeCodeword(X12_UNLATCH),t.getNewEncoding()<0&&t.signalEncoderChange(ASCII_ENCODATION)},e}(C40Encoder),__extends$3=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),TextEncoder$1=function(r){__extends$3(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return TEXT_ENCODATION},e.prototype.encodeChar=function(t,n){if(t===32)return n.append(3),1;if(t>=48&&t<=57)return n.append(t-48+4),1;if(t>=97&&t<=122)return n.append(t-97+14),1;if(t<32)return n.append(0),n.append(t),2;if(t<=47)return n.append(1),n.append(t-33),2;if(t<=64)return n.append(1),n.append(t-58+15),2;if(t>=91&&t<=95)return n.append(1),n.append(t-91+22),2;if(t===96)return n.append(2),n.append(0),2;if(t<=90)return n.append(2),n.append(t-65+1),2;if(t<=127)return n.append(2),n.append(t-123+27),2;n.append("1");var i=2;return i+=this.encodeChar(t-128,n),i},e}(C40Encoder),HighLevelEncoder$1=function(){function r(){}return r.randomize253State=function(e){var t=149*e%253+1,n=PAD+t;return n<=254?n:n-254},r.encodeHighLevel=function(e,t,n,i,s){t===void 0&&(t=0),n===void 0&&(n=null),i===void 0&&(i=null),s===void 0&&(s=!1);var a=new C40Encoder,o=[new ASCIIEncoder,a,new TextEncoder$1,new X12Encoder,new EdifactEncoder,new Base256Encoder],c=new EncoderContext(e);c.setSymbolShape(t),c.setSizeConstraints(n,i),e.startsWith(MACRO_05_HEADER)&&e.endsWith(MACRO_TRAILER)?(c.writeCodeword(MACRO_05),c.setSkipAtEnd(2),c.pos+=MACRO_05_HEADER.length):e.startsWith(MACRO_06_HEADER)&&e.endsWith(MACRO_TRAILER)&&(c.writeCodeword(MACRO_06),c.setSkipAtEnd(2),c.pos+=MACRO_06_HEADER.length);var h=ASCII_ENCODATION;for(s&&(a.encodeMaximal(c),h=c.getNewEncoding(),c.resetEncoderSignal());c.hasMoreCharacters();)o[h].encode(c),c.getNewEncoding()>=0&&(h=c.getNewEncoding(),c.resetEncoderSignal());var f=c.getCodewordCount();c.updateSymbolInfo();var m=c.getSymbolInfo().getDataCapacity();f<m&&h!==ASCII_ENCODATION&&h!==BASE256_ENCODATION&&h!==EDIFACT_ENCODATION&&c.writeCodeword("þ");var g=c.getCodewords();for(g.length()<m&&g.append(PAD);g.length()<m;)g.append(this.randomize253State(g.length()+1));return c.getCodewords().toString()},r.lookAheadTest=function(e,t,n){var i=this.lookAheadTestIntern(e,t,n);if(n===X12_ENCODATION&&i===X12_ENCODATION){for(var s=Math.min(t+3,e.length),a=t;a<s;a++)if(!this.isNativeX12(e.charCodeAt(a)))return ASCII_ENCODATION}else if(n===EDIFACT_ENCODATION&&i===EDIFACT_ENCODATION){for(var s=Math.min(t+4,e.length),a=t;a<s;a++)if(!this.isNativeEDIFACT(e.charCodeAt(a)))return ASCII_ENCODATION}return i},r.lookAheadTestIntern=function(e,t,n){if(t>=e.length)return n;var i;n===ASCII_ENCODATION?i=[0,1,1,1,1,1.25]:(i=[1,2,2,2,2,2.25],i[n]=0);for(var s=0,a=new Uint8Array(6),o=[];;){if(t+s===e.length){Arrays.fill(a,0),Arrays.fill(o,0);var c=this.findMinimums(i,o,Integer.MAX_VALUE,a),h=this.getMinimumCount(a);if(o[ASCII_ENCODATION]===c)return ASCII_ENCODATION;if(h===1){if(a[BASE256_ENCODATION]>0)return BASE256_ENCODATION;if(a[EDIFACT_ENCODATION]>0)return EDIFACT_ENCODATION;if(a[TEXT_ENCODATION]>0)return TEXT_ENCODATION;if(a[X12_ENCODATION]>0)return X12_ENCODATION}return C40_ENCODATION}var f=e.charCodeAt(t+s);if(s++,this.isDigit(f)?i[ASCII_ENCODATION]+=.5:this.isExtendedASCII(f)?(i[ASCII_ENCODATION]=Math.ceil(i[ASCII_ENCODATION]),i[ASCII_ENCODATION]+=2):(i[ASCII_ENCODATION]=Math.ceil(i[ASCII_ENCODATION]),i[ASCII_ENCODATION]++),this.isNativeC40(f)?i[C40_ENCODATION]+=2/3:this.isExtendedASCII(f)?i[C40_ENCODATION]+=8/3:i[C40_ENCODATION]+=4/3,this.isNativeText(f)?i[TEXT_ENCODATION]+=2/3:this.isExtendedASCII(f)?i[TEXT_ENCODATION]+=8/3:i[TEXT_ENCODATION]+=4/3,this.isNativeX12(f)?i[X12_ENCODATION]+=2/3:this.isExtendedASCII(f)?i[X12_ENCODATION]+=13/3:i[X12_ENCODATION]+=10/3,this.isNativeEDIFACT(f)?i[EDIFACT_ENCODATION]+=3/4:this.isExtendedASCII(f)?i[EDIFACT_ENCODATION]+=17/4:i[EDIFACT_ENCODATION]+=13/4,this.isSpecialB256(f)?i[BASE256_ENCODATION]+=4:i[BASE256_ENCODATION]++,s>=4){if(Arrays.fill(a,0),Arrays.fill(o,0),this.findMinimums(i,o,Integer.MAX_VALUE,a),o[ASCII_ENCODATION]<this.min(o[BASE256_ENCODATION],o[C40_ENCODATION],o[TEXT_ENCODATION],o[X12_ENCODATION],o[EDIFACT_ENCODATION]))return ASCII_ENCODATION;if(o[BASE256_ENCODATION]<o[ASCII_ENCODATION]||o[BASE256_ENCODATION]+1<this.min(o[C40_ENCODATION],o[TEXT_ENCODATION],o[X12_ENCODATION],o[EDIFACT_ENCODATION]))return BASE256_ENCODATION;if(o[EDIFACT_ENCODATION]+1<this.min(o[BASE256_ENCODATION],o[C40_ENCODATION],o[TEXT_ENCODATION],o[X12_ENCODATION],o[ASCII_ENCODATION]))return EDIFACT_ENCODATION;if(o[TEXT_ENCODATION]+1<this.min(o[BASE256_ENCODATION],o[C40_ENCODATION],o[EDIFACT_ENCODATION],o[X12_ENCODATION],o[ASCII_ENCODATION]))return TEXT_ENCODATION;if(o[X12_ENCODATION]+1<this.min(o[BASE256_ENCODATION],o[C40_ENCODATION],o[EDIFACT_ENCODATION],o[TEXT_ENCODATION],o[ASCII_ENCODATION]))return X12_ENCODATION;if(o[C40_ENCODATION]+1<this.min(o[ASCII_ENCODATION],o[BASE256_ENCODATION],o[EDIFACT_ENCODATION],o[TEXT_ENCODATION])){if(o[C40_ENCODATION]<o[X12_ENCODATION])return C40_ENCODATION;if(o[C40_ENCODATION]===o[X12_ENCODATION]){for(var m=t+s+1;m<e.length;){var g=e.charCodeAt(m);if(this.isX12TermSep(g))return X12_ENCODATION;if(!this.isNativeX12(g))break;m++}return C40_ENCODATION}}}}},r.min=function(e,t,n,i,s){var a=Math.min(e,Math.min(t,Math.min(n,i)));return s===void 0?a:Math.min(a,s)},r.findMinimums=function(e,t,n,i){for(var s=0;s<6;s++){var a=t[s]=Math.ceil(e[s]);n>a&&(n=a,Arrays.fill(i,0)),n===a&&(i[s]=i[s]+1)}return n},r.getMinimumCount=function(e){for(var t=0,n=0;n<6;n++)t+=e[n];return t||0},r.isDigit=function(e){return e>=48&&e<=57},r.isExtendedASCII=function(e){return e>=128&&e<=255},r.isNativeC40=function(e){return e===32||e>=48&&e<=57||e>=65&&e<=90},r.isNativeText=function(e){return e===32||e>=48&&e<=57||e>=97&&e<=122},r.isNativeX12=function(e){return this.isX12TermSep(e)||e===32||e>=48&&e<=57||e>=65&&e<=90},r.isX12TermSep=function(e){return e===13||e===42||e===62},r.isNativeEDIFACT=function(e){return e>=32&&e<=94},r.isSpecialB256=function(e){return!1},r.determineConsecutiveDigitCount=function(e,t){t===void 0&&(t=0);for(var n=e.length,i=t;i<n&&this.isDigit(e.charCodeAt(i));)i++;return i-t},r.illegalCharacter=function(e){var t=Integer.toHexString(e.charCodeAt(0));throw t="0000".substring(0,4-t.length)+t,new Error("Illegal character: "+e+" (0x"+t+")")},r}(),__values$4=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},CharsetEncoder=function(){function r(e){this.charset=e,this.name=e.name}return r.prototype.canEncode=function(e){try{return StringEncoding.encode(e,this.charset)!=null}catch{return!1}},r}(),ECIEncoderSet=function(){function r(e,t,n){var i,s,a,o,c,h;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(P){return new CharsetEncoder(Charset.forName(P))}),this.encoders=[];var f=[];f.push(new CharsetEncoder(StandardCharsets.ISO_8859_1));for(var m=t!=null&&t.name.startsWith("UTF"),g=0;g<e.length;g++){var _=!1;try{for(var E=(i=void 0,__values$4(f)),A=E.next();!A.done;A=E.next()){var C=A.value,I=e.charAt(g),b=I.charCodeAt(0);if(b===n||C.canEncode(I)){_=!0;break}}}catch(P){i={error:P}}finally{try{A&&!A.done&&(s=E.return)&&s.call(E)}finally{if(i)throw i.error}}if(!_)try{for(var R=(a=void 0,__values$4(this.ENCODERS)),V=R.next();!V.done;V=R.next()){var C=V.value;if(C.canEncode(e.charAt(g))){f.push(C),_=!0;break}}}catch(P){a={error:P}}finally{try{V&&!V.done&&(o=R.return)&&o.call(R)}finally{if(a)throw a.error}}_||(m=!0)}if(f.length===1&&!m)this.encoders=[f[0]];else{this.encoders=[];var U=0;try{for(var W=__values$4(f),j=W.next();!j.done;j=W.next()){var C=j.value;this.encoders[U++]=C}}catch(P){c={error:P}}finally{try{j&&!j.done&&(h=W.return)&&h.call(W)}finally{if(c)throw c.error}}}var w=-1;if(t!=null){for(var g=0;g<this.encoders.length;g++)if(this.encoders[g]!=null&&t.name===this.encoders[g].name){w=g;break}}this.priorityEncoderIndex=w}return r.prototype.length=function(){return this.encoders.length},r.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},r.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},r.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},r.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},r.prototype.canEncode=function(e,t){if(!(t<this.length()))throw new Error("index must be less than length");return!0},r.prototype.encode=function(e,t){if(!(t<this.length()))throw new Error("index must be less than length");return StringEncoding.encode(StringUtils.getCharAt(e),this.encoders[t].name)},r}(),COST_PER_ECI=3,MinimalECIInput=function(){function r(e,t,n){this.fnc1=n;var i=new ECIEncoderSet(e,t,n);if(i.length()===1)for(var s=0;s<this.bytes.length;s++){var a=e.charAt(s).charCodeAt(0);this.bytes[s]=a===n?1e3:a}else this.bytes=this.encodeMinimally(e,i,n)}return r.prototype.getFNC1Character=function(){return this.fnc1},r.prototype.length=function(){return this.bytes.length},r.prototype.haveNCharacters=function(e,t){if(e+t-1>=this.bytes.length)return!1;for(var n=0;n<t;n++)if(this.isECI(e+n))return!1;return!0},r.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},r.prototype.subSequence=function(e,t){if(e<0||e>t||t>this.length())throw new Error(""+e);for(var n=new StringBuilder,i=e;i<t;i++){if(this.isECI(i))throw new Error("value at "+i+" is not a character but an ECI");n.append(this.charAt(i))}return n.toString()},r.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},r.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]===1e3},r.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},r.prototype.addEdge=function(e,t,n){(e[t][n.encoderIndex]==null||e[t][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(e[t][n.encoderIndex]=n)},r.prototype.addEdges=function(e,t,n,i,s,a){var o=e.charAt(i).charCodeAt(0),c=0,h=t.length();t.getPriorityEncoderIndex()>=0&&(o===a||t.canEncode(o,t.getPriorityEncoderIndex()))&&(c=t.getPriorityEncoderIndex(),h=c+1);for(var f=c;f<h;f++)(o===a||t.canEncode(o,f))&&this.addEdge(n,i+1,new InputEdge(o,t,f,s,a))},r.prototype.encodeMinimally=function(e,t,n){var i=e.length,s=new InputEdge[i+1][t.length()];this.addEdges(e,t,s,0,null,n);for(var a=1;a<=i;a++){for(var o=0;o<t.length();o++)s[a][o]!=null&&a<i&&this.addEdges(e,t,s,a,s[a][o],n);for(var o=0;o<t.length();o++)s[a-1][o]=null}for(var c=-1,h=Integer.MAX_VALUE,o=0;o<t.length();o++)if(s[i][o]!=null){var f=s[i][o];f.cachedTotalSize<h&&(h=f.cachedTotalSize,c=o)}if(c<0)throw new Error('Failed to encode "'+e+'"');for(var m=[],g=s[i][c];g!=null;){if(g.isFNC1())m.unshift(1e3);else for(var _=t.encode(g.c,g.encoderIndex),a=_.length-1;a>=0;a--)m.unshift(_[a]&255);var E=g.previous===null?0:g.previous.encoderIndex;E!==g.encoderIndex&&m.unshift(256+t.getECIValue(g.encoderIndex)),g=g.previous}for(var A=[],a=0;a<A.length;a++)A[a]=m[a];return A},r}(),InputEdge=function(){function r(e,t,n,i,s){this.c=e,this.encoderSet=t,this.encoderIndex=n,this.previous=i,this.fnc1=s,this.c=e===s?1e3:e;var a=this.isFNC1()?1:t.encode(e,n).length,o=i===null?0:i.encoderIndex;o!==n&&(a+=COST_PER_ECI),i!=null&&(a+=i.cachedTotalSize),this.cachedTotalSize=a}return r.prototype.isFNC1=function(){return this.c===1e3},r}(),__extends$2=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),__read=function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s},Mode;(function(r){r[r.ASCII=0]="ASCII",r[r.C40=1]="C40",r[r.TEXT=2]="TEXT",r[r.X12=3]="X12",r[r.EDF=4]="EDF",r[r.B256=5]="B256"})(Mode||(Mode={}));(function(r){__extends$2(e,r);function e(t,n,i,s,a){var o=r.call(this,t,n,i)||this;return o.shape=s,o.macroId=a,o}return e.prototype.getMacroId=function(){return this.macroId},e.prototype.getShapeHint=function(){return this.shape},e})(MinimalECIInput);var AztecCode=function(){function r(){}return r.prototype.isCompact=function(){return this.compact},r.prototype.setCompact=function(e){this.compact=e},r.prototype.getSize=function(){return this.size},r.prototype.setSize=function(e){this.size=e},r.prototype.getLayers=function(){return this.layers},r.prototype.setLayers=function(e){this.layers=e},r.prototype.getCodeWords=function(){return this.codeWords},r.prototype.setCodeWords=function(e){this.codeWords=e},r.prototype.getMatrix=function(){return this.matrix},r.prototype.setMatrix=function(e){this.matrix=e},r}(),Collections=function(){function r(){}return r.singletonList=function(e){return[e]},r.min=function(e,t){return e.sort(t)[0]},r}(),Token=function(){function r(e){this.previous=e}return r.prototype.getPrevious=function(){return this.previous},r}(),__extends$1=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),SimpleToken=function(r){__extends$1(e,r);function e(t,n,i){var s=r.call(this,t)||this;return s.value=n,s.bitCount=i,s}return e.prototype.appendTo=function(t,n){t.appendBits(this.value,this.bitCount)},e.prototype.add=function(t,n){return new e(this,t,n)},e.prototype.addBinaryShift=function(t,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new e(this,t,n)},e.prototype.toString=function(){var t=this.value&(1<<this.bitCount)-1;return t|=1<<this.bitCount,"<"+Integer.toBinaryString(t|1<<this.bitCount).substring(1)+">"},e}(Token),__extends=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)i.hasOwnProperty(s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),BinaryShiftToken=function(r){__extends(e,r);function e(t,n,i){var s=r.call(this,t,0,0)||this;return s.binaryShiftStart=n,s.binaryShiftByteCount=i,s}return e.prototype.appendTo=function(t,n){for(var i=0;i<this.binaryShiftByteCount;i++)(i===0||i===31&&this.binaryShiftByteCount<=62)&&(t.appendBits(31,5),this.binaryShiftByteCount>62?t.appendBits(this.binaryShiftByteCount-31,16):i===0?t.appendBits(Math.min(this.binaryShiftByteCount,31),5):t.appendBits(this.binaryShiftByteCount-31,5)),t.appendBits(n[this.binaryShiftStart+i],8)},e.prototype.addBinaryShift=function(t,n){return new e(this,t,n)},e.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},e}(SimpleToken);function addBinaryShift(r,e,t){return new BinaryShiftToken(r,e,t)}function add(r,e,t){return new SimpleToken(r,e,t)}var MODE_NAMES=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],MODE_UPPER=0,MODE_LOWER=1,MODE_DIGIT=2,MODE_MIXED=3,MODE_PUNCT=4,EMPTY_TOKEN=new SimpleToken(null,0,0),LATCH_TABLE=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])],__values$3=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function static_SHIFT_TABLE(r){var e,t;try{for(var n=__values$3(r),i=n.next();!i.done;i=n.next()){var s=i.value;Arrays.fill(s,-1)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r[MODE_UPPER][MODE_PUNCT]=0,r[MODE_LOWER][MODE_PUNCT]=0,r[MODE_LOWER][MODE_UPPER]=28,r[MODE_MIXED][MODE_PUNCT]=0,r[MODE_DIGIT][MODE_PUNCT]=0,r[MODE_DIGIT][MODE_UPPER]=15,r}var SHIFT_TABLE=static_SHIFT_TABLE(Arrays.createInt32Array(6,6)),__values$2=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},State=function(){function r(e,t,n,i){this.token=e,this.mode=t,this.binaryShiftByteCount=n,this.bitCount=i}return r.prototype.getMode=function(){return this.mode},r.prototype.getToken=function(){return this.token},r.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},r.prototype.getBitCount=function(){return this.bitCount},r.prototype.latchAndAppend=function(e,t){var n=this.bitCount,i=this.token;if(e!==this.mode){var s=LATCH_TABLE[this.mode][e];i=add(i,s&65535,s>>16),n+=s>>16}var a=e===MODE_DIGIT?4:5;return i=add(i,t,a),new r(i,e,0,n+a)},r.prototype.shiftAndAppend=function(e,t){var n=this.token,i=this.mode===MODE_DIGIT?4:5;return n=add(n,SHIFT_TABLE[this.mode][e],i),n=add(n,t,5),new r(n,this.mode,0,this.bitCount+i+5)},r.prototype.addBinaryShiftChar=function(e){var t=this.token,n=this.mode,i=this.bitCount;if(this.mode===MODE_PUNCT||this.mode===MODE_DIGIT){var s=LATCH_TABLE[n][MODE_UPPER];t=add(t,s&65535,s>>16),i+=s>>16,n=MODE_UPPER}var a=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,o=new r(t,n,this.binaryShiftByteCount+1,i+a);return o.binaryShiftByteCount===2078&&(o=o.endBinaryShift(e+1)),o},r.prototype.endBinaryShift=function(e){if(this.binaryShiftByteCount===0)return this;var t=this.token;return t=addBinaryShift(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new r(t,this.mode,0,this.bitCount)},r.prototype.isBetterThanOrEqualTo=function(e){var t=this.bitCount+(LATCH_TABLE[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=r.calculateBinaryShiftCost(e)-r.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount},r.prototype.toBitArray=function(e){for(var t,n,i=[],s=this.endBinaryShift(e.length).token;s!==null;s=s.getPrevious())i.unshift(s);var a=new BitArray;try{for(var o=__values$2(i),c=o.next();!c.done;c=o.next()){var h=c.value;h.appendTo(a,e)}}catch(f){t={error:f}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a},r.prototype.toString=function(){return StringUtils.format("%s bits=%d bytes=%d",MODE_NAMES[this.mode],this.bitCount,this.binaryShiftByteCount)},r.calculateBinaryShiftCost=function(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0},r.INITIAL_STATE=new r(EMPTY_TOKEN,MODE_UPPER,0,0),r}();function static_CHAR_MAP(r){var e=StringUtils.getCharCode(" "),t=StringUtils.getCharCode("."),n=StringUtils.getCharCode(",");r[MODE_UPPER][e]=1;for(var i=StringUtils.getCharCode("Z"),s=StringUtils.getCharCode("A"),a=s;a<=i;a++)r[MODE_UPPER][a]=a-s+2;r[MODE_LOWER][e]=1;for(var o=StringUtils.getCharCode("z"),c=StringUtils.getCharCode("a"),a=c;a<=o;a++)r[MODE_LOWER][a]=a-c+2;r[MODE_DIGIT][e]=1;for(var h=StringUtils.getCharCode("9"),f=StringUtils.getCharCode("0"),a=f;a<=h;a++)r[MODE_DIGIT][a]=a-f+2;r[MODE_DIGIT][n]=12,r[MODE_DIGIT][t]=13;for(var m=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],g=0;g<m.length;g++)r[MODE_MIXED][StringUtils.getCharCode(m[g])]=g;for(var _=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],g=0;g<_.length;g++)StringUtils.getCharCode(_[g])>0&&(r[MODE_PUNCT][StringUtils.getCharCode(_[g])]=g);return r}var CHAR_MAP=static_CHAR_MAP(Arrays.createInt32Array(5,256)),__values$1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},HighLevelEncoder=function(){function r(e){this.text=e}return r.prototype.encode=function(){for(var e=StringUtils.getCharCode(" "),t=StringUtils.getCharCode(`
`),n=Collections.singletonList(State.INITIAL_STATE),i=0;i<this.text.length;i++){var s=void 0,a=i+1<this.text.length?this.text[i+1]:0;switch(this.text[i]){case StringUtils.getCharCode("\r"):s=a===t?2:0;break;case StringUtils.getCharCode("."):s=a===e?3:0;break;case StringUtils.getCharCode(","):s=a===e?4:0;break;case StringUtils.getCharCode(":"):s=a===e?5:0;break;default:s=0}s>0?(n=r.updateStateListForPair(n,i,s),i++):n=this.updateStateListForChar(n,i)}var o=Collections.min(n,function(c,h){return c.getBitCount()-h.getBitCount()});return o.toBitArray(this.text)},r.prototype.updateStateListForChar=function(e,t){var n,i,s=[];try{for(var a=__values$1(e),o=a.next();!o.done;o=a.next()){var c=o.value;this.updateStateForChar(c,t,s)}}catch(h){n={error:h}}finally{try{o&&!o.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return r.simplifyStates(s)},r.prototype.updateStateForChar=function(e,t,n){for(var i=this.text[t]&255,s=CHAR_MAP[e.getMode()][i]>0,a=null,o=0;o<=MODE_PUNCT;o++){var c=CHAR_MAP[o][i];if(c>0){if(a==null&&(a=e.endBinaryShift(t)),!s||o===e.getMode()||o===MODE_DIGIT){var h=a.latchAndAppend(o,c);n.push(h)}if(!s&&SHIFT_TABLE[e.getMode()][o]>=0){var f=a.shiftAndAppend(o,c);n.push(f)}}}if(e.getBinaryShiftByteCount()>0||CHAR_MAP[e.getMode()][i]===0){var m=e.addBinaryShiftChar(t);n.push(m)}},r.updateStateListForPair=function(e,t,n){var i,s,a=[];try{for(var o=__values$1(e),c=o.next();!c.done;c=o.next()){var h=c.value;this.updateStateForPair(h,t,n,a)}}catch(f){i={error:f}}finally{try{c&&!c.done&&(s=o.return)&&s.call(o)}finally{if(i)throw i.error}}return this.simplifyStates(a)},r.updateStateForPair=function(e,t,n,i){var s=e.endBinaryShift(t);if(i.push(s.latchAndAppend(MODE_PUNCT,n)),e.getMode()!==MODE_PUNCT&&i.push(s.shiftAndAppend(MODE_PUNCT,n)),n===3||n===4){var a=s.latchAndAppend(MODE_DIGIT,16-n).latchAndAppend(MODE_DIGIT,1);i.push(a)}if(e.getBinaryShiftByteCount()>0){var o=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);i.push(o)}},r.simplifyStates=function(e){var t,n,i,s,a=[];try{for(var o=__values$1(e),c=o.next();!c.done;c=o.next()){var h=c.value,f=!0,m=function(C){if(C.isBetterThanOrEqualTo(h))return f=!1,"break";h.isBetterThanOrEqualTo(C)&&(a=a.filter(function(I){return I!==C}))};try{for(var g=(i=void 0,__values$1(a)),_=g.next();!_.done;_=g.next()){var E=_.value,A=m(E);if(A==="break")break}}catch(C){i={error:C}}finally{try{_&&!_.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}f&&a.push(h)}}catch(C){t={error:C}}finally{try{c&&!c.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a},r}(),__values=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function r(){}return r.encodeBytes=function(e){return r.encode(e,r.DEFAULT_EC_PERCENT,r.DEFAULT_AZTEC_LAYERS)},r.encode=function(e,t,n){var i=new HighLevelEncoder(e).encode(),s=Integer.truncDivision(i.getSize()*t,100)+11,a=i.getSize()+s,o,c,h,f,m;if(n!==r.DEFAULT_AZTEC_LAYERS){if(o=n<0,c=Math.abs(n),c>(o?r.MAX_NB_BITS_COMPACT:r.MAX_NB_BITS))throw new IllegalArgumentException(StringUtils.format("Illegal value %s for layers",n));h=r.totalBitsInLayer(c,o),f=r.WORD_SIZE[c];var g=h-h%f;if(m=r.stuffBits(i,f),m.getSize()+s>g)throw new IllegalArgumentException("Data to large for user specified layer");if(o&&m.getSize()>f*64)throw new IllegalArgumentException("Data to large for user specified layer")}else{f=0,m=null;for(var _=0;;_++){if(_>r.MAX_NB_BITS)throw new IllegalArgumentException("Data too large for an Aztec code");if(o=_<=3,c=o?_+1:_,h=r.totalBitsInLayer(c,o),!(a>h)){(m==null||f!==r.WORD_SIZE[c])&&(f=r.WORD_SIZE[c],m=r.stuffBits(i,f));var g=h-h%f;if(!(o&&m.getSize()>f*64)&&m.getSize()+s<=g)break}}}var E=r.generateCheckWords(m,h,f),A=m.getSize()/f,C=r.generateModeMessage(o,c,A),I=(o?11:14)+c*4,b=new Int32Array(I),R;if(o){R=I;for(var _=0;_<b.length;_++)b[_]=_}else{R=I+1+2*Integer.truncDivision(Integer.truncDivision(I,2)-1,15);for(var V=Integer.truncDivision(I,2),U=Integer.truncDivision(R,2),_=0;_<V;_++){var W=_+Integer.truncDivision(_,15);b[V-_-1]=U-W-1,b[V+_]=U+W+1}}for(var j=new BitMatrix(R),_=0,w=0;_<c;_++){for(var P=(c-_)*4+(o?9:12),K=0;K<P;K++)for(var X=K*2,Y=0;Y<2;Y++)E.get(w+X+Y)&&j.set(b[_*2+Y],b[_*2+K]),E.get(w+P*2+X+Y)&&j.set(b[_*2+K],b[I-1-_*2-Y]),E.get(w+P*4+X+Y)&&j.set(b[I-1-_*2-Y],b[I-1-_*2-K]),E.get(w+P*6+X+Y)&&j.set(b[I-1-_*2-K],b[_*2+Y]);w+=P*8}if(r.drawModeMessage(j,o,R,C),o)r.drawBullsEye(j,Integer.truncDivision(R,2),5);else{r.drawBullsEye(j,Integer.truncDivision(R,2),7);for(var _=0,K=0;_<Integer.truncDivision(I,2)-1;_+=15,K+=16)for(var Y=Integer.truncDivision(R,2)&1;Y<R;Y+=2)j.set(Integer.truncDivision(R,2)-K,Y),j.set(Integer.truncDivision(R,2)+K,Y),j.set(Y,Integer.truncDivision(R,2)-K),j.set(Y,Integer.truncDivision(R,2)+K)}var Z=new AztecCode;return Z.setCompact(o),Z.setSize(R),Z.setLayers(c),Z.setCodeWords(A),Z.setMatrix(j),Z},r.drawBullsEye=function(e,t,n){for(var i=0;i<n;i+=2)for(var s=t-i;s<=t+i;s++)e.set(s,t-i),e.set(s,t+i),e.set(t-i,s),e.set(t+i,s);e.set(t-n,t-n),e.set(t-n+1,t-n),e.set(t-n,t-n+1),e.set(t+n,t-n),e.set(t+n,t-n+1),e.set(t+n,t+n-1)},r.generateModeMessage=function(e,t,n){var i=new BitArray;return e?(i.appendBits(t-1,2),i.appendBits(n-1,6),i=r.generateCheckWords(i,28,4)):(i.appendBits(t-1,5),i.appendBits(n-1,11),i=r.generateCheckWords(i,40,4)),i},r.drawModeMessage=function(e,t,n,i){var s=Integer.truncDivision(n,2);if(t)for(var a=0;a<7;a++){var o=s-3+a;i.get(a)&&e.set(o,s-5),i.get(a+7)&&e.set(s+5,o),i.get(20-a)&&e.set(o,s+5),i.get(27-a)&&e.set(s-5,o)}else for(var a=0;a<10;a++){var o=s-5+a+Integer.truncDivision(a,5);i.get(a)&&e.set(o,s-7),i.get(a+10)&&e.set(s+7,o),i.get(29-a)&&e.set(o,s+7),i.get(39-a)&&e.set(s-7,o)}},r.generateCheckWords=function(e,t,n){var i,s,a=e.getSize()/n,o=new ReedSolomonEncoder(r.getGF(n)),c=Integer.truncDivision(t,n),h=r.bitsToWords(e,n,c);o.encode(h,c-a);var f=t%n,m=new BitArray;m.appendBits(0,f);try{for(var g=__values(Array.from(h)),_=g.next();!_.done;_=g.next()){var E=_.value;m.appendBits(E,n)}}catch(A){i={error:A}}finally{try{_&&!_.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}return m},r.bitsToWords=function(e,t,n){var i=new Int32Array(n),s,a;for(s=0,a=e.getSize()/t;s<a;s++){for(var o=0,c=0;c<t;c++)o|=e.get(s*t+c)?1<<t-c-1:0;i[s]=o}return i},r.getGF=function(e){switch(e){case 4:return GenericGF.AZTEC_PARAM;case 6:return GenericGF.AZTEC_DATA_6;case 8:return GenericGF.AZTEC_DATA_8;case 10:return GenericGF.AZTEC_DATA_10;case 12:return GenericGF.AZTEC_DATA_12;default:throw new IllegalArgumentException("Unsupported word size "+e)}},r.stuffBits=function(e,t){for(var n=new BitArray,i=e.getSize(),s=(1<<t)-2,a=0;a<i;a+=t){for(var o=0,c=0;c<t;c++)(a+c>=i||e.get(a+c))&&(o|=1<<t-1-c);(o&s)===s?(n.appendBits(o&s,t),a--):(o&s)===0?(n.appendBits(o|1,t),a--):n.appendBits(o,t)}return n},r.totalBitsInLayer=function(e,t){return((t?88:112)+16*e)*e},r.DEFAULT_EC_PERCENT=33,r.DEFAULT_AZTEC_LAYERS=0,r.MAX_NB_BITS=32,r.MAX_NB_BITS_COMPACT=4,r.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),r})();const BarcodeScanner=({onDetected:r,onError:e})=>{const t=reactExports.useRef(null),n=reactExports.useRef(new BrowserMultiFormatReader),i=reactExports.useRef(!1);return reactExports.useEffect(()=>{const s=t.current;let a;const o=()=>{s.play().catch(f=>console.error("play() failed:",f))},c=()=>{s.videoWidth===0||s.videoHeight===0||i.current||(i.current=!0,n.current.decodeFromStream(a,s,(f,m)=>{f&&(n.current.reset(),r(f.getText())),m&&!(m instanceof NotFoundException)&&(n.current.reset(),e(m.message||"スキャナーでエラーが発生しました。"))}))};return(async()=>{if(s)try{a=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",aspectRatio:.5}}),s.srcObject=a,s.muted=!0,s.addEventListener("loadedmetadata",o),s.addEventListener("playing",c)}catch(f){const m=`カメラの起動に失敗しました。ブラウザや端末のカメラ権限設定を確認し、許可されているかご確認ください。
詳細: ${f&&f.message?f.message:""}`;console.log("[BarcodeScanner] onError呼び出し",m),e(m)}})(),()=>{if(n.current.reset(),i.current=!1,s){s.removeEventListener("loadedmetadata",o),s.removeEventListener("playing",c);const f=s.srcObject;f&&f.getTracks().forEach(g=>g.stop()),s.srcObject=null}}},[r,e]),jsxRuntimeExports.jsx(Box,{"data-testid":"barcode-scanner-container",children:jsxRuntimeExports.jsx("video",{ref:t,style:{width:"100%",height:"auto",border:"1px solid gray"},autoPlay:!0,muted:!0,playsInline:!0,"data-testid":"barcode-scanner-video"})})},modalStyle={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90%",maxWidth:400,bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4},BookScanner=({onScan:r,onScanError:e})=>{const[t,n]=reactExports.useState(!1),{setGlobalError:i}=reactExports.useContext(ErrorDialogContext)||{setGlobalError:()=>{}},s=o=>{r(o),n(!1)},a=o=>{i(o),n(!1)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{variant:"outlined",startIcon:jsxRuntimeExports.jsx(CameraAltIcon,{}),onClick:()=>n(!0),sx:{mt:2,mb:2},fullWidth:!0,"data-testid":"barcode-scan-button",children:"バーコードスキャン"}),jsxRuntimeExports.jsx(Modal,{open:t,onClose:()=>n(!1),"aria-labelledby":"scanner-modal-title","data-testid":"barcode-scan-modal",children:jsxRuntimeExports.jsxs(Box,{sx:modalStyle,children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[jsxRuntimeExports.jsx(Typography,{id:"scanner-modal-title",variant:"h6",component:"h2",children:"バーコードスキャン"}),jsxRuntimeExports.jsx(IconButton,{onClick:()=>n(!1),children:jsxRuntimeExports.jsx(Typography,{variant:"h6",children:"×"})})]}),jsxRuntimeExports.jsx(BarcodeScanner,{onDetected:s,onError:a,"data-testid":"barcode-scanner"})]})})]})};function BookAdd(){const[r,e]=reactExports.useState(""),t=useNavigate(),n=s=>{console.log("[BookAdd] handleScanDetected スキャン結果:",s),e(s)},i=s=>{t(`/book/${s}`)};return jsxRuntimeExports.jsxs(Box,{sx:{maxWidth:500,mx:"auto",pb:{xs:"72px",sm:"80px"}},children:[jsxRuntimeExports.jsx(PageHeader,{title:"本を追加",subtitle:"新しい本をライブラリに追加","data-testid":"book-add-header"}),jsxRuntimeExports.jsxs(Box,{sx:{px:{xs:1.5,sm:2,md:0}},children:[jsxRuntimeExports.jsx(BookScanner,{onScan:n,onScanError:s=>console.error(s)}),jsxRuntimeExports.jsx(BookForm,{isbn:r,onBookAdded:i})]})]})}const MEMO_RATING={NONE:0,ONE:1,TWO:2,THREE:3,FOUR:4,FIVE:5},DEFAULT_MEMO_RATING=MEMO_RATING.NONE,isMemoRated=r=>r!=null&&r>MEMO_RATING.NONE,getMemoRatingValue=r=>(r==null?void 0:r.rating)||DEFAULT_MEMO_RATING,getMemoRatingSortOrder=r=>isMemoRated(r)?r:0,getMemoRatingDescription=r=>{const e={[MEMO_RATING.NONE]:"ランク未設定",[MEMO_RATING.ONE]:"あまり面白くなかった",[MEMO_RATING.TWO]:"普通",[MEMO_RATING.THREE]:"まあまあ面白かった",[MEMO_RATING.FOUR]:"面白かった",[MEMO_RATING.FIVE]:"とても面白かった"};return e[r]||e[DEFAULT_MEMO_RATING]},useMemo=r=>{const{user:e}=useAuth(),t=reactExports.useContext(ErrorDialogContext),n=(t==null?void 0:t.setGlobalError)||(()=>{}),[i,s]=reactExports.useState([]),[a,o]=reactExports.useState(!0),[c,h]=reactExports.useState(null),f=reactExports.useCallback(async()=>{if(!e||!r){s([]),o(!1);return}try{o(!0),h(null);const E=collection(db,"books",r,"memos"),A=query(E,orderBy("createdAt","desc")),b=(await getDocs(A)).docs.map(R=>({id:R.id,...R.data(),rating:R.data().rating||DEFAULT_MEMO_RATING})).sort((R,V)=>{var j,w,P,K;const U=getMemoRatingSortOrder(R.rating),W=getMemoRatingSortOrder(V.rating);return U!==W?W-U:new Date(((w=(j=V.createdAt)==null?void 0:j.toDate)==null?void 0:w.call(j))||V.createdAt||0)-new Date(((K=(P=R.createdAt)==null?void 0:P.toDate)==null?void 0:K.call(P))||R.createdAt||0)});s(b)}catch(E){console.error("Error fetching memos:",E),n("メモ一覧の取得に失敗しました。"),h("メモ一覧の取得に失敗しました。")}finally{o(!1)}},[e==null?void 0:e.uid,r]),m=reactExports.useCallback(async E=>{if(!e||!r)throw new Error("ユーザーまたは書籍IDが無効です。");try{const A=collection(db,"books",r,"memos"),C=await addDoc(A,{...E,userId:e.uid,createdAt:serverTimestamp(),updatedAt:serverTimestamp()}),I={id:C.id,...E,userId:e.uid,createdAt:new Date,updatedAt:new Date};return s(b=>[I,...b]),C.id}catch(A){throw console.error("Error adding memo:",A),n("メモの追加に失敗しました。"),A}},[e==null?void 0:e.uid,r]),g=reactExports.useCallback(async(E,A)=>{if(!e||!r||!E)throw new Error("ユーザー・書籍ID・メモIDが無効です。");try{const C=doc(db,"books",r,"memos",E);return await updateDoc(C,{...A,userId:e.uid,updatedAt:serverTimestamp()}),s(I=>I.map(R=>R.id===E?{...R,...A,userId:e.uid,updatedAt:new Date}:R)),!0}catch(C){throw console.error("Error updating memo:",C),n("メモの更新に失敗しました。"),C}},[e==null?void 0:e.uid,r]),_=reactExports.useCallback(async E=>{if(!e||!r||!E)throw new Error("ユーザー・書籍ID・メモIDが無効です。");try{const A=doc(db,"books",r,"memos",E);return await deleteDoc(A),s(C=>C.filter(I=>I.id!==E)),!0}catch(A){throw console.error("Error deleting memo:",A),n("メモの削除に失敗しました。"),A}},[e==null?void 0:e.uid,r]);return reactExports.useEffect(()=>{f()},[f]),{memos:i,loading:a,error:c,fetchMemos:f,addMemo:m,updateMemo:g,deleteMemo:_}},formatDateYMD=r=>{try{const e=r&&typeof r.toDate=="function"?r.toDate():r instanceof Date?r:null;if(!e)return"";const t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate();return`${t}/${n}/${i}`}catch{return""}},MemoCard=({memo:r,onEdit:e,onDelete:t,onClick:n})=>{const i=useMediaQuery("(max-width:600px)"),[s,a]=reactExports.useState(!1),h=(r.text?r.text.split(`
`):[]).slice(0,2).join(`
`),f=r.createdAt&&r.createdAt.toDate?r.createdAt.toDate():null,m=E=>{E&&E.stopPropagation(),a(!1),typeof e=="function"&&e(r,!0)},g=E=>{E&&E.stopPropagation(),a(!1),t(r.id)},_=useSwipeable({onSwipedLeft:()=>a(!0),onSwipedRight:()=>a(!1),preventDefaultTouchmoveEvent:!0,trackMouse:!0});return i?jsxRuntimeExports.jsxs(Box,{position:"relative",..._,sx:{mb:2},children:[jsxRuntimeExports.jsxs(Card,{"data-testid":"memo-card",sx:{position:"relative",maxWidth:"100%",mx:"auto",cursor:n?"pointer":"default",bgcolor:"background.paper",transition:"transform 0.2s",transform:s?"translateX(-100px)":"none"},onClick:n?()=>n(r,!1):void 0,children:[jsxRuntimeExports.jsxs(CardContent,{sx:{pb:.5,minHeight:48,maxHeight:80,overflow:"hidden"},children:[jsxRuntimeExports.jsx(Typography,{variant:"body1",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",lineHeight:1.2},children:h}),r.comment&&jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",lineHeight:1.2,mt:.25},children:r.comment}),getMemoRatingValue(r)>0&&jsxRuntimeExports.jsx(Rating,{value:getMemoRatingValue(r),readOnly:!0,size:"small",sx:{mt:.25,mb:.25}})]}),jsxRuntimeExports.jsx(CardActions,{sx:{justifyContent:"space-between",alignItems:"center",py:0},children:jsxRuntimeExports.jsxs(Stack,{direction:"row",spacing:1,alignItems:"center",children:[r.page&&jsxRuntimeExports.jsxs(Typography,{variant:"caption",children:["p.",r.page]}),f&&jsxRuntimeExports.jsx(Typography,{variant:"caption",color:"text.secondary",children:formatDateYMD(f)}),Array.isArray(r.tags)&&r.tags.map((E,A)=>jsxRuntimeExports.jsx(Chip,{label:E,size:"small",color:"secondary"},A))]})})]}),s&&jsxRuntimeExports.jsxs(Box,{position:"absolute",top:0,right:0,height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",zIndex:2,sx:{p:1,gap:1},children:[jsxRuntimeExports.jsx(IconButton,{onClick:m,sx:{bgcolor:"primary.main",color:"white",mb:1},size:"large",children:jsxRuntimeExports.jsx(EditIcon,{})}),jsxRuntimeExports.jsx(IconButton,{onClick:g,sx:{bgcolor:"error.main",color:"white"},size:"large",children:jsxRuntimeExports.jsx(DeleteIcon,{})})]})]}):jsxRuntimeExports.jsxs(Card,{"data-testid":"memo-card",sx:{position:"relative",maxWidth:"100%",mx:"auto",cursor:n?"pointer":"default",bgcolor:"background.paper"},onClick:n?()=>n(r,!1):void 0,children:[jsxRuntimeExports.jsxs(CardContent,{sx:{pb:1,minHeight:{xs:48,sm:64},maxHeight:{xs:72,sm:88},overflow:"hidden"},children:[jsxRuntimeExports.jsx(Typography,{variant:"body1",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:h}),r.comment&&jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:r.comment}),getMemoRatingValue(r)>0&&jsxRuntimeExports.jsx(Rating,{value:getMemoRatingValue(r),readOnly:!0,size:"small",sx:{mt:.5}})]}),jsxRuntimeExports.jsxs(CardActions,{sx:{justifyContent:"space-between",alignItems:"center",py:0},children:[jsxRuntimeExports.jsxs(Stack,{direction:"row",spacing:1,alignItems:"center",children:[r.page&&jsxRuntimeExports.jsxs(Typography,{variant:"caption",children:["p.",r.page]}),f&&jsxRuntimeExports.jsx(Typography,{variant:"caption",color:"text.secondary",children:formatDateYMD(f)}),Array.isArray(r.tags)&&r.tags.map((E,A)=>jsxRuntimeExports.jsx(Chip,{label:E,size:"small",color:"secondary"},A))]}),jsxRuntimeExports.jsxs(Box,{sx:{display:{xs:"none",sm:"flex"}},children:[jsxRuntimeExports.jsx(IconButton,{"aria-label":"edit",onClick:m,size:"small","data-testid":"memo-edit-button",children:jsxRuntimeExports.jsx(EditIcon,{fontSize:"small"})}),jsxRuntimeExports.jsx(IconButton,{"aria-label":"delete",onClick:g,size:"small","data-testid":"memo-delete-button",children:jsxRuntimeExports.jsx(DeleteIcon,{fontSize:"small"})})]})]})]})},formatDateTime=r=>{try{const e=r&&typeof r.toDate=="function"?r.toDate():r instanceof Date?r:null;if(!e)return"";const t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate(),s=e.getHours(),a=String(e.getMinutes()).padStart(2,"0"),o=String(e.getSeconds()).padStart(2,"0");return`${t}/${n}/${i} ${s}:${a}:${o}`}catch{return""}},MemoEditor=({open:r,memo:e,bookId:t,onClose:n,onUpdate:i,onDelete:s,editMode:a=!1})=>{const{setGlobalError:o}=reactExports.useContext(ErrorDialogContext),{updateMemo:c,deleteMemo:h}=useMemo(t),[f,m]=reactExports.useState(a?"edit":"view"),[g,_]=reactExports.useState(null),[E,A]=reactExports.useState(!1),[C,I]=reactExports.useState("");React.useEffect(()=>{e&&(_({...e,rating:getMemoRatingValue(e)}),m(a?"edit":"view"),A(!1),I(""))},[e,a]);const b=()=>{_(null),m("view"),A(!1),I(""),n()},R=async U=>{if(U.preventDefault(),!g||!g.text.trim())return;let W=g.tags||[];C&&!W.includes(C)&&(W=[...W,C]);try{await c(g.id,{text:g.text,comment:g.comment,page:Number(g.page)||null,tags:W,rating:g.rating||DEFAULT_MEMO_RATING}),b(),i&&i()}catch(j){console.error("Error updating memo: ",j),o("メモの更新に失敗しました。")}},V=async U=>{try{await h(U),b(),s&&s()}catch(W){console.error("Error deleting memo: ",W),o("メモの削除に失敗しました。")}};return e?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Dialog,{open:r,onClose:b,maxWidth:"sm",fullWidth:!0,"data-testid":"memo-detail-dialog",children:[jsxRuntimeExports.jsx(DialogTitle,{"data-testid":"memo-detail-title",children:"メモ詳細"}),jsxRuntimeExports.jsx(DialogContent,{children:f==="view"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Typography,{variant:"body1",sx:{whiteSpace:"pre-line",mb:2},children:g==null?void 0:g.text}),(g==null?void 0:g.comment)&&jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mb:1},children:g.comment}),(g==null?void 0:g.rating)&&g.rating>0&&jsxRuntimeExports.jsxs(Box,{sx:{mb:1},children:[jsxRuntimeExports.jsx(Rating,{value:g.rating,readOnly:!0,size:"small",sx:{mb:.5}}),jsxRuntimeExports.jsx(Typography,{variant:"caption",color:"text.secondary",sx:{display:"block"},children:getMemoRatingDescription(g.rating)})]}),jsxRuntimeExports.jsx(Stack,{direction:"row",spacing:1,sx:{mb:1,flexWrap:"wrap"},children:Array.isArray(g==null?void 0:g.tags)&&g.tags.map((U,W)=>jsxRuntimeExports.jsx(Chip,{label:U,size:"small",color:"secondary"},W))}),(g==null?void 0:g.page)&&jsxRuntimeExports.jsxs(Typography,{variant:"caption",sx:{display:"block",mb:1},children:["p. ",g.page]}),(g==null?void 0:g.createdAt)&&jsxRuntimeExports.jsx(Typography,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:1},children:formatDateTime(g.createdAt)})]}):jsxRuntimeExports.jsxs(Box,{component:"form",onSubmit:R,sx:{mt:1},children:[jsxRuntimeExports.jsx(TextField,{label:"引用・抜き書き",fullWidth:!0,multiline:!0,rows:4,value:(g==null?void 0:g.text)||"",onChange:U=>_({...g,text:U.target.value}),margin:"normal",required:!0,inputProps:{"data-testid":"memo-text-input"}}),jsxRuntimeExports.jsx(TextField,{label:"感想・コメント",fullWidth:!0,multiline:!0,rows:2,value:(g==null?void 0:g.comment)||"",onChange:U=>_({...g,comment:U.target.value}),margin:"normal",inputProps:{"data-testid":"memo-comment-input"}}),jsxRuntimeExports.jsx(TextField,{label:"ページ番号",type:"number",value:(g==null?void 0:g.page)||"",onChange:U=>_({...g,page:U.target.value}),margin:"normal",sx:{mr:2},inputProps:{"data-testid":"memo-page-input"}}),jsxRuntimeExports.jsxs(FormControl,{margin:"normal",fullWidth:!0,children:[jsxRuntimeExports.jsx(FormLabel,{component:"legend",children:"ランク評価"}),jsxRuntimeExports.jsx(Rating,{value:(g==null?void 0:g.rating)||DEFAULT_MEMO_RATING,onChange:(U,W)=>{_({...g,rating:W||DEFAULT_MEMO_RATING})},size:"large",sx:{mt:1},"data-testid":"memo-rating-input"}),(g==null?void 0:g.rating)&&g.rating>0&&jsxRuntimeExports.jsx(Typography,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:getMemoRatingDescription(g.rating)})]}),jsxRuntimeExports.jsx(Autocomplete,{multiple:!0,freeSolo:!0,options:[],value:(g==null?void 0:g.tags)||[],getOptionLabel:U=>typeof U=="string"?U:U.inputValue||U.tag||"",onChange:(U,W)=>{const j=(W||[]).map(w=>{if(typeof w=="string")return w;if(w&&typeof w=="object"){if("inputValue"in w&&w.inputValue)return w.inputValue;if("tag"in w&&w.tag)return w.tag}return""}).filter(Boolean);_({...g,tags:j})},inputValue:C,onInputChange:(U,W)=>I(W),renderInput:U=>jsxRuntimeExports.jsx(TextField,{...U,label:"タグ",margin:"normal",fullWidth:!0,placeholder:"例: 名言,感想,引用",inputProps:{...U.inputProps,"data-testid":"memo-tags-input"}})})]})}),jsxRuntimeExports.jsx(DialogActions,{children:f==="view"?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{onClick:()=>m("edit"),"data-testid":"memo-edit-button",children:"編集"}),jsxRuntimeExports.jsx(Button,{onClick:()=>A(!0),color:"error","data-testid":"memo-delete-button",children:"削除"}),jsxRuntimeExports.jsx(Button,{onClick:b,"data-testid":"memo-close-button",children:"閉じる"})]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{onClick:()=>m("view"),"data-testid":"memo-cancel-button",children:"キャンセル"}),jsxRuntimeExports.jsx(Button,{onClick:R,variant:"contained","data-testid":"memo-update-button",children:"更新"})]})})]}),jsxRuntimeExports.jsxs(Dialog,{open:E,onClose:()=>A(!1),"data-testid":"memo-delete-dialog",children:[jsxRuntimeExports.jsx(DialogTitle,{"data-testid":"memo-delete-confirm-title",children:"本当に削除しますか？"}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(Typography,{children:"このメモを削除すると、元に戻すことはできません。"})}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:()=>A(!1),"data-testid":"memo-delete-cancel-button",children:"キャンセル"}),jsxRuntimeExports.jsx(Button,{onClick:()=>{V(g==null?void 0:g.id)},color:"error",variant:"contained","data-testid":"memo-delete-confirm-button",children:"削除"})]})]})]}):null},MemoList=({bookId:r,onMemoUpdated:e})=>{const{setGlobalError:t}=reactExports.useContext(ErrorDialogContext),{memos:n,loading:i,deleteMemo:s}=useMemo(r),[a,o]=reactExports.useState(null),[c,h]=reactExports.useState(!1),[f,m]=reactExports.useState(!1),[g,_]=reactExports.useState(null),[E,A]=reactExports.useState(!1),C=(W,j=!1)=>{o(W),A(j),h(!0)},I=W=>{const j=n.find(w=>w.id===W);j&&(_(j),m(!0))},b=async()=>{if(g)try{await s(g.id),m(!1),_(null)}catch(W){console.error("Error deleting memo:",W),t("メモの削除に失敗しました。")}},R=()=>{o(null),h(!1)},V=()=>{m(!1),_(null)},U=()=>{e&&e()};return i?jsxRuntimeExports.jsx(Typography,{children:"メモを読み込み中..."}):n.length===0?jsxRuntimeExports.jsx(Typography,{children:"まだメモはありません。"}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Box,{sx:{display:"flex",flexDirection:"column",gap:2},children:n.map(W=>jsxRuntimeExports.jsx(MemoCard,{memo:W,onEdit:(j,w)=>C(j,w),onDelete:I,onClick:j=>C(j,!1)},W.id))}),jsxRuntimeExports.jsx(MemoEditor,{open:c,memo:a,bookId:r,onClose:R,onUpdate:U,onDelete:U,editMode:E}),jsxRuntimeExports.jsxs(Dialog,{open:f,onClose:V,"data-testid":"memo-delete-dialog",children:[jsxRuntimeExports.jsx(DialogTitle,{"data-testid":"memo-delete-confirm-title",children:"本当に削除しますか？"}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(Typography,{children:"このメモを削除すると、元に戻すことはできません。"})}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:V,"data-testid":"memo-delete-cancel-button",children:"キャンセル"}),jsxRuntimeExports.jsx(Button,{onClick:b,color:"error",variant:"contained","data-testid":"memo-delete-confirm-button",children:"削除"})]})]})]})},CameraPasteOCR=({onTextDetected:r,disabled:e=!1})=>{const[t,n]=reactExports.useState(!1),[i,s]=reactExports.useState(null),a=async()=>{n(!0),s(null);try{if(navigator.clipboard&&navigator.clipboard.readText){const c=await navigator.clipboard.readText();c&&c.trim()?(console.log("[CameraPasteOCR] ペーストされたテキスト:",c),r(c.trim())):s("クリップボードが空です")}else s("クリップボード機能が利用できません")}catch(c){console.error("[CameraPasteOCR] クリップボード読み取りエラー:",c),s("テキストの読み取りに失敗しました")}finally{n(!1)}},o=()=>{s(null)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Button,{variant:"outlined",startIcon:jsxRuntimeExports.jsx(ContentPasteIcon,{}),onClick:a,disabled:e||t,fullWidth:!0,sx:{mt:1,mb:1,height:{xs:"40px",sm:"48px"},fontSize:{xs:"0.8rem",sm:"0.9rem"}},"data-testid":"camera-paste-ocr-button",children:t?"読み取り中...":"テキストをペースト"}),jsxRuntimeExports.jsx(Snackbar,{open:!!i,autoHideDuration:6e3,onClose:o,anchorOrigin:{vertical:"bottom",horizontal:"center"},children:jsxRuntimeExports.jsx(Alert,{onClose:o,severity:"error",children:i})})]})};var define_process_env_default={};const LOG_LEVELS={ERROR:0,WARN:1,INFO:2,DEBUG:3},getCurrentLogLevel=()=>{let r,e=!1;try{if(typeof window<"u"){const t=window.__VITE_ENV__||{};r=t.VITE_LOG_LEVEL,e=t.PROD}}catch{}return typeof process<"u"&&define_process_env_default&&(r||(r=define_process_env_default.VITE_LOG_LEVEL),e||(e=!0)),r&&LOG_LEVELS[r.toUpperCase()]!==void 0?LOG_LEVELS[r.toUpperCase()]:e?LOG_LEVELS.WARN:LOG_LEVELS.DEBUG},currentLogLevel=getCurrentLogLevel(),LOG_CATEGORIES={AUTH:"🔐 AUTH",BOOK:"📖 BOOK",MEMO:"📝 MEMO",STATUS:"📊 STATUS",FIREBASE:"🔥 FIREBASE"},formatLog=(r,e,t,n=null)=>{const i=new Date().toISOString();let a=`${{[LOG_LEVELS.ERROR]:"❌",[LOG_LEVELS.WARN]:"⚠️",[LOG_LEVELS.INFO]:"ℹ️",[LOG_LEVELS.DEBUG]:"🐛"}[r]||"📝"} ${e} [${i}] ${t}`;return n!=null&&(a+=`
  Data: ${JSON.stringify(n,null,2)}`),a},log$1=(r,e,t,n=null)=>{if(r>currentLogLevel)return;const i=formatLog(r,e,t,n);switch(r){case LOG_LEVELS.ERROR:console.error(i);break;case LOG_LEVELS.WARN:console.warn(i);break;case LOG_LEVELS.INFO:console.info(i);break;case LOG_LEVELS.DEBUG:console.log(i);break;default:console.log(i)}},logger={error:(r,e,t)=>log$1(LOG_LEVELS.ERROR,r,e,t),warn:(r,e,t)=>log$1(LOG_LEVELS.WARN,r,e,t),info:(r,e,t)=>log$1(LOG_LEVELS.INFO,r,e,t),debug:(r,e,t)=>log$1(LOG_LEVELS.DEBUG,r,e,t),auth:{error:(r,e)=>logger.error(LOG_CATEGORIES.AUTH,r,e),warn:(r,e)=>logger.warn(LOG_CATEGORIES.AUTH,r,e),info:(r,e)=>logger.info(LOG_CATEGORIES.AUTH,r,e),debug:(r,e)=>logger.debug(LOG_CATEGORIES.AUTH,r,e)},book:{error:(r,e)=>logger.error(LOG_CATEGORIES.BOOK,r,e),warn:(r,e)=>logger.warn(LOG_CATEGORIES.BOOK,r,e),info:(r,e)=>logger.info(LOG_CATEGORIES.BOOK,r,e),debug:(r,e)=>logger.debug(LOG_CATEGORIES.BOOK,r,e)},memo:{error:(r,e)=>logger.error(LOG_CATEGORIES.MEMO,r,e),warn:(r,e)=>logger.warn(LOG_CATEGORIES.MEMO,r,e),info:(r,e)=>logger.info(LOG_CATEGORIES.MEMO,r,e),debug:(r,e)=>logger.debug(LOG_CATEGORIES.MEMO,r,e)},status:{error:(r,e)=>logger.error(LOG_CATEGORIES.STATUS,r,e),warn:(r,e)=>logger.warn(LOG_CATEGORIES.STATUS,r,e),info:(r,e)=>logger.info(LOG_CATEGORIES.STATUS,r,e),debug:(r,e)=>logger.debug(LOG_CATEGORIES.STATUS,r,e)},firebase:{error:(r,e)=>logger.error(LOG_CATEGORIES.FIREBASE,r,e),warn:(r,e)=>logger.warn(LOG_CATEGORIES.FIREBASE,r,e),info:(r,e)=>logger.info(LOG_CATEGORIES.FIREBASE,r,e),debug:(r,e)=>logger.debug(LOG_CATEGORIES.FIREBASE,r,e)}},MemoAdd=({bookId:r,bookTags:e=[],onMemoAdded:t,onClose:n})=>{const{user:i}=useAuth(),{setGlobalError:s}=reactExports.useContext(ErrorDialogContext),{addMemo:a}=useMemo(r),[o,c]=reactExports.useState(""),[h,f]=reactExports.useState(""),[m,g]=reactExports.useState(""),[_,E]=reactExports.useState([]),[A,C]=reactExports.useState(""),[I,b]=reactExports.useState(DEFAULT_MEMO_RATING),[R,V]=reactExports.useState(!1),{tagOptions:U,fetchTagHistory:W,saveTagsToHistory:j}=useTagHistory("memo",i);reactExports.useEffect(()=>{W()},[W]);const w=async Y=>{if(Y.preventDefault(),!o.trim()||R)return;V(!0),logger.memo.debug("handleSubmit開始",{text:o,comment:h,page:m,tags:_});let Z=_;A&&!_.includes(A)&&(Z=[..._,A]),logger.memo.debug("保存するタグ",Z);try{logger.memo.debug("addMemo呼び出し前");const ae=await a({text:o,comment:h,page:Number(m)||null,tags:Z,rating:I||DEFAULT_MEMO_RATING});logger.memo.info("addMemo呼び出し完了",{memoId:ae}),await j(Z),logger.memo.debug("フォームリセット前"),c(""),f(""),g(""),E([]),C(""),b(DEFAULT_MEMO_RATING),logger.memo.debug("フォームリセット完了"),t&&(logger.memo.debug("onMemoAddedコールバック呼び出し"),t())}catch(ae){logger.memo.error("Error adding memo",ae),s("メモの追加に失敗しました。")}finally{V(!1)}},P=()=>{n&&n()},K=Y=>{logger.memo.info("OCRで検出されたテキスト",{detectedText:Y}),c(Y)};return n?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(DialogTitle,{"data-testid":"memo-add-dialog-title",children:"メモを追加"}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsxs(Box,{component:"form",onSubmit:w,sx:{mt:1},"data-testid":"memo-add-form",children:[jsxRuntimeExports.jsx(TextField,{label:"引用・抜き書き",fullWidth:!0,multiline:!0,rows:3,value:o,onChange:Y=>c(Y.target.value),required:!0,inputProps:{"data-testid":"memo-text-input"}}),jsxRuntimeExports.jsx(CameraPasteOCR,{onTextDetected:K}),jsxRuntimeExports.jsx(TextField,{label:"感想・コメント",fullWidth:!0,multiline:!0,rows:2,value:h,onChange:Y=>f(Y.target.value),inputProps:{"data-testid":"memo-comment-input"}}),jsxRuntimeExports.jsx(TextField,{label:"ページ番号",type:"number",value:m,onChange:Y=>g(Y.target.value),sx:{mr:2,width:{xs:"100%",sm:"auto"}},inputProps:{"data-testid":"memo-page-input"}}),jsxRuntimeExports.jsxs(FormControl,{margin:"normal",fullWidth:!0,children:[jsxRuntimeExports.jsx(FormLabel,{component:"legend",children:"ランク評価"}),jsxRuntimeExports.jsx(Rating,{value:I,onChange:(Y,Z)=>{b(Z||DEFAULT_MEMO_RATING)},size:"large",sx:{mt:1},"data-testid":"memo-rating-input"}),I>0&&jsxRuntimeExports.jsx(Typography,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:getMemoRatingDescription(I)})]}),jsxRuntimeExports.jsx(Autocomplete,{multiple:!0,freeSolo:!0,options:U,value:_,getOptionLabel:Y=>typeof Y=="string"?Y:Y.inputValue||Y.tag||"",onChange:async(Y,Z)=>{const ae=(Z||[]).map(le=>{if(typeof le=="string")return le;if(le&&typeof le=="object"){if("inputValue"in le&&le.inputValue)return le.inputValue;if("tag"in le&&le.tag)return le.tag}return""}).filter(Boolean);E(ae),await j(ae)},inputValue:A,onInputChange:(Y,Z)=>C(Z),renderInput:Y=>jsxRuntimeExports.jsx(TextField,{...Y,label:"タグ",fullWidth:!0,placeholder:"例: 名言,感想,引用",inputProps:{...Y.inputProps,"data-testid":"memo-tags-input"}})})]})}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:P,"data-testid":"memo-add-cancel",disabled:R,children:"キャンセル"}),jsxRuntimeExports.jsx(Button,{onClick:w,variant:"contained","data-testid":"memo-add-submit",disabled:R,children:R?"追加中...":"メモを追加"})]})]}):jsxRuntimeExports.jsxs(Box,{component:"form",onSubmit:w,sx:{mt:1},"data-testid":"memo-add-form",children:[jsxRuntimeExports.jsx(TextField,{label:"引用・抜き書き",fullWidth:!0,multiline:!0,rows:3,value:o,onChange:Y=>c(Y.target.value),required:!0,inputProps:{"data-testid":"memo-text-input"}}),jsxRuntimeExports.jsx(CameraPasteOCR,{onTextDetected:K}),jsxRuntimeExports.jsx(TextField,{label:"感想・コメント",fullWidth:!0,multiline:!0,rows:2,value:h,onChange:Y=>f(Y.target.value),inputProps:{"data-testid":"memo-comment-input"}}),jsxRuntimeExports.jsx(TextField,{label:"ページ番号",type:"number",value:m,onChange:Y=>g(Y.target.value),sx:{mr:2,width:{xs:"100%",sm:"auto"}},inputProps:{"data-testid":"memo-page-input"}}),jsxRuntimeExports.jsxs(FormControl,{margin:"normal",fullWidth:!0,children:[jsxRuntimeExports.jsx(FormLabel,{component:"legend",children:"ランク評価"}),jsxRuntimeExports.jsx(Rating,{value:I,onChange:(Y,Z)=>{b(Z||DEFAULT_MEMO_RATING)},size:"large",sx:{mt:1},"data-testid":"memo-rating-input"}),I>0&&jsxRuntimeExports.jsx(Typography,{variant:"caption",color:"text.secondary",sx:{mt:1,display:"block"},children:getMemoRatingDescription(I)})]}),jsxRuntimeExports.jsx(Autocomplete,{multiple:!0,freeSolo:!0,options:U,value:_,getOptionLabel:Y=>typeof Y=="string"?Y:Y.inputValue||Y.tag||"",onChange:async(Y,Z)=>{const ae=(Z||[]).map(le=>{if(typeof le=="string")return le;if(le&&typeof le=="object"){if("inputValue"in le&&le.inputValue)return le.inputValue;if("tag"in le&&le.tag)return le.tag}return""}).filter(Boolean);E(ae),await j(ae)},inputValue:A,onInputChange:(Y,Z)=>C(Z),renderInput:Y=>jsxRuntimeExports.jsx(TextField,{...Y,label:"タグ",fullWidth:!0,placeholder:"例: 名言,感想,引用",inputProps:{...Y.inputProps,"data-testid":"memo-tags-input"}})}),jsxRuntimeExports.jsx(Button,{type:"submit",variant:"contained",disabled:R,sx:{mt:2,mb:{xs:8,sm:2},width:{xs:"100%",sm:"auto"}},"data-testid":"memo-add-submit",children:R?"追加中...":"メモを追加"})]})};function toJsDate(r){if(!r)return null;if(typeof r.toDate=="function")return r.toDate();try{return new Date(r)}catch{return null}}function extractImportantDates(r){if(!Array.isArray(r)||r.length===0)return{};const e=r.find(s=>(s==null?void 0:s.status)===BOOK_STATUS.READING||(s==null?void 0:s.status)===BOOK_STATUS.RE_READING),t=r.find(s=>(s==null?void 0:s.status)===BOOK_STATUS.FINISHED),n=r.find(s=>(s==null?void 0:s.status)===BOOK_STATUS.RE_READING),i={};return e!=null&&e.changedAt&&(i.readingStartedAt=e.changedAt),t!=null&&t.changedAt&&(i.finishedAt=t.changedAt),n!=null&&n.changedAt&&(i.reReadingStartedAt=n.changedAt),i}function getCurrentStatusFromHistory(r){var e;return!Array.isArray(r)||r.length===0?null:((e=r[0])==null?void 0:e.status)??null}function calculateReadingDuration(r){if(!r)return null;const{readingStartedAt:e,finishedAt:t}=r;if(!e||!t)return null;const n=toJsDate(e),i=toJsDate(t);if(!n||!i)return null;const s=Math.abs(i-n);return Math.ceil(s/(1e3*60*60*24))}const useBookStatusHistory=r=>{const{user:e}=useAuth(),t=reactExports.useContext(ErrorDialogContext),n=(t==null?void 0:t.setGlobalError)||(()=>{}),[i,s]=reactExports.useState([]),[a,o]=reactExports.useState(!0),[c,h]=reactExports.useState(null),f=reactExports.useCallback(()=>{if(!e||!r)return logger.status.debug("No user or bookId",{user:!!e,bookId:r}),o(!1),()=>{};try{logger.status.debug("Setting up listener for bookId",{bookId:r}),o(!0),h(null);const I=collection(db,"books",r,"statusHistory"),b=query(I);return onSnapshot(b,V=>{logger.status.debug("Snapshot received",{size:V.size,empty:V.empty,bookId:r});const U=V.docs.map(W=>({id:W.id,...W.data()}));U.sort((W,j)=>{var K,X;const w=(K=W.changedAt)!=null&&K.toDate?W.changedAt.toDate():new Date(W.changedAt||0);return((X=j.changedAt)!=null&&X.toDate?j.changedAt.toDate():new Date(j.changedAt||0))-w}),s(U),o(!1)},V=>{if(logger.status.error("Error fetching status history",V),logger.status.error("Error details",{code:V.code,message:V.message,bookId:r,userId:e.uid}),V.code==="permission-denied"){logger.status.warn("Permission denied for statusHistory, treating as empty history"),s([]),o(!1);return}n("ステータス履歴の取得に失敗しました。"),h("ステータス履歴の取得に失敗しました。"),o(!1)})}catch(I){return logger.status.error("Error setting up status history listener",I),n("ステータス履歴の取得に失敗しました。"),h("ステータス履歴の取得に失敗しました。"),o(!1),()=>{}}},[r,e,n]),m=reactExports.useCallback(async(I,b,R=null)=>{if(!e||!r||!isValidBookStatus(I))throw new Error("無効なパラメータです。");try{const V=collection(db,"books",r,"statusHistory"),U={status:I,previousStatus:b||null,changedAt:serverTimestamp(),changedBy:e.uid,notes:R||null,createdAt:serverTimestamp()};return(await addDoc(V,U)).id}catch(V){throw logger.status.error("Error adding status history",V),n("ステータス履歴の保存に失敗しました。"),V}},[r,e,n]),g=reactExports.useCallback(()=>i.length?extractImportantDates(i):{},[i]),_=reactExports.useCallback(()=>getCurrentStatusFromHistory(i),[i]),E=reactExports.useCallback(()=>calculateReadingDuration(g()),[g]),A=reactExports.useCallback(async(I,b,R)=>{if(!e||!r){logger.status.debug("No user or bookId for manual history addition",{user:!!e,bookId:r});return}if(!isValidBookStatus(b))throw new Error("Invalid status");try{logger.status.info("Adding manual status history",{bookId:r,date:I,status:b,previousStatus:R,userId:e.uid});const V=collection(db,"books",r,"statusHistory"),U={status:b,previousStatus:R||"",changedAt:I,userId:e.uid};await addDoc(V,U),logger.status.info("Manual status history added successfully")}catch(V){throw logger.status.error("Error adding manual status history",V),n("手動履歴の追加に失敗しました。"),V}},[e,r,n]),C=i.length>0?i[0]:null;return reactExports.useEffect(()=>f(),[r,e]),{history:i,loading:a,error:c,addStatusHistory:m,addManualStatusHistory:A,latestHistory:C,getImportantDates:g,getCurrentStatus:_,getReadingDuration:E,refetch:f}},BookStatusChanger=({book:r,bookId:e,onStatusChange:t})=>{const n=reactExports.useContext(ErrorDialogContext),i=(n==null?void 0:n.setGlobalError)||(()=>{}),{addStatusHistory:s}=useBookStatusHistory(e),[a,o]=reactExports.useState(!1),[c,h]=reactExports.useState(null),f=async E=>{if(!r||!isValidBookStatus(E))return;o(!0),h(null);const A=doc(db,"books",e),C=r.status||DEFAULT_BOOK_STATUS;try{const I={status:E,updatedAt:serverTimestamp()};E===BOOK_STATUS.FINISHED&&(I.finishedAt=serverTimestamp()),await updateDoc(A,I);try{await s(E,C)}catch(b){console.error("Error adding status history:",b)}t(E)}catch(I){console.error("Error updating status:",I),i("ステータスの更新に失敗しました。")}finally{o(!1)}},m=E=>{h(E.currentTarget)},g=()=>{h(null)};if(!r)return null;const _=r.status||DEFAULT_BOOK_STATUS;return jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center",gap:1},children:[jsxRuntimeExports.jsx(Chip,{label:getBookStatusLabel(_),color:getBookStatusColor(_),"data-testid":"book-status-chip"}),jsxRuntimeExports.jsx(Button,{onClick:m,variant:"outlined",disabled:a,endIcon:jsxRuntimeExports.jsx(KeyboardArrowDown,{}),"data-testid":"book-status-change-button",children:a?"更新中...":"ステータス変更"}),jsxRuntimeExports.jsx(Menu,{anchorEl:c,open:!!c,onClose:g,"data-testid":"book-status-menu",children:ALL_BOOK_STATUSES.map(E=>jsxRuntimeExports.jsx(MenuItem,{onClick:()=>f(E),disabled:E===_,"data-testid":`status-menu-item-${E}`,children:getBookStatusLabel(E)},E))})]})},BookInfo=({book:r,bookId:e,onStatusChange:t})=>r?jsxRuntimeExports.jsxs(Box,{"data-testid":"book-info",children:[jsxRuntimeExports.jsx(Box,{sx:{display:"flex",justifyContent:"center",alignItems:"center",mb:2},children:jsxRuntimeExports.jsx(BookStatusChanger,{book:r,bookId:e,onStatusChange:t})}),jsxRuntimeExports.jsx(Box,{sx:{textAlign:"left",mb:2},"data-testid":"book-cover-section",children:r.coverImageUrl?jsxRuntimeExports.jsx("img",{src:r.coverImageUrl,alt:`${r.title}の表紙`,style:{maxHeight:"250px",width:"auto"},"data-testid":"book-cover-image"}):jsxRuntimeExports.jsx(Box,{sx:{border:"1px dashed grey",height:250,width:167,display:"flex",alignItems:"center",justifyContent:"center",mx:"auto"},"data-testid":"book-cover-placeholder",children:jsxRuntimeExports.jsx(Typography,{variant:"body1",color:"text.secondary",children:"書影なし"})})}),jsxRuntimeExports.jsxs(Box,{sx:{mb:2},"data-testid":"book-details",children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",gutterBottom:!0,sx:{wordBreak:"break-word"},"data-testid":"book-title",children:r.title}),jsxRuntimeExports.jsx(Typography,{variant:"h6",color:"text.secondary",gutterBottom:!0,"data-testid":"book-author",children:r.author}),r.publisher&&jsxRuntimeExports.jsxs(Typography,{variant:"body1",color:"text.secondary",gutterBottom:!0,"data-testid":"book-publisher",children:["出版社: ",r.publisher]}),r.publishedDate&&jsxRuntimeExports.jsxs(Typography,{variant:"body1",color:"text.secondary",gutterBottom:!0,"data-testid":"book-published-date",children:["出版日: ",r.publishedDate]}),r.acquisitionType&&r.acquisitionType!==ACQUISITION_TYPE.UNKNOWN&&jsxRuntimeExports.jsx(Box,{sx:{mb:1},children:jsxRuntimeExports.jsx(Chip,{label:`取得方法: ${getAcquisitionTypeLabel(r.acquisitionType)}`,color:"primary",variant:"outlined",size:"small","data-testid":"book-acquisition-type"})})]})]}):null,BookTagEditor=({book:r,bookId:e,onTagsChange:t})=>{const{user:n}=useAuth(),i=reactExports.useContext(ErrorDialogContext),s=(i==null?void 0:i.setGlobalError)||(()=>{}),[a,o]=reactExports.useState(!1),[c,h]=reactExports.useState([]),{tagOptions:f,fetchTagHistory:m,saveTagsToHistory:g}=useTagHistory("book",n);reactExports.useEffect(()=>{m()},[m]);const _=()=>{h(r.tags||[]),o(!0)},E=async()=>{if(r)try{const A=doc(db,"books",e);await updateDoc(A,{tags:c,updatedAt:serverTimestamp()}),await g(c),t(c),o(!1)}catch(A){console.error("Error updating tags:",A),s("タグの更新に失敗しました。")}};return r?jsxRuntimeExports.jsxs(Box,{sx:{mb:2},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",children:"タグ:"}),jsxRuntimeExports.jsx(IconButton,{onClick:_,size:"small","data-testid":"edit-tags-button",children:jsxRuntimeExports.jsx(EditIcon,{})})]}),jsxRuntimeExports.jsx(Box,{sx:{display:"flex",flexWrap:"wrap",gap:1},children:(r.tags||[]).map((A,C)=>jsxRuntimeExports.jsx(Chip,{label:A,size:"small"},C))}),jsxRuntimeExports.jsxs(Dialog,{open:a,onClose:()=>o(!1),maxWidth:"sm",fullWidth:!0,children:[jsxRuntimeExports.jsx(DialogTitle,{children:"タグを編集"}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsx(Autocomplete,{multiple:!0,freeSolo:!0,options:f,value:c,onChange:(A,C)=>h(C),renderInput:A=>jsxRuntimeExports.jsx(TextField,{...A,label:"タグ",placeholder:"タグを入力または選択",fullWidth:!0,margin:"normal"}),renderTags:(A,C)=>A.map((I,b)=>reactExports.createElement(Chip,{...C({index:b}),key:b,label:I,size:"small"}))})}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:()=>o(!1),children:"キャンセル"}),jsxRuntimeExports.jsx(Button,{onClick:E,variant:"contained","data-testid":"save-tags-button",children:"保存"})]})]})]}):null},getPickersLocalization=r=>({components:{MuiLocalizationProvider:{defaultProps:{localeText:_extends({},r)}}}}),enUSPickers={previousMonth:"Previous month",nextMonth:"Next month",openPreviousView:"Open previous view",openNextView:"Open next view",calendarViewSwitchingButtonAriaLabel:r=>r==="year"?"year view is open, switch to calendar view":"calendar view is open, switch to year view",start:"Start",end:"End",startDate:"Start date",startTime:"Start time",endDate:"End date",endTime:"End time",cancelButtonLabel:"Cancel",clearButtonLabel:"Clear",okButtonLabel:"OK",todayButtonLabel:"Today",nextStepButtonLabel:"Next",datePickerToolbarTitle:"Select date",dateTimePickerToolbarTitle:"Select date & time",timePickerToolbarTitle:"Select time",dateRangePickerToolbarTitle:"Select date range",timeRangePickerToolbarTitle:"Select time range",clockLabelText:(r,e)=>`Select ${r}. ${e?`Selected time is ${e}`:"No time selected"}`,hoursClockNumberText:r=>`${r} hours`,minutesClockNumberText:r=>`${r} minutes`,secondsClockNumberText:r=>`${r} seconds`,selectViewText:r=>`Select ${r}`,calendarWeekNumberHeaderLabel:"Week number",calendarWeekNumberHeaderText:"#",calendarWeekNumberAriaLabelText:r=>`Week ${r}`,calendarWeekNumberText:r=>`${r}`,openDatePickerDialogue:r=>r?`Choose date, selected date is ${r}`:"Choose date",openTimePickerDialogue:r=>r?`Choose time, selected time is ${r}`:"Choose time",openRangePickerDialogue:r=>r?`Choose range, selected range is ${r}`:"Choose range",fieldClearLabel:"Clear",timeTableLabel:"pick time",dateTableLabel:"pick date",fieldYearPlaceholder:r=>"Y".repeat(r.digitAmount),fieldMonthPlaceholder:r=>r.contentType==="letter"?"MMMM":"MM",fieldDayPlaceholder:()=>"DD",fieldWeekDayPlaceholder:r=>r.contentType==="letter"?"EEEE":"EE",fieldHoursPlaceholder:()=>"hh",fieldMinutesPlaceholder:()=>"mm",fieldSecondsPlaceholder:()=>"ss",fieldMeridiemPlaceholder:()=>"aa",year:"Year",month:"Month",day:"Day",weekDay:"Week day",hours:"Hours",minutes:"Minutes",seconds:"Seconds",meridiem:"Meridiem",empty:"Empty"},DEFAULT_LOCALE$1=enUSPickers;getPickersLocalization(enUSPickers);const _excluded$12=["localeText"],PickerAdapterContext=reactExports.createContext(null),LocalizationProvider=function r(e){const{localeText:t}=e,n=_objectWithoutPropertiesLoose(e,_excluded$12),{adapter:i,localeText:s}=reactExports.useContext(PickerAdapterContext)??{adapter:void 0,localeText:void 0},a=useThemeProps({props:n,name:"MuiLocalizationProvider"}),{children:o,dateAdapter:c,dateFormats:h,dateLibInstance:f,adapterLocale:m,localeText:g}=a,_=reactExports.useMemo(()=>_extends({},g,s,t),[g,s,t]),E=reactExports.useMemo(()=>{if(!c)return i||null;const I=new c({locale:m,formats:h,instance:f});if(!I.isMUIAdapter)throw new Error(["MUI X: The date adapter should be imported from `@mui/x-date-pickers` or `@mui/x-date-pickers-pro`, not from `@date-io`","For example, `import { AdapterDayjs } from '@mui/x-date-pickers/AdapterDayjs'` instead of `import AdapterDayjs from '@date-io/dayjs'`","More information on the installation documentation: https://mui.com/x/react-date-pickers/quickstart/#installation"].join(`
`));return I},[c,m,h,f,i]),A=reactExports.useMemo(()=>E?{minDate:E.date("1900-01-01T00:00:00.000"),maxDate:E.date("2099-12-31T00:00:00.000")}:null,[E]),C=reactExports.useMemo(()=>({utils:E,adapter:E,defaultDates:A,localeText:_}),[A,E,_]);return jsxRuntimeExports.jsx(PickerAdapterContext.Provider,{value:C,children:o})},useLocalizationContext=()=>{const r=reactExports.useContext(PickerAdapterContext);if(r===null)throw new Error(["MUI X: Can not find the date and time pickers localization context.","It looks like you forgot to wrap your component in LocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-date-pickers` package"].join(`
`));if(r.adapter===null)throw new Error(["MUI X: Can not find the date and time pickers adapter from its localization context.","It looks like you forgot to pass a `dateAdapter` to your LocalizationProvider."].join(`
`));const e=reactExports.useMemo(()=>_extends({},DEFAULT_LOCALE$1,r.localeText),[r.localeText]);return reactExports.useMemo(()=>_extends({},r,{localeText:e}),[r,e])},usePickerAdapter=()=>useLocalizationContext().adapter,usePickerTranslations=()=>useLocalizationContext().localeText,DATE_VALIDATION_PROP_NAMES=["disablePast","disableFuture","minDate","maxDate","shouldDisableDate","shouldDisableMonth","shouldDisableYear"],TIME_VALIDATION_PROP_NAMES=["disablePast","disableFuture","minTime","maxTime","shouldDisableTime","minutesStep","ampm","disableIgnoringDatePartForTimeValidation"],DATE_TIME_VALIDATION_PROP_NAMES=["minDateTime","maxDateTime"],VALIDATION_PROP_NAMES=[...DATE_VALIDATION_PROP_NAMES,...TIME_VALIDATION_PROP_NAMES,...DATE_TIME_VALIDATION_PROP_NAMES],extractValidationProps=r=>VALIDATION_PROP_NAMES.reduce((e,t)=>(r.hasOwnProperty(t)&&(e[t]=r[t]),e),{}),SHARED_FIELD_INTERNAL_PROP_NAMES=["value","defaultValue","referenceDate","format","formatDensity","onChange","timezone","onError","shouldRespectLeadingZeros","selectedSections","onSelectedSectionsChange","unstableFieldRef","unstableStartFieldRef","unstableEndFieldRef","enableAccessibleFieldDOMStructure","disabled","readOnly","dateSeparator","autoFocus","focused"],useSplitFieldProps=(r,e)=>reactExports.useMemo(()=>{const t=_extends({},r),n={},i=s=>{t.hasOwnProperty(s)&&(n[s]=t[s],delete t[s])};return SHARED_FIELD_INTERNAL_PROP_NAMES.forEach(i),e==="date"?DATE_VALIDATION_PROP_NAMES.forEach(i):e==="time"?TIME_VALIDATION_PROP_NAMES.forEach(i):e==="date-time"&&(DATE_VALIDATION_PROP_NAMES.forEach(i),TIME_VALIDATION_PROP_NAMES.forEach(i),DATE_TIME_VALIDATION_PROP_NAMES.forEach(i)),{forwardedProps:t,internalProps:n}},[r,e]),areViewsEqual=(r,e)=>r.length!==e.length?!1:e.every(t=>r.includes(t)),applyDefaultViewProps=({openTo:r,defaultOpenTo:e,views:t,defaultViews:n})=>{const i=t??n;let s;if(r!=null)s=r;else if(i.includes(e))s=e;else if(i.length>0)s=i[0];else throw new Error("MUI X: The `views` prop must contain at least one view.");return{views:i,openTo:s}},mergeDateAndTime=(r,e,t)=>{let n=e;return n=r.setHours(n,r.getHours(t)),n=r.setMinutes(n,r.getMinutes(t)),n=r.setSeconds(n,r.getSeconds(t)),n=r.setMilliseconds(n,r.getMilliseconds(t)),n},findClosestEnabledDate=({date:r,disableFuture:e,disablePast:t,maxDate:n,minDate:i,isDateDisabled:s,adapter:a,timezone:o})=>{const c=mergeDateAndTime(a,a.date(void 0,o),r);t&&a.isBefore(i,c)&&(i=c),e&&a.isAfter(n,c)&&(n=c);let h=r,f=r;for(a.isBefore(r,i)&&(h=i,f=null),a.isAfter(r,n)&&(f&&(f=n),h=null);h||f;){if(h&&a.isAfter(h,n)&&(h=null),f&&a.isBefore(f,i)&&(f=null),h){if(!s(h))return h;h=a.addDays(h,1)}if(f){if(!s(f))return f;f=a.addDays(f,-1)}}return null},replaceInvalidDateByNull=(r,e)=>r.isValid(e)?e:null,applyDefaultDate=(r,e,t)=>e==null||!r.isValid(e)?t:e,areDatesEqual=(r,e,t)=>!r.isValid(e)&&e!=null&&!r.isValid(t)&&t!=null?!0:r.isEqual(e,t),getMonthsInYear=(r,e)=>{const n=[r.startOfYear(e)];for(;n.length<12;){const i=n[n.length-1];n.push(r.addMonths(i,1))}return n},getTodayDate=(r,e,t)=>t==="date"?r.startOfDay(r.date(void 0,e)):r.date(void 0,e),formatMeridiem=(r,e)=>{const t=r.setHours(r.date(),e==="am"?2:14);return r.format(t,"meridiem")},DATE_VIEWS=["year","month","day"],isDatePickerView=r=>DATE_VIEWS.includes(r),resolveDateFormat=(r,{format:e,views:t},n)=>{if(e!=null)return e;const i=r.formats;return areViewsEqual(t,["year"])?i.year:areViewsEqual(t,["month"])?i.month:areViewsEqual(t,["day"])?i.dayOfMonth:areViewsEqual(t,["month","year"])?`${i.month} ${i.year}`:areViewsEqual(t,["day","month"])?`${i.month} ${i.dayOfMonth}`:i.keyboardDate},getWeekdays=(r,e)=>{const t=r.startOfWeek(e);return[0,1,2,3,4,5,6].map(n=>r.addDays(t,n))},getDateSectionConfigFromFormatToken=(r,e)=>{const t=r.formatTokenMap[e];if(t==null)throw new Error([`MUI X: The token "${e}" is not supported by the Date and Time Pickers.`,"Please try using another token or open an issue on https://github.com/mui/mui-x/issues/new/choose if you think it should be supported."].join(`
`));return typeof t=="string"?{type:t,contentType:t==="meridiem"?"letter":"digit",maxLength:void 0}:{type:t.sectionType,contentType:t.contentType,maxLength:t.maxLength}},getDaysInWeekStr=(r,e)=>{const t=[],n=r.date(void 0,"default"),i=r.startOfWeek(n),s=r.endOfWeek(n);let a=i;for(;r.isBefore(a,s);)t.push(a),a=r.addDays(a,1);return t.map(o=>r.formatByString(o,e))},getLetterEditingOptions=(r,e,t,n)=>{switch(t){case"month":return getMonthsInYear(r,r.date(void 0,e)).map(i=>r.formatByString(i,n));case"weekDay":return getDaysInWeekStr(r,n);case"meridiem":{const i=r.date(void 0,e);return[r.startOfDay(i),r.endOfDay(i)].map(s=>r.formatByString(s,n))}default:return[]}},FORMAT_SECONDS_NO_LEADING_ZEROS="s",NON_LOCALIZED_DIGITS=["0","1","2","3","4","5","6","7","8","9"],getLocalizedDigits=r=>{const e=r.date(void 0);return r.formatByString(r.setSeconds(e,0),FORMAT_SECONDS_NO_LEADING_ZEROS)==="0"?NON_LOCALIZED_DIGITS:Array.from({length:10}).map((n,i)=>r.formatByString(r.setSeconds(e,i),FORMAT_SECONDS_NO_LEADING_ZEROS))},removeLocalizedDigits=(r,e)=>{if(e[0]==="0")return r;const t=[];let n="";for(let i=0;i<r.length;i+=1){n+=r[i];const s=e.indexOf(n);s>-1&&(t.push(s.toString()),n="")}return t.join("")},applyLocalizedDigits=(r,e)=>e[0]==="0"?r:r.split("").map(t=>e[Number(t)]).join(""),isStringNumber=(r,e)=>{const t=removeLocalizedDigits(r,e);return t!==" "&&!Number.isNaN(Number(t))},cleanLeadingZeros=(r,e)=>Number(r).toString().padStart(e,"0"),cleanDigitSectionValue=(r,e,t,n,i)=>{if(i.type==="day"&&i.contentType==="digit-with-letter"){const a=r.setDate(t.longestMonth,e);return r.formatByString(a,i.format)}let s=e.toString();return i.hasLeadingZerosInInput&&(s=cleanLeadingZeros(s,i.maxLength)),applyLocalizedDigits(s,n)},getSectionVisibleValue=(r,e,t)=>{let n=r.value||r.placeholder;const i=e==="non-input"?r.hasLeadingZerosInFormat:r.hasLeadingZerosInInput;return e==="non-input"&&r.hasLeadingZerosInInput&&!r.hasLeadingZerosInFormat&&(n=Number(removeLocalizedDigits(n,t)).toString()),["input-rtl","input-ltr"].includes(e)&&r.contentType==="digit"&&!i&&n.length===1&&(n=`${n}‎`),e==="input-rtl"&&(n=`⁨${n}⁩`),n},changeSectionValueFormat=(r,e,t,n)=>r.formatByString(r.parse(e,t),n),isFourDigitYearFormat=(r,e)=>r.formatByString(r.date(void 0,"system"),e).length===4,doesSectionFormatHaveLeadingZeros=(r,e,t,n)=>{if(e!=="digit")return!1;const i=r.date(void 0,"default");switch(t){case"year":return r.lib==="dayjs"&&n==="YY"?!0:r.formatByString(r.setYear(i,1),n).startsWith("0");case"month":return r.formatByString(r.startOfYear(i),n).length>1;case"day":return r.formatByString(r.startOfMonth(i),n).length>1;case"weekDay":return r.formatByString(r.startOfWeek(i),n).length>1;case"hours":return r.formatByString(r.setHours(i,1),n).length>1;case"minutes":return r.formatByString(r.setMinutes(i,1),n).length>1;case"seconds":return r.formatByString(r.setSeconds(i,1),n).length>1;default:throw new Error("Invalid section type")}},getDateFromDateSections=(r,e,t)=>{const n=e.some(c=>c.type==="day"),i=[],s=[];for(let c=0;c<e.length;c+=1){const h=e[c];n&&h.type==="weekDay"||(i.push(h.format),s.push(getSectionVisibleValue(h,"non-input",t)))}const a=i.join(" "),o=s.join(" ");return r.parse(o,a)},createDateStrForV7HiddenInputFromSections=r=>r.map(e=>`${e.startSeparator}${e.value||e.placeholder}${e.endSeparator}`).join(""),createDateStrForV6InputFromSections=(r,e,t)=>{const i=r.map(s=>{const a=getSectionVisibleValue(s,t?"input-rtl":"input-ltr",e);return`${s.startSeparator}${a}${s.endSeparator}`}).join("");return t?`⁦${i}⁩`:i},getSectionsBoundaries=(r,e,t)=>{const n=r.date(void 0,t),i=r.endOfYear(n),s=r.endOfDay(n),{maxDaysInMonth:a,longestMonth:o}=getMonthsInYear(r,n).reduce((c,h)=>{const f=r.getDaysInMonth(h);return f>c.maxDaysInMonth?{maxDaysInMonth:f,longestMonth:h}:c},{maxDaysInMonth:0,longestMonth:null});return{year:({format:c})=>({minimum:0,maximum:isFourDigitYearFormat(r,c)?9999:99}),month:()=>({minimum:1,maximum:r.getMonth(i)+1}),day:({currentDate:c})=>({minimum:1,maximum:r.isValid(c)?r.getDaysInMonth(c):a,longestMonth:o}),weekDay:({format:c,contentType:h})=>{if(h==="digit"){const f=getDaysInWeekStr(r,c).map(Number);return{minimum:Math.min(...f),maximum:Math.max(...f)}}return{minimum:1,maximum:7}},hours:({format:c})=>{const h=r.getHours(s);return removeLocalizedDigits(r.formatByString(r.endOfDay(n),c),e)!==h.toString()?{minimum:1,maximum:Number(removeLocalizedDigits(r.formatByString(r.startOfDay(n),c),e))}:{minimum:0,maximum:h}},minutes:()=>({minimum:0,maximum:r.getMinutes(s)}),seconds:()=>({minimum:0,maximum:r.getSeconds(s)}),meridiem:()=>({minimum:0,maximum:1}),empty:()=>({minimum:0,maximum:0})}},transferDateSectionValue=(r,e,t,n)=>{switch(e.type){case"year":return r.setYear(n,r.getYear(t));case"month":return r.setMonth(n,r.getMonth(t));case"weekDay":{let i=r.formatByString(t,e.format);e.hasLeadingZerosInInput&&(i=cleanLeadingZeros(i,e.maxLength));const s=getDaysInWeekStr(r,e.format),a=s.indexOf(i),c=s.indexOf(e.value)-a;return r.addDays(t,c)}case"day":return r.setDate(n,r.getDate(t));case"meridiem":{const i=r.getHours(t)<12,s=r.getHours(n);return i&&s>=12?r.addHours(n,-12):!i&&s<12?r.addHours(n,12):n}case"hours":return r.setHours(n,r.getHours(t));case"minutes":return r.setMinutes(n,r.getMinutes(t));case"seconds":return r.setSeconds(n,r.getSeconds(t));default:return n}},reliableSectionModificationOrder={year:1,month:2,day:3,weekDay:4,hours:5,minutes:6,seconds:7,meridiem:8,empty:9},mergeDateIntoReferenceDate=(r,e,t,n,i)=>[...t].sort((s,a)=>reliableSectionModificationOrder[s.type]-reliableSectionModificationOrder[a.type]).reduce((s,a)=>!i||a.modified?transferDateSectionValue(r,a,e,s):s,n),isAndroid=()=>navigator.userAgent.toLowerCase().includes("android"),getSectionOrder=(r,e)=>{const t={};if(!e)return r.forEach((c,h)=>{const f=h===0?null:h-1,m=h===r.length-1?null:h+1;t[h]={leftIndex:f,rightIndex:m}}),{neighbors:t,startIndex:0,endIndex:r.length-1};const n={},i={};let s=0,a=0,o=r.length-1;for(;o>=0;){a=r.findIndex((c,h)=>{var f;return h>=s&&((f=c.endSeparator)==null?void 0:f.includes(" "))&&c.endSeparator!==" / "}),a===-1&&(a=r.length-1);for(let c=a;c>=s;c-=1)i[c]=o,n[o]=c,o-=1;s=a+1}return r.forEach((c,h)=>{const f=i[h],m=f===0?null:n[f-1],g=f===r.length-1?null:n[f+1];t[h]={leftIndex:m,rightIndex:g}}),{neighbors:t,startIndex:n[0],endIndex:n[r.length-1]}},parseSelectedSections=(r,e)=>{if(r==null)return null;if(r==="all")return"all";if(typeof r=="string"){const t=e.findIndex(n=>n.type===r);return t===-1?null:t}return r},expandFormat=({adapter:r,format:e})=>{let t=10,n=e,i=r.expandFormat(e);for(;i!==n;)if(n=i,i=r.expandFormat(n),t-=1,t<0)throw new Error("MUI X: The format expansion seems to be in an infinite loop. Please open an issue with the format passed to the component.");return i},getEscapedPartsFromFormat=({adapter:r,expandedFormat:e})=>{const t=[],{start:n,end:i}=r.escapedCharacters,s=new RegExp(`(\\${n}[^\\${i}]*\\${i})+`,"g");let a=null;for(;a=s.exec(e);)t.push({start:a.index,end:s.lastIndex-1});return t},getSectionPlaceholder=(r,e,t,n)=>{switch(t.type){case"year":return e.fieldYearPlaceholder({digitAmount:r.formatByString(r.date(void 0,"default"),n).length,format:n});case"month":return e.fieldMonthPlaceholder({contentType:t.contentType,format:n});case"day":return e.fieldDayPlaceholder({format:n});case"weekDay":return e.fieldWeekDayPlaceholder({contentType:t.contentType,format:n});case"hours":return e.fieldHoursPlaceholder({format:n});case"minutes":return e.fieldMinutesPlaceholder({format:n});case"seconds":return e.fieldSecondsPlaceholder({format:n});case"meridiem":return e.fieldMeridiemPlaceholder({format:n});default:return n}},createSection=({adapter:r,date:e,shouldRespectLeadingZeros:t,localeText:n,localizedDigits:i,now:s,token:a,startSeparator:o})=>{if(a==="")throw new Error("MUI X: Should not call `commitToken` with an empty token");const c=getDateSectionConfigFromFormatToken(r,a),h=doesSectionFormatHaveLeadingZeros(r,c.contentType,c.type,a),f=t?h:c.contentType==="digit",m=r.isValid(e);let g=m?r.formatByString(e,a):"",_=null;if(f)if(h)_=g===""?r.formatByString(s,a).length:g.length;else{if(c.maxLength==null)throw new Error(`MUI X: The token ${a} should have a 'maxLength' property on it's adapter`);_=c.maxLength,m&&(g=applyLocalizedDigits(cleanLeadingZeros(removeLocalizedDigits(g,i),_),i))}return _extends({},c,{format:a,maxLength:_,value:g,placeholder:getSectionPlaceholder(r,n,c,a),hasLeadingZerosInFormat:h,hasLeadingZerosInInput:f,startSeparator:o,endSeparator:"",modified:!1})},buildSections=r=>{var _;const{adapter:e,expandedFormat:t,escapedParts:n}=r,i=e.date(void 0),s=[];let a="";const o=Object.keys(e.formatTokenMap).sort((E,A)=>A.length-E.length),c=/^([a-zA-Z]+)/,h=new RegExp(`^(${o.join("|")})*$`),f=new RegExp(`^(${o.join("|")})`),m=E=>n.find(A=>A.start<=E&&A.end>=E);let g=0;for(;g<t.length;){const E=m(g),A=E!=null,C=(_=c.exec(t.slice(g)))==null?void 0:_[1];if(!A&&C!=null&&h.test(C)){let I=C;for(;I.length>0;){const b=f.exec(I)[1];I=I.slice(b.length),s.push(createSection(_extends({},r,{now:i,token:b,startSeparator:a}))),a=""}g+=C.length}else{const I=t[g];A&&(E==null?void 0:E.start)===g||(E==null?void 0:E.end)===g||(s.length===0?a+=I:(s[s.length-1].endSeparator+=I,s[s.length-1].isEndFormatSeparator=!0)),g+=1}}return s.length===0&&a.length>0&&s.push({type:"empty",contentType:"letter",maxLength:null,format:"",value:"",placeholder:"",hasLeadingZerosInFormat:!1,hasLeadingZerosInInput:!1,startSeparator:a,endSeparator:"",modified:!1}),s},postProcessSections=({isRtl:r,formatDensity:e,sections:t})=>t.map(n=>{const i=s=>{let a=s;return r&&a!==null&&a.includes(" ")&&(a=`⁩${a}⁦`),e==="spacious"&&["/",".","-"].includes(a)&&(a=` ${a} `),a};return n.startSeparator=i(n.startSeparator),n.endSeparator=i(n.endSeparator),n}),buildSectionsFromFormat=r=>{let e=expandFormat(r);r.isRtl&&r.enableAccessibleFieldDOMStructure&&(e=e.split(" ").reverse().join(" "));const t=getEscapedPartsFromFormat(_extends({},r,{expandedFormat:e})),n=buildSections(_extends({},r,{expandedFormat:e,escapedParts:t}));return postProcessSections(_extends({},r,{sections:n}))},PickerContext=reactExports.createContext(null),usePickerContext=()=>{const r=reactExports.useContext(PickerContext);if(r==null)throw new Error("MUI X: The `usePickerContext` hook can only be called inside the context of a Picker component");return r},useNullablePickerContext=()=>reactExports.useContext(PickerContext),IsValidValueContext=reactExports.createContext(()=>!0);function useIsValidValue(){return reactExports.useContext(IsValidValueContext)}const PickerFieldPrivateContext=reactExports.createContext(null);function useNullableFieldPrivateContext(){return reactExports.useContext(PickerFieldPrivateContext)}const PickerActionsContext=reactExports.createContext(null),PickerPrivateContext=reactExports.createContext({ownerState:{isPickerDisabled:!1,isPickerReadOnly:!1,isPickerValueEmpty:!1,isPickerOpen:!1,pickerVariant:"desktop",pickerOrientation:"portrait"},rootRefObject:{current:null},labelId:void 0,dismissViews:()=>{},hasUIView:!0,getCurrentViewMode:()=>"UI",triggerElement:null,viewContainerRole:null,defaultActionBarActions:[],onPopperExited:void 0});function PickerProvider(r){const{contextValue:e,actionsContextValue:t,privateContextValue:n,fieldPrivateContextValue:i,isValidContextValue:s,localeText:a,children:o}=r;return jsxRuntimeExports.jsx(PickerContext.Provider,{value:e,children:jsxRuntimeExports.jsx(PickerActionsContext.Provider,{value:t,children:jsxRuntimeExports.jsx(PickerPrivateContext.Provider,{value:n,children:jsxRuntimeExports.jsx(PickerFieldPrivateContext.Provider,{value:i,children:jsxRuntimeExports.jsx(IsValidValueContext.Provider,{value:s,children:jsxRuntimeExports.jsx(LocalizationProvider,{localeText:a,children:o})})})})})})}const usePickerActionsContext=()=>{const r=reactExports.useContext(PickerActionsContext);if(r==null)throw new Error(["MUI X: The `usePickerActionsContext` can only be called in fields that are used as a slot of a Picker component"].join(`
`));return r},useDefaultDates=()=>useLocalizationContext().defaultDates,useNow=r=>{const e=usePickerAdapter(),t=reactExports.useRef(void 0);return t.current===void 0&&(t.current=e.date(void 0,r)),t.current},ArrowDropDownIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M7 10l5 5 5-5z"})),ArrowLeftIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z"})),ArrowRightIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z"})),CalendarIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M17 12h-5v5h5v-5zM16 1v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-1V1h-2zm3 18H5V8h14v11z"}));createSvgIcon(jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),jsxRuntimeExports.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]}));const DateRangeIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"})),TimeIcon=createSvgIcon(jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),jsxRuntimeExports.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"})]})),ClearIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}));function getPickersArrowSwitcherUtilityClass(r){return generateUtilityClass("MuiPickersArrowSwitcher",r)}generateUtilityClasses("MuiPickersArrowSwitcher",["root","spacer","button","previousIconButton","nextIconButton","leftArrowIcon","rightArrowIcon"]);const usePickerPrivateContext=()=>reactExports.useContext(PickerPrivateContext),_excluded$11=["children","className","slots","slotProps","isNextDisabled","isNextHidden","onGoToNext","nextLabel","isPreviousDisabled","isPreviousHidden","onGoToPrevious","previousLabel","labelId","classes"],_excluded2$9=["ownerState"],_excluded3$1=["ownerState"],PickersArrowSwitcherRoot=styled("div",{name:"MuiPickersArrowSwitcher",slot:"Root"})({display:"flex"}),PickersArrowSwitcherSpacer=styled("div",{name:"MuiPickersArrowSwitcher",slot:"Spacer"})(({theme:r})=>({width:r.spacing(3)})),PickersArrowSwitcherButton=styled(IconButton,{name:"MuiPickersArrowSwitcher",slot:"Button"})({variants:[{props:{isButtonHidden:!0},style:{visibility:"hidden"}}]}),useUtilityClasses$F=r=>composeClasses({root:["root"],spacer:["spacer"],button:["button"],previousIconButton:["previousIconButton"],nextIconButton:["nextIconButton"],leftArrowIcon:["leftArrowIcon"],rightArrowIcon:["rightArrowIcon"]},getPickersArrowSwitcherUtilityClass,r),PickersArrowSwitcher=reactExports.forwardRef(function r(e,t){const n=useRtl(),i=useThemeProps({props:e,name:"MuiPickersArrowSwitcher"}),{children:s,className:a,slots:o,slotProps:c,isNextDisabled:h,isNextHidden:f,onGoToNext:m,nextLabel:g,isPreviousDisabled:_,isPreviousHidden:E,onGoToPrevious:A,previousLabel:C,labelId:I,classes:b}=i,R=_objectWithoutPropertiesLoose(i,_excluded$11),{ownerState:V}=usePickerPrivateContext(),U=useUtilityClasses$F(b),W={isDisabled:h,isHidden:f,goTo:m,label:g},j={isDisabled:_,isHidden:E,goTo:A,label:C},w=(o==null?void 0:o.previousIconButton)??PickersArrowSwitcherButton,P=useSlotProps({elementType:w,externalSlotProps:c==null?void 0:c.previousIconButton,additionalProps:{size:"medium",title:j.label,"aria-label":j.label,disabled:j.isDisabled,edge:"end",onClick:j.goTo},ownerState:_extends({},V,{isButtonHidden:j.isHidden??!1}),className:clsx(U.button,U.previousIconButton)}),K=(o==null?void 0:o.nextIconButton)??PickersArrowSwitcherButton,X=useSlotProps({elementType:K,externalSlotProps:c==null?void 0:c.nextIconButton,additionalProps:{size:"medium",title:W.label,"aria-label":W.label,disabled:W.isDisabled,edge:"start",onClick:W.goTo},ownerState:_extends({},V,{isButtonHidden:W.isHidden??!1}),className:clsx(U.button,U.nextIconButton)}),Y=(o==null?void 0:o.leftArrowIcon)??ArrowLeftIcon,Z=useSlotProps({elementType:Y,externalSlotProps:c==null?void 0:c.leftArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:V,className:U.leftArrowIcon}),ae=_objectWithoutPropertiesLoose(Z,_excluded2$9),le=(o==null?void 0:o.rightArrowIcon)??ArrowRightIcon,ie=useSlotProps({elementType:le,externalSlotProps:c==null?void 0:c.rightArrowIcon,additionalProps:{fontSize:"inherit"},ownerState:V,className:U.rightArrowIcon}),se=_objectWithoutPropertiesLoose(ie,_excluded3$1);return jsxRuntimeExports.jsxs(PickersArrowSwitcherRoot,_extends({ref:t,className:clsx(U.root,a),ownerState:V},R,{children:[jsxRuntimeExports.jsx(w,_extends({},P,{children:n?jsxRuntimeExports.jsx(le,_extends({},se)):jsxRuntimeExports.jsx(Y,_extends({},ae))})),s?jsxRuntimeExports.jsx(Typography,{variant:"subtitle1",component:"span",id:I,children:s}):jsxRuntimeExports.jsx(PickersArrowSwitcherSpacer,{className:U.spacer,ownerState:V}),jsxRuntimeExports.jsx(K,_extends({},X,{children:n?jsxRuntimeExports.jsx(Y,_extends({},ae)):jsxRuntimeExports.jsx(le,_extends({},se))}))]}))}),EXPORTED_TIME_VIEWS=["hours","minutes","seconds"],TIME_VIEWS=["hours","minutes","seconds","meridiem"],isTimeView=r=>EXPORTED_TIME_VIEWS.includes(r),isInternalTimeView=r=>TIME_VIEWS.includes(r),getMeridiem=(r,e)=>r?e.getHours(r)>=12?"pm":"am":null,convertValueToMeridiem=(r,e,t)=>t&&(r>=12?"pm":"am")!==e?e==="am"?r-12:r+12:r,convertToMeridiem=(r,e,t,n)=>{const i=convertValueToMeridiem(n.getHours(r),e,t);return n.setHours(r,i)},getSecondsInDay=(r,e)=>e.getHours(r)*3600+e.getMinutes(r)*60+e.getSeconds(r),createIsAfterIgnoreDatePart=(r,e)=>(t,n)=>r?e.isAfter(t,n):getSecondsInDay(t,e)>getSecondsInDay(n,e),resolveTimeFormat=(r,{format:e,views:t,ampm:n})=>{if(e!=null)return e;const i=r.formats;return areViewsEqual(t,["hours"])?n?`${i.hours12h} ${i.meridiem}`:i.hours24h:areViewsEqual(t,["minutes"])?i.minutes:areViewsEqual(t,["seconds"])?i.seconds:areViewsEqual(t,["minutes","seconds"])?`${i.minutes}:${i.seconds}`:areViewsEqual(t,["hours","minutes","seconds"])?n?`${i.hours12h}:${i.minutes}:${i.seconds} ${i.meridiem}`:`${i.hours24h}:${i.minutes}:${i.seconds}`:n?`${i.hours12h}:${i.minutes} ${i.meridiem}`:`${i.hours24h}:${i.minutes}`},DEFAULT_STEP_NAVIGATION={hasNextStep:!1,hasSeveralSteps:!1,goToNextStep:()=>{},areViewsInSameStep:()=>!0};function createStepNavigation(r){const{steps:e,isViewMatchingStep:t,onStepChange:n}=r;return i=>{if(e==null)return DEFAULT_STEP_NAVIGATION;const s=e.findIndex(o=>t(i.view,o)),a=s===-1||s===e.length-1?null:e[s+1];return{hasNextStep:a!=null,hasSeveralSteps:e.length>1,goToNextStep:()=>{a!=null&&n(_extends({},i,{step:a}))},areViewsInSameStep:(o,c)=>{const h=e.find(m=>t(o,m)),f=e.find(m=>t(c,m));return h===f}}}}function useViews({onChange:r,onViewChange:e,openTo:t,view:n,views:i,autoFocus:s,focusedView:a,onFocusedViewChange:o,getStepNavigation:c}){const h=reactExports.useRef(t),f=reactExports.useRef(i),m=reactExports.useRef(i.includes(t)?t:i[0]),[g,_]=useControlled({name:"useViews",state:"view",controlled:n,default:m.current}),E=reactExports.useRef(s?g:null),[A,C]=useControlled({name:"useViews",state:"focusedView",controlled:a,default:E.current}),I=c?c({setView:_,view:g,defaultView:m.current,views:i}):DEFAULT_STEP_NAVIGATION;reactExports.useEffect(()=>{(h.current&&h.current!==t||f.current&&f.current.some(P=>!i.includes(P)))&&(_(i.includes(t)?t:i[0]),f.current=i,h.current=t)},[t,_,g,i]);const b=i.indexOf(g),R=i[b-1]??null,V=i[b+1]??null,U=useEventCallback((P,K)=>{C(K?P:X=>P===X?null:X),o==null||o(P,K)}),W=useEventCallback(P=>{U(P,!0),P!==g&&(_(P),e&&e(P))}),j=useEventCallback(()=>{V&&W(V)}),w=useEventCallback((P,K,X)=>{const Y=K==="finish",Z=X?i.indexOf(X)<i.length-1:!!V;r(P,Y&&Z?"partial":K,X);let le=null;if(X!=null&&X!==g?le=X:Y&&(le=g),le==null)return;const ie=i[i.indexOf(le)+1];ie==null||!I.areViewsInSameStep(le,ie)||W(ie)});return _extends({},I,{view:g,setView:W,focusedView:A,setFocusedView:U,nextView:V,previousView:R,defaultView:i.includes(t)?t:i[0],goToNextView:j,setValueAndGoToNextView:w})}function useNextMonthDisabled(r,{disableFuture:e,maxDate:t,timezone:n}){const i=usePickerAdapter();return reactExports.useMemo(()=>{const s=i.date(void 0,n),a=i.startOfMonth(e&&i.isBefore(s,t)?s:t);return!i.isAfter(a,r)},[e,t,r,i,n])}function usePreviousMonthDisabled(r,{disablePast:e,minDate:t,timezone:n}){const i=usePickerAdapter();return reactExports.useMemo(()=>{const s=i.date(void 0,n),a=i.startOfMonth(e&&i.isAfter(s,t)?s:t);return!i.isBefore(a,r)},[e,t,r,i,n])}function useMeridiemMode(r,e,t,n){const i=usePickerAdapter(),s=reactExports.useMemo(()=>i.isValid(r)?r:null,[i,r]),a=getMeridiem(s,i),o=reactExports.useCallback(c=>{const h=s==null?null:convertToMeridiem(s,c,!!e,i);t(h,n??"partial")},[e,s,t,n,i]);return{meridiemMode:a,handleMeridiemChange:o}}const DAY_SIZE=36,DAY_MARGIN=2,DIALOG_WIDTH=320,MAX_CALENDAR_HEIGHT=280,VIEW_HEIGHT=336,DIGITAL_CLOCK_VIEW_HEIGHT=232,MULTI_SECTION_CLOCK_SECTION_WIDTH=48,PickerViewRoot=styled("div")({overflow:"hidden",width:DIALOG_WIDTH,maxHeight:VIEW_HEIGHT,display:"flex",flexDirection:"column",margin:"0 auto"}),useControlledValue=({name:r,timezone:e,value:t,defaultValue:n,referenceDate:i,onChange:s,valueManager:a})=>{const o=usePickerAdapter(),[c,h]=useControlled({name:r,state:"value",controlled:t,default:n??a.emptyValue}),f=reactExports.useMemo(()=>a.getTimezone(o,c),[o,a,c]),m=useEventCallback(A=>f==null?A:a.setTimezone(o,f,A)),g=reactExports.useMemo(()=>e||f||(i?o.getTimezone(Array.isArray(i)?i[0]:i):"default"),[e,f,i,o]),_=reactExports.useMemo(()=>a.setTimezone(o,g,c),[a,o,g,c]),E=useEventCallback((A,...C)=>{const I=m(A);h(I),s==null||s(I,...C)});return{value:_,handleValueChange:E,timezone:g}},SECTION_TYPE_GRANULARITY={year:1,month:2,day:3,hours:4,minutes:5,seconds:6,milliseconds:7},getSectionTypeGranularity=r=>Math.max(...r.map(e=>SECTION_TYPE_GRANULARITY[e.type]??1)),roundDate=(r,e,t)=>{if(e===SECTION_TYPE_GRANULARITY.year)return r.startOfYear(t);if(e===SECTION_TYPE_GRANULARITY.month)return r.startOfMonth(t);if(e===SECTION_TYPE_GRANULARITY.day)return r.startOfDay(t);let n=t;return e<SECTION_TYPE_GRANULARITY.minutes&&(n=r.setMinutes(n,0)),e<SECTION_TYPE_GRANULARITY.seconds&&(n=r.setSeconds(n,0)),e<SECTION_TYPE_GRANULARITY.milliseconds&&(n=r.setMilliseconds(n,0)),n},getDefaultReferenceDate=({props:r,adapter:e,granularity:t,timezone:n,getTodayDate:i})=>{let s=i?i():roundDate(e,t,getTodayDate(e,n));r.minDate!=null&&e.isAfterDay(r.minDate,s)&&(s=roundDate(e,t,r.minDate)),r.maxDate!=null&&e.isBeforeDay(r.maxDate,s)&&(s=roundDate(e,t,r.maxDate));const a=createIsAfterIgnoreDatePart(r.disableIgnoringDatePartForTimeValidation??!1,e);return r.minTime!=null&&a(r.minTime,s)&&(s=roundDate(e,t,r.disableIgnoringDatePartForTimeValidation?r.minTime:mergeDateAndTime(e,s,r.minTime))),r.maxTime!=null&&a(s,r.maxTime)&&(s=roundDate(e,t,r.disableIgnoringDatePartForTimeValidation?r.maxTime:mergeDateAndTime(e,s,r.maxTime))),s},_excluded$10=["value","referenceDate"],singleItemValueManager={emptyValue:null,getTodayValue:getTodayDate,getInitialReferenceValue:r=>{let{value:e,referenceDate:t}=r,n=_objectWithoutPropertiesLoose(r,_excluded$10);return n.adapter.isValid(e)?e:t??getDefaultReferenceDate(n)},cleanValue:replaceInvalidDateByNull,areValuesEqual:areDatesEqual,isSameError:(r,e)=>r===e,hasError:r=>r!=null,defaultErrorState:null,getTimezone:(r,e)=>r.isValid(e)?r.getTimezone(e):null,setTimezone:(r,e,t)=>t==null?null:r.setTimezone(t,e)},singleItemFieldValueManager={updateReferenceValue:(r,e,t)=>r.isValid(e)?e:t,getSectionsFromValue:(r,e)=>e(r),getV7HiddenInputValueFromSections:createDateStrForV7HiddenInputFromSections,getV6InputValueFromSections:createDateStrForV6InputFromSections,parseValueStr:(r,e,t)=>t(r.trim(),e),getDateFromSection:r=>r,getDateSectionsFromValue:r=>r,updateDateInValue:(r,e,t)=>t,clearDateSections:r=>r.map(e=>_extends({},e,{value:""}))},useClockReferenceDate=({value:r,referenceDate:e,adapter:t,props:n,timezone:i})=>{const s=reactExports.useMemo(()=>singleItemValueManager.getInitialReferenceValue({value:r,adapter:t,props:n,referenceDate:e,granularity:SECTION_TYPE_GRANULARITY.day,timezone:i,getTodayDate:()=>getTodayDate(t,i,"date")}),[e,i]);return r??s};function getDigitalClockUtilityClass(r){return generateUtilityClass("MuiDigitalClock",r)}const digitalClockClasses=generateUtilityClasses("MuiDigitalClock",["root","list","item"]);function arrayIncludes(r,e){return Array.isArray(e)?e.every(t=>r.indexOf(t)!==-1):r.indexOf(e)!==-1}const executeInTheNextEventLoopTick=r=>{setTimeout(r,0)},getActiveElementInternal=(r=document)=>{const e=r.activeElement;return e?e.shadowRoot?getActiveElementInternal(e.shadowRoot):e:null},getActiveElement=r=>getActiveElementInternal(ownerDocument(r)),getFocusedListItemIndex=r=>Array.from(r.children).indexOf(getActiveElement(r)),DEFAULT_DESKTOP_MODE_MEDIA_QUERY="@media (pointer: fine)";function mergeSx(...r){return r.reduce((e,t)=>(Array.isArray(t)?e.push(...t):t!=null&&e.push(t),e),[])}const _excluded$$=["ampm","timeStep","autoFocus","slots","slotProps","value","defaultValue","referenceDate","disableIgnoringDatePartForTimeValidation","maxTime","minTime","disableFuture","disablePast","minutesStep","shouldDisableTime","onChange","view","openTo","onViewChange","focusedView","onFocusedViewChange","className","classes","disabled","readOnly","views","skipDisabled","timezone"],useUtilityClasses$E=r=>composeClasses({root:["root"],list:["list"],item:["item"]},getDigitalClockUtilityClass,r),DigitalClockRoot=styled(PickerViewRoot,{name:"MuiDigitalClock",slot:"Root"})({overflowY:"auto",width:"100%",scrollbarWidth:"thin","@media (prefers-reduced-motion: no-preference)":{scrollBehavior:"auto"},maxHeight:DIGITAL_CLOCK_VIEW_HEIGHT,variants:[{props:{hasDigitalClockAlreadyBeenRendered:!0},style:{"@media (prefers-reduced-motion: no-preference)":{scrollBehavior:"smooth"}}}]}),DigitalClockList=styled(MenuList,{name:"MuiDigitalClock",slot:"List"})({padding:0}),DigitalClockItem=styled(MenuItem,{name:"MuiDigitalClock",slot:"Item",shouldForwardProp:r=>r!=="itemValue"&&r!=="formattedValue"})(({theme:r})=>({padding:"8px 16px",margin:"2px 4px","&:first-of-type":{marginTop:4},"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.primary.mainChannel} / ${r.vars.palette.action.hoverOpacity})`:alpha(r.palette.primary.main,r.palette.action.hoverOpacity)},"&.Mui-selected":{backgroundColor:(r.vars||r).palette.primary.main,color:(r.vars||r).palette.primary.contrastText,"&:focus-visible, &:hover":{backgroundColor:(r.vars||r).palette.primary.dark}},"&.Mui-focusVisible":{backgroundColor:r.vars?`rgba(${r.vars.palette.primary.mainChannel} / ${r.vars.palette.action.focusOpacity})`:alpha(r.palette.primary.main,r.palette.action.focusOpacity)}})),DigitalClock=reactExports.forwardRef(function r(e,t){const n=usePickerAdapter(),i=reactExports.useRef(null),s=useForkRef(t,i),a=reactExports.useRef(null),o=useThemeProps({props:e,name:"MuiDigitalClock"}),{ampm:c=n.is12HourCycleInCurrentLocale(),timeStep:h=30,autoFocus:f,slots:m,slotProps:g,value:_,defaultValue:E,referenceDate:A,disableIgnoringDatePartForTimeValidation:C=!1,maxTime:I,minTime:b,disableFuture:R,disablePast:V,minutesStep:U=1,shouldDisableTime:W,onChange:j,view:w,openTo:P,onViewChange:K,focusedView:X,onFocusedViewChange:Y,className:Z,classes:ae,disabled:le,readOnly:ie,views:se=["hours"],skipDisabled:ce=!1,timezone:ue}=o,Ae=_objectWithoutPropertiesLoose(o,_excluded$$),{value:Se,handleValueChange:ye,timezone:he}=useControlledValue({name:"DigitalClock",timezone:ue,value:_,defaultValue:E,referenceDate:A,onChange:j,valueManager:singleItemValueManager}),ke=usePickerTranslations(),Pe=useNow(he),{ownerState:Le}=usePickerPrivateContext(),$e=_extends({},Le,{hasDigitalClockAlreadyBeenRendered:!!i.current}),qe=useUtilityClasses$E(ae),xe=(m==null?void 0:m.digitalClockItem)??DigitalClockItem,Ie=useSlotProps({elementType:xe,externalSlotProps:g==null?void 0:g.digitalClockItem,ownerState:$e,className:qe.item}),Te=useClockReferenceDate({value:Se,referenceDate:A,adapter:n,props:o,timezone:he}),pe=useEventCallback(He=>ye(He,"finish","hours")),{setValueAndGoToNextView:Fe}=useViews({view:w,views:se,openTo:P,onViewChange:K,onChange:pe,focusedView:X,onFocusedViewChange:Y}),Re=useEventCallback(He=>{Fe(He,"finish")});useEnhancedEffect(()=>{if(i.current===null)return;const He=i.current.querySelector('[role="listbox"] [role="option"][tabindex="0"], [role="listbox"] [role="option"][aria-selected="true"]');if(!He)return;const Ne=He.offsetTop;(f||X)&&He.focus(),i.current.scrollTop=Ne-4});const Ue=reactExports.useCallback(He=>{const Ne=createIsAfterIgnoreDatePart(C,n),Be=()=>!(b&&Ne(b,He)||I&&Ne(He,I)||R&&Ne(He,Pe)||V&&Ne(Pe,He)),et=()=>n.getMinutes(He)%U!==0?!1:W?!W(He,"hours"):!0;return!Be()||!et()},[C,n,b,I,R,Pe,V,U,W]),Ve=reactExports.useMemo(()=>{const He=[];let Be=n.startOfDay(Te);for(;n.isSameDay(Te,Be);)He.push(Be),Be=n.addMinutes(Be,h);return He},[Te,h,n]),Me=Ve.findIndex(He=>n.isEqual(He,Te)),ze=He=>{switch(He.key){case"PageUp":{const Ne=getFocusedListItemIndex(a.current)-5,Be=a.current.children,et=Math.max(0,Ne),nt=Be[et];nt&&nt.focus(),He.preventDefault();break}case"PageDown":{const Ne=getFocusedListItemIndex(a.current)+5,Be=a.current.children,et=Math.min(Be.length-1,Ne),nt=Be[et];nt&&nt.focus(),He.preventDefault();break}}};return jsxRuntimeExports.jsx(DigitalClockRoot,_extends({ref:s,className:clsx(qe.root,Z),ownerState:$e},Ae,{children:jsxRuntimeExports.jsx(DigitalClockList,{ref:a,role:"listbox","aria-label":ke.timePickerToolbarTitle,className:qe.list,onKeyDown:ze,children:Ve.map((He,Ne)=>{const Be=Ue(He);if(ce&&Be)return null;const et=n.isEqual(He,Se),nt=n.format(He,c?"fullTime12h":"fullTime24h"),dr=Me===Ne||Me===-1&&Ne===0?0:-1;return jsxRuntimeExports.jsx(xe,_extends({onClick:()=>!ie&&Re(He),selected:et,disabled:le||Be,disableRipple:ie,role:"option","aria-disabled":ie,"aria-selected":et,tabIndex:dr,itemValue:He,formattedValue:nt},Ie,{children:nt}),`${He.valueOf()}-${nt}`)})})}))});function getMultiSectionDigitalClockUtilityClass(r){return generateUtilityClass("MuiMultiSectionDigitalClock",r)}const multiSectionDigitalClockClasses=generateUtilityClasses("MuiMultiSectionDigitalClock",["root"]);function getMultiSectionDigitalClockSectionUtilityClass(r){return generateUtilityClass("MuiMultiSectionDigitalClockSection",r)}const multiSectionDigitalClockSectionClasses=generateUtilityClasses("MuiMultiSectionDigitalClockSection",["root","item"]),_excluded$_=["autoFocus","onChange","className","classes","disabled","readOnly","items","active","slots","slotProps","skipDisabled"],useUtilityClasses$D=r=>composeClasses({root:["root"],item:["item"]},getMultiSectionDigitalClockSectionUtilityClass,r),MultiSectionDigitalClockSectionRoot=styled(MenuList,{name:"MuiMultiSectionDigitalClockSection",slot:"Root"})(({theme:r})=>({maxHeight:DIGITAL_CLOCK_VIEW_HEIGHT,width:56,padding:0,overflow:"hidden",scrollbarWidth:"thin","@media (prefers-reduced-motion: no-preference)":{scrollBehavior:"auto"},"@media (pointer: fine)":{"&:hover":{overflowY:"auto"}},"@media (pointer: none), (pointer: coarse)":{overflowY:"auto"},"&:not(:first-of-type)":{borderLeft:`1px solid ${(r.vars||r).palette.divider}`},variants:[{props:{hasDigitalClockAlreadyBeenRendered:!0},style:{"@media (prefers-reduced-motion: no-preference)":{scrollBehavior:"smooth"}}}]})),MultiSectionDigitalClockSectionItem=styled(MenuItem,{name:"MuiMultiSectionDigitalClockSection",slot:"Item"})(({theme:r})=>({padding:8,margin:"2px 4px",width:MULTI_SECTION_CLOCK_SECTION_WIDTH,justifyContent:"center","&:first-of-type":{marginTop:4},"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.primary.mainChannel} / ${r.vars.palette.action.hoverOpacity})`:alpha(r.palette.primary.main,r.palette.action.hoverOpacity)},"&.Mui-selected":{backgroundColor:(r.vars||r).palette.primary.main,color:(r.vars||r).palette.primary.contrastText,"&:focus-visible, &:hover":{backgroundColor:(r.vars||r).palette.primary.dark}},"&.Mui-focusVisible":{backgroundColor:r.vars?`rgba(${r.vars.palette.primary.mainChannel} / ${r.vars.palette.action.focusOpacity})`:alpha(r.palette.primary.main,r.palette.action.focusOpacity)}})),MultiSectionDigitalClockSection=reactExports.forwardRef(function r(e,t){const n=reactExports.useRef(null),i=useForkRef(t,n),s=reactExports.useRef(null),a=useThemeProps({props:e,name:"MuiMultiSectionDigitalClockSection"}),{autoFocus:o,onChange:c,className:h,classes:f,disabled:m,readOnly:g,items:_,active:E,slots:A,slotProps:C,skipDisabled:I}=a,b=_objectWithoutPropertiesLoose(a,_excluded$_),{ownerState:R}=usePickerPrivateContext(),V=_extends({},R,{hasDigitalClockAlreadyBeenRendered:!!n.current}),U=useUtilityClasses$D(f),W=(A==null?void 0:A.digitalClockSectionItem)??MultiSectionDigitalClockSectionItem;useEnhancedEffect(()=>{if(n.current===null)return;const P=n.current.querySelector('[role="option"][tabindex="0"], [role="option"][aria-selected="true"]');if(E&&o&&P&&P.focus(),!P||s.current===P)return;s.current=P;const K=P.offsetTop,X=P.offsetHeight,Y=n.current.clientHeight,Z=n.current.scrollHeight,ae=K-Y/2+X/2,le=Z-Y,ie=Math.min(ae,le);n.current.scrollTop=Math.max(0,ie)});const j=_.findIndex(P=>P.isFocused(P.value)),w=P=>{switch(P.key){case"PageUp":{const K=getFocusedListItemIndex(n.current)-5,X=n.current.children,Y=Math.max(0,K),Z=X[Y];Z&&Z.focus(),P.preventDefault();break}case"PageDown":{const K=getFocusedListItemIndex(n.current)+5,X=n.current.children,Y=Math.min(X.length-1,K),Z=X[Y];Z&&Z.focus(),P.preventDefault();break}}};return jsxRuntimeExports.jsx(MultiSectionDigitalClockSectionRoot,_extends({ref:i,className:clsx(U.root,h),ownerState:V,autoFocusItem:o&&E,role:"listbox",onKeyDown:w},b,{children:_.map((P,K)=>{var le;const X=(le=P.isDisabled)==null?void 0:le.call(P,P.value),Y=m||X;if(I&&Y)return null;const Z=P.isSelected(P.value),ae=j===K||j===-1&&K===0?0:-1;return jsxRuntimeExports.jsx(W,_extends({onClick:()=>!g&&c(P.value),selected:Z,disabled:Y,disableRipple:g,role:"option","aria-disabled":g||Y||void 0,"aria-label":P.ariaLabel,"aria-selected":Z,tabIndex:ae,className:U.item},C==null?void 0:C.digitalClockSectionItem,{children:P.label}),P.label)})}))}),getHourSectionOptions=({now:r,value:e,adapter:t,ampm:n,isDisabled:i,resolveAriaLabel:s,timeStep:a,valueOrReferenceDate:o})=>{const c=e?t.getHours(e):null,h=[],f=(_,E)=>{const A=E??c;return A===null?!1:n?_===12?A===12||A===0:A===_||A-12===_:A===_},m=_=>f(_,t.getHours(o)),g=n?11:23;for(let _=0;_<=g;_+=a){let E=t.format(t.setHours(r,_),n?"hours12h":"hours24h");const A=s(parseInt(E,10).toString());E=t.formatNumber(E),h.push({value:_,label:E,isSelected:f,isDisabled:i,isFocused:m,ariaLabel:A})}return h},getTimeSectionOptions=({value:r,adapter:e,isDisabled:t,timeStep:n,resolveLabel:i,resolveAriaLabel:s,hasValue:a=!0})=>{const o=h=>r===null?!1:a&&r===h,c=h=>r===h;return[...Array.from({length:Math.ceil(60/n)},(h,f)=>{const m=n*f;return{value:m,label:e.formatNumber(i(m)),isDisabled:t,isSelected:o,isFocused:c,ariaLabel:s(m.toString())}})]},_excluded$Z=["ampm","timeSteps","autoFocus","slots","slotProps","value","defaultValue","referenceDate","disableIgnoringDatePartForTimeValidation","maxTime","minTime","disableFuture","disablePast","minutesStep","shouldDisableTime","onChange","view","views","openTo","onViewChange","focusedView","onFocusedViewChange","className","classes","disabled","readOnly","skipDisabled","timezone"],useUtilityClasses$C=r=>composeClasses({root:["root"]},getMultiSectionDigitalClockUtilityClass,r),MultiSectionDigitalClockRoot=styled(PickerViewRoot,{name:"MuiMultiSectionDigitalClock",slot:"Root"})(({theme:r})=>({flexDirection:"row",width:"100%",borderBottom:`1px solid ${(r.vars||r).palette.divider}`})),MultiSectionDigitalClock=reactExports.forwardRef(function r(e,t){const n=usePickerAdapter(),i=useRtl(),s=useThemeProps({props:e,name:"MuiMultiSectionDigitalClock"}),{ampm:a=n.is12HourCycleInCurrentLocale(),timeSteps:o,autoFocus:c,slots:h,slotProps:f,value:m,defaultValue:g,referenceDate:_,disableIgnoringDatePartForTimeValidation:E=!1,maxTime:A,minTime:C,disableFuture:I,disablePast:b,minutesStep:R=1,shouldDisableTime:V,onChange:U,view:W,views:j=["hours","minutes"],openTo:w,onViewChange:P,focusedView:K,onFocusedViewChange:X,className:Y,classes:Z,disabled:ae,readOnly:le,skipDisabled:ie=!1,timezone:se}=s,ce=_objectWithoutPropertiesLoose(s,_excluded$Z),{value:ue,handleValueChange:Ae,timezone:Se}=useControlledValue({name:"MultiSectionDigitalClock",timezone:se,value:m,defaultValue:g,referenceDate:_,onChange:U,valueManager:singleItemValueManager}),ye=usePickerTranslations(),he=useNow(Se),ke=reactExports.useMemo(()=>_extends({hours:1,minutes:5,seconds:5},o),[o]),Pe=useClockReferenceDate({value:ue,referenceDate:_,adapter:n,props:s,timezone:Se}),Le=useEventCallback((Ne,Be,et)=>Ae(Ne,Be,et)),$e=reactExports.useMemo(()=>!a||!j.includes("hours")||j.includes("meridiem")?j:[...j,"meridiem"],[a,j]),{view:qe,setValueAndGoToNextView:xe,focusedView:Ie}=useViews({view:W,views:$e,openTo:w,onViewChange:P,onChange:Le,focusedView:K,onFocusedViewChange:X}),Te=useEventCallback(Ne=>{xe(Ne,"finish","meridiem")}),{meridiemMode:pe,handleMeridiemChange:Fe}=useMeridiemMode(Pe,a,Te,"finish"),Re=reactExports.useCallback((Ne,Be)=>{const et=createIsAfterIgnoreDatePart(E,n),nt=Be==="hours"||Be==="minutes"&&$e.includes("seconds"),ir=({start:Xe,end:Ke})=>!(C&&et(C,Ke)||A&&et(Xe,A)||I&&et(Xe,he)||b&&et(he,nt?Ke:Xe)),dr=(Xe,Ke=1)=>{if(Xe%Ke!==0)return!1;if(V)switch(Be){case"hours":return!V(n.setHours(Pe,Xe),"hours");case"minutes":return!V(n.setMinutes(Pe,Xe),"minutes");case"seconds":return!V(n.setSeconds(Pe,Xe),"seconds");default:return!1}return!0};switch(Be){case"hours":{const Xe=convertValueToMeridiem(Ne,pe,a),Ke=n.setHours(Pe,Xe);if(n.getHours(Ke)!==Xe)return!0;const cr=n.setSeconds(n.setMinutes(Ke,0),0),We=n.setSeconds(n.setMinutes(Ke,59),59);return!ir({start:cr,end:We})||!dr(Xe)}case"minutes":{const Xe=n.setMinutes(Pe,Ne),Ke=n.setSeconds(Xe,0),cr=n.setSeconds(Xe,59);return!ir({start:Ke,end:cr})||!dr(Ne,R)}case"seconds":{const Xe=n.setSeconds(Pe,Ne);return!ir({start:Xe,end:Xe})||!dr(Ne)}default:throw new Error("not supported")}},[a,Pe,E,A,pe,C,R,V,n,I,b,he,$e]),Ue=reactExports.useCallback(Ne=>{switch(Ne){case"hours":return{onChange:Be=>{const et=convertValueToMeridiem(Be,pe,a);xe(n.setHours(Pe,et),"finish","hours")},items:getHourSectionOptions({now:he,value:ue,ampm:a,adapter:n,isDisabled:Be=>Re(Be,"hours"),timeStep:ke.hours,resolveAriaLabel:ye.hoursClockNumberText,valueOrReferenceDate:Pe})};case"minutes":return{onChange:Be=>{xe(n.setMinutes(Pe,Be),"finish","minutes")},items:getTimeSectionOptions({value:n.getMinutes(Pe),adapter:n,isDisabled:Be=>Re(Be,"minutes"),resolveLabel:Be=>n.format(n.setMinutes(he,Be),"minutes"),timeStep:ke.minutes,hasValue:!!ue,resolveAriaLabel:ye.minutesClockNumberText})};case"seconds":return{onChange:Be=>{xe(n.setSeconds(Pe,Be),"finish","seconds")},items:getTimeSectionOptions({value:n.getSeconds(Pe),adapter:n,isDisabled:Be=>Re(Be,"seconds"),resolveLabel:Be=>n.format(n.setSeconds(he,Be),"seconds"),timeStep:ke.seconds,hasValue:!!ue,resolveAriaLabel:ye.secondsClockNumberText})};case"meridiem":{const Be=formatMeridiem(n,"am"),et=formatMeridiem(n,"pm");return{onChange:Fe,items:[{value:"am",label:Be,isSelected:()=>!!ue&&pe==="am",isFocused:()=>!!Pe&&pe==="am",ariaLabel:Be},{value:"pm",label:et,isSelected:()=>!!ue&&pe==="pm",isFocused:()=>!!Pe&&pe==="pm",ariaLabel:et}]}}default:throw new Error(`Unknown view: ${Ne} found.`)}},[he,ue,a,n,ke.hours,ke.minutes,ke.seconds,ye.hoursClockNumberText,ye.minutesClockNumberText,ye.secondsClockNumberText,pe,xe,Pe,Re,Fe]),Ve=reactExports.useMemo(()=>{if(!i)return $e;const Ne=$e.filter(Be=>Be!=="meridiem");return Ne.reverse(),$e.includes("meridiem")&&Ne.push("meridiem"),Ne},[i,$e]),Me=reactExports.useMemo(()=>$e.reduce((Ne,Be)=>_extends({},Ne,{[Be]:Ue(Be)}),{}),[$e,Ue]),{ownerState:ze}=usePickerPrivateContext(),He=useUtilityClasses$C(Z);return jsxRuntimeExports.jsx(MultiSectionDigitalClockRoot,_extends({ref:t,className:clsx(He.root,Y),ownerState:ze,role:"group"},ce,{children:Ve.map(Ne=>jsxRuntimeExports.jsx(MultiSectionDigitalClockSection,{items:Me[Ne].items,onChange:Me[Ne].onChange,active:qe===Ne,autoFocus:c||Ie===Ne,disabled:ae,readOnly:le,slots:h,slotProps:f,skipDisabled:ie,"aria-label":ye.selectViewText(Ne)},Ne))}))});function getPickersDayUtilityClass(r){return generateUtilityClass("MuiPickersDay",r)}const pickersDayClasses=generateUtilityClasses("MuiPickersDay",["root","dayWithMargin","dayOutsideMonth","hiddenDaySpacingFiller","today","selected","disabled"]);function usePickerDayOwnerState(r){const{disabled:e,selected:t,today:n,outsideCurrentMonth:i,day:s,disableMargin:a,disableHighlightToday:o,showDaysOutsideCurrentMonth:c}=r,h=usePickerAdapter(),{ownerState:f}=usePickerPrivateContext();return reactExports.useMemo(()=>_extends({},f,{day:s,isDaySelected:t??!1,isDayDisabled:e??!1,isDayCurrent:n??!1,isDayOutsideMonth:i??!1,isDayStartOfWeek:h.isSameDay(s,h.startOfWeek(s)),isDayEndOfWeek:h.isSameDay(s,h.endOfWeek(s)),disableMargin:a??!1,disableHighlightToday:o??!1,showDaysOutsideCurrentMonth:c??!1}),[h,f,s,t,e,n,i,a,o,c])}const _excluded$Y=["autoFocus","className","classes","hidden","isAnimating","onClick","onDaySelect","onFocus","onBlur","onKeyDown","onMouseDown","onMouseEnter","children","isFirstVisibleCell","isLastVisibleCell","day","selected","disabled","today","outsideCurrentMonth","disableMargin","disableHighlightToday","showDaysOutsideCurrentMonth"],useUtilityClasses$B=(r,e)=>{const{isDaySelected:t,isDayDisabled:n,isDayCurrent:i,isDayOutsideMonth:s,disableMargin:a,disableHighlightToday:o,showDaysOutsideCurrentMonth:c}=e,h=s&&!c;return composeClasses({root:["root",t&&!h&&"selected",n&&"disabled",!a&&"dayWithMargin",!o&&i&&"today",s&&c&&"dayOutsideMonth",h&&"hiddenDaySpacingFiller"],hiddenDaySpacingFiller:["hiddenDaySpacingFiller"]},getPickersDayUtilityClass,r)},styleArg=({theme:r})=>_extends({},r.typography.caption,{width:DAY_SIZE,height:DAY_SIZE,borderRadius:"50%",padding:0,backgroundColor:"transparent",transition:r.transitions.create("background-color",{duration:r.transitions.duration.short}),color:(r.vars||r).palette.text.primary,"@media (pointer: fine)":{"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.primary.mainChannel} / ${r.vars.palette.action.hoverOpacity})`:alpha(r.palette.primary.main,r.palette.action.hoverOpacity)}},"&:focus":{backgroundColor:r.vars?`rgba(${r.vars.palette.primary.mainChannel} / ${r.vars.palette.action.focusOpacity})`:alpha(r.palette.primary.main,r.palette.action.focusOpacity),[`&.${pickersDayClasses.selected}`]:{willChange:"background-color",backgroundColor:(r.vars||r).palette.primary.dark}},[`&.${pickersDayClasses.selected}`]:{color:(r.vars||r).palette.primary.contrastText,backgroundColor:(r.vars||r).palette.primary.main,fontWeight:r.typography.fontWeightMedium,"&:hover":{willChange:"background-color",backgroundColor:(r.vars||r).palette.primary.dark}},[`&.${pickersDayClasses.disabled}:not(.${pickersDayClasses.selected})`]:{color:(r.vars||r).palette.text.disabled},[`&.${pickersDayClasses.disabled}&.${pickersDayClasses.selected}`]:{opacity:.6},variants:[{props:{disableMargin:!1},style:{margin:`0 ${DAY_MARGIN}px`}},{props:{isDayOutsideMonth:!0,showDaysOutsideCurrentMonth:!0},style:{color:(r.vars||r).palette.text.secondary}},{props:{disableHighlightToday:!1,isDayCurrent:!0},style:{[`&:not(.${pickersDayClasses.selected})`]:{border:`1px solid ${(r.vars||r).palette.text.secondary}`}}}]}),overridesResolver=(r,e)=>{const{ownerState:t}=r;return[e.root,!t.disableMargin&&e.dayWithMargin,!t.disableHighlightToday&&t.isDayCurrent&&e.today,!t.isDayOutsideMonth&&t.showDaysOutsideCurrentMonth&&e.dayOutsideMonth,t.isDayOutsideMonth&&!t.showDaysOutsideCurrentMonth&&e.hiddenDaySpacingFiller]},PickersDayRoot=styled(ButtonBase,{name:"MuiPickersDay",slot:"Root",overridesResolver})(styleArg),PickersDayFiller=styled("div",{name:"MuiPickersDay",slot:"Root",overridesResolver})(({theme:r})=>_extends({},styleArg({theme:r}),{opacity:0,pointerEvents:"none"})),noop$2=()=>{},PickersDayRaw=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiPickersDay"}),{autoFocus:i=!1,className:s,classes:a,isAnimating:o,onClick:c,onDaySelect:h,onFocus:f=noop$2,onBlur:m=noop$2,onKeyDown:g=noop$2,onMouseDown:_=noop$2,onMouseEnter:E=noop$2,children:A,day:C,selected:I,disabled:b,today:R,outsideCurrentMonth:V,disableMargin:U,disableHighlightToday:W,showDaysOutsideCurrentMonth:j}=n,w=_objectWithoutPropertiesLoose(n,_excluded$Y),P=usePickerDayOwnerState({day:C,selected:I,disabled:b,today:R,outsideCurrentMonth:V,disableMargin:U,disableHighlightToday:W,showDaysOutsideCurrentMonth:j}),K=useUtilityClasses$B(a,P),X=usePickerAdapter(),Y=reactExports.useRef(null),Z=useForkRef(Y,t);useEnhancedEffect(()=>{i&&!b&&!o&&!V&&Y.current.focus()},[i,b,o,V]);const ae=ie=>{_(ie),V&&ie.preventDefault()},le=ie=>{ie.defaultMuiPrevented=!0,b||h(C),V&&ie.currentTarget.focus(),c&&c(ie)};return V&&!j?jsxRuntimeExports.jsx(PickersDayFiller,{className:clsx(K.root,K.hiddenDaySpacingFiller,s),ownerState:P,role:w.role}):jsxRuntimeExports.jsx(PickersDayRoot,_extends({className:clsx(K.root,s),ref:Z,centerRipple:!0,disabled:b,tabIndex:I?0:-1,onKeyDown:ie=>g(ie,C),onFocus:ie=>f(ie,C),onBlur:ie=>m(ie,C),onMouseEnter:ie=>E(ie,C),onClick:le,onMouseDown:ae},w,{ownerState:P,children:A??X.format(C,"dayOfMonth")}))}),PickersDay=reactExports.memo(PickersDayRaw),isQueryResponseWithoutValue=r=>r.saveQuery!=null,useFieldCharacterEditing=({stateResponse:{localizedDigits:r,sectionsValueBoundaries:e,state:t,timezone:n,setCharacterQuery:i,setTempAndroidValueStr:s,updateSectionValue:a}})=>{const o=usePickerAdapter(),c=({keyPressed:m,sectionIndex:g},_,E)=>{const A=m.toLowerCase(),C=t.sections[g];if(t.characterQuery!=null&&(!E||E(t.characterQuery.value))&&t.characterQuery.sectionIndex===g){const b=`${t.characterQuery.value}${A}`,R=_(b,C);if(!isQueryResponseWithoutValue(R))return i({sectionIndex:g,value:b,sectionType:C.type}),R}const I=_(A,C);return isQueryResponseWithoutValue(I)&&!I.saveQuery?(i(null),null):(i({sectionIndex:g,value:A,sectionType:C.type}),isQueryResponseWithoutValue(I)?null:I)},h=m=>{const g=(A,C,I)=>{const b=C.filter(R=>R.toLowerCase().startsWith(I));return b.length===0?{saveQuery:!1}:{sectionValue:b[0],shouldGoToNextSection:b.length===1}},_=(A,C,I,b)=>{const R=V=>getLetterEditingOptions(o,n,C.type,V);if(C.contentType==="letter")return g(C.format,R(C.format),A);if(I&&b!=null&&getDateSectionConfigFromFormatToken(o,I).contentType==="letter"){const V=R(I),U=g(I,V,A);return isQueryResponseWithoutValue(U)?{saveQuery:!1}:_extends({},U,{sectionValue:b(U.sectionValue,V)})}return{saveQuery:!1}};return c(m,(A,C)=>{switch(C.type){case"month":{const I=b=>changeSectionValueFormat(o,b,o.formats.month,C.format);return _(A,C,o.formats.month,I)}case"weekDay":{const I=(b,R)=>R.indexOf(b).toString();return _(A,C,o.formats.weekday,I)}case"meridiem":return _(A,C);default:return{saveQuery:!1}}})},f=m=>{const g=({queryValue:E,skipIfBelowMinimum:A,section:C})=>{const I=removeLocalizedDigits(E,r),b=Number(I),R=e[C.type]({currentDate:null,format:C.format,contentType:C.contentType});if(b>R.maximum)return{saveQuery:!1};if(A&&b<R.minimum)return{saveQuery:!0};const V=b*10>R.maximum||I.length===R.maximum.toString().length;return{sectionValue:cleanDigitSectionValue(o,b,R,r,C),shouldGoToNextSection:V}};return c(m,(E,A)=>{if(A.contentType==="digit"||A.contentType==="digit-with-letter")return g({queryValue:E,skipIfBelowMinimum:!1,section:A});if(A.type==="month"){doesSectionFormatHaveLeadingZeros(o,"digit","month","MM");const C=g({queryValue:E,skipIfBelowMinimum:!0,section:{type:A.type,format:"MM",hasLeadingZerosInInput:!0,contentType:"digit",maxLength:2}});if(isQueryResponseWithoutValue(C))return C;const I=changeSectionValueFormat(o,C.sectionValue,"MM",A.format);return _extends({},C,{sectionValue:I})}if(A.type==="weekDay"){const C=g({queryValue:E,skipIfBelowMinimum:!0,section:A});if(isQueryResponseWithoutValue(C))return C;const I=getDaysInWeekStr(o,A.format)[Number(C.sectionValue)-1];return _extends({},C,{sectionValue:I})}return{saveQuery:!1}},E=>isStringNumber(E,r))};return useEventCallback(m=>{const g=t.sections[m.sectionIndex],E=isStringNumber(m.keyPressed,r)?f(_extends({},m,{keyPressed:applyLocalizedDigits(m.keyPressed,r)})):h(m);if(E==null){s(null);return}a({section:g,newSectionValue:E.sectionValue,shouldGoToNextSection:E.shouldGoToNextSection})})},validateDate=({props:r,value:e,timezone:t,adapter:n})=>{if(e===null)return null;const{shouldDisableDate:i,shouldDisableMonth:s,shouldDisableYear:a,disablePast:o,disableFuture:c,minDate:h,maxDate:f}=r,m=n.date(void 0,t);switch(!0){case!n.isValid(e):return"invalidDate";case!!(i&&i(e)):return"shouldDisableDate";case!!(s&&s(e)):return"shouldDisableMonth";case!!(a&&a(e)):return"shouldDisableYear";case!!(c&&n.isAfterDay(e,m)):return"disableFuture";case!!(o&&n.isBeforeDay(e,m)):return"disablePast";case!!(h&&n.isBeforeDay(e,h)):return"minDate";case!!(f&&n.isAfterDay(e,f)):return"maxDate";default:return null}};validateDate.valueManager=singleItemValueManager;const validateTime=({adapter:r,value:e,timezone:t,props:n})=>{if(e===null)return null;const{minTime:i,maxTime:s,minutesStep:a,shouldDisableTime:o,disableIgnoringDatePartForTimeValidation:c=!1,disablePast:h,disableFuture:f}=n,m=r.date(void 0,t),g=createIsAfterIgnoreDatePart(c,r);switch(!0){case!r.isValid(e):return"invalidDate";case!!(i&&g(i,e)):return"minTime";case!!(s&&g(e,s)):return"maxTime";case!!(f&&r.isAfter(e,m)):return"disableFuture";case!!(h&&r.isBefore(e,m)):return"disablePast";case!!(o&&o(e,"hours")):return"shouldDisableTime-hours";case!!(o&&o(e,"minutes")):return"shouldDisableTime-minutes";case!!(o&&o(e,"seconds")):return"shouldDisableTime-seconds";case!!(a&&r.getMinutes(e)%a!==0):return"minutesStep";default:return null}};validateTime.valueManager=singleItemValueManager;const validateDateTime=({adapter:r,value:e,timezone:t,props:n})=>{const i=validateDate({adapter:r,value:e,timezone:t,props:n});return i!==null?i:validateTime({adapter:r,value:e,timezone:t,props:n})};validateDateTime.valueManager=singleItemValueManager;function useValidation(r){const{props:e,validator:t,value:n,timezone:i,onError:s}=r,a=usePickerAdapter(),o=reactExports.useRef(t.valueManager.defaultErrorState),c=t({adapter:a,value:n,timezone:i,props:e}),h=t.valueManager.hasError(c);reactExports.useEffect(()=>{s&&!t.valueManager.isSameError(c,o.current)&&s(c,n),o.current=c},[t,s,c,n]);const f=useEventCallback(m=>t({adapter:a,value:m,timezone:i,props:e}));return{validationError:c,hasValidationError:h,getValidationErrorForNewValue:f}}const QUERY_LIFE_DURATION_MS=5e3,useFieldState=r=>{var Ve;const e=usePickerAdapter(),t=usePickerTranslations(),n=useRtl(),{manager:{validator:i,valueType:s,internal_valueManager:a,internal_fieldValueManager:o},internalPropsWithDefaults:c,internalPropsWithDefaults:{value:h,defaultValue:f,referenceDate:m,onChange:g,format:_,formatDensity:E="dense",selectedSections:A,onSelectedSectionsChange:C,shouldRespectLeadingZeros:I=!1,timezone:b,enableAccessibleFieldDOMStructure:R=!0},forwardedProps:{error:V}}=r,{value:U,handleValueChange:W,timezone:j}=useControlledValue({name:"a field component",timezone:b,value:h,defaultValue:f,referenceDate:m,onChange:g,valueManager:a}),w=reactExports.useRef(U);reactExports.useEffect(()=>{w.current=U},[U]);const{hasValidationError:P}=useValidation({props:c,validator:i,timezone:j,value:U,onError:c.onError}),K=reactExports.useMemo(()=>V!==void 0?V:P,[P,V]),X=reactExports.useMemo(()=>getLocalizedDigits(e),[e]),Y=reactExports.useMemo(()=>getSectionsBoundaries(e,X,j),[e,X,j]),Z=reactExports.useCallback(Me=>o.getSectionsFromValue(Me,ze=>buildSectionsFromFormat({adapter:e,localeText:t,localizedDigits:X,format:_,date:ze,formatDensity:E,shouldRespectLeadingZeros:I,enableAccessibleFieldDOMStructure:R,isRtl:n})),[o,_,t,X,n,I,e,E,R]),[ae,le]=reactExports.useState(()=>{const Me=Z(U),ze={sections:Me,lastExternalValue:U,lastSectionsDependencies:{format:_,isRtl:n,locale:e.locale},tempValueStrAndroid:null,characterQuery:null},He=getSectionTypeGranularity(Me),Ne=a.getInitialReferenceValue({referenceDate:m,value:U,adapter:e,props:c,granularity:He,timezone:j});return _extends({},ze,{referenceValue:Ne})}),[ie,se]=useControlled({controlled:A,default:null,name:"useField",state:"selectedSections"}),ce=Me=>{se(Me),C==null||C(Me)},ue=reactExports.useMemo(()=>parseSelectedSections(ie,ae.sections),[ie,ae.sections]),Ae=ue==="all"?0:ue,Se=reactExports.useMemo(()=>getSectionOrder(ae.sections,n&&!R),[ae.sections,n,R]),ye=reactExports.useMemo(()=>ae.sections.every(Me=>Me.value===""),[ae.sections]),he=Me=>{const ze={validationError:i({adapter:e,value:Me,timezone:j,props:c})};W(Me,ze)},ke=(Me,ze)=>{const He=[...ae.sections];return He[Me]=_extends({},He[Me],{value:ze,modified:!0}),He},Pe=reactExports.useRef(null),Le=useTimeout(),$e=Me=>{Ae!=null&&(Pe.current={sectionIndex:Ae,value:Me},Le.start(0,()=>{Pe.current=null}))},qe=()=>{a.areValuesEqual(e,U,a.emptyValue)?le(Me=>_extends({},Me,{sections:Me.sections.map(ze=>_extends({},ze,{value:""})),tempValueStrAndroid:null,characterQuery:null})):(le(Me=>_extends({},Me,{characterQuery:null})),he(a.emptyValue))},xe=()=>{if(Ae==null)return;const Me=ae.sections[Ae];Me.value!==""&&($e(""),o.getDateFromSection(U,Me)===null?le(ze=>_extends({},ze,{sections:ke(Ae,""),tempValueStrAndroid:null,characterQuery:null})):(le(ze=>_extends({},ze,{characterQuery:null})),he(o.updateDateInValue(U,Me,null))))},Ie=Me=>{const ze=(Ne,Be)=>{const et=e.parse(Ne,_);if(!e.isValid(et))return null;const nt=buildSectionsFromFormat({adapter:e,localeText:t,localizedDigits:X,format:_,date:et,formatDensity:E,shouldRespectLeadingZeros:I,enableAccessibleFieldDOMStructure:R,isRtl:n});return mergeDateIntoReferenceDate(e,et,nt,Be,!1)},He=o.parseValueStr(Me,ae.referenceValue,ze);he(He)},Te=useTimeout(),pe=({section:Me,newSectionValue:ze,shouldGoToNextSection:He})=>{Le.clear(),Te.clear();const Ne=o.getDateFromSection(U,Me);He&&Ae<ae.sections.length-1&&ce(Ae+1);const Be=ke(Ae,ze),et=o.getDateSectionsFromValue(Be,Me),nt=getDateFromDateSections(e,et,X);if(e.isValid(nt)){const ir=mergeDateIntoReferenceDate(e,nt,et,o.getDateFromSection(ae.referenceValue,Me),!0);return Ne==null&&Te.start(0,()=>{w.current===U&&le(dr=>_extends({},dr,{sections:o.clearDateSections(ae.sections,Me),tempValueStrAndroid:null}))}),he(o.updateDateInValue(U,Me,ir))}return et.every(ir=>ir.value!=="")&&(Ne==null||e.isValid(Ne))?($e(ze),he(o.updateDateInValue(U,Me,nt))):Ne!=null?($e(ze),he(o.updateDateInValue(U,Me,null))):le(ir=>_extends({},ir,{sections:Be,tempValueStrAndroid:null}))},Fe=Me=>le(ze=>_extends({},ze,{tempValueStrAndroid:Me})),Re=useEventCallback(Me=>{le(ze=>_extends({},ze,{characterQuery:Me}))});if(U!==ae.lastExternalValue){let Me;Pe.current!=null&&!e.isValid(o.getDateFromSection(U,ae.sections[Pe.current.sectionIndex]))?Me=ke(Pe.current.sectionIndex,Pe.current.value):Me=Z(U),le(ze=>_extends({},ze,{lastExternalValue:U,sections:Me,sectionsDependencies:{format:_,isRtl:n,locale:e.locale},referenceValue:o.updateReferenceValue(e,U,ze.referenceValue),tempValueStrAndroid:null}))}if(n!==ae.lastSectionsDependencies.isRtl||_!==ae.lastSectionsDependencies.format||e.locale!==ae.lastSectionsDependencies.locale){const Me=Z(U);le(ze=>_extends({},ze,{lastSectionsDependencies:{format:_,isRtl:n,locale:e.locale},sections:Me,tempValueStrAndroid:null,characterQuery:null}))}ae.characterQuery!=null&&!K&&Ae==null&&Re(null),ae.characterQuery!=null&&((Ve=ae.sections[ae.characterQuery.sectionIndex])==null?void 0:Ve.type)!==ae.characterQuery.sectionType&&Re(null),reactExports.useEffect(()=>{Pe.current!=null&&(Pe.current=null)});const Ue=useTimeout();return reactExports.useEffect(()=>(ae.characterQuery!=null&&Ue.start(QUERY_LIFE_DURATION_MS,()=>Re(null)),()=>{}),[ae.characterQuery,Re,Ue]),reactExports.useEffect(()=>{ae.tempValueStrAndroid!=null&&Ae!=null&&xe()},[ae.sections]),{activeSectionIndex:Ae,areAllSectionsEmpty:ye,error:K,localizedDigits:X,parsedSelectedSections:ue,sectionOrder:Se,sectionsValueBoundaries:Y,state:ae,timezone:j,value:U,clearValue:qe,clearActiveSection:xe,setCharacterQuery:Re,setSelectedSections:ce,setTempAndroidValueStr:Fe,updateSectionValue:pe,updateValueFromValueStr:Ie,getSectionsFromValue:Z}};function useFieldInternalPropsWithDefaults(r){const{manager:{internal_useApplyDefaultValuesToFieldInternalProps:e},internalProps:t,skipContextFieldRefAssignment:n}=r,i=useNullablePickerContext(),s=useNullableFieldPrivateContext(),a=useForkRef(t.unstableFieldRef,n?null:s==null?void 0:s.fieldRef),o=i==null?void 0:i.setValue,c=reactExports.useCallback((f,m)=>o==null?void 0:o(f,{validationError:m.validationError,shouldClose:!1}),[o]),h=reactExports.useMemo(()=>s!=null&&i!=null?_extends({value:i.value,onChange:c,timezone:i.timezone,disabled:i.disabled,readOnly:i.readOnly,autoFocus:i.autoFocus&&!i.open,focused:i.open?!0:void 0,format:i.fieldFormat,formatDensity:s.formatDensity,enableAccessibleFieldDOMStructure:s.enableAccessibleFieldDOMStructure,selectedSections:s.selectedSections,onSelectedSectionsChange:s.onSelectedSectionsChange,unstableFieldRef:a},t):t,[i,s,t,c,a]);return e(h)}function syncSelectionToDOM(r){const{focused:e,domGetters:t,stateResponse:{parsedSelectedSections:n,state:i}}=r;if(!t.isReady())return;const s=ownerDocument(t.getRoot()).getSelection();if(!s)return;if(n==null){s.rangeCount>0&&s.getRangeAt(0).startContainer instanceof Node&&t.getRoot().contains(s.getRangeAt(0).startContainer)&&s.removeAllRanges(),e&&t.getRoot().blur();return}if(!t.getRoot().contains(getActiveElement(t.getRoot())))return;const a=new window.Range;let o;n==="all"?o=t.getRoot():i.sections[n].type==="empty"?o=t.getSectionContainer(n):o=t.getSectionContent(n),a.selectNodeContents(o),o.focus(),s.removeAllRanges(),s.addRange(a)}function useFieldRootHandleKeyDown(r){const e=usePickerAdapter(),{manager:{internal_fieldValueManager:t},internalPropsWithDefaults:{minutesStep:n,disabled:i,readOnly:s},stateResponse:{state:a,value:o,activeSectionIndex:c,parsedSelectedSections:h,sectionsValueBoundaries:f,localizedDigits:m,timezone:g,sectionOrder:_,clearValue:E,clearActiveSection:A,setSelectedSections:C,updateSectionValue:I}}=r;return useEventCallback(b=>{if(!i)switch(!0){case((b.ctrlKey||b.metaKey)&&String.fromCharCode(b.keyCode)==="A"&&!b.shiftKey&&!b.altKey):{b.preventDefault(),C("all");break}case b.key==="ArrowRight":{if(b.preventDefault(),h==null)C(_.startIndex);else if(h==="all")C(_.endIndex);else{const R=_.neighbors[h].rightIndex;R!==null&&C(R)}break}case b.key==="ArrowLeft":{if(b.preventDefault(),h==null)C(_.endIndex);else if(h==="all")C(_.startIndex);else{const R=_.neighbors[h].leftIndex;R!==null&&C(R)}break}case b.key==="Delete":{if(b.preventDefault(),s)break;h==null||h==="all"?E():A();break}case["ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(b.key):{if(b.preventDefault(),s||c==null)break;h==="all"&&C(c);const R=a.sections[c],V=adjustSectionValue(e,g,R,b.key,f,m,t.getDateFromSection(o,R),{minutesStep:n});I({section:R,newSectionValue:V,shouldGoToNextSection:!1});break}}})}function getDeltaFromKeyCode(r){switch(r){case"ArrowUp":return 1;case"ArrowDown":return-1;case"PageUp":return 5;case"PageDown":return-5;default:return 0}}function adjustSectionValue(r,e,t,n,i,s,a,o){const c=getDeltaFromKeyCode(n),h=n==="Home",f=n==="End",m=t.value===""||h||f,g=()=>{const E=i[t.type]({currentDate:a,format:t.format,contentType:t.contentType}),A=b=>cleanDigitSectionValue(r,b,E,s,t),C=t.type==="minutes"&&(o!=null&&o.minutesStep)?o.minutesStep:1;let I;if(m){if(t.type==="year"&&!f&&!h)return r.formatByString(r.date(void 0,e),t.format);c>0||h?I=E.minimum:I=E.maximum}else I=parseInt(removeLocalizedDigits(t.value,s),10)+c*C;return I%C!==0&&((c<0||h)&&(I+=C-(C+I)%C),(c>0||f)&&(I-=I%C)),I>E.maximum?A(E.minimum+(I-E.maximum-1)%(E.maximum-E.minimum+1)):I<E.minimum?A(E.maximum-(E.minimum-I-1)%(E.maximum-E.minimum+1)):A(I)},_=()=>{const E=getLetterEditingOptions(r,e,t.type,t.format);if(E.length===0)return t.value;if(m)return c>0||h?E[0]:E[E.length-1];const I=((E.indexOf(t.value)+c)%E.length+E.length)%E.length;return E[I]};return t.contentType==="digit"||t.contentType==="digit-with-letter"?g():_()}function useFieldRootProps(r){const{manager:e,focused:t,setFocused:n,domGetters:i,stateResponse:s,applyCharacterEditing:a,internalPropsWithDefaults:o,stateResponse:{parsedSelectedSections:c,sectionOrder:h,state:f,clearValue:m,setCharacterQuery:g,setSelectedSections:_,updateValueFromValueStr:E},internalPropsWithDefaults:{disabled:A=!1,readOnly:C=!1}}=r,I=useFieldRootHandleKeyDown({manager:e,internalPropsWithDefaults:o,stateResponse:s}),b=useTimeout(),R=useEventCallback(w=>{A||!i.isReady()||(n(!0),c==="all"?b.start(0,()=>{const P=document.getSelection().getRangeAt(0).startOffset;if(P===0){_(h.startIndex);return}let K=0,X=0;for(;X<P&&K<f.sections.length;){const Y=f.sections[K];K+=1,X+=`${Y.startSeparator}${Y.value||Y.placeholder}${Y.endSeparator}`.length}_(K-1)}):t?i.getRoot().contains(w.target)||_(h.startIndex):(n(!0),_(h.startIndex)))}),V=useEventCallback(w=>{if(!i.isReady()||c!=="all")return;const K=w.target.textContent??"";i.getRoot().innerHTML=f.sections.map(X=>`${X.startSeparator}${X.value||X.placeholder}${X.endSeparator}`).join(""),syncSelectionToDOM({focused:t,domGetters:i,stateResponse:s}),K.length===0||K.charCodeAt(0)===10?(m(),_("all")):K.length>1?E(K):(c==="all"&&_(0),a({keyPressed:K,sectionIndex:0}))}),U=useEventCallback(w=>{if(C||c!=="all"){w.preventDefault();return}const P=w.clipboardData.getData("text");w.preventDefault(),g(null),E(P)}),W=useEventCallback(()=>{if(t||A||!i.isReady())return;const w=getActiveElement(i.getRoot());n(!0),i.getSectionIndexFromDOMElement(w)!=null||_(h.startIndex)}),j=useEventCallback(()=>{setTimeout(()=>{if(!i.isReady())return;const w=getActiveElement(i.getRoot());!i.getRoot().contains(w)&&(n(!1),_(null))})});return{onKeyDown:I,onBlur:j,onFocus:W,onClick:R,onPaste:U,onInput:V,contentEditable:c==="all",tabIndex:c===0?-1:0}}function useFieldHiddenInputProps(r){const{manager:{internal_fieldValueManager:e},stateResponse:{areAllSectionsEmpty:t,state:n,updateValueFromValueStr:i}}=r,s=useEventCallback(o=>{i(o.target.value)});return{value:reactExports.useMemo(()=>t?"":e.getV7HiddenInputValueFromSections(n.sections),[t,n.sections,e]),onChange:s}}function useFieldSectionContainerProps(r){const{stateResponse:{setSelectedSections:e},internalPropsWithDefaults:{disabled:t=!1}}=r,n=reactExports.useCallback(i=>s=>{t||s.isDefaultPrevented()||e(i)},[t,e]);return reactExports.useCallback(i=>({"data-sectionindex":i,onClick:n(i)}),[n])}function useFieldSectionContentProps(r){const e=usePickerAdapter(),t=usePickerTranslations(),{focused:n,domGetters:i,stateResponse:s,applyCharacterEditing:a,manager:{internal_fieldValueManager:o},stateResponse:{parsedSelectedSections:c,sectionsValueBoundaries:h,state:f,value:m,clearActiveSection:g,setCharacterQuery:_,setSelectedSections:E,updateSectionValue:A,updateValueFromValueStr:C},internalPropsWithDefaults:{disabled:I=!1,readOnly:b=!1}}=r,R=c==="all",V=!R&&!I&&!b,U=useEventCallback(X=>{if(!i.isReady())return;const Y=f.sections[X];i.getSectionContent(X).innerHTML=Y.value||Y.placeholder,syncSelectionToDOM({focused:n,domGetters:i,stateResponse:s})}),W=useEventCallback(X=>{if(!i.isReady())return;const Y=X.target,Z=Y.textContent??"",ae=i.getSectionIndexFromDOMElement(Y),le=f.sections[ae];if(b){U(ae);return}if(Z.length===0){if(le.value===""){U(ae);return}const ie=X.nativeEvent.inputType;if(ie==="insertParagraph"||ie==="insertLineBreak"){U(ae);return}U(ae),g();return}a({keyPressed:Z,sectionIndex:ae}),U(ae)}),j=useEventCallback(X=>{X.preventDefault()}),w=useEventCallback(X=>{if(X.preventDefault(),b||I||typeof c!="number")return;const Y=f.sections[c],Z=X.clipboardData.getData("text"),ae=/^[a-zA-Z]+$/.test(Z),le=/^[0-9]+$/.test(Z),ie=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(Z);Y.contentType==="letter"&&ae||Y.contentType==="digit"&&le||Y.contentType==="digit-with-letter"&&ie?(_(null),A({section:Y,newSectionValue:Z,shouldGoToNextSection:!0})):!ae&&!le&&(_(null),C(Z))}),P=useEventCallback(X=>{X.preventDefault(),X.dataTransfer.dropEffect="none"}),K=reactExports.useCallback(X=>()=>{I||E(X)},[I,E]);return reactExports.useCallback((X,Y)=>{const Z=h[X.type]({currentDate:o.getDateFromSection(m,X),contentType:X.contentType,format:X.format});return{onInput:W,onPaste:w,onMouseUp:j,onDragOver:P,onFocus:K(Y),"aria-readonly":b,"aria-valuenow":getSectionValueNow(X,e),"aria-valuemin":Z.minimum,"aria-valuemax":Z.maximum,"aria-valuetext":X.value?getSectionValueText(X,e):t.empty,"aria-label":t[X.type],"aria-disabled":I,tabIndex:R||Y>0?-1:0,contentEditable:!R&&!I&&!b,role:"spinbutton","data-range-position":X.dateName||void 0,spellCheck:V?!1:void 0,autoCapitalize:V?"off":void 0,autoCorrect:V?"off":void 0,children:X.value||X.placeholder,inputMode:X.contentType==="letter"?"text":"numeric"}},[h,R,I,b,V,t,e,W,w,j,P,K,o,m])}function getSectionValueText(r,e){if(r.value)switch(r.type){case"month":{if(r.contentType==="digit"){const n=e.setMonth(e.date(),Number(r.value)-1);return e.isValid(n)?e.format(n,"month"):""}const t=e.parse(r.value,r.format);return t&&e.isValid(t)?e.format(t,"month"):void 0}case"day":if(r.contentType==="digit"){const t=e.setDate(e.startOfYear(e.date()),Number(r.value));return e.isValid(t)?e.format(t,"dayOfMonthFull"):""}return r.value;case"weekDay":return;default:return}}function getSectionValueNow(r,e){if(r.value)switch(r.type){case"weekDay":return r.contentType==="letter"?void 0:Number(r.value);case"meridiem":{const t=e.parse(`01:00 ${r.value}`,`${e.formats.hours12h}:${e.formats.minutes} ${r.format}`);return t?e.getHours(t)>=12?1:0:void 0}case"day":return r.contentType==="digit-with-letter"?parseInt(r.value,10):Number(r.value);case"month":{if(r.contentType==="digit")return Number(r.value);const t=e.parse(r.value,r.format);return t?e.getMonth(t)+1:void 0}default:return r.contentType!=="letter"?Number(r.value):void 0}}const useFieldV7TextField=r=>{const{props:e,manager:t,skipContextFieldRefAssignment:n,manager:{valueType:i,internal_useOpenPickerButtonAriaLabel:s}}=r,{internalProps:a,forwardedProps:o}=useSplitFieldProps(e,i),c=useFieldInternalPropsWithDefaults({manager:t,internalProps:a,skipContextFieldRefAssignment:n}),{sectionListRef:h,onBlur:f,onClick:m,onFocus:g,onInput:_,onPaste:E,onKeyDown:A,onClear:C,clearable:I}=o,{disabled:b=!1,readOnly:R=!1,autoFocus:V=!1,focused:U,unstableFieldRef:W}=c,j=reactExports.useRef(null),w=useForkRef(h,j),P=reactExports.useMemo(()=>({isReady:()=>j.current!=null,getRoot:()=>j.current.getRoot(),getSectionContainer:Ve=>j.current.getSectionContainer(Ve),getSectionContent:Ve=>j.current.getSectionContent(Ve),getSectionIndexFromDOMElement:Ve=>j.current.getSectionIndexFromDOMElement(Ve)}),[j]),K=useFieldState({manager:t,internalPropsWithDefaults:c,forwardedProps:o}),{areAllSectionsEmpty:X,error:Y,parsedSelectedSections:Z,sectionOrder:ae,state:le,value:ie,clearValue:se,setSelectedSections:ce}=K,ue=useFieldCharacterEditing({stateResponse:K}),Ae=s(ie),[Se,ye]=reactExports.useState(!1);function he(Ve=0){if(b||!j.current||getActiveSectionIndex(j)!=null)return;const Me=parseSelectedSections(Ve,le.sections);ye(!0),j.current.getSectionContent(Me).focus()}const ke=useFieldRootProps({manager:t,internalPropsWithDefaults:c,stateResponse:K,applyCharacterEditing:ue,focused:Se,setFocused:ye,domGetters:P}),Pe=useFieldHiddenInputProps({manager:t,stateResponse:K}),Le=useFieldSectionContainerProps({stateResponse:K,internalPropsWithDefaults:c}),$e=useFieldSectionContentProps({manager:t,stateResponse:K,applyCharacterEditing:ue,internalPropsWithDefaults:c,domGetters:P,focused:Se}),qe=useEventCallback(Ve=>{A==null||A(Ve),ke.onKeyDown(Ve)}),xe=useEventCallback(Ve=>{f==null||f(Ve),ke.onBlur(Ve)}),Ie=useEventCallback(Ve=>{g==null||g(Ve),ke.onFocus(Ve)}),Te=useEventCallback(Ve=>{Ve.isDefaultPrevented()||(m==null||m(Ve),ke.onClick(Ve))}),pe=useEventCallback(Ve=>{E==null||E(Ve),ke.onPaste(Ve)}),Fe=useEventCallback(Ve=>{_==null||_(Ve),ke.onInput(Ve)}),Re=useEventCallback((Ve,...Me)=>{Ve.preventDefault(),C==null||C(Ve,...Me),se(),isFieldFocused$1(j)?ce(ae.startIndex):he(0)}),Ue=reactExports.useMemo(()=>le.sections.map((Ve,Me)=>{const ze=$e(Ve,Me);return{container:Le(Me),content:$e(Ve,Me),before:{children:Ve.startSeparator},after:{children:Ve.endSeparator,"data-range-position":Ve.isEndFormatSeparator?ze["data-range-position"]:void 0}}}),[le.sections,Le,$e]);return reactExports.useEffect(()=>{if(j.current==null)throw new Error(["MUI X: The `sectionListRef` prop has not been initialized by `PickersSectionList`","You probably tried to pass a component to the `textField` slot that contains an `<input />` element instead of a `PickersSectionList`.","","If you want to keep using an `<input />` HTML element for the editing, please add the `enableAccessibleFieldDOMStructure={false}` prop to your Picker or Field component:","","<DatePicker enableAccessibleFieldDOMStructure={false} slots={{ textField: MyCustomTextField }} />","","Learn more about the field accessible DOM structure on the MUI documentation: https://mui.com/x/react-date-pickers/fields/#fields-to-edit-a-single-element"].join(`
`));V&&!b&&j.current&&j.current.getSectionContent(ae.startIndex).focus()},[]),useEnhancedEffect(()=>{if(!(!Se||!j.current)){if(Z==="all")j.current.getRoot().focus();else if(typeof Z=="number"){const Ve=j.current.getSectionContent(Z);Ve&&Ve.focus()}}},[Z,Se]),useEnhancedEffect(()=>{syncSelectionToDOM({focused:Se,domGetters:P,stateResponse:K})}),reactExports.useImperativeHandle(W,()=>({getSections:()=>le.sections,getActiveSectionIndex:()=>getActiveSectionIndex(j),setSelectedSections:Ve=>{if(b||!j.current)return;const Me=parseSelectedSections(Ve,le.sections);ye((Me==="all"?0:Me)!==null),ce(Ve)},focusField:he,isFieldFocused:()=>isFieldFocused$1(j)})),_extends({},o,ke,{onBlur:xe,onClick:Te,onFocus:Ie,onInput:Fe,onPaste:pe,onKeyDown:qe,onClear:Re},Pe,{error:Y,clearable:!!(I&&!X&&!R&&!b),focused:U??Se,sectionListRef:w,enableAccessibleFieldDOMStructure:!0,elements:Ue,areAllSectionsEmpty:X,disabled:b,readOnly:R,autoFocus:V,openPickerAriaLabel:Ae})};function getActiveSectionIndex(r){var t;const e=getActiveElement((t=r.current)==null?void 0:t.getRoot());return!e||!r.current||!r.current.getRoot().contains(e)?null:r.current.getSectionIndexFromDOMElement(e)}function isFieldFocused$1(r){var t;const e=getActiveElement((t=r.current)==null?void 0:t.getRoot());return!!r.current&&r.current.getRoot().contains(e)}const cleanString=r=>r.replace(/[\u2066\u2067\u2068\u2069]/g,""),addPositionPropertiesToSections=(r,e,t)=>{let n=0,i=t?1:0;const s=[];for(let a=0;a<r.length;a+=1){const o=r[a],c=getSectionVisibleValue(o,t?"input-rtl":"input-ltr",e),h=`${o.startSeparator}${c}${o.endSeparator}`,f=cleanString(h).length,m=h.length,g=cleanString(c),_=i+(g===""?0:c.indexOf(g[0]))+o.startSeparator.length,E=_+g.length;s.push(_extends({},o,{start:n,end:n+f,startInInput:_,endInInput:E})),n+=f,i+=m}return s},useFieldV6TextField=r=>{const e=useRtl(),t=useTimeout(),n=useTimeout(),{props:i,manager:s,skipContextFieldRefAssignment:a,manager:{valueType:o,internal_valueManager:c,internal_fieldValueManager:h,internal_useOpenPickerButtonAriaLabel:f}}=r,{internalProps:m,forwardedProps:g}=useSplitFieldProps(i,o),_=useFieldInternalPropsWithDefaults({manager:s,internalProps:m,skipContextFieldRefAssignment:a}),{onFocus:E,onClick:A,onPaste:C,onBlur:I,onKeyDown:b,onClear:R,clearable:V,inputRef:U,placeholder:W}=g,{readOnly:j=!1,disabled:w=!1,autoFocus:P=!1,focused:K,unstableFieldRef:X}=_,Y=reactExports.useRef(null),Z=useForkRef(U,Y),ae=useFieldState({manager:s,internalPropsWithDefaults:_,forwardedProps:g}),{activeSectionIndex:le,areAllSectionsEmpty:ie,error:se,localizedDigits:ce,parsedSelectedSections:ue,sectionOrder:Ae,state:Se,value:ye,clearValue:he,clearActiveSection:ke,setCharacterQuery:Pe,setSelectedSections:Le,setTempAndroidValueStr:$e,updateSectionValue:qe,updateValueFromValueStr:xe,getSectionsFromValue:Ie}=ae,Te=useFieldCharacterEditing({stateResponse:ae}),pe=f(ye),Fe=reactExports.useMemo(()=>addPositionPropertiesToSections(Se.sections,ce,e),[Se.sections,ce,e]);function Re(){const We=Y.current.selectionStart??0;let tt;We<=Fe[0].startInInput||We>=Fe[Fe.length-1].endInInput?tt=1:tt=Fe.findIndex(Gt=>Gt.startInInput-Gt.startSeparator.length>We);const It=tt===-1?Fe.length-1:tt-1;Le(It)}function Ue(We=0){var tt;getActiveElement(Y.current)!==Y.current&&((tt=Y.current)==null||tt.focus(),Le(We))}const Ve=useEventCallback(We=>{E==null||E(We);const tt=Y.current;t.start(0,()=>{!tt||tt!==Y.current||le==null&&(tt.value.length&&Number(tt.selectionEnd)-Number(tt.selectionStart)===tt.value.length?Le("all"):Re())})}),Me=useEventCallback((We,...tt)=>{We.isDefaultPrevented()||(A==null||A(We,...tt),Re())}),ze=useEventCallback(We=>{if(C==null||C(We),We.preventDefault(),j||w)return;const tt=We.clipboardData.getData("text");if(typeof ue=="number"){const It=Se.sections[ue],Gt=/^[a-zA-Z]+$/.test(tt),or=/^[0-9]+$/.test(tt),ur=/^(([a-zA-Z]+)|)([0-9]+)(([a-zA-Z]+)|)$/.test(tt);if(It.contentType==="letter"&&Gt||It.contentType==="digit"&&or||It.contentType==="digit-with-letter"&&ur){Pe(null),qe({section:It,newSectionValue:tt,shouldGoToNextSection:!0});return}if(Gt||or)return}Pe(null),xe(tt)}),He=useEventCallback(We=>{I==null||I(We),Le(null)}),Ne=useEventCallback(We=>{if(j)return;const tt=We.target.value;if(tt===""){he();return}const It=We.nativeEvent.data,Gt=It&&It.length>1,or=Gt?It:tt,ur=cleanString(or);if(ue==="all"&&Le(le),le==null||Gt){xe(Gt?It:ur);return}let Lt;if(ue==="all"&&ur.length===1)Lt=ur;else{const Lr=cleanString(h.getV6InputValueFromSections(Fe,ce,e));let rt=-1,pr=-1;for(let Ar=0;Ar<Lr.length;Ar+=1)rt===-1&&Lr[Ar]!==ur[Ar]&&(rt=Ar),pr===-1&&Lr[Lr.length-Ar-1]!==ur[ur.length-Ar-1]&&(pr=Ar);const yr=Fe[le];if(rt<yr.start||Lr.length-pr-1>yr.end)return;const Wr=ur.length-Lr.length+yr.end-cleanString(yr.endSeparator||"").length;Lt=ur.slice(yr.start+cleanString(yr.startSeparator||"").length,Wr)}if(Lt.length===0){isAndroid()&&$e(or),ke();return}Te({keyPressed:Lt,sectionIndex:le})}),Be=useEventCallback((We,...tt)=>{We.preventDefault(),R==null||R(We,...tt),he(),isFieldFocused(Y)?Le(Ae.startIndex):Ue(0)}),et=useFieldRootHandleKeyDown({manager:s,internalPropsWithDefaults:_,stateResponse:ae}),nt=useEventCallback(We=>{b==null||b(We),et(We)}),ir=reactExports.useMemo(()=>W!==void 0?W:h.getV6InputValueFromSections(Ie(c.emptyValue),ce,e),[W,h,Ie,c.emptyValue,ce,e]),dr=reactExports.useMemo(()=>Se.tempValueStrAndroid??h.getV6InputValueFromSections(Se.sections,ce,e),[Se.sections,h,Se.tempValueStrAndroid,ce,e]);reactExports.useEffect(()=>{Y.current&&Y.current===getActiveElement(Y.current)&&Le("all")},[]),useEnhancedEffect(()=>{function We(){if(!Y.current)return;if(ue==null){Y.current.scrollLeft&&(Y.current.scrollLeft=0);return}if(Y.current!==getActiveElement(Y.current))return;const tt=Y.current.scrollTop;if(ue==="all")Y.current.select();else{const It=Fe[ue],Gt=It.type==="empty"?It.startInInput-It.startSeparator.length:It.startInInput,or=It.type==="empty"?It.endInInput+It.endSeparator.length:It.endInInput;(Gt!==Y.current.selectionStart||or!==Y.current.selectionEnd)&&Y.current===getActiveElement(Y.current)&&Y.current.setSelectionRange(Gt,or),n.start(0,()=>{Y.current&&Y.current===getActiveElement(Y.current)&&Y.current.selectionStart===Y.current.selectionEnd&&(Y.current.selectionStart!==Gt||Y.current.selectionEnd!==or)&&We()})}Y.current.scrollTop=tt}We()});const Xe=reactExports.useMemo(()=>le==null||Se.sections[le].contentType==="letter"?"text":"numeric",[le,Se.sections]),cr=!(Y.current&&Y.current===getActiveElement(Y.current))&&ie;return reactExports.useImperativeHandle(X,()=>({getSections:()=>Se.sections,getActiveSectionIndex:()=>{const We=Y.current.selectionStart??0,tt=Y.current.selectionEnd??0;if(We===0&&tt===0)return null;const It=We<=Fe[0].startInInput?1:Fe.findIndex(Gt=>Gt.startInInput-Gt.startSeparator.length>We);return It===-1?Fe.length-1:It-1},setSelectedSections:We=>Le(We),focusField:Ue,isFieldFocused:()=>isFieldFocused(Y)})),_extends({},g,{error:se,clearable:!!(V&&!ie&&!j&&!w),onBlur:He,onClick:Me,onFocus:Ve,onPaste:ze,onKeyDown:nt,onClear:Be,inputRef:Z,enableAccessibleFieldDOMStructure:!1,placeholder:ir,inputMode:Xe,autoComplete:"off",value:cr?"":dr,onChange:Ne,focused:K,disabled:w,readOnly:j,autoFocus:P,openPickerAriaLabel:pe})};function isFieldFocused(r){return r.current===getActiveElement(r.current)}const useField=r=>{const e=useNullableFieldPrivateContext();return(r.props.enableAccessibleFieldDOMStructure??(e==null?void 0:e.enableAccessibleFieldDOMStructure)??!0?useFieldV7TextField:useFieldV6TextField)(r)};function useApplyDefaultValuesToDateValidationProps(r){const e=usePickerAdapter(),t=useDefaultDates();return reactExports.useMemo(()=>({disablePast:r.disablePast??!1,disableFuture:r.disableFuture??!1,minDate:applyDefaultDate(e,r.minDate,t.minDate),maxDate:applyDefaultDate(e,r.maxDate,t.maxDate)}),[r.minDate,r.maxDate,r.disableFuture,r.disablePast,e,t])}function useDateTimeManager(r={}){const{enableAccessibleFieldDOMStructure:e=!0}=r;return reactExports.useMemo(()=>({valueType:"date-time",validator:validateDateTime,internal_valueManager:singleItemValueManager,internal_fieldValueManager:singleItemFieldValueManager,internal_enableAccessibleFieldDOMStructure:e,internal_useApplyDefaultValuesToFieldInternalProps:useApplyDefaultValuesToDateTimeFieldInternalProps,internal_useOpenPickerButtonAriaLabel:useOpenPickerButtonAriaLabel}),[e])}function useOpenPickerButtonAriaLabel(r){const e=usePickerAdapter(),t=usePickerTranslations();return reactExports.useMemo(()=>{const n=e.isValid(r)?e.format(r,"fullDate"):null;return t.openDatePickerDialogue(n)},[r,t,e])}function useApplyDefaultValuesToDateTimeFieldInternalProps(r){const e=usePickerAdapter(),t=useApplyDefaultValuesToDateTimeValidationProps(r),n=reactExports.useMemo(()=>r.ampm??e.is12HourCycleInCurrentLocale(),[r.ampm,e]);return reactExports.useMemo(()=>_extends({},r,t,{format:r.format??(n?e.formats.keyboardDateTime12h:e.formats.keyboardDateTime24h)}),[r,t,n,e])}function useApplyDefaultValuesToDateTimeValidationProps(r){const e=usePickerAdapter(),t=useDefaultDates();return reactExports.useMemo(()=>({disablePast:r.disablePast??!1,disableFuture:r.disableFuture??!1,disableIgnoringDatePartForTimeValidation:!!r.minDateTime||!!r.maxDateTime||!!r.disableFuture||!!r.disablePast,minDate:applyDefaultDate(e,r.minDateTime??r.minDate,t.minDate),maxDate:applyDefaultDate(e,r.maxDateTime??r.maxDate,t.maxDate),minTime:r.minDateTime??r.minTime,maxTime:r.maxDateTime??r.maxTime}),[r.minDateTime,r.maxDateTime,r.minTime,r.maxTime,r.minDate,r.maxDate,r.disableFuture,r.disablePast,e,t])}function useFieldOwnerState(r){const{ownerState:e}=usePickerPrivateContext(),t=useRtl();return reactExports.useMemo(()=>_extends({},e,{isFieldDisabled:r.disabled??!1,isFieldReadOnly:r.readOnly??!1,isFieldRequired:r.required??!1,fieldDirection:t?"rtl":"ltr"}),[e,r.disabled,r.readOnly,r.required,t])}function getPickersTextFieldUtilityClass(r){return generateUtilityClass("MuiPickersTextField",r)}generateUtilityClasses("MuiPickersTextField",["root","focused","disabled","error","required"]);function getPickersInputBaseUtilityClass(r){return generateUtilityClass("MuiPickersInputBase",r)}const pickersInputBaseClasses=generateUtilityClasses("MuiPickersInputBase",["root","focused","disabled","error","notchedOutline","sectionContent","sectionBefore","sectionAfter","adornedStart","adornedEnd","input","inputSizeSmall","activeBar"]);function getPickersSectionListUtilityClass(r){return generateUtilityClass("MuiPickersSectionList",r)}const pickersSectionListClasses=generateUtilityClasses("MuiPickersSectionList",["root","section","sectionContent"]),_excluded$X=["slots","slotProps","elements","sectionListRef","classes"],PickersSectionListRoot=styled("div",{name:"MuiPickersSectionList",slot:"Root"})({direction:"ltr /*! @noflip */",outline:"none"}),PickersSectionListSection=styled("span",{name:"MuiPickersSectionList",slot:"Section"})({}),PickersSectionListSectionSeparator=styled("span",{name:"MuiPickersSectionList",slot:"SectionSeparator"})({whiteSpace:"pre"}),PickersSectionListSectionContent=styled("span",{name:"MuiPickersSectionList",slot:"SectionContent"})({outline:"none"}),useUtilityClasses$A=r=>composeClasses({root:["root"],section:["section"],sectionContent:["sectionContent"]},getPickersSectionListUtilityClass,r);function PickersSection(r){const{slots:e,slotProps:t,element:n,classes:i}=r,{ownerState:s}=usePickerPrivateContext(),a=(e==null?void 0:e.section)??PickersSectionListSection,o=useSlotProps({elementType:a,externalSlotProps:t==null?void 0:t.section,externalForwardedProps:n.container,className:i.section,ownerState:s}),c=(e==null?void 0:e.sectionContent)??PickersSectionListSectionContent,h=useSlotProps({elementType:c,externalSlotProps:t==null?void 0:t.sectionContent,externalForwardedProps:n.content,additionalProps:{suppressContentEditableWarning:!0},className:i.sectionContent,ownerState:s}),f=(e==null?void 0:e.sectionSeparator)??PickersSectionListSectionSeparator,m=useSlotProps({elementType:f,externalSlotProps:t==null?void 0:t.sectionSeparator,externalForwardedProps:n.before,ownerState:_extends({},s,{separatorPosition:"before"})}),g=useSlotProps({elementType:f,externalSlotProps:t==null?void 0:t.sectionSeparator,externalForwardedProps:n.after,ownerState:_extends({},s,{separatorPosition:"after"})});return jsxRuntimeExports.jsxs(a,_extends({},o,{children:[jsxRuntimeExports.jsx(f,_extends({},m)),jsxRuntimeExports.jsx(c,_extends({},h)),jsxRuntimeExports.jsx(f,_extends({},g))]}))}const PickersSectionList=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiPickersSectionList"}),{slots:i,slotProps:s,elements:a,sectionListRef:o,classes:c}=n,h=_objectWithoutPropertiesLoose(n,_excluded$X),f=useUtilityClasses$A(c),{ownerState:m}=usePickerPrivateContext(),g=reactExports.useRef(null),_=useForkRef(t,g),E=I=>{if(!g.current)throw new Error(`MUI X: Cannot call sectionListRef.${I} before the mount of the component.`);return g.current};reactExports.useImperativeHandle(o,()=>({getRoot(){return E("getRoot")},getSectionContainer(I){return E("getSectionContainer").querySelector(`.${pickersSectionListClasses.section}[data-sectionindex="${I}"]`)},getSectionContent(I){return E("getSectionContent").querySelector(`.${pickersSectionListClasses.section}[data-sectionindex="${I}"] .${pickersSectionListClasses.sectionContent}`)},getSectionIndexFromDOMElement(I){const b=E("getSectionIndexFromDOMElement");if(I==null||!b.contains(I))return null;let R=null;return I.classList.contains(pickersSectionListClasses.section)?R=I:I.classList.contains(pickersSectionListClasses.sectionContent)&&(R=I.parentElement),R==null?null:Number(R.dataset.sectionindex)}}));const A=(i==null?void 0:i.root)??PickersSectionListRoot,C=useSlotProps({elementType:A,externalSlotProps:s==null?void 0:s.root,externalForwardedProps:h,additionalProps:{ref:_,suppressContentEditableWarning:!0},className:f.root,ownerState:m});return jsxRuntimeExports.jsx(A,_extends({},C,{children:C.contentEditable?a.map(({content:I,before:b,after:R})=>`${b.children}${I.children}${R.children}`).join(""):jsxRuntimeExports.jsx(reactExports.Fragment,{children:a.map((I,b)=>jsxRuntimeExports.jsx(PickersSection,{slots:i,slotProps:s,element:I,classes:f},b))})}))}),PickerTextFieldOwnerStateContext=reactExports.createContext(null),usePickerTextFieldOwnerState=()=>{const r=reactExports.useContext(PickerTextFieldOwnerStateContext);if(r==null)throw new Error(["MUI X: The `usePickerTextFieldOwnerState` can only be called in components that are used inside a PickerTextField component"].join(`
`));return r},_excluded$W=["elements","areAllSectionsEmpty","defaultValue","label","value","onChange","id","autoFocus","endAdornment","startAdornment","renderSuffix","slots","slotProps","contentEditable","tabIndex","onInput","onPaste","onKeyDown","fullWidth","name","readOnly","inputProps","inputRef","sectionListRef","onFocus","onBlur","classes","ownerState"],round=r=>Math.round(r*1e5)/1e5,PickersInputBaseRoot=styled("div",{name:"MuiPickersInputBase",slot:"Root"})(({theme:r})=>_extends({},r.typography.body1,{color:(r.vars||r).palette.text.primary,cursor:"text",padding:0,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",boxSizing:"border-box",letterSpacing:`${round(.15/16)}em`,variants:[{props:{isInputInFullWidth:!0},style:{width:"100%"}}]})),PickersInputBaseSectionsContainer=styled(PickersSectionListRoot,{name:"MuiPickersInputBase",slot:"SectionsContainer"})(({theme:r})=>({padding:"4px 0 5px",fontFamily:r.typography.fontFamily,fontSize:"inherit",lineHeight:"1.4375em",flexGrow:1,outline:"none",display:"flex",flexWrap:"nowrap",overflow:"hidden",letterSpacing:"inherit",width:"182px",variants:[{props:{fieldDirection:"rtl"},style:{justifyContent:"end"}},{props:{inputSize:"small"},style:{paddingTop:1}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0},style:{color:"currentColor",opacity:0}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0,inputHasLabel:!1},style:r.vars?{opacity:r.vars.opacity.inputPlaceholder}:{opacity:r.palette.mode==="light"?.42:.5}},{props:{hasStartAdornment:!1,isFieldFocused:!1,isFieldValueEmpty:!0,inputHasLabel:!0,isLabelShrunk:!0},style:r.vars?{opacity:r.vars.opacity.inputPlaceholder}:{opacity:r.palette.mode==="light"?.42:.5}}]})),PickersInputBaseSection=styled(PickersSectionListSection,{name:"MuiPickersInputBase",slot:"Section"})(({theme:r})=>({fontFamily:r.typography.fontFamily,fontSize:"inherit",letterSpacing:"inherit",lineHeight:"1.4375em",display:"inline-block",whiteSpace:"nowrap"})),PickersInputBaseSectionContent=styled(PickersSectionListSectionContent,{name:"MuiPickersInputBase",slot:"SectionContent",overridesResolver:(r,e)=>e.content})(({theme:r})=>({fontFamily:r.typography.fontFamily,lineHeight:"1.4375em",letterSpacing:"inherit",width:"fit-content",outline:"none"})),PickersInputBaseSectionSeparator=styled(PickersSectionListSectionSeparator,{name:"MuiPickersInputBase",slot:"Separator"})(()=>({whiteSpace:"pre",letterSpacing:"inherit"})),PickersInputBaseInput=styled("input",{name:"MuiPickersInputBase",slot:"Input",overridesResolver:(r,e)=>e.hiddenInput})(_extends({},visuallyHidden)),PickersInputBaseActiveBar=styled("div",{name:"MuiPickersInputBase",slot:"ActiveBar"})(({theme:r,ownerState:e})=>({display:"none",position:"absolute",height:2,bottom:2,borderTopLeftRadius:2,borderTopRightRadius:2,transition:r.transitions.create(["width","left"],{duration:r.transitions.duration.shortest}),backgroundColor:(r.vars||r).palette.primary.main,'[data-active-range-position="start"] &, [data-active-range-position="end"] &':{display:"block"},'[data-active-range-position="start"] &':{left:e.sectionOffsets[0]},'[data-active-range-position="end"] &':{left:e.sectionOffsets[1]}})),useUtilityClasses$z=(r,e)=>{const{isFieldFocused:t,isFieldDisabled:n,isFieldReadOnly:i,hasFieldError:s,inputSize:a,isInputInFullWidth:o,inputColor:c,hasStartAdornment:h,hasEndAdornment:f}=e,m={root:["root",t&&!n&&"focused",n&&"disabled",i&&"readOnly",s&&"error",o&&"fullWidth",`color${capitalize(c)}`,a==="small"&&"inputSizeSmall",h&&"adornedStart",f&&"adornedEnd"],notchedOutline:["notchedOutline"],input:["input"],sectionsContainer:["sectionsContainer"],sectionContent:["sectionContent"],sectionBefore:["sectionBefore"],sectionAfter:["sectionAfter"],activeBar:["activeBar"]};return composeClasses(m,getPickersInputBaseUtilityClass,r)};function resolveSectionElementWidth(r,e,t,n){var i;if(r.content.id){const s=(i=e.current)==null?void 0:i.querySelectorAll(`[data-sectionindex="${t}"] [data-range-position="${n}"]`);if(s)return Array.from(s).reduce((a,o)=>a+o.offsetWidth,0)}return 0}function resolveSectionWidthAndOffsets(r,e){var i,s,a,o,c;let t=0;if(((i=e.current)==null?void 0:i.getAttribute("data-active-range-position"))==="end")for(let h=r.length-1;h>=r.length/2;h-=1)t+=resolveSectionElementWidth(r[h],e,h,"end");else for(let h=0;h<r.length/2;h+=1)t+=resolveSectionElementWidth(r[h],e,h,"start");return{activeBarWidth:t,sectionOffsets:[((a=(s=e.current)==null?void 0:s.querySelector('[data-sectionindex="0"]'))==null?void 0:a.offsetLeft)||0,((c=(o=e.current)==null?void 0:o.querySelector(`[data-sectionindex="${r.length/2}"]`))==null?void 0:c.offsetLeft)||0]}}const PickersInputBase=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiPickersInputBase"}),{elements:i,areAllSectionsEmpty:s,value:a,onChange:o,id:c,endAdornment:h,startAdornment:f,renderSuffix:m,slots:g,slotProps:_,contentEditable:E,tabIndex:A,onInput:C,onPaste:I,onKeyDown:b,name:R,readOnly:V,inputProps:U,inputRef:W,sectionListRef:j,onFocus:w,onBlur:P,classes:K,ownerState:X}=n,Y=_objectWithoutPropertiesLoose(n,_excluded$W),Z=usePickerTextFieldOwnerState(),ae=reactExports.useRef(null),le=reactExports.useRef(null),ie=reactExports.useRef([]),se=useForkRef(t,ae),ce=useForkRef(U==null?void 0:U.ref,W),ue=useFormControl();if(!ue)throw new Error("MUI X: PickersInputBase should always be used inside a PickersTextField component");const Ae=X??Z,Se=Ie=>{var Te;(Te=ue.onFocus)==null||Te.call(ue,Ie),w==null||w(Ie)},ye=Ie=>{Se(Ie)},he=Ie=>{var Te,pe;if(b==null||b(Ie),Ie.key==="Enter"&&!Ie.defaultMuiPrevented){if((Te=ae.current)!=null&&Te.dataset.multiInput)return;const Fe=(pe=ae.current)==null?void 0:pe.closest("form"),Re=Fe==null?void 0:Fe.querySelector('[type="submit"]');if(!Fe||!Re)return;Ie.preventDefault(),Fe.requestSubmit(Re)}},ke=Ie=>{var Te;(Te=ue.onBlur)==null||Te.call(ue,Ie),P==null||P(Ie)};reactExports.useEffect(()=>{ue&&ue.setAdornedStart(!!f)},[ue,f]),reactExports.useEffect(()=>{ue&&(s?ue.onEmpty():ue.onFilled())},[ue,s]);const Pe=useUtilityClasses$z(K,Ae),Le=(g==null?void 0:g.root)||PickersInputBaseRoot,$e=useSlotProps({elementType:Le,externalSlotProps:_==null?void 0:_.root,externalForwardedProps:Y,additionalProps:{"aria-invalid":ue.error,ref:se},className:Pe.root,ownerState:Ae}),qe=(g==null?void 0:g.input)||PickersInputBaseSectionsContainer,xe=i.some(Ie=>Ie.content["data-range-position"]!==void 0);return reactExports.useEffect(()=>{if(!xe||!Ae.isPickerOpen)return;const{activeBarWidth:Ie,sectionOffsets:Te}=resolveSectionWidthAndOffsets(i,ae);ie.current=[Te[0],Te[1]],le.current&&(le.current.style.width=`${Ie}px`)},[i,xe,Ae.isPickerOpen]),jsxRuntimeExports.jsxs(Le,_extends({},$e,{children:[f,jsxRuntimeExports.jsx(PickersSectionList,{sectionListRef:j,elements:i,contentEditable:E,tabIndex:A,className:Pe.sectionsContainer,onFocus:Se,onBlur:ke,onInput:C,onPaste:I,onKeyDown:he,slots:{root:qe,section:PickersInputBaseSection,sectionContent:PickersInputBaseSectionContent,sectionSeparator:PickersInputBaseSectionSeparator},slotProps:{root:_extends({},_==null?void 0:_.input,{ownerState:Ae}),sectionContent:{className:pickersInputBaseClasses.sectionContent},sectionSeparator:({separatorPosition:Ie})=>({className:Ie==="before"?pickersInputBaseClasses.sectionBefore:pickersInputBaseClasses.sectionAfter})}}),h,m?m(_extends({},ue)):null,jsxRuntimeExports.jsx(PickersInputBaseInput,_extends({name:R,className:Pe.input,value:a,onChange:o,id:c,"aria-hidden":"true",tabIndex:-1,readOnly:V,required:ue.required,disabled:ue.disabled,onFocus:ye},U,{ref:ce})),xe&&jsxRuntimeExports.jsx(PickersInputBaseActiveBar,{className:Pe.activeBar,ref:le,ownerState:{sectionOffsets:ie.current}})]}))});function getPickersOutlinedInputUtilityClass(r){return generateUtilityClass("MuiPickersOutlinedInput",r)}const pickersOutlinedInputClasses=_extends({},pickersInputBaseClasses,generateUtilityClasses("MuiPickersOutlinedInput",["root","notchedOutline","input"])),_excluded$V=["children","className","label","notched","shrink"],OutlineRoot=styled("fieldset",{name:"MuiPickersOutlinedInput",slot:"NotchedOutline"})(({theme:r})=>{const e=r.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%",borderColor:r.vars?`rgba(${r.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),OutlineLabel=styled("span")(({theme:r})=>({fontFamily:r.typography.fontFamily,fontSize:"inherit"})),OutlineLegend=styled("legend",{shouldForwardProp:r=>shouldForwardProp(r)&&r!=="notched"})(({theme:r})=>({float:"unset",width:"auto",overflow:"hidden",variants:[{props:{inputHasLabel:!1},style:{padding:0,lineHeight:"11px",transition:r.transitions.create("width",{duration:150,easing:r.transitions.easing.easeOut})}},{props:{inputHasLabel:!0},style:{display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:r.transitions.create("max-width",{duration:50,easing:r.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}}},{props:{inputHasLabel:!0,notched:!0},style:{maxWidth:"100%",transition:r.transitions.create("max-width",{duration:100,easing:r.transitions.easing.easeOut,delay:50})}}]}));function Outline(r){const{className:e,label:t,notched:n}=r,i=_objectWithoutPropertiesLoose(r,_excluded$V),s=usePickerTextFieldOwnerState();return jsxRuntimeExports.jsx(OutlineRoot,_extends({"aria-hidden":!0,className:e},i,{ownerState:s,children:jsxRuntimeExports.jsx(OutlineLegend,{ownerState:s,notched:n,children:t?jsxRuntimeExports.jsx(OutlineLabel,{children:t}):jsxRuntimeExports.jsx(OutlineLabel,{className:"notranslate",children:"​"})})}))}const _excluded$U=["label","autoFocus","ownerState","classes","notched"],PickersOutlinedInputRoot=styled(PickersInputBaseRoot,{name:"MuiPickersOutlinedInput",slot:"Root"})(({theme:r})=>{const e=r.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{padding:"0 14px",borderRadius:(r.vars||r).shape.borderRadius,[`&:hover .${pickersOutlinedInputClasses.notchedOutline}`]:{borderColor:(r.vars||r).palette.text.primary},"@media (hover: none)":{[`&:hover .${pickersOutlinedInputClasses.notchedOutline}`]:{borderColor:r.vars?`rgba(${r.vars.palette.common.onBackgroundChannel} / 0.23)`:e}},[`&.${pickersOutlinedInputClasses.focused} .${pickersOutlinedInputClasses.notchedOutline}`]:{borderStyle:"solid",borderWidth:2},[`&.${pickersOutlinedInputClasses.disabled}`]:{[`& .${pickersOutlinedInputClasses.notchedOutline}`]:{borderColor:(r.vars||r).palette.action.disabled},"*":{color:(r.vars||r).palette.action.disabled}},[`&.${pickersOutlinedInputClasses.error} .${pickersOutlinedInputClasses.notchedOutline}`]:{borderColor:(r.vars||r).palette.error.main},variants:Object.keys((r.vars??r).palette).filter(t=>{var n;return((n=(r.vars??r).palette[t])==null?void 0:n.main)??!1}).map(t=>({props:{inputColor:t},style:{[`&.${pickersOutlinedInputClasses.focused}:not(.${pickersOutlinedInputClasses.error}) .${pickersOutlinedInputClasses.notchedOutline}`]:{borderColor:(r.vars||r).palette[t].main}}}))}}),PickersOutlinedInputSectionsContainer=styled(PickersInputBaseSectionsContainer,{name:"MuiPickersOutlinedInput",slot:"SectionsContainer"})({padding:"16.5px 0",variants:[{props:{inputSize:"small"},style:{padding:"8.5px 0"}}]}),useUtilityClasses$y=r=>{const t=composeClasses({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},getPickersOutlinedInputUtilityClass,r);return _extends({},r,t)},PickersOutlinedInput=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiPickersOutlinedInput"}),{label:i,classes:s,notched:a}=n,o=_objectWithoutPropertiesLoose(n,_excluded$U),c=useFormControl(),h=useUtilityClasses$y(s);return jsxRuntimeExports.jsx(PickersInputBase,_extends({slots:{root:PickersOutlinedInputRoot,input:PickersOutlinedInputSectionsContainer},renderSuffix:f=>jsxRuntimeExports.jsx(Outline,{shrink:!!(a||f.adornedStart||f.focused||f.filled),notched:!!(a||f.adornedStart||f.focused||f.filled),className:h.notchedOutline,label:i!=null&&i!==""&&(c!=null&&c.required)?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[i," ","*"]}):i})},o,{label:i,classes:h,ref:t}))});PickersOutlinedInput.muiName="Input";function getPickersFilledInputUtilityClass(r){return generateUtilityClass("MuiPickersFilledInput",r)}const pickersFilledInputClasses=_extends({},pickersInputBaseClasses,generateUtilityClasses("MuiPickersFilledInput",["root","underline","input"])),_excluded$T=["label","autoFocus","disableUnderline","hiddenLabel","classes"],PickersFilledInputRoot=styled(PickersInputBaseRoot,{name:"MuiPickersFilledInput",slot:"Root",shouldForwardProp:r=>shouldForwardProp(r)&&r!=="disableUnderline"})(({theme:r})=>{const e=r.palette.mode==="light",t=e?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",n=e?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",i=e?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",s=e?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return{backgroundColor:r.vars?r.vars.palette.FilledInput.bg:n,borderTopLeftRadius:(r.vars||r).shape.borderRadius,borderTopRightRadius:(r.vars||r).shape.borderRadius,transition:r.transitions.create("background-color",{duration:r.transitions.duration.shorter,easing:r.transitions.easing.easeOut}),"&:hover":{backgroundColor:r.vars?r.vars.palette.FilledInput.hoverBg:i,"@media (hover: none)":{backgroundColor:r.vars?r.vars.palette.FilledInput.bg:n}},[`&.${pickersFilledInputClasses.focused}`]:{backgroundColor:r.vars?r.vars.palette.FilledInput.bg:n},[`&.${pickersFilledInputClasses.disabled}`]:{backgroundColor:r.vars?r.vars.palette.FilledInput.disabledBg:s},variants:[...Object.keys((r.vars??r).palette).filter(a=>(r.vars??r).palette[a].main).map(a=>{var o;return{props:{inputColor:a,disableUnderline:!1},style:{"&::after":{borderBottom:`2px solid ${(o=(r.vars||r).palette[a])==null?void 0:o.main}`}}}}),{props:{disableUnderline:!1},style:{"&::after":{left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:r.transitions.create("transform",{duration:r.transitions.duration.shorter,easing:r.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${pickersFilledInputClasses.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${pickersFilledInputClasses.error}`]:{"&:before, &:after":{borderBottomColor:(r.vars||r).palette.error.main}},"&::before":{borderBottom:`1px solid ${r.vars?`rgba(${r.vars.palette.common.onBackgroundChannel} / ${r.vars.opacity.inputUnderline})`:t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:r.transitions.create("border-bottom-color",{duration:r.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${pickersFilledInputClasses.disabled}, .${pickersFilledInputClasses.error}):before`]:{borderBottom:`1px solid ${(r.vars||r).palette.text.primary}`},[`&.${pickersFilledInputClasses.disabled}:before`]:{borderBottomStyle:"dotted"}}},{props:{hasStartAdornment:!0},style:{paddingLeft:12}},{props:{hasEndAdornment:!0},style:{paddingRight:12}}]}}),PickersFilledSectionsContainer=styled(PickersInputBaseSectionsContainer,{name:"MuiPickersFilledInput",slot:"sectionsContainer",shouldForwardProp:r=>shouldForwardProp(r)&&r!=="hiddenLabel"})({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12,variants:[{props:{inputSize:"small"},style:{paddingTop:21,paddingBottom:4}},{props:{hasStartAdornment:!0},style:{paddingLeft:0}},{props:{hasEndAdornment:!0},style:{paddingRight:0}},{props:{hiddenLabel:!0},style:{paddingTop:16,paddingBottom:17}},{props:{hiddenLabel:!0,inputSize:"small"},style:{paddingTop:8,paddingBottom:9}}]}),useUtilityClasses$x=(r,e)=>{const{inputHasUnderline:t}=e,i=composeClasses({root:["root",t&&"underline"],input:["input"]},getPickersFilledInputUtilityClass,r);return _extends({},r,i)},PickersFilledInput=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiPickersFilledInput"}),{label:i,disableUnderline:s=!1,hiddenLabel:a=!1,classes:o}=n,c=_objectWithoutPropertiesLoose(n,_excluded$T),h=usePickerTextFieldOwnerState(),f=_extends({},h,{inputHasUnderline:!s}),m=useUtilityClasses$x(o,f);return jsxRuntimeExports.jsx(PickersInputBase,_extends({slots:{root:PickersFilledInputRoot,input:PickersFilledSectionsContainer},slotProps:{root:{disableUnderline:s},input:{hiddenLabel:a}}},c,{label:i,classes:m,ref:t,ownerState:f}))});PickersFilledInput.muiName="Input";function getPickersInputUtilityClass(r){return generateUtilityClass("MuiPickersFilledInput",r)}const pickersInputClasses=_extends({},pickersInputBaseClasses,generateUtilityClasses("MuiPickersInput",["root","underline","input"])),_excluded$S=["label","autoFocus","disableUnderline","ownerState","classes"],PickersInputRoot=styled(PickersInputBaseRoot,{name:"MuiPickersInput",slot:"Root",shouldForwardProp:r=>shouldForwardProp(r)&&r!=="disableUnderline"})(({theme:r})=>{let t=r.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return r.vars&&(t=`rgba(${r.vars.palette.common.onBackgroundChannel} / ${r.vars.opacity.inputUnderline})`),{"label + &":{marginTop:16},variants:[...Object.keys((r.vars??r).palette).filter(n=>(r.vars??r).palette[n].main).map(n=>({props:{inputColor:n,inputHasUnderline:!0},style:{"&::after":{borderBottom:`2px solid ${(r.vars||r).palette[n].main}`}}})),{props:{inputHasUnderline:!0},style:{"&::after":{background:"red",left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:r.transitions.create("transform",{duration:r.transitions.duration.shorter,easing:r.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${pickersInputClasses.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${pickersInputClasses.error}`]:{"&:before, &:after":{borderBottomColor:(r.vars||r).palette.error.main}},"&::before":{borderBottom:`1px solid ${t}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:r.transitions.create("border-bottom-color",{duration:r.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${pickersInputClasses.disabled}, .${pickersInputClasses.error}):before`]:{borderBottom:`2px solid ${(r.vars||r).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${t}`}},[`&.${pickersInputClasses.disabled}:before`]:{borderBottomStyle:"dotted"}}}]}}),useUtilityClasses$w=(r,e)=>{const{inputHasUnderline:t}=e,i=composeClasses({root:["root",!t&&"underline"],input:["input"]},getPickersInputUtilityClass,r);return _extends({},r,i)},PickersInput=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiPickersInput"}),{label:i,disableUnderline:s=!1,classes:a}=n,o=_objectWithoutPropertiesLoose(n,_excluded$S),c=usePickerTextFieldOwnerState(),h=_extends({},c,{inputHasUnderline:!s}),f=useUtilityClasses$w(a,h);return jsxRuntimeExports.jsx(PickersInputBase,_extends({slots:{root:PickersInputRoot},slotProps:{root:{disableUnderline:s}}},o,{ownerState:h,label:i,classes:f,ref:t}))});PickersInput.muiName="Input";const _excluded$R=["onFocus","onBlur","className","classes","color","disabled","error","variant","required","hiddenLabel","InputProps","inputProps","inputRef","sectionListRef","elements","areAllSectionsEmpty","onClick","onKeyDown","onKeyUp","onPaste","onInput","endAdornment","startAdornment","tabIndex","contentEditable","focused","value","onChange","fullWidth","id","name","helperText","FormHelperTextProps","label","InputLabelProps","data-active-range-position"],VARIANT_COMPONENT={standard:PickersInput,filled:PickersFilledInput,outlined:PickersOutlinedInput},PickersTextFieldRoot=styled(FormControl,{name:"MuiPickersTextField",slot:"Root"})({maxWidth:"100%"}),useUtilityClasses$v=(r,e)=>{const{isFieldFocused:t,isFieldDisabled:n,isFieldRequired:i}=e;return composeClasses({root:["root",t&&!n&&"focused",n&&"disabled",i&&"required"]},getPickersTextFieldUtilityClass,r)},PickersTextField=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiPickersTextField"}),{onFocus:i,onBlur:s,className:a,classes:o,color:c="primary",disabled:h=!1,error:f=!1,variant:m="outlined",required:g=!1,hiddenLabel:_=!1,InputProps:E,inputProps:A,inputRef:C,sectionListRef:I,elements:b,areAllSectionsEmpty:R,onClick:V,onKeyDown:U,onKeyUp:W,onPaste:j,onInput:w,endAdornment:P,startAdornment:K,tabIndex:X,contentEditable:Y,focused:Z,value:ae,onChange:le,fullWidth:ie,id:se,name:ce,helperText:ue,FormHelperTextProps:Ae,label:Se,InputLabelProps:ye,"data-active-range-position":he}=n,ke=_objectWithoutPropertiesLoose(n,_excluded$R),Pe=reactExports.useRef(null),Le=useForkRef(t,Pe),$e=useId(se),qe=ue&&$e?`${$e}-helper-text`:void 0,xe=Se&&$e?`${$e}-label`:void 0,Ie=useFieldOwnerState({disabled:n.disabled,required:n.required,readOnly:E==null?void 0:E.readOnly}),Te=reactExports.useMemo(()=>_extends({},Ie,{isFieldValueEmpty:R,isFieldFocused:Z??!1,hasFieldError:f??!1,inputSize:n.size??"medium",inputColor:c??"primary",isInputInFullWidth:ie??!1,hasStartAdornment:!!(K??(E==null?void 0:E.startAdornment)),hasEndAdornment:!!(P??(E==null?void 0:E.endAdornment)),inputHasLabel:!!Se,isLabelShrunk:!!(ye!=null&&ye.shrink)}),[Ie,R,Z,f,n.size,c,ie,K,P,E==null?void 0:E.startAdornment,E==null?void 0:E.endAdornment,Se,ye==null?void 0:ye.shrink]),pe=useUtilityClasses$v(o,Te),Fe=VARIANT_COMPONENT[m],Re={};return m==="outlined"?(ye&&typeof ye.shrink<"u"&&(Re.notched=ye.shrink),Re.label=Se):m==="filled"&&(Re.hiddenLabel=_),jsxRuntimeExports.jsx(PickerTextFieldOwnerStateContext.Provider,{value:Te,children:jsxRuntimeExports.jsxs(PickersTextFieldRoot,_extends({className:clsx(pe.root,a),ref:Le,focused:Z,disabled:h,variant:m,error:f,color:c,fullWidth:ie,required:g,ownerState:Te},ke,{children:[Se!=null&&Se!==""&&jsxRuntimeExports.jsx(InputLabel,_extends({htmlFor:$e,id:xe},ye,{children:Se})),jsxRuntimeExports.jsx(Fe,_extends({elements:b,areAllSectionsEmpty:R,onClick:V,onKeyDown:U,onKeyUp:W,onInput:w,onPaste:j,onFocus:i,onBlur:s,endAdornment:P,startAdornment:K,tabIndex:X,contentEditable:Y,value:ae,onChange:le,id:$e,fullWidth:ie,inputProps:A,inputRef:C,sectionListRef:I,label:Se,name:ce,role:"group","aria-labelledby":xe,"aria-describedby":qe,"aria-live":qe?"polite":void 0,"data-active-range-position":he},Re,E)),ue&&jsxRuntimeExports.jsx(FormHelperText,_extends({id:qe},Ae,{children:ue}))]}))})}),_excluded$Q=["enableAccessibleFieldDOMStructure"],_excluded2$8=["InputProps","readOnly","onClear","clearable","clearButtonPosition","openPickerButtonPosition","openPickerAriaLabel"],_excluded3=["onPaste","onKeyDown","inputMode","readOnly","InputProps","inputProps","inputRef","onClear","clearable","clearButtonPosition","openPickerButtonPosition","openPickerAriaLabel"],_excluded4=["ownerState"],_excluded5=["ownerState"],_excluded6=["ownerState"],_excluded7=["ownerState"],_excluded8=["InputProps","inputProps"],noop$1=()=>{},cleanFieldResponse=r=>{var b,R,V,U,W,j,w,P,K;let{enableAccessibleFieldDOMStructure:e}=r,t=_objectWithoutPropertiesLoose(r,_excluded$Q);if(e){const{InputProps:X,readOnly:Y,onClear:Z,clearable:ae,clearButtonPosition:le,openPickerButtonPosition:ie,openPickerAriaLabel:se}=t,ce=_objectWithoutPropertiesLoose(t,_excluded2$8),ue=major>=6&&((b=ce==null?void 0:ce.slotProps)!=null&&b.input)?mergeSlotProps((R=ce==null?void 0:ce.slotProps)==null?void 0:R.input,X):noop$1;return{clearable:ae,onClear:Z,clearButtonPosition:le,openPickerButtonPosition:ie,openPickerAriaLabel:se,textFieldProps:_extends({},ce,major>=6&&((V=ce==null?void 0:ce.slotProps)!=null&&V.input)?{slotProps:_extends({},ce==null?void 0:ce.slotProps,{input:Ae=>_extends({},resolveComponentProps(ue,Ae),{readOnly:Y})})}:{InputProps:_extends({},X??{},{readOnly:Y})})}}const{onPaste:n,onKeyDown:i,inputMode:s,readOnly:a,InputProps:o,inputProps:c,inputRef:h,onClear:f,clearable:m,clearButtonPosition:g,openPickerButtonPosition:_,openPickerAriaLabel:E}=t,A=_objectWithoutPropertiesLoose(t,_excluded3),C=major>=6&&((U=A==null?void 0:A.slotProps)!=null&&U.input)?mergeSlotProps((W=A==null?void 0:A.slotProps)==null?void 0:W.input,o):noop$1,I=major>=6&&((j=A==null?void 0:A.slotProps)!=null&&j.htmlInput)?mergeSlotProps((w=A==null?void 0:A.slotProps)==null?void 0:w.htmlInput,c):noop$1;return{clearable:m,onClear:f,clearButtonPosition:g,openPickerButtonPosition:_,openPickerAriaLabel:E,textFieldProps:_extends({},A,major>=6&&((P=A==null?void 0:A.slotProps)!=null&&P.input||(K=A==null?void 0:A.slotProps)!=null&&K.htmlInput)?{slotProps:_extends({},A==null?void 0:A.slotProps,{input:X=>_extends({},resolveComponentProps(C,X),{readOnly:a}),htmlInput:X=>_extends({},resolveComponentProps(I,X),{inputMode:s,onPaste:n,onKeyDown:i,ref:h})})}:{InputProps:_extends({},o??{},{readOnly:a}),inputProps:_extends({},c??{},{inputMode:s,onPaste:n,onKeyDown:i,ref:h})})}},PickerFieldUIContext=reactExports.createContext({slots:{},slotProps:{},inputRef:void 0});function PickerFieldUI(r){var Ae,Se,ye;const{fieldResponse:e,defaultOpenPickerIcon:t}=r,n=usePickerTranslations(),i=useNullablePickerContext(),s=reactExports.useContext(PickerFieldUIContext),{textFieldProps:a,onClear:o,clearable:c,openPickerAriaLabel:h,clearButtonPosition:f="end",openPickerButtonPosition:m="end"}=cleanFieldResponse(e),g=useFieldOwnerState(a),_=useEventCallback(he=>{he.preventDefault(),i==null||i.setOpen(ke=>!ke)}),E=i?i.triggerStatus:"hidden",A=c?f:null,C=E!=="hidden"?m:null,I=s.slots.textField??(e.enableAccessibleFieldDOMStructure===!1?TextField:PickersTextField),b=s.slots.inputAdornment??InputAdornment,R=useSlotProps({elementType:b,externalSlotProps:s.slotProps.inputAdornment,additionalProps:{position:"start"},ownerState:_extends({},g,{position:"start"})}),V=_objectWithoutPropertiesLoose(R,_excluded4),U=useSlotProps({elementType:b,externalSlotProps:s.slotProps.inputAdornment,additionalProps:{position:"end"},ownerState:_extends({},g,{position:"end"})}),W=_objectWithoutPropertiesLoose(U,_excluded5),j=s.slots.openPickerButton??IconButton,w=useSlotProps({elementType:j,externalSlotProps:s.slotProps.openPickerButton,additionalProps:{disabled:E==="disabled",onClick:_,"aria-label":h,edge:a.variant!=="standard"?C:!1},ownerState:g}),P=_objectWithoutPropertiesLoose(w,_excluded6),K=s.slots.openPickerIcon??t,X=useSlotProps({elementType:K,externalSlotProps:s.slotProps.openPickerIcon,ownerState:g}),Y=s.slots.clearButton??IconButton,Z=useSlotProps({elementType:Y,externalSlotProps:s.slotProps.clearButton,className:"clearButton",additionalProps:{title:n.fieldClearLabel,tabIndex:-1,onClick:o,disabled:e.disabled||e.readOnly,edge:a.variant!=="standard"&&A!==C?A:!1},ownerState:g}),ae=_objectWithoutPropertiesLoose(Z,_excluded7),le=s.slots.clearIcon??ClearIcon,ie=useSlotProps({elementType:le,externalSlotProps:s.slotProps.clearIcon,additionalProps:{fontSize:"small"},ownerState:g});a.ref=useForkRef(a.ref,i==null?void 0:i.rootRef);const se={},ce=resolveComponentProps((major>=6&&((Ae=a==null?void 0:a.slotProps)==null?void 0:Ae.input))??a.InputProps,g);i&&(se.ref=i.triggerRef),!(ce!=null&&ce.startAdornment)&&(A==="start"||C==="start")&&(se.startAdornment=jsxRuntimeExports.jsxs(b,_extends({},V,{children:[C==="start"&&jsxRuntimeExports.jsx(j,_extends({},P,{children:jsxRuntimeExports.jsx(K,_extends({},X))})),A==="start"&&jsxRuntimeExports.jsx(Y,_extends({},ae,{children:jsxRuntimeExports.jsx(le,_extends({},ie))}))]}))),!(ce!=null&&ce.endAdornment)&&(A==="end"||C==="end")&&(se.endAdornment=jsxRuntimeExports.jsxs(b,_extends({},W,{children:[A==="end"&&jsxRuntimeExports.jsx(Y,_extends({},ae,{children:jsxRuntimeExports.jsx(le,_extends({},ie))})),C==="end"&&jsxRuntimeExports.jsx(j,_extends({},P,{children:jsxRuntimeExports.jsx(K,_extends({},X))}))]}))),!(se!=null&&se.endAdornment)&&!(se!=null&&se.startAdornment)&&s.slots.inputAdornment&&(se.endAdornment=jsxRuntimeExports.jsx(b,_extends({},W))),A!=null&&(a.sx=[{"& .clearButton":{opacity:1},"@media (pointer: fine)":{"& .clearButton":{opacity:0},"&:hover, &:focus-within":{".clearButton":{opacity:1}}}},...Array.isArray(a.sx)?a.sx:[a.sx]]);const ue=major>=6&&((Se=a==null?void 0:a.slotProps)!=null&&Se.input)?resolveComponentProps(mergeSlotProps(ce,se),g):_extends({},ce,se);return(ye=a==null?void 0:a.slotProps)==null||delete ye.input,e.enableAccessibleFieldDOMStructure&&(a==null||delete a.slotProps),jsxRuntimeExports.jsx(I,_extends({},a,{InputProps:ue}))}function mergeSlotProps(r,e){return r?e?t=>_extends({},resolveComponentProps(e,t),resolveComponentProps(r,t)):r:e}function useFieldTextFieldProps(r){const{ref:e,externalForwardedProps:t,slotProps:n}=r,i=reactExports.useContext(PickerFieldUIContext),s=useNullablePickerContext(),a=useFieldOwnerState(t),{InputProps:o,inputProps:c}=t,h=_objectWithoutPropertiesLoose(t,_excluded8),f=useSlotProps({elementType:PickersTextField,externalSlotProps:mergeSlotProps(i.slotProps.textField,n==null?void 0:n.textField),externalForwardedProps:h,additionalProps:{ref:e,sx:s==null?void 0:s.rootSx,label:s==null?void 0:s.label,name:s==null?void 0:s.name,className:s==null?void 0:s.rootClassName,inputRef:i.inputRef},ownerState:a});return f.inputProps=_extends({},c,f.inputProps),f.InputProps=_extends({},o,f.InputProps),f}function PickerFieldUIContextProvider(r){const{slots:e={},slotProps:t={},inputRef:n,children:i}=r,s=reactExports.useMemo(()=>({inputRef:n,slots:{openPickerButton:e.openPickerButton,openPickerIcon:e.openPickerIcon,textField:e.textField,inputAdornment:e.inputAdornment,clearIcon:e.clearIcon,clearButton:e.clearButton},slotProps:{openPickerButton:t.openPickerButton,openPickerIcon:t.openPickerIcon,textField:t.textField,inputAdornment:t.inputAdornment,clearIcon:t.clearIcon,clearButton:t.clearButton}}),[n,e.openPickerButton,e.openPickerIcon,e.textField,e.inputAdornment,e.clearIcon,e.clearButton,t.openPickerButton,t.openPickerIcon,t.textField,t.inputAdornment,t.clearIcon,t.clearButton]);return jsxRuntimeExports.jsx(PickerFieldUIContext.Provider,{value:s,children:i})}const useDateTimeField=r=>{const e=useDateTimeManager(r);return useField({manager:e,props:r})},_excluded$P=["slots","slotProps"],DateTimeField=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiDateTimeField"}),{slots:i,slotProps:s}=n,a=_objectWithoutPropertiesLoose(n,_excluded$P),o=useFieldTextFieldProps({slotProps:s,ref:t,externalForwardedProps:a}),c=useDateTimeField(o);return jsxRuntimeExports.jsx(PickerFieldUIContextProvider,{slots:i,slotProps:s,inputRef:a.inputRef,children:jsxRuntimeExports.jsx(PickerFieldUI,{fieldResponse:c,defaultOpenPickerIcon:CalendarIcon})})}),useIsDateDisabled=({shouldDisableDate:r,shouldDisableMonth:e,shouldDisableYear:t,minDate:n,maxDate:i,disableFuture:s,disablePast:a,timezone:o})=>{const c=usePickerAdapter();return reactExports.useCallback(h=>validateDate({adapter:c,value:h,timezone:o,props:{shouldDisableDate:r,shouldDisableMonth:e,shouldDisableYear:t,minDate:n,maxDate:i,disableFuture:s,disablePast:a}})!==null,[c,r,e,t,n,i,s,a,o])},createCalendarStateReducer=(r,e)=>(t,n)=>{switch(n.type){case"setVisibleDate":return _extends({},t,{slideDirection:n.direction,currentMonth:n.month,isMonthSwitchingAnimating:!e.isSameMonth(n.month,t.currentMonth)&&!r&&!n.skipAnimation,focusedDay:n.focusedDay});case"changeMonthTimezone":{const i=n.newTimezone;if(e.getTimezone(t.currentMonth)===i)return t;let s=e.setTimezone(t.currentMonth,i);return e.getMonth(s)!==e.getMonth(t.currentMonth)&&(s=e.setMonth(s,e.getMonth(t.currentMonth))),_extends({},t,{currentMonth:s})}case"finishMonthSwitchingAnimation":return _extends({},t,{isMonthSwitchingAnimating:!1});default:throw new Error("missing support")}},useCalendarState=r=>{const{value:e,referenceDate:t,disableFuture:n,disablePast:i,maxDate:s,minDate:a,onMonthChange:o,onYearChange:c,reduceAnimations:h,shouldDisableDate:f,timezone:m,getCurrentMonthFromVisibleDate:g}=r,_=usePickerAdapter(),E=reactExports.useRef(createCalendarStateReducer(!!h,_)).current,A=reactExports.useMemo(()=>singleItemValueManager.getInitialReferenceValue({value:e,adapter:_,timezone:m,props:r,referenceDate:t,granularity:SECTION_TYPE_GRANULARITY.day}),[t,m]),[C,I]=reactExports.useReducer(E,{isMonthSwitchingAnimating:!1,focusedDay:A,currentMonth:_.startOfMonth(A),slideDirection:"left"}),b=useIsDateDisabled({shouldDisableDate:f,minDate:a,maxDate:s,disableFuture:n,disablePast:i,timezone:m});reactExports.useEffect(()=>{I({type:"changeMonthTimezone",newTimezone:_.getTimezone(A)})},[A,_]);const R=useEventCallback(({target:U,reason:W})=>{if(W==="cell-interaction"&&C.focusedDay!=null&&_.isSameDay(U,C.focusedDay))return;const j=W==="cell-interaction";let w,P;if(W==="cell-interaction")w=g(U,C.currentMonth),P=U;else if(w=_.isSameMonth(U,C.currentMonth)?C.currentMonth:_.startOfMonth(U),P=U,b(P)){const Y=_.startOfMonth(U),Z=_.endOfMonth(U);P=findClosestEnabledDate({adapter:_,date:P,minDate:_.isBefore(a,Y)?Y:a,maxDate:_.isAfter(s,Z)?Z:s,disablePast:i,disableFuture:n,isDateDisabled:b,timezone:m})}const K=!_.isSameMonth(C.currentMonth,w),X=!_.isSameYear(C.currentMonth,w);K&&(o==null||o(w)),X&&(c==null||c(_.startOfYear(w))),I({type:"setVisibleDate",month:w,direction:_.isAfterDay(w,C.currentMonth)?"left":"right",focusedDay:C.focusedDay!=null&&P!=null&&_.isSameDay(P,C.focusedDay)?C.focusedDay:P,skipAnimation:j})}),V=reactExports.useCallback(()=>{I({type:"finishMonthSwitchingAnimation"})},[]);return{referenceDate:A,calendarState:C,setVisibleDate:R,isDateDisabled:b,onMonthSwitchingAnimationEnd:V}},getPickersFadeTransitionGroupUtilityClass=r=>generateUtilityClass("MuiPickersFadeTransitionGroup",r);generateUtilityClasses("MuiPickersFadeTransitionGroup",["root"]);const _excluded$O=["children"],useUtilityClasses$u=r=>composeClasses({root:["root"]},getPickersFadeTransitionGroupUtilityClass,r),PickersFadeTransitionGroupRoot=styled(TransitionGroup,{name:"MuiPickersFadeTransitionGroup",slot:"Root"})({display:"block",position:"relative"});function PickersFadeTransitionGroup(r){const e=useThemeProps({props:r,name:"MuiPickersFadeTransitionGroup"}),{className:t,reduceAnimations:n,transKey:i,classes:s}=e,{children:a}=e,o=_objectWithoutPropertiesLoose(e,_excluded$O),c=useUtilityClasses$u(s),h=useTheme();return n?a:jsxRuntimeExports.jsx(PickersFadeTransitionGroupRoot,{className:clsx(c.root,t),ownerState:o,children:jsxRuntimeExports.jsx(Fade,{appear:!1,mountOnEnter:!0,unmountOnExit:!0,timeout:{appear:h.transitions.duration.enteringScreen,enter:h.transitions.duration.enteringScreen,exit:0},children:a},i)})}const getPickersSlideTransitionUtilityClass=r=>generateUtilityClass("MuiPickersSlideTransition",r),pickersSlideTransitionClasses=generateUtilityClasses("MuiPickersSlideTransition",["root","slideEnter-left","slideEnter-right","slideEnterActive","slideExit","slideExitActiveLeft-left","slideExitActiveLeft-right"]),_excluded$N=["children","className","reduceAnimations","slideDirection","transKey","classes"],useUtilityClasses$t=(r,e)=>{const{slideDirection:t}=e,n={root:["root"],exit:["slideExit"],enterActive:["slideEnterActive"],enter:[`slideEnter-${t}`],exitActive:[`slideExitActiveLeft-${t}`]};return composeClasses(n,getPickersSlideTransitionUtilityClass,r)},PickersSlideTransitionRoot=styled(TransitionGroup,{name:"MuiPickersSlideTransition",slot:"Root",overridesResolver:(r,e)=>[e.root,{[`.${pickersSlideTransitionClasses["slideEnter-left"]}`]:e["slideEnter-left"]},{[`.${pickersSlideTransitionClasses["slideEnter-right"]}`]:e["slideEnter-right"]},{[`.${pickersSlideTransitionClasses.slideEnterActive}`]:e.slideEnterActive},{[`.${pickersSlideTransitionClasses.slideExit}`]:e.slideExit},{[`.${pickersSlideTransitionClasses["slideExitActiveLeft-left"]}`]:e["slideExitActiveLeft-left"]},{[`.${pickersSlideTransitionClasses["slideExitActiveLeft-right"]}`]:e["slideExitActiveLeft-right"]}]})(({theme:r})=>{const e=r.transitions.create("transform",{duration:r.transitions.duration.complex,easing:"cubic-bezier(0.35, 0.8, 0.4, 1)"});return{display:"block",position:"relative",overflowX:"hidden","& > *":{position:"absolute",top:0,right:0,left:0},[`& .${pickersSlideTransitionClasses["slideEnter-left"]}`]:{willChange:"transform",transform:"translate(100%)",zIndex:1},[`& .${pickersSlideTransitionClasses["slideEnter-right"]}`]:{willChange:"transform",transform:"translate(-100%)",zIndex:1},[`& .${pickersSlideTransitionClasses.slideEnterActive}`]:{transform:"translate(0%)",transition:e},[`& .${pickersSlideTransitionClasses.slideExit}`]:{transform:"translate(0%)"},[`& .${pickersSlideTransitionClasses["slideExitActiveLeft-left"]}`]:{willChange:"transform",transform:"translate(-100%)",transition:e,zIndex:0},[`& .${pickersSlideTransitionClasses["slideExitActiveLeft-right"]}`]:{willChange:"transform",transform:"translate(100%)",transition:e,zIndex:0}}});function PickersSlideTransition(r){const e=useThemeProps({props:r,name:"MuiPickersSlideTransition"}),{children:t,className:n,reduceAnimations:i,slideDirection:s,transKey:a,classes:o}=e,c=_objectWithoutPropertiesLoose(e,_excluded$N),{ownerState:h}=usePickerPrivateContext(),f=_extends({},h,{slideDirection:s}),m=useUtilityClasses$t(o,f),g=useTheme();if(i)return jsxRuntimeExports.jsx("div",{className:clsx(m.root,n),children:t});const _={exit:m.exit,enterActive:m.enterActive,enter:m.enter,exitActive:m.exitActive};return jsxRuntimeExports.jsx(PickersSlideTransitionRoot,{className:clsx(m.root,n),childFactory:E=>reactExports.cloneElement(E,{classNames:_}),role:"presentation",ownerState:f,children:jsxRuntimeExports.jsx(CSSTransition,_extends({mountOnEnter:!0,unmountOnExit:!0,timeout:g.transitions.duration.complex,classNames:_},c,{children:t}),a)})}const getDayCalendarUtilityClass=r=>generateUtilityClass("MuiDayCalendar",r);generateUtilityClasses("MuiDayCalendar",["root","header","weekDayLabel","loadingContainer","slideTransition","monthContainer","weekContainer","weekNumberLabel","weekNumber"]);const _excluded$M=["parentProps","day","focusedDay","selectedDays","isDateDisabled","currentMonthNumber","isViewFocused"],_excluded2$7=["ownerState"],useUtilityClasses$s=r=>composeClasses({root:["root"],header:["header"],weekDayLabel:["weekDayLabel"],loadingContainer:["loadingContainer"],slideTransition:["slideTransition"],monthContainer:["monthContainer"],weekContainer:["weekContainer"],weekNumberLabel:["weekNumberLabel"],weekNumber:["weekNumber"]},getDayCalendarUtilityClass,r),weeksContainerHeight=(DAY_SIZE+DAY_MARGIN*2)*6,PickersCalendarDayRoot=styled("div",{name:"MuiDayCalendar",slot:"Root"})({}),PickersCalendarDayHeader=styled("div",{name:"MuiDayCalendar",slot:"Header"})({display:"flex",justifyContent:"center",alignItems:"center"}),PickersCalendarWeekDayLabel=styled(Typography,{name:"MuiDayCalendar",slot:"WeekDayLabel"})(({theme:r})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(r.vars||r).palette.text.secondary})),PickersCalendarWeekNumberLabel=styled(Typography,{name:"MuiDayCalendar",slot:"WeekNumberLabel"})(({theme:r})=>({width:36,height:40,margin:"0 2px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",color:(r.vars||r).palette.text.disabled})),PickersCalendarWeekNumber=styled(Typography,{name:"MuiDayCalendar",slot:"WeekNumber"})(({theme:r})=>_extends({},r.typography.caption,{width:DAY_SIZE,height:DAY_SIZE,padding:0,margin:`0 ${DAY_MARGIN}px`,color:(r.vars||r).palette.text.disabled,fontSize:"0.75rem",alignItems:"center",justifyContent:"center",display:"inline-flex"})),PickersCalendarLoadingContainer=styled("div",{name:"MuiDayCalendar",slot:"LoadingContainer"})({display:"flex",justifyContent:"center",alignItems:"center",minHeight:weeksContainerHeight}),PickersCalendarSlideTransition=styled(PickersSlideTransition,{name:"MuiDayCalendar",slot:"SlideTransition"})({minHeight:weeksContainerHeight}),PickersCalendarWeekContainer=styled("div",{name:"MuiDayCalendar",slot:"MonthContainer"})({overflow:"hidden"}),PickersCalendarWeek=styled("div",{name:"MuiDayCalendar",slot:"WeekContainer"})({margin:`${DAY_MARGIN}px 0`,display:"flex",justifyContent:"center"});function WrappedDay(r){let{parentProps:e,day:t,focusedDay:n,selectedDays:i,isDateDisabled:s,currentMonthNumber:a,isViewFocused:o}=r,c=_objectWithoutPropertiesLoose(r,_excluded$M);const{disabled:h,disableHighlightToday:f,isMonthSwitchingAnimating:m,showDaysOutsideCurrentMonth:g,slots:_,slotProps:E,timezone:A}=e,C=usePickerAdapter(),I=useNow(A),b=n!=null&&C.isSameDay(t,n),R=o&&b,V=i.some(ae=>C.isSameDay(ae,t)),U=C.isSameDay(t,I),W=reactExports.useMemo(()=>h||s(t),[h,s,t]),j=reactExports.useMemo(()=>C.getMonth(t)!==a,[C,t,a]),w=usePickerDayOwnerState({day:t,selected:V,disabled:W,today:U,outsideCurrentMonth:j,disableMargin:void 0,disableHighlightToday:f,showDaysOutsideCurrentMonth:g}),P=(_==null?void 0:_.day)??PickersDay,K=useSlotProps({elementType:P,externalSlotProps:E==null?void 0:E.day,additionalProps:_extends({disableHighlightToday:f,showDaysOutsideCurrentMonth:g,role:"gridcell",isAnimating:m,"data-timestamp":C.toJsDate(t).valueOf()},c),ownerState:_extends({},w,{day:t,isDayDisabled:W,isDaySelected:V})}),X=_objectWithoutPropertiesLoose(K,_excluded2$7),Y=reactExports.useMemo(()=>{const ae=C.startOfMonth(C.setMonth(t,a));return g?C.isSameDay(t,C.startOfWeek(ae)):C.isSameDay(t,ae)},[a,t,g,C]),Z=reactExports.useMemo(()=>{const ae=C.endOfMonth(C.setMonth(t,a));return g?C.isSameDay(t,C.endOfWeek(ae)):C.isSameDay(t,ae)},[a,t,g,C]);return jsxRuntimeExports.jsx(P,_extends({},X,{day:t,disabled:W,autoFocus:!j&&R,today:U,outsideCurrentMonth:j,isFirstVisibleCell:Y,isLastVisibleCell:Z,selected:V,tabIndex:b?0:-1,"aria-selected":V,"aria-current":U?"date":void 0}))}function DayCalendar(r){const e=useThemeProps({props:r,name:"MuiDayCalendar"}),t=usePickerAdapter(),{onFocusedDayChange:n,className:i,classes:s,currentMonth:a,selectedDays:o,focusedDay:c,loading:h,onSelectedDaysChange:f,onMonthSwitchingAnimationEnd:m,readOnly:g,reduceAnimations:_,renderLoading:E=()=>jsxRuntimeExports.jsx("span",{children:"..."}),slideDirection:A,TransitionProps:C,disablePast:I,disableFuture:b,minDate:R,maxDate:V,shouldDisableDate:U,shouldDisableMonth:W,shouldDisableYear:j,dayOfWeekFormatter:w=Te=>t.format(Te,"weekdayShort").charAt(0).toUpperCase(),hasFocus:P,onFocusedViewChange:K,gridLabelId:X,displayWeekNumber:Y,fixedWeekNumber:Z,timezone:ae}=e,le=useNow(ae),ie=useUtilityClasses$s(s),se=useRtl(),ce=useIsDateDisabled({shouldDisableDate:U,shouldDisableMonth:W,shouldDisableYear:j,minDate:R,maxDate:V,disablePast:I,disableFuture:b,timezone:ae}),ue=usePickerTranslations(),Ae=useEventCallback(Te=>{g||f(Te)}),Se=Te=>{ce(Te)||(n(Te),K==null||K(!0))},ye=useEventCallback((Te,pe)=>{switch(Te.key){case"ArrowUp":Se(t.addDays(pe,-7)),Te.preventDefault();break;case"ArrowDown":Se(t.addDays(pe,7)),Te.preventDefault();break;case"ArrowLeft":{const Fe=t.addDays(pe,se?1:-1),Re=t.addMonths(pe,se?1:-1),Ue=findClosestEnabledDate({adapter:t,date:Fe,minDate:se?Fe:t.startOfMonth(Re),maxDate:se?t.endOfMonth(Re):Fe,isDateDisabled:ce,timezone:ae});Se(Ue||Fe),Te.preventDefault();break}case"ArrowRight":{const Fe=t.addDays(pe,se?-1:1),Re=t.addMonths(pe,se?-1:1),Ue=findClosestEnabledDate({adapter:t,date:Fe,minDate:se?t.startOfMonth(Re):Fe,maxDate:se?Fe:t.endOfMonth(Re),isDateDisabled:ce,timezone:ae});Se(Ue||Fe),Te.preventDefault();break}case"Home":Se(t.startOfWeek(pe)),Te.preventDefault();break;case"End":Se(t.endOfWeek(pe)),Te.preventDefault();break;case"PageUp":Se(t.addMonths(pe,1)),Te.preventDefault();break;case"PageDown":Se(t.addMonths(pe,-1)),Te.preventDefault();break}}),he=useEventCallback((Te,pe)=>Se(pe)),ke=useEventCallback((Te,pe)=>{c!=null&&t.isSameDay(c,pe)&&(K==null||K(!1))}),Pe=t.getMonth(a),Le=t.getYear(a),$e=reactExports.useMemo(()=>o.filter(Te=>!!Te).map(Te=>t.startOfDay(Te)),[t,o]),qe=`${Le}-${Pe}`,xe=reactExports.useMemo(()=>reactExports.createRef(),[qe]),Ie=reactExports.useMemo(()=>{const Te=t.getWeekArray(a);let pe=t.addMonths(a,1);for(;Z&&Te.length<Z;){const Fe=t.getWeekArray(pe),Re=t.isSameDay(Te[Te.length-1][0],Fe[0][0]);Fe.slice(Re?1:0).forEach(Ue=>{Te.length<Z&&Te.push(Ue)}),pe=t.addMonths(pe,1)}return Te},[a,Z,t]);return jsxRuntimeExports.jsxs(PickersCalendarDayRoot,{role:"grid","aria-labelledby":X,className:ie.root,children:[jsxRuntimeExports.jsxs(PickersCalendarDayHeader,{role:"row",className:ie.header,children:[Y&&jsxRuntimeExports.jsx(PickersCalendarWeekNumberLabel,{variant:"caption",role:"columnheader","aria-label":ue.calendarWeekNumberHeaderLabel,className:ie.weekNumberLabel,children:ue.calendarWeekNumberHeaderText}),getWeekdays(t,le).map((Te,pe)=>jsxRuntimeExports.jsx(PickersCalendarWeekDayLabel,{variant:"caption",role:"columnheader","aria-label":t.format(Te,"weekday"),className:ie.weekDayLabel,children:w(Te)},pe.toString()))]}),h?jsxRuntimeExports.jsx(PickersCalendarLoadingContainer,{className:ie.loadingContainer,children:E()}):jsxRuntimeExports.jsx(PickersCalendarSlideTransition,_extends({transKey:qe,onExited:m,reduceAnimations:_,slideDirection:A,className:clsx(i,ie.slideTransition)},C,{nodeRef:xe,children:jsxRuntimeExports.jsx(PickersCalendarWeekContainer,{ref:xe,role:"rowgroup",className:ie.monthContainer,children:Ie.map((Te,pe)=>jsxRuntimeExports.jsxs(PickersCalendarWeek,{role:"row",className:ie.weekContainer,"aria-rowindex":pe+1,children:[Y&&jsxRuntimeExports.jsx(PickersCalendarWeekNumber,{className:ie.weekNumber,role:"rowheader","aria-label":ue.calendarWeekNumberAriaLabelText(t.getWeekNumber(Te[0])),children:ue.calendarWeekNumberText(t.getWeekNumber(Te[0]))}),Te.map((Fe,Re)=>jsxRuntimeExports.jsx(WrappedDay,{parentProps:e,day:Fe,selectedDays:$e,isViewFocused:P,focusedDay:c,onKeyDown:ye,onFocus:he,onBlur:ke,onDaySelect:Ae,isDateDisabled:ce,currentMonthNumber:Pe,"aria-colindex":Re+1},Fe.toString()))]},`week-${Te[0]}`))})}))]})}function getMonthCalendarUtilityClass(r){return generateUtilityClass("MuiMonthCalendar",r)}const monthCalendarClasses=generateUtilityClasses("MuiMonthCalendar",["root","button","disabled","selected"]),_excluded$L=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],useUtilityClasses$r=(r,e)=>{const t={button:["button",e.isMonthDisabled&&"disabled",e.isMonthSelected&&"selected"]};return composeClasses(t,getMonthCalendarUtilityClass,r)},DefaultMonthButton=styled("button",{name:"MuiMonthCalendar",slot:"Button",overridesResolver:(r,e)=>[e.button,{[`&.${monthCalendarClasses.disabled}`]:e.disabled},{[`&.${monthCalendarClasses.selected}`]:e.selected}]})(({theme:r})=>_extends({color:"unset",backgroundColor:"transparent",border:0,outline:0},r.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.hoverOpacity})`:alpha(r.palette.action.active,r.palette.action.hoverOpacity)},"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.hoverOpacity})`:alpha(r.palette.action.active,r.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${monthCalendarClasses.disabled}`]:{color:(r.vars||r).palette.text.secondary},[`&.${monthCalendarClasses.selected}`]:{color:(r.vars||r).palette.primary.contrastText,backgroundColor:(r.vars||r).palette.primary.main,"&:focus, &:hover":{backgroundColor:(r.vars||r).palette.primary.dark}}})),MonthCalendarButton=reactExports.memo(function r(e){const{autoFocus:t,classes:n,disabled:i,selected:s,value:a,onClick:o,onKeyDown:c,onFocus:h,onBlur:f,slots:m,slotProps:g}=e,_=_objectWithoutPropertiesLoose(e,_excluded$L),E=reactExports.useRef(null),{ownerState:A}=usePickerPrivateContext(),C=_extends({},A,{isMonthDisabled:i,isMonthSelected:s}),I=useUtilityClasses$r(n,C);useEnhancedEffect(()=>{var V;t&&((V=E.current)==null||V.focus())},[t]);const b=(m==null?void 0:m.monthButton)??DefaultMonthButton,R=useSlotProps({elementType:b,externalSlotProps:g==null?void 0:g.monthButton,externalForwardedProps:_,additionalProps:{disabled:i,ref:E,type:"button",role:"radio","aria-checked":s,onClick:V=>o(V,a),onKeyDown:V=>c(V,a),onFocus:V=>h(V,a),onBlur:V=>f(V,a)},ownerState:C,className:I.button});return jsxRuntimeExports.jsx(b,_extends({},R))}),_excluded$K=["autoFocus","className","currentMonth","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","shouldDisableMonth","readOnly","disableHighlightToday","onMonthFocus","hasFocus","onFocusedViewChange","monthsPerRow","timezone","gridLabelId","slots","slotProps"],useUtilityClasses$q=r=>composeClasses({root:["root"]},getMonthCalendarUtilityClass,r);function useMonthCalendarDefaultizedProps(r,e){const t=useThemeProps({props:r,name:e}),n=useApplyDefaultValuesToDateValidationProps(t);return _extends({},t,n,{monthsPerRow:t.monthsPerRow??3})}const isSameMonth$1=(r,e,t,n,i)=>!!(r===e&&n&&i.isSameYear(t,n)),MonthCalendarRoot=styled("div",{name:"MuiMonthCalendar",slot:"Root",shouldForwardProp:r=>shouldForwardProp(r)&&r!=="monthsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:16,padding:"8px 0",width:DIALOG_WIDTH,boxSizing:"border-box",variants:[{props:{monthsPerRow:3},style:{columnGap:24}},{props:{monthsPerRow:4},style:{columnGap:0}}]}),MonthCalendar=reactExports.forwardRef(function r(e,t){const n=useMonthCalendarDefaultizedProps(e,"MuiMonthCalendar"),{autoFocus:i,className:s,currentMonth:a,classes:o,value:c,defaultValue:h,referenceDate:f,disabled:m,disableFuture:g,disablePast:_,maxDate:E,minDate:A,onChange:C,shouldDisableMonth:I,readOnly:b,onMonthFocus:R,hasFocus:V,onFocusedViewChange:U,monthsPerRow:W,timezone:j,gridLabelId:w,slots:P,slotProps:K}=n,X=_objectWithoutPropertiesLoose(n,_excluded$K),{value:Y,handleValueChange:Z,timezone:ae}=useControlledValue({name:"MonthCalendar",timezone:j,value:c,defaultValue:h,referenceDate:f,onChange:C,valueManager:singleItemValueManager}),le=useNow(ae),ie=useRtl(),se=usePickerAdapter(),{ownerState:ce}=usePickerPrivateContext(),ue=reactExports.useMemo(()=>singleItemValueManager.getInitialReferenceValue({value:Y,adapter:se,props:n,timezone:ae,referenceDate:f,granularity:SECTION_TYPE_GRANULARITY.month}),[]),Ae=useUtilityClasses$q(o),Se=reactExports.useMemo(()=>se.getMonth(le),[se,le]),ye=reactExports.useMemo(()=>Y!=null?se.getMonth(Y):null,[Y,se]),[he,ke]=reactExports.useState(()=>ye||se.getMonth(ue)),[Pe,Le]=useControlled({name:"MonthCalendar",state:"hasFocus",controlled:V,default:i??!1}),$e=useEventCallback(Re=>{Le(Re),U&&U(Re)}),qe=reactExports.useCallback(Re=>{const Ue=se.startOfMonth(_&&se.isAfter(le,A)?le:A),Ve=se.startOfMonth(g&&se.isBefore(le,E)?le:E),Me=se.startOfMonth(Re);return se.isBefore(Me,Ue)||se.isAfter(Me,Ve)?!0:I?I(Me):!1},[g,_,E,A,le,I,se]),xe=useEventCallback((Re,Ue)=>{if(b)return;const Ve=Y&&a&&!se.isSameYear(Y,a)?se.setYear(Y,se.getYear(a)):Y,Me=se.setMonth(Ve??ue,Ue);Z(Me)}),Ie=useEventCallback(Re=>{qe(se.setMonth(Y??a??ue,Re))||(ke(Re),$e(!0),R&&R(Re))});reactExports.useEffect(()=>{ke(Re=>ye!==null&&Re!==ye?ye:Re)},[ye]);const Te=useEventCallback((Re,Ue)=>{switch(Re.key){case"ArrowUp":Ie((12+Ue-3)%12),Re.preventDefault();break;case"ArrowDown":Ie((12+Ue+3)%12),Re.preventDefault();break;case"ArrowLeft":Ie((12+Ue+(ie?1:-1))%12),Re.preventDefault();break;case"ArrowRight":Ie((12+Ue+(ie?-1:1))%12),Re.preventDefault();break}}),pe=useEventCallback((Re,Ue)=>{Ie(Ue)}),Fe=useEventCallback((Re,Ue)=>{he===Ue&&$e(!1)});return jsxRuntimeExports.jsx(MonthCalendarRoot,_extends({ref:t,className:clsx(Ae.root,s),ownerState:ce,role:"radiogroup","aria-labelledby":w,monthsPerRow:W},X,{children:getMonthsInYear(se,a??Y??ue).map(Re=>{const Ue=se.getMonth(Re),Ve=se.format(Re,"monthShort"),Me=se.format(Re,"month"),ze=isSameMonth$1(Ue,ye,Re,Y,se),He=m||qe(Re);return jsxRuntimeExports.jsx(MonthCalendarButton,{selected:ze,value:Ue,onClick:xe,onKeyDown:Te,autoFocus:Pe&&Ue===he,disabled:He,tabIndex:Ue===he&&!He?0:-1,onFocus:pe,onBlur:Fe,"aria-current":isSameMonth$1(Ue,Se,Re,le,se)?"date":void 0,"aria-label":Me,slots:P,slotProps:K,classes:o,children:Ve},Ve)})}))});function getYearCalendarUtilityClass(r){return generateUtilityClass("MuiYearCalendar",r)}const yearCalendarClasses=generateUtilityClasses("MuiYearCalendar",["root","button","disabled","selected"]),_excluded$J=["autoFocus","classes","disabled","selected","value","onClick","onKeyDown","onFocus","onBlur","slots","slotProps"],useUtilityClasses$p=(r,e)=>{const t={button:["button",e.isYearDisabled&&"disabled",e.isYearSelected&&"selected"]};return composeClasses(t,getYearCalendarUtilityClass,r)},DefaultYearButton=styled("button",{name:"MuiYearCalendar",slot:"Button",overridesResolver:(r,e)=>[e.button,{[`&.${yearCalendarClasses.disabled}`]:e.disabled},{[`&.${yearCalendarClasses.selected}`]:e.selected}]})(({theme:r})=>_extends({color:"unset",backgroundColor:"transparent",border:0,outline:0},r.typography.subtitle1,{height:36,width:72,borderRadius:18,cursor:"pointer","&:focus":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.focusOpacity})`:alpha(r.palette.action.active,r.palette.action.focusOpacity)},"&:hover":{backgroundColor:r.vars?`rgba(${r.vars.palette.action.activeChannel} / ${r.vars.palette.action.hoverOpacity})`:alpha(r.palette.action.active,r.palette.action.hoverOpacity)},"&:disabled":{cursor:"auto",pointerEvents:"none"},[`&.${yearCalendarClasses.disabled}`]:{color:(r.vars||r).palette.text.secondary},[`&.${yearCalendarClasses.selected}`]:{color:(r.vars||r).palette.primary.contrastText,backgroundColor:(r.vars||r).palette.primary.main,"&:focus, &:hover":{backgroundColor:(r.vars||r).palette.primary.dark}}})),YearCalendarButton=reactExports.memo(function r(e){const{autoFocus:t,classes:n,disabled:i,selected:s,value:a,onClick:o,onKeyDown:c,onFocus:h,onBlur:f,slots:m,slotProps:g}=e,_=_objectWithoutPropertiesLoose(e,_excluded$J),E=reactExports.useRef(null),{ownerState:A}=usePickerPrivateContext(),C=_extends({},A,{isYearDisabled:i,isYearSelected:s}),I=useUtilityClasses$p(n,C);useEnhancedEffect(()=>{var V;t&&((V=E.current)==null||V.focus())},[t]);const b=(m==null?void 0:m.yearButton)??DefaultYearButton,R=useSlotProps({elementType:b,externalSlotProps:g==null?void 0:g.yearButton,externalForwardedProps:_,additionalProps:{disabled:i,ref:E,type:"button",role:"radio","aria-checked":s,onClick:V=>o(V,a),onKeyDown:V=>c(V,a),onFocus:V=>h(V,a),onBlur:V=>f(V,a)},ownerState:C,className:I.button});return jsxRuntimeExports.jsx(b,_extends({},R))}),_excluded$I=["autoFocus","className","classes","value","defaultValue","referenceDate","disabled","disableFuture","disablePast","maxDate","minDate","onChange","readOnly","shouldDisableYear","disableHighlightToday","onYearFocus","hasFocus","onFocusedViewChange","yearsOrder","yearsPerRow","timezone","gridLabelId","slots","slotProps"],useUtilityClasses$o=r=>composeClasses({root:["root"]},getYearCalendarUtilityClass,r);function useYearCalendarDefaultizedProps(r,e){const t=useThemeProps({props:r,name:e}),n=useApplyDefaultValuesToDateValidationProps(t);return _extends({},t,n,{yearsPerRow:t.yearsPerRow??3,yearsOrder:t.yearsOrder??"asc"})}const YearCalendarRoot=styled("div",{name:"MuiYearCalendar",slot:"Root",shouldForwardProp:r=>shouldForwardProp(r)&&r!=="yearsPerRow"})({display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",rowGap:12,padding:"6px 0",overflowY:"auto",height:"100%",width:DIALOG_WIDTH,maxHeight:MAX_CALENDAR_HEIGHT,boxSizing:"border-box",position:"relative",variants:[{props:{yearsPerRow:3},style:{columnGap:24}},{props:{yearsPerRow:4},style:{columnGap:0,padding:"0 2px"}}]}),YearCalendarButtonFiller=styled("div",{name:"MuiYearCalendar",slot:"ButtonFiller"})({height:36,width:72}),YearCalendar=reactExports.forwardRef(function r(e,t){const n=useYearCalendarDefaultizedProps(e,"MuiYearCalendar"),{autoFocus:i,className:s,classes:a,value:o,defaultValue:c,referenceDate:h,disabled:f,disableFuture:m,disablePast:g,maxDate:_,minDate:E,onChange:A,readOnly:C,shouldDisableYear:I,onYearFocus:b,hasFocus:R,onFocusedViewChange:V,yearsOrder:U,yearsPerRow:W,timezone:j,gridLabelId:w,slots:P,slotProps:K}=n,X=_objectWithoutPropertiesLoose(n,_excluded$I),{value:Y,handleValueChange:Z,timezone:ae}=useControlledValue({name:"YearCalendar",timezone:j,value:o,defaultValue:c,referenceDate:h,onChange:A,valueManager:singleItemValueManager}),le=useNow(ae),ie=useRtl(),se=usePickerAdapter(),{ownerState:ce}=usePickerPrivateContext(),ue=reactExports.useMemo(()=>singleItemValueManager.getInitialReferenceValue({value:Y,adapter:se,props:n,timezone:ae,referenceDate:h,granularity:SECTION_TYPE_GRANULARITY.year}),[]),Ae=useUtilityClasses$o(a),Se=reactExports.useMemo(()=>se.getYear(le),[se,le]),ye=reactExports.useMemo(()=>Y!=null?se.getYear(Y):null,[Y,se]),[he,ke]=reactExports.useState(()=>ye||se.getYear(ue)),[Pe,Le]=useControlled({name:"YearCalendar",state:"hasFocus",controlled:R,default:i??!1}),$e=useEventCallback(Ne=>{Le(Ne),V&&V(Ne)}),qe=reactExports.useCallback(Ne=>{if(g&&se.isBeforeYear(Ne,le)||m&&se.isAfterYear(Ne,le)||E&&se.isBeforeYear(Ne,E)||_&&se.isAfterYear(Ne,_))return!0;if(!I)return!1;const Be=se.startOfYear(Ne);return I(Be)},[m,g,_,E,le,I,se]),xe=useEventCallback((Ne,Be)=>{if(C)return;const et=se.setYear(Y??ue,Be);Z(et)}),Ie=useEventCallback(Ne=>{qe(se.setYear(Y??ue,Ne))||(ke(Ne),$e(!0),b==null||b(Ne))});reactExports.useEffect(()=>{ke(Ne=>ye!==null&&Ne!==ye?ye:Ne)},[ye]);const Te=U!=="desc"?W*1:W*-1,pe=ie&&U==="asc"||!ie&&U==="desc"?-1:1,Fe=useEventCallback((Ne,Be)=>{switch(Ne.key){case"ArrowUp":Ie(Be-Te),Ne.preventDefault();break;case"ArrowDown":Ie(Be+Te),Ne.preventDefault();break;case"ArrowLeft":Ie(Be-pe),Ne.preventDefault();break;case"ArrowRight":Ie(Be+pe),Ne.preventDefault();break}}),Re=useEventCallback((Ne,Be)=>{Ie(Be)}),Ue=useEventCallback((Ne,Be)=>{he===Be&&$e(!1)}),Ve=reactExports.useRef(null),Me=useForkRef(t,Ve);reactExports.useEffect(()=>{if(i||Ve.current===null)return;const Ne=Ve.current.querySelector('[tabindex="0"]');if(!Ne)return;const Be=Ne.offsetHeight,et=Ne.offsetTop,nt=Ve.current.clientHeight,ir=Ve.current.scrollTop,dr=et+Be;Be>nt||et<ir||(Ve.current.scrollTop=dr-nt/2-Be/2)},[i]);const ze=se.getYearRange([E,_]);U==="desc"&&ze.reverse();let He=W-ze.length%W;return He===W&&(He=0),jsxRuntimeExports.jsxs(YearCalendarRoot,_extends({ref:Me,className:clsx(Ae.root,s),ownerState:ce,role:"radiogroup","aria-labelledby":w,yearsPerRow:W},X,{children:[ze.map(Ne=>{const Be=se.getYear(Ne),et=Be===ye,nt=f||qe(Ne);return jsxRuntimeExports.jsx(YearCalendarButton,{selected:et,value:Be,onClick:xe,onKeyDown:Fe,autoFocus:Pe&&Be===he,disabled:nt,tabIndex:Be===he&&!nt?0:-1,onFocus:Re,onBlur:Ue,"aria-current":Se===Be?"date":void 0,slots:P,slotProps:K,classes:a,children:se.format(Ne,"year")},se.format(Ne,"year"))}),Array.from({length:He},(Ne,Be)=>jsxRuntimeExports.jsx(YearCalendarButtonFiller,{},Be))]}))}),getPickersCalendarHeaderUtilityClass=r=>generateUtilityClass("MuiPickersCalendarHeader",r),pickersCalendarHeaderClasses=generateUtilityClasses("MuiPickersCalendarHeader",["root","labelContainer","label","switchViewButton","switchViewIcon"]),_excluded$H=["slots","slotProps","currentMonth","disabled","disableFuture","disablePast","maxDate","minDate","onMonthChange","onViewChange","view","reduceAnimations","views","labelId","className","classes","timezone","format"],_excluded2$6=["ownerState"],useUtilityClasses$n=r=>composeClasses({root:["root"],labelContainer:["labelContainer"],label:["label"],switchViewButton:["switchViewButton"],switchViewIcon:["switchViewIcon"]},getPickersCalendarHeaderUtilityClass,r),PickersCalendarHeaderRoot=styled("div",{name:"MuiPickersCalendarHeader",slot:"Root"})({display:"flex",alignItems:"center",marginTop:12,marginBottom:4,paddingLeft:24,paddingRight:12,maxHeight:40,minHeight:40}),PickersCalendarHeaderLabelContainer=styled("div",{name:"MuiPickersCalendarHeader",slot:"LabelContainer"})(({theme:r})=>_extends({display:"flex",overflow:"hidden",alignItems:"center",cursor:"pointer",marginRight:"auto"},r.typography.body1,{fontWeight:r.typography.fontWeightMedium})),PickersCalendarHeaderLabel=styled("div",{name:"MuiPickersCalendarHeader",slot:"Label"})({marginRight:6}),PickersCalendarHeaderSwitchViewButton=styled(IconButton,{name:"MuiPickersCalendarHeader",slot:"SwitchViewButton"})({marginRight:"auto",variants:[{props:{view:"year"},style:{[`.${pickersCalendarHeaderClasses.switchViewIcon}`]:{transform:"rotate(180deg)"}}}]}),PickersCalendarHeaderSwitchViewIcon=styled(ArrowDropDownIcon,{name:"MuiPickersCalendarHeader",slot:"SwitchViewIcon"})(({theme:r})=>({willChange:"transform",transition:r.transitions.create("transform"),transform:"rotate(0deg)"})),PickersCalendarHeader=reactExports.forwardRef(function r(e,t){const n=usePickerTranslations(),i=usePickerAdapter(),s=useThemeProps({props:e,name:"MuiPickersCalendarHeader"}),{slots:a,slotProps:o,currentMonth:c,disabled:h,disableFuture:f,disablePast:m,maxDate:g,minDate:_,onMonthChange:E,onViewChange:A,view:C,reduceAnimations:I,views:b,labelId:R,className:V,classes:U,timezone:W,format:j=`${i.formats.month} ${i.formats.year}`}=s,w=_objectWithoutPropertiesLoose(s,_excluded$H),{ownerState:P}=usePickerPrivateContext(),K=useUtilityClasses$n(U),X=(a==null?void 0:a.switchViewButton)??PickersCalendarHeaderSwitchViewButton,Y=useSlotProps({elementType:X,externalSlotProps:o==null?void 0:o.switchViewButton,additionalProps:{size:"small","aria-label":n.calendarViewSwitchingButtonAriaLabel(C)},ownerState:_extends({},P,{view:C}),className:K.switchViewButton}),Z=(a==null?void 0:a.switchViewIcon)??PickersCalendarHeaderSwitchViewIcon,ae=useSlotProps({elementType:Z,externalSlotProps:o==null?void 0:o.switchViewIcon,ownerState:P,className:K.switchViewIcon}),le=_objectWithoutPropertiesLoose(ae,_excluded2$6),ie=()=>E(i.addMonths(c,1)),se=()=>E(i.addMonths(c,-1)),ce=useNextMonthDisabled(c,{disableFuture:f,maxDate:g,timezone:W}),ue=usePreviousMonthDisabled(c,{disablePast:m,minDate:_,timezone:W}),Ae=()=>{if(!(b.length===1||!A||h))if(b.length===2)A(b.find(ye=>ye!==C)||b[0]);else{const ye=b.indexOf(C)!==0?0:1;A(b[ye])}};if(b.length===1&&b[0]==="year")return null;const Se=i.formatByString(c,j);return jsxRuntimeExports.jsxs(PickersCalendarHeaderRoot,_extends({},w,{ownerState:P,className:clsx(K.root,V),ref:t,children:[jsxRuntimeExports.jsxs(PickersCalendarHeaderLabelContainer,{role:"presentation",onClick:Ae,ownerState:P,"aria-live":"polite",className:K.labelContainer,children:[jsxRuntimeExports.jsx(PickersFadeTransitionGroup,{reduceAnimations:I,transKey:Se,children:jsxRuntimeExports.jsx(PickersCalendarHeaderLabel,{id:R,ownerState:P,className:K.label,children:Se})}),b.length>1&&!h&&jsxRuntimeExports.jsx(X,_extends({},Y,{children:jsxRuntimeExports.jsx(Z,_extends({},le))}))]}),jsxRuntimeExports.jsx(Fade,{in:C==="day",appear:!I,enter:!I,children:jsxRuntimeExports.jsx(PickersArrowSwitcher,{slots:a,slotProps:o,onGoToPrevious:se,isPreviousDisabled:ue,previousLabel:n.previousMonth,onGoToNext:ie,isNextDisabled:ce,nextLabel:n.nextMonth})})]}))}),PREFERS_REDUCED_MOTION="@media (prefers-reduced-motion: reduce)",mobileVersionMatches=typeof navigator<"u"&&navigator.userAgent.match(/android\s(\d+)|OS\s(\d+)/i),androidVersion=mobileVersionMatches&&mobileVersionMatches[1]?parseInt(mobileVersionMatches[1],10):null,iOSVersion=mobileVersionMatches&&mobileVersionMatches[2]?parseInt(mobileVersionMatches[2],10):null,slowAnimationDevices=androidVersion&&androidVersion<10||iOSVersion&&iOSVersion<13||!1;function useReduceAnimations(r){const e=useMediaQuery(PREFERS_REDUCED_MOTION,{defaultMatches:!1});return r??(e||slowAnimationDevices)}const getDateCalendarUtilityClass=r=>generateUtilityClass("MuiDateCalendar",r);generateUtilityClasses("MuiDateCalendar",["root","viewTransitionContainer"]);const _excluded$G=["autoFocus","onViewChange","value","defaultValue","referenceDate","disableFuture","disablePast","onChange","onYearChange","onMonthChange","reduceAnimations","shouldDisableDate","shouldDisableMonth","shouldDisableYear","view","views","openTo","className","classes","disabled","readOnly","minDate","maxDate","disableHighlightToday","focusedView","onFocusedViewChange","showDaysOutsideCurrentMonth","fixedWeekNumber","dayOfWeekFormatter","slots","slotProps","loading","renderLoading","displayWeekNumber","yearsOrder","yearsPerRow","monthsPerRow","timezone"],useUtilityClasses$m=r=>composeClasses({root:["root"],viewTransitionContainer:["viewTransitionContainer"]},getDateCalendarUtilityClass,r);function useDateCalendarDefaultizedProps(r,e){const t=useThemeProps({props:r,name:e}),n=useReduceAnimations(t.reduceAnimations),i=useApplyDefaultValuesToDateValidationProps(t);return _extends({},t,i,{loading:t.loading??!1,openTo:t.openTo??"day",views:t.views??["year","day"],reduceAnimations:n,renderLoading:t.renderLoading??(()=>jsxRuntimeExports.jsx("span",{children:"..."}))})}const DateCalendarRoot=styled(PickerViewRoot,{name:"MuiDateCalendar",slot:"Root"})({display:"flex",flexDirection:"column",height:VIEW_HEIGHT}),DateCalendarViewTransitionContainer=styled(PickersFadeTransitionGroup,{name:"MuiDateCalendar",slot:"ViewTransitionContainer"})({}),DateCalendar=reactExports.forwardRef(function r(e,t){const n=usePickerAdapter(),{ownerState:i}=usePickerPrivateContext(),s=useId(),a=useDateCalendarDefaultizedProps(e,"MuiDateCalendar"),{autoFocus:o,onViewChange:c,value:h,defaultValue:f,referenceDate:m,disableFuture:g,disablePast:_,onChange:E,onMonthChange:A,reduceAnimations:C,shouldDisableDate:I,shouldDisableMonth:b,shouldDisableYear:R,view:V,views:U,openTo:W,className:j,classes:w,disabled:P,readOnly:K,minDate:X,maxDate:Y,disableHighlightToday:Z,focusedView:ae,onFocusedViewChange:le,showDaysOutsideCurrentMonth:ie,fixedWeekNumber:se,dayOfWeekFormatter:ce,slots:ue,slotProps:Ae,loading:Se,renderLoading:ye,displayWeekNumber:he,yearsOrder:ke,yearsPerRow:Pe,monthsPerRow:Le,timezone:$e}=a,qe=_objectWithoutPropertiesLoose(a,_excluded$G),{value:xe,handleValueChange:Ie,timezone:Te}=useControlledValue({name:"DateCalendar",timezone:$e,value:h,defaultValue:f,referenceDate:m,onChange:E,valueManager:singleItemValueManager}),{view:pe,setView:Fe,focusedView:Re,setFocusedView:Ue,goToNextView:Ve,setValueAndGoToNextView:Me}=useViews({view:V,views:U,openTo:W,onChange:Ie,onViewChange:c,autoFocus:o,focusedView:ae,onFocusedViewChange:le}),{referenceDate:ze,calendarState:He,setVisibleDate:Ne,isDateDisabled:Be,onMonthSwitchingAnimationEnd:et}=useCalendarState({value:xe,referenceDate:m,reduceAnimations:C,onMonthChange:A,minDate:X,maxDate:Y,shouldDisableDate:I,disablePast:_,disableFuture:g,timezone:Te,getCurrentMonthFromVisibleDate:(rt,pr)=>n.isSameMonth(rt,pr)?pr:n.startOfMonth(rt)}),nt=P&&xe||X,ir=P&&xe||Y,dr=`${s}-grid-label`,Xe=Re!==null,Ke=(ue==null?void 0:ue.calendarHeader)??PickersCalendarHeader,cr=useSlotProps({elementType:Ke,externalSlotProps:Ae==null?void 0:Ae.calendarHeader,additionalProps:{views:U,view:pe,currentMonth:He.currentMonth,onViewChange:Fe,onMonthChange:rt=>Ne({target:rt,reason:"header-navigation"}),minDate:nt,maxDate:ir,disabled:P,disablePast:_,disableFuture:g,reduceAnimations:C,timezone:Te,labelId:dr},ownerState:i}),We=useEventCallback(rt=>{const pr=n.startOfMonth(rt),yr=n.endOfMonth(rt),jr=Be(rt)?findClosestEnabledDate({adapter:n,date:rt,minDate:n.isBefore(X,pr)?pr:X,maxDate:n.isAfter(Y,yr)?yr:Y,disablePast:_,disableFuture:g,isDateDisabled:Be,timezone:Te}):rt;jr?(Me(jr,"finish"),Ne({target:jr,reason:"cell-interaction"})):(Ve(),Ne({target:pr,reason:"cell-interaction"}))}),tt=useEventCallback(rt=>{const pr=n.startOfYear(rt),yr=n.endOfYear(rt),jr=Be(rt)?findClosestEnabledDate({adapter:n,date:rt,minDate:n.isBefore(X,pr)?pr:X,maxDate:n.isAfter(Y,yr)?yr:Y,disablePast:_,disableFuture:g,isDateDisabled:Be,timezone:Te}):rt;jr?(Me(jr,"finish"),Ne({target:jr,reason:"cell-interaction"})):(Ve(),Ne({target:pr,reason:"cell-interaction"}))}),It=useEventCallback(rt=>Ie(rt&&mergeDateAndTime(n,rt,xe??ze),"finish",pe));reactExports.useEffect(()=>{n.isValid(xe)&&Ne({target:xe,reason:"controlled-value-change"})},[xe]);const Gt=useUtilityClasses$m(w),or={disablePast:_,disableFuture:g,maxDate:Y,minDate:X},ur={disableHighlightToday:Z,readOnly:K,disabled:P,timezone:Te,gridLabelId:dr,slots:ue,slotProps:Ae},Lt=reactExports.useRef(pe);reactExports.useEffect(()=>{Lt.current!==pe&&(Re===Lt.current&&Ue(pe,!0),Lt.current=pe)},[Re,Ue,pe]);const Lr=reactExports.useMemo(()=>[xe],[xe]);return jsxRuntimeExports.jsxs(DateCalendarRoot,_extends({ref:t,className:clsx(Gt.root,j),ownerState:i},qe,{children:[jsxRuntimeExports.jsx(Ke,_extends({},cr,{slots:ue,slotProps:Ae})),jsxRuntimeExports.jsx(DateCalendarViewTransitionContainer,{reduceAnimations:C,className:Gt.viewTransitionContainer,transKey:pe,ownerState:i,children:jsxRuntimeExports.jsxs("div",{children:[pe==="year"&&jsxRuntimeExports.jsx(YearCalendar,_extends({},or,ur,{value:xe,onChange:tt,shouldDisableYear:R,hasFocus:Xe,onFocusedViewChange:rt=>Ue("year",rt),yearsOrder:ke,yearsPerRow:Pe,referenceDate:ze})),pe==="month"&&jsxRuntimeExports.jsx(MonthCalendar,_extends({},or,ur,{currentMonth:He.currentMonth,hasFocus:Xe,className:j,value:xe,onChange:We,shouldDisableMonth:b,onFocusedViewChange:rt=>Ue("month",rt),monthsPerRow:Le,referenceDate:ze})),pe==="day"&&jsxRuntimeExports.jsx(DayCalendar,_extends({},He,or,ur,{onMonthSwitchingAnimationEnd:et,hasFocus:Xe,onFocusedDayChange:rt=>Ne({target:rt,reason:"cell-interaction"}),reduceAnimations:C,selectedDays:Lr,onSelectedDaysChange:It,shouldDisableDate:I,shouldDisableMonth:b,shouldDisableYear:R,onFocusedViewChange:rt=>Ue("day",rt),showDaysOutsideCurrentMonth:ie,fixedWeekNumber:se,dayOfWeekFormatter:ce,displayWeekNumber:he,loading:Se,renderLoading:ye}))]})})]}))});function getPickersToolbarUtilityClass(r){return generateUtilityClass("MuiPickersToolbar",r)}const pickersToolbarClasses=generateUtilityClasses("MuiPickersToolbar",["root","title","content"]);function useToolbarOwnerState(){const{ownerState:r}=usePickerPrivateContext(),e=useRtl();return reactExports.useMemo(()=>_extends({},r,{toolbarDirection:e?"rtl":"ltr"}),[r,e])}const _excluded$F=["children","className","classes","toolbarTitle","hidden","titleId","classes","landscapeDirection"],useUtilityClasses$l=r=>composeClasses({root:["root"],title:["title"],content:["content"]},getPickersToolbarUtilityClass,r),PickersToolbarRoot=styled("div",{name:"MuiPickersToolbar",slot:"Root"})(({theme:r})=>({display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"space-between",padding:r.spacing(2,3),variants:[{props:{pickerOrientation:"landscape"},style:{height:"auto",maxWidth:160,padding:16,justifyContent:"flex-start",flexWrap:"wrap"}}]})),PickersToolbarContent=styled("div",{name:"MuiPickersToolbar",slot:"Content",shouldForwardProp:r=>shouldForwardProp(r)&&r!=="landscapeDirection"})({display:"flex",flexWrap:"wrap",width:"100%",flex:1,justifyContent:"space-between",alignItems:"center",flexDirection:"row",variants:[{props:{pickerOrientation:"landscape"},style:{justifyContent:"flex-start",alignItems:"flex-start",flexDirection:"column"}},{props:{pickerOrientation:"landscape",landscapeDirection:"row"},style:{flexDirection:"row"}}]}),PickersToolbar=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiPickersToolbar"}),{children:i,className:s,classes:a,toolbarTitle:o,hidden:c,titleId:h,landscapeDirection:f}=n,m=_objectWithoutPropertiesLoose(n,_excluded$F),g=useToolbarOwnerState(),_=useUtilityClasses$l(a);return c?null:jsxRuntimeExports.jsxs(PickersToolbarRoot,_extends({ref:t,className:clsx(_.root,s),ownerState:g},m,{children:[jsxRuntimeExports.jsx(Typography,{color:"text.secondary",variant:"overline",id:h,className:_.title,children:o}),jsxRuntimeExports.jsx(PickersToolbarContent,{className:_.content,ownerState:g,landscapeDirection:f,children:i})]}))});function getPickerPopperUtilityClass(r){return generateUtilityClass("MuiPickerPopper",r)}generateUtilityClasses("MuiPickerPopper",["root","paper"]);const _excluded$E=["PaperComponent","ownerState","children","paperSlotProps","paperClasses","onPaperClick","onPaperTouchStart"],useUtilityClasses$k=r=>composeClasses({root:["root"],paper:["paper"]},getPickerPopperUtilityClass,r),PickerPopperRoot=styled(Popper,{name:"MuiPickerPopper",slot:"Root"})(({theme:r})=>({zIndex:r.zIndex.modal})),PickerPopperPaper=styled(Paper,{name:"MuiPickerPopper",slot:"Paper"})({outline:0,transformOrigin:"top center",variants:[{props:({popperPlacement:r})=>new Set(["top","top-start","top-end"]).has(r),style:{transformOrigin:"bottom center"}}]});function clickedRootScrollbar(r,e){return e.documentElement.clientWidth<r.clientX||e.documentElement.clientHeight<r.clientY}function useClickAwayListener(r,e){const t=reactExports.useRef(!1),n=reactExports.useRef(!1),i=reactExports.useRef(null),s=reactExports.useRef(!1);reactExports.useEffect(()=>{if(!r)return;function c(){s.current=!0}return document.addEventListener("mousedown",c,!0),document.addEventListener("touchstart",c,!0),()=>{document.removeEventListener("mousedown",c,!0),document.removeEventListener("touchstart",c,!0),s.current=!1}},[r]);const a=useEventCallback(c=>{if(!s.current)return;const h=n.current;n.current=!1;const f=ownerDocument(i.current);if(!i.current||"clientX"in c&&clickedRootScrollbar(c,f))return;if(t.current){t.current=!1;return}let m;c.composedPath?m=c.composedPath().indexOf(i.current)>-1:m=!f.documentElement.contains(c.target)||i.current.contains(c.target),!m&&!h&&e(c)}),o=c=>{c.defaultMuiPrevented||(n.current=!0)};return reactExports.useEffect(()=>{if(r){const c=ownerDocument(i.current),h=()=>{t.current=!0};return c.addEventListener("touchstart",a),c.addEventListener("touchmove",h),()=>{c.removeEventListener("touchstart",a),c.removeEventListener("touchmove",h)}}},[r,a]),reactExports.useEffect(()=>{if(r){const c=ownerDocument(i.current);return c.addEventListener("click",a),()=>{c.removeEventListener("click",a),n.current=!1}}},[r,a]),[i,o,o]}const PickerPopperPaperWrapper=reactExports.forwardRef((r,e)=>{const{PaperComponent:t,ownerState:n,children:i,paperSlotProps:s,paperClasses:a,onPaperClick:o,onPaperTouchStart:c}=r,h=_objectWithoutPropertiesLoose(r,_excluded$E),f=useSlotProps({elementType:t,externalSlotProps:s,additionalProps:{tabIndex:-1,elevation:8,ref:e},className:a,ownerState:n});return jsxRuntimeExports.jsx(t,_extends({},h,f,{onClick:m=>{var g;o(m),(g=f.onClick)==null||g.call(f,m)},onTouchStart:m=>{var g;c(m),(g=f.onTouchStart)==null||g.call(f,m)},ownerState:n,children:i}))});function PickerPopper(r){const e=useThemeProps({props:r,name:"MuiPickerPopper"}),{children:t,placement:n="bottom-start",slots:i,slotProps:s,classes:a}=e,{open:o,popupRef:c,reduceAnimations:h}=usePickerContext(),{ownerState:f,rootRefObject:m}=usePickerPrivateContext(),{dismissViews:g,getCurrentViewMode:_,onPopperExited:E,triggerElement:A,viewContainerRole:C}=usePickerPrivateContext();reactExports.useEffect(()=>{function se(ce){o&&ce.key==="Escape"&&g()}return document.addEventListener("keydown",se),()=>{document.removeEventListener("keydown",se)}},[g,o]);const I=reactExports.useRef(null);reactExports.useEffect(()=>{C==="tooltip"||_()==="field"||(o?I.current=getActiveElement(m.current):I.current&&I.current instanceof HTMLElement&&setTimeout(()=>{I.current instanceof HTMLElement&&I.current.focus()}))},[o,C,_,m]);const b=useUtilityClasses$k(a),R=useEventCallback(()=>{C==="tooltip"?executeInTheNextEventLoopTick(()=>{var se,ce;(se=m.current)!=null&&se.contains(getActiveElement(m.current))||(ce=c.current)!=null&&ce.contains(getActiveElement(c.current))||g()}):g()}),[V,U,W]=useClickAwayListener(o,R),j=reactExports.useRef(null),w=useForkRef(j,c),P=useForkRef(w,V),K=se=>{se.key==="Escape"&&(se.stopPropagation(),g())},X=(i==null?void 0:i.desktopTransition)??h?Fade:Grow,Y=(i==null?void 0:i.desktopTrapFocus)??FocusTrap,Z=(i==null?void 0:i.desktopPaper)??PickerPopperPaper,ae=(i==null?void 0:i.popper)??PickerPopperRoot,le=useSlotProps({elementType:ae,externalSlotProps:s==null?void 0:s.popper,additionalProps:{transition:!0,role:C??void 0,open:o,placement:n,anchorEl:A,onKeyDown:K},className:b.root,ownerState:f}),ie=reactExports.useMemo(()=>_extends({},f,{popperPlacement:le.placement}),[f,le.placement]);return jsxRuntimeExports.jsx(ae,_extends({},le,{children:({TransitionProps:se})=>jsxRuntimeExports.jsx(Y,_extends({open:o,disableAutoFocus:!0,disableRestoreFocus:!0,disableEnforceFocus:C==="tooltip",isEnabled:()=>!0},s==null?void 0:s.desktopTrapFocus,{children:jsxRuntimeExports.jsx(X,_extends({},se,s==null?void 0:s.desktopTransition,{onExited:ce=>{var ue,Ae,Se;E==null||E(),(Ae=(ue=s==null?void 0:s.desktopTransition)==null?void 0:ue.onExited)==null||Ae.call(ue,ce),(Se=se==null?void 0:se.onExited)==null||Se.call(se)},children:jsxRuntimeExports.jsx(PickerPopperPaperWrapper,{PaperComponent:Z,ownerState:ie,ref:P,onPaperClick:U,onPaperTouchStart:W,paperClasses:b.paper,paperSlotProps:s==null?void 0:s.desktopPaper,children:t})}))}))}))}function getOrientation(){return typeof window>"u"?"portrait":window.screen&&window.screen.orientation&&window.screen.orientation.angle?Math.abs(window.screen.orientation.angle)===90?"landscape":"portrait":window.orientation&&Math.abs(Number(window.orientation))===90?"landscape":"portrait"}function useOrientation(r,e){const[t,n]=reactExports.useState(getOrientation);return useEnhancedEffect(()=>{const i=()=>{n(getOrientation())};return window.addEventListener("orientationchange",i),()=>{window.removeEventListener("orientationchange",i)}},[]),arrayIncludes(r,["hours","minutes","seconds"])?"portrait":e??t}function useValueAndOpenStates(r){const{props:e,valueManager:t,validator:n}=r,{value:i,defaultValue:s,onChange:a,referenceDate:o,timezone:c,onAccept:h,closeOnSelect:f,open:m,onOpen:g,onClose:_}=e,{current:E}=reactExports.useRef(s),{current:A}=reactExports.useRef(i!==void 0),{current:C}=reactExports.useRef(m!==void 0),I=usePickerAdapter(),{timezone:b,value:R,handleValueChange:V}=useControlledValue({name:"a picker component",timezone:c,value:i,defaultValue:E,referenceDate:o,onChange:a,valueManager:t}),[U,W]=reactExports.useState(()=>({open:!1,lastExternalValue:R,clockShallowValue:void 0,lastCommittedValue:R,hasBeenModifiedSinceMount:!1})),{getValidationErrorForNewValue:j}=useValidation({props:e,validator:n,timezone:b,value:R,onError:e.onError}),w=useEventCallback(Y=>{const Z=typeof Y=="function"?Y(U.open):Y;C||W(ae=>_extends({},ae,{open:Z})),Z&&g&&g(),Z||_==null||_()}),P=useEventCallback((Y,Z)=>{const{changeImportance:ae="accept",skipPublicationIfPristine:le=!1,validationError:ie,shortcut:se,shouldClose:ce=ae==="accept"}=Z??{};let ue,Ae;!le&&!A&&!U.hasBeenModifiedSinceMount?(ue=!0,Ae=ae==="accept"):(ue=!t.areValuesEqual(I,Y,R),Ae=ae==="accept"&&!t.areValuesEqual(I,Y,U.lastCommittedValue)),W(he=>_extends({},he,{clockShallowValue:ue?void 0:he.clockShallowValue,lastCommittedValue:Ae?Y:he.lastCommittedValue,hasBeenModifiedSinceMount:!0}));let Se=null;const ye=()=>(Se||(Se={validationError:ie??j(Y)},se&&(Se.shortcut=se)),Se);ue&&V(Y,ye()),Ae&&h&&h(Y,ye()),ce&&w(!1)});R!==U.lastExternalValue&&W(Y=>_extends({},Y,{lastExternalValue:R,clockShallowValue:void 0,hasBeenModifiedSinceMount:!0}));const K=useEventCallback((Y,Z="partial")=>{if(Z==="shallow"){W(ae=>_extends({},ae,{clockShallowValue:Y,hasBeenModifiedSinceMount:!0}));return}P(Y,{changeImportance:Z==="finish"&&f?"accept":"set"})});reactExports.useEffect(()=>{if(C){if(m===void 0)throw new Error("You must not mix controlling and uncontrolled mode for `open` prop");W(Y=>_extends({},Y,{open:m}))}},[C,m]);const X=reactExports.useMemo(()=>t.cleanValue(I,U.clockShallowValue===void 0?R:U.clockShallowValue),[I,t,U.clockShallowValue,R]);return{timezone:b,state:U,setValue:P,setValueFromView:K,setOpen:w,value:R,viewValue:X}}const _excluded$D=["className","sx"],usePicker=({ref:r,props:e,valueManager:t,valueType:n,variant:i,validator:s,onPopperExited:a,autoFocusView:o,rendererInterceptor:c,localeText:h,viewContainerRole:f,getStepNavigation:m})=>{const{views:g,view:_,openTo:E,onViewChange:A,viewRenderers:C,reduceAnimations:I,orientation:b,disableOpenPicker:R,closeOnSelect:V,disabled:U,readOnly:W,formatDensity:j,enableAccessibleFieldDOMStructure:w,selectedSections:P,onSelectedSectionsChange:K,format:X,label:Y,autoFocus:Z,name:ae}=e,{className:le,sx:ie}=e,se=_objectWithoutPropertiesLoose(e,_excluded$D),ce=useId(),ue=usePickerAdapter(),Ae=useReduceAnimations(I),Se=useOrientation(g,b),{current:ye}=reactExports.useRef(E??null),[he,ke]=reactExports.useState(null),Pe=reactExports.useRef(null),Le=reactExports.useRef(null),$e=reactExports.useRef(null),qe=useForkRef(r,$e),{timezone:xe,state:Ie,setOpen:Te,setValue:pe,setValueFromView:Fe,value:Re,viewValue:Ue}=useValueAndOpenStates({props:e,valueManager:t,validator:s}),{view:Ve,setView:Me,defaultView:ze,focusedView:He,setFocusedView:Ne,setValueAndGoToNextView:Be,goToNextStep:et,hasNextStep:nt,hasSeveralSteps:ir}=useViews({view:_,views:g,openTo:E,onChange:Fe,onViewChange:A,autoFocus:o,getStepNavigation:m}),dr=useEventCallback(()=>pe(t.emptyValue)),Xe=useEventCallback(()=>pe(t.getTodayValue(ue,xe,n))),Ke=useEventCallback(()=>pe(Re)),cr=useEventCallback(()=>pe(Ie.lastCommittedValue,{skipPublicationIfPristine:!0})),We=useEventCallback(()=>{pe(Re,{skipPublicationIfPristine:!0})}),{hasUIView:tt,viewModeLookup:It,timeViewsCount:Gt}=reactExports.useMemo(()=>g.reduce((sr,Tr)=>{const Ki=C[Tr]==null?"field":"UI";return sr.viewModeLookup[Tr]=Ki,Ki==="UI"&&(sr.hasUIView=!0,isTimeView(Tr)&&(sr.timeViewsCount+=1)),sr},{hasUIView:!1,viewModeLookup:{},timeViewsCount:0}),[C,g]),or=It[Ve],ur=useEventCallback(()=>or),[Lt,Lr]=reactExports.useState(or==="UI"?Ve:null);Lt!==Ve&&It[Ve]==="UI"&&Lr(Ve),useEnhancedEffect(()=>{or==="field"&&Ie.open&&(Te(!1),setTimeout(()=>{var sr,Tr;(sr=Le==null?void 0:Le.current)==null||sr.setSelectedSections(Ve),(Tr=Le==null?void 0:Le.current)==null||Tr.focusField(Ve)}))},[Ve]),useEnhancedEffect(()=>{if(!Ie.open)return;let sr=Ve;or==="field"&&Lt!=null&&(sr=Lt),sr!==ze&&It[sr]==="UI"&&It[ze]==="UI"&&(sr=ze),sr!==Ve&&Me(sr),Ne(sr,!0)},[Ie.open]);const rt=reactExports.useMemo(()=>({isPickerValueEmpty:t.areValuesEqual(ue,Re,t.emptyValue),isPickerOpen:Ie.open,isPickerDisabled:e.disabled??!1,isPickerReadOnly:e.readOnly??!1,pickerOrientation:Se,pickerVariant:i}),[ue,t,Re,Ie.open,Se,i,e.disabled,e.readOnly]),pr=reactExports.useMemo(()=>R||!tt?"hidden":U||W?"disabled":"enabled",[R,tt,U,W]),yr=useEventCallback(et),jr=reactExports.useMemo(()=>V&&!ir?[]:["cancel","nextOrAccept"],[V,ir]),Wr=reactExports.useMemo(()=>({setValue:pe,setOpen:Te,clearValue:dr,setValueToToday:Xe,acceptValueChanges:Ke,cancelValueChanges:cr,setView:Me,goToNextStep:yr}),[pe,Te,dr,Xe,Ke,cr,Me,yr]),Ar=reactExports.useMemo(()=>_extends({},Wr,{value:Re,timezone:xe,open:Ie.open,views:g,view:Lt,initialView:ye,disabled:U??!1,readOnly:W??!1,autoFocus:Z??!1,variant:i,orientation:Se,popupRef:Pe,reduceAnimations:Ae,triggerRef:ke,triggerStatus:pr,hasNextStep:nt,fieldFormat:X??"",name:ae,label:Y,rootSx:ie,rootRef:qe,rootClassName:le}),[Wr,Re,qe,i,Se,Ae,U,W,X,le,ae,Y,ie,pr,nt,xe,Ie.open,Lt,g,ye,Z]),Xi=reactExports.useMemo(()=>({dismissViews:We,ownerState:rt,hasUIView:tt,getCurrentViewMode:ur,rootRefObject:$e,labelId:ce,triggerElement:he,viewContainerRole:f,defaultActionBarActions:jr,onPopperExited:a}),[We,rt,tt,ur,ce,he,f,jr,a]),yn=reactExports.useMemo(()=>({formatDensity:j,enableAccessibleFieldDOMStructure:w,selectedSections:P,onSelectedSectionsChange:K,fieldRef:Le}),[j,w,P,K,Le]);return{providerProps:{localeText:h,contextValue:Ar,privateContextValue:Xi,actionsContextValue:Wr,fieldPrivateContextValue:yn,isValidContextValue:sr=>{const Tr=s({adapter:ue,value:sr,timezone:xe,props:e});return!t.hasError(Tr)}},renderCurrentView:()=>{if(Lt==null)return null;const sr=C[Lt];if(sr==null)return null;const Tr=_extends({},se,{views:g,timezone:xe,value:Ue,onChange:Be,view:Lt,onViewChange:Me,showViewSwitcher:Gt>1,timeViewsCount:Gt},f==="tooltip"?{focusedView:null,onFocusedViewChange:()=>{}}:{focusedView:He,onFocusedViewChange:Ne});return c?jsxRuntimeExports.jsx(c,{viewRenderers:C,popperView:Lt,rendererProps:Tr}):sr(Tr)},ownerState:rt}};function getPickersLayoutUtilityClass(r){return generateUtilityClass("MuiPickersLayout",r)}const pickersLayoutClasses=generateUtilityClasses("MuiPickersLayout",["root","landscape","contentWrapper","toolbar","actionBar","tabs","shortcuts"]),_excluded$C=["actions"],PickersActionBarRoot=styled(DialogActions,{name:"MuiPickersLayout",slot:"ActionBar"})({});function PickersActionBarComponent(r){const{actions:e}=r,t=_objectWithoutPropertiesLoose(r,_excluded$C),n=usePickerTranslations(),{clearValue:i,setValueToToday:s,acceptValueChanges:a,cancelValueChanges:o,goToNextStep:c,hasNextStep:h}=usePickerContext();if(e==null||e.length===0)return null;const f=e==null?void 0:e.map(m=>{switch(m){case"clear":return jsxRuntimeExports.jsx(Button,{onClick:i,children:n.clearButtonLabel},m);case"cancel":return jsxRuntimeExports.jsx(Button,{onClick:o,children:n.cancelButtonLabel},m);case"accept":return jsxRuntimeExports.jsx(Button,{onClick:a,children:n.okButtonLabel},m);case"today":return jsxRuntimeExports.jsx(Button,{onClick:s,children:n.todayButtonLabel},m);case"next":return jsxRuntimeExports.jsx(Button,{onClick:c,children:n.nextStepButtonLabel},m);case"nextOrAccept":return h?jsxRuntimeExports.jsx(Button,{onClick:c,children:n.nextStepButtonLabel},m):jsxRuntimeExports.jsx(Button,{onClick:a,children:n.okButtonLabel},m);default:return null}});return jsxRuntimeExports.jsx(PickersActionBarRoot,_extends({},t,{children:f}))}const PickersActionBar=reactExports.memo(PickersActionBarComponent),_excluded$B=["items","changeImportance"],_excluded2$5=["getValue"],PickersShortcutsRoot=styled(List,{name:"MuiPickersLayout",slot:"Shortcuts"})({});function PickersShortcuts(r){const{items:e,changeImportance:t="accept"}=r,n=_objectWithoutPropertiesLoose(r,_excluded$B),{setValue:i}=usePickerActionsContext(),s=useIsValidValue();if(e==null||e.length===0)return null;const a=e.map(o=>{let{getValue:c}=o,h=_objectWithoutPropertiesLoose(o,_excluded2$5);const f=c({isValid:s});return _extends({},h,{label:h.label,onClick:()=>{i(f,{changeImportance:t,shortcut:h})},disabled:!s(f)})});return jsxRuntimeExports.jsx(PickersShortcutsRoot,_extends({dense:!0,sx:[{maxHeight:VIEW_HEIGHT,maxWidth:200,overflow:"auto"},...Array.isArray(n.sx)?n.sx:[n.sx]]},n,{children:a.map(o=>jsxRuntimeExports.jsx(ListItem,{children:jsxRuntimeExports.jsx(Chip,_extends({},o))},o.id??o.label))}))}const _excluded$A=["ownerState"];function toolbarHasView(r){return r.view!==null}const useUtilityClasses$j=(r,e)=>{const{pickerOrientation:t}=e;return composeClasses({root:["root",t==="landscape"&&"landscape"],contentWrapper:["contentWrapper"],toolbar:["toolbar"],actionBar:["actionBar"],tabs:["tabs"],landscape:["landscape"],shortcuts:["shortcuts"]},getPickersLayoutUtilityClass,r)},usePickerLayout=r=>{const{ownerState:e,defaultActionBarActions:t}=usePickerPrivateContext(),{view:n}=usePickerContext(),i=useRtl(),{children:s,slots:a,slotProps:o,classes:c}=r,h=reactExports.useMemo(()=>_extends({},e,{layoutDirection:i?"rtl":"ltr",hasShortcuts:!1}),[e,i]),f=useUtilityClasses$j(c,h),m=(a==null?void 0:a.actionBar)??PickersActionBar,g=useSlotProps({elementType:m,externalSlotProps:o==null?void 0:o.actionBar,additionalProps:{actions:t},className:f.actionBar,ownerState:h}),_=_objectWithoutPropertiesLoose(g,_excluded$A),E=jsxRuntimeExports.jsx(m,_extends({},_)),A=a==null?void 0:a.toolbar,C=useSlotProps({elementType:A,externalSlotProps:o==null?void 0:o.toolbar,className:f.toolbar,ownerState:h}),I=toolbarHasView(C)&&A?jsxRuntimeExports.jsx(A,_extends({},C)):null,b=s,R=a==null?void 0:a.tabs,V=n&&R?jsxRuntimeExports.jsx(R,_extends({className:f.tabs},o==null?void 0:o.tabs)):null,U=(a==null?void 0:a.shortcuts)??PickersShortcuts,W=useSlotProps({elementType:U,externalSlotProps:o==null?void 0:o.shortcuts,className:f.shortcuts,ownerState:h}),j=Array.isArray(W==null?void 0:W.items)&&W.items.length>0,w=n&&U?jsxRuntimeExports.jsx(U,_extends({},W)):null;return{toolbar:I,content:b,tabs:V,actionBar:E,shortcuts:w,ownerState:_extends({},h,{hasShortcuts:j})}},useUtilityClasses$i=(r,e)=>{const{pickerOrientation:t}=e;return composeClasses({root:["root",t==="landscape"&&"landscape"],contentWrapper:["contentWrapper"]},getPickersLayoutUtilityClass,r)},PickersLayoutRoot=styled("div",{name:"MuiPickersLayout",slot:"Root"})({display:"grid",gridAutoColumns:"max-content auto max-content",gridAutoRows:"max-content auto max-content",[`& .${pickersLayoutClasses.actionBar}`]:{gridColumn:"1 / 4",gridRow:3},variants:[{props:{pickerOrientation:"landscape",hasShortcuts:!1},style:{[`& .${pickersLayoutClasses.toolbar}`]:{gridColumn:1,gridRow:"1 / 3"}}},{props:{pickerOrientation:"landscape",hasShortcuts:!0},style:{[`& .${pickersLayoutClasses.toolbar}`]:{gridColumn:"2 / 4",gridRow:1,maxWidth:"max-content"},[`& .${pickersLayoutClasses.shortcuts}`]:{gridColumn:1,gridRow:2}}},{props:{pickerOrientation:"portrait"},style:{[`& .${pickersLayoutClasses.toolbar}`]:{gridColumn:"2 / 4",gridRow:1},[`& .${pickersLayoutClasses.shortcuts}`]:{gridColumn:1,gridRow:"2 / 3"}}},{props:{hasShortcuts:!0,layoutDirection:"rtl"},style:{[`& .${pickersLayoutClasses.shortcuts}`]:{gridColumn:4}}}]}),PickersLayoutContentWrapper=styled("div",{name:"MuiPickersLayout",slot:"ContentWrapper"})({gridColumn:"2 / 4",gridRow:2,display:"flex",flexDirection:"column"}),PickersLayout=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiPickersLayout"}),{toolbar:i,content:s,tabs:a,actionBar:o,shortcuts:c,ownerState:h}=usePickerLayout(n),{orientation:f,variant:m}=usePickerContext(),{sx:g,className:_,classes:E}=n,A=useUtilityClasses$i(E,h);return jsxRuntimeExports.jsxs(PickersLayoutRoot,{ref:t,sx:g,className:clsx(A.root,_),ownerState:h,children:[f==="landscape"?c:i,f==="landscape"?i:c,jsxRuntimeExports.jsx(PickersLayoutContentWrapper,{className:A.contentWrapper,ownerState:h,children:m==="desktop"?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[s,a]}):jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[a,s]})}),o]})});function createNonRangePickerStepNavigation(r){const{steps:e}=r;return createStepNavigation({steps:e,isViewMatchingStep:(t,n)=>n.views==null||n.views.includes(t),onStepChange:({step:t,defaultView:n,setView:i,view:s,views:a})=>{const o=t.views==null?n:t.views.find(c=>a.includes(c));o!==s&&i(o)}})}const _excluded$z=["props","steps"],_excluded2$4=["ownerState"],useDesktopPicker=r=>{var W;let{props:e,steps:t}=r,n=_objectWithoutPropertiesLoose(r,_excluded$z);const{slots:i,slotProps:s,label:a,inputRef:o,localeText:c}=e,h=createNonRangePickerStepNavigation({steps:t}),{providerProps:f,renderCurrentView:m,ownerState:g}=usePicker(_extends({},n,{props:e,localeText:c,autoFocusView:!0,viewContainerRole:"dialog",variant:"desktop",getStepNavigation:h})),_=f.privateContextValue.labelId,E=((W=s==null?void 0:s.toolbar)==null?void 0:W.hidden)??!1,A=i.field,C=useSlotProps({elementType:A,externalSlotProps:s==null?void 0:s.field,additionalProps:_extends({},E&&{id:_}),ownerState:g}),I=_objectWithoutPropertiesLoose(C,_excluded2$4),b=i.layout??PickersLayout;let R=_;E&&(a?R=`${_}-label`:R=void 0);const V=_extends({},s,{toolbar:_extends({},s==null?void 0:s.toolbar,{titleId:_}),popper:_extends({"aria-labelledby":R},s==null?void 0:s.popper)});return{renderPicker:()=>jsxRuntimeExports.jsxs(PickerProvider,_extends({},f,{children:[jsxRuntimeExports.jsx(A,_extends({},I,{slots:i,slotProps:V,inputRef:o})),jsxRuntimeExports.jsx(PickerPopper,{slots:i,slotProps:V,children:jsxRuntimeExports.jsx(b,_extends({},V==null?void 0:V.layout,{slots:i,slotProps:V,children:m()}))})]}))}},renderDateViewCalendar=({view:r,onViewChange:e,views:t,focusedView:n,onFocusedViewChange:i,value:s,defaultValue:a,referenceDate:o,onChange:c,className:h,classes:f,disableFuture:m,disablePast:g,minDate:_,maxDate:E,shouldDisableDate:A,shouldDisableMonth:C,shouldDisableYear:I,reduceAnimations:b,onMonthChange:R,monthsPerRow:V,onYearChange:U,yearsOrder:W,yearsPerRow:j,slots:w,slotProps:P,loading:K,renderLoading:X,disableHighlightToday:Y,readOnly:Z,disabled:ae,showDaysOutsideCurrentMonth:le,dayOfWeekFormatter:ie,sx:se,autoFocus:ce,fixedWeekNumber:ue,displayWeekNumber:Ae,timezone:Se})=>jsxRuntimeExports.jsx(DateCalendar,{view:r,onViewChange:e,views:t.filter(isDatePickerView),focusedView:n&&isDatePickerView(n)?n:null,onFocusedViewChange:i,value:s,defaultValue:a,referenceDate:o,onChange:c,className:h,classes:f,disableFuture:m,disablePast:g,minDate:_,maxDate:E,shouldDisableDate:A,shouldDisableMonth:C,shouldDisableYear:I,reduceAnimations:b,onMonthChange:R,monthsPerRow:V,onYearChange:U,yearsOrder:W,yearsPerRow:j,slots:w,slotProps:P,loading:K,renderLoading:X,disableHighlightToday:Y,readOnly:Z,disabled:ae,showDaysOutsideCurrentMonth:le,dayOfWeekFormatter:ie,sx:se,autoFocus:ce,fixedWeekNumber:ue,displayWeekNumber:Ae,timezone:Se}),PickersModalDialogRoot=styled(Dialog)({[`& .${dialogClasses.container}`]:{outline:0},[`& .${dialogClasses.paper}`]:{outline:0,minWidth:DIALOG_WIDTH}}),PickersModalDialogContent=styled(DialogContent)({"&:first-of-type":{padding:0}});function PickersModalDialog(r){const{children:e,slots:t,slotProps:n}=r,{open:i}=usePickerContext(),{dismissViews:s,onPopperExited:a}=usePickerPrivateContext(),o=(t==null?void 0:t.dialog)??PickersModalDialogRoot,c=(t==null?void 0:t.mobileTransition)??Fade;return jsxRuntimeExports.jsx(o,_extends({open:i,onClose:()=>{s(),a==null||a()}},n==null?void 0:n.dialog,{TransitionComponent:c,TransitionProps:n==null?void 0:n.mobileTransition,PaperComponent:t==null?void 0:t.mobilePaper,PaperProps:n==null?void 0:n.mobilePaper,children:jsxRuntimeExports.jsx(PickersModalDialogContent,{children:e})}))}const _excluded$y=["props","steps"],_excluded2$3=["ownerState"],useMobilePicker=r=>{var W;let{props:e,steps:t}=r,n=_objectWithoutPropertiesLoose(r,_excluded$y);const{slots:i,slotProps:s,label:a,inputRef:o,localeText:c}=e,h=createNonRangePickerStepNavigation({steps:t}),{providerProps:f,renderCurrentView:m,ownerState:g}=usePicker(_extends({},n,{props:e,localeText:c,autoFocusView:!0,viewContainerRole:"dialog",variant:"mobile",getStepNavigation:h})),_=f.privateContextValue.labelId,E=((W=s==null?void 0:s.toolbar)==null?void 0:W.hidden)??!1,A=i.field,C=useSlotProps({elementType:A,externalSlotProps:s==null?void 0:s.field,additionalProps:_extends({},E&&{id:_}),ownerState:g}),I=_objectWithoutPropertiesLoose(C,_excluded2$3),b=i.layout??PickersLayout;let R=_;E&&(a?R=`${_}-label`:R=void 0);const V=_extends({},s,{toolbar:_extends({},s==null?void 0:s.toolbar,{titleId:_}),mobilePaper:_extends({"aria-labelledby":R},s==null?void 0:s.mobilePaper)});return{renderPicker:()=>jsxRuntimeExports.jsxs(PickerProvider,_extends({},f,{children:[jsxRuntimeExports.jsx(A,_extends({},I,{slots:i,slotProps:V,inputRef:o})),jsxRuntimeExports.jsx(PickersModalDialog,{slots:i,slotProps:V,children:jsxRuntimeExports.jsx(b,_extends({},V==null?void 0:V.layout,{slots:i,slotProps:V,children:m()}))})]}))}};function getPickersToolbarTextUtilityClass(r){return generateUtilityClass("MuiPickersToolbarText",r)}const pickersToolbarTextClasses=generateUtilityClasses("MuiPickersToolbarText",["root"]),_excluded$x=["className","classes","selected","value"],useUtilityClasses$h=r=>composeClasses({root:["root"]},getPickersToolbarTextUtilityClass,r),PickersToolbarTextRoot=styled(Typography,{name:"MuiPickersToolbarText",slot:"Root"})(({theme:r})=>({transition:r.transitions.create("color"),color:(r.vars||r).palette.text.secondary,"&[data-selected]":{color:(r.vars||r).palette.text.primary}})),PickersToolbarText=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiPickersToolbarText"}),{className:i,classes:s,selected:a,value:o}=n,c=_objectWithoutPropertiesLoose(n,_excluded$x),h=useUtilityClasses$h(s);return jsxRuntimeExports.jsx(PickersToolbarTextRoot,_extends({ref:t,className:clsx(h.root,i),component:"span",ownerState:n},a&&{"data-selected":!0},c,{children:o}))}),_excluded$w=["align","className","classes","selected","typographyClassName","value","variant","width"],useUtilityClasses$g=r=>composeClasses({root:["root"]},getPickersToolbarUtilityClass,r),PickersToolbarButtonRoot=styled(Button,{name:"MuiPickersToolbarButton",slot:"Root"})({padding:0,minWidth:16,textTransform:"none"}),PickersToolbarButton=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiPickersToolbarButton"}),{align:i,className:s,classes:a,selected:o,typographyClassName:c,value:h,variant:f,width:m}=n,g=_objectWithoutPropertiesLoose(n,_excluded$w),_=useUtilityClasses$g(a);return jsxRuntimeExports.jsx(PickersToolbarButtonRoot,_extends({variant:"text",ref:t,className:clsx(_.root,s),ownerState:n},m?{sx:{width:m}}:{},g,{children:jsxRuntimeExports.jsx(PickersToolbarText,{align:i,className:c,variant:f,value:h,selected:o})}))}),renderDigitalClockTimeView=({view:r,onViewChange:e,focusedView:t,onFocusedViewChange:n,views:i,value:s,defaultValue:a,referenceDate:o,onChange:c,className:h,classes:f,disableFuture:m,disablePast:g,minTime:_,maxTime:E,shouldDisableTime:A,minutesStep:C,ampm:I,slots:b,slotProps:R,readOnly:V,disabled:U,sx:W,autoFocus:j,disableIgnoringDatePartForTimeValidation:w,timeSteps:P,skipDisabled:K,timezone:X})=>jsxRuntimeExports.jsx(DigitalClock,{view:r,onViewChange:e,focusedView:t&&isTimeView(t)?t:null,onFocusedViewChange:n,views:i.filter(isTimeView),value:s,defaultValue:a,referenceDate:o,onChange:c,className:h,classes:f,disableFuture:m,disablePast:g,minTime:_,maxTime:E,shouldDisableTime:A,minutesStep:C,ampm:I,slots:b,slotProps:R,readOnly:V,disabled:U,sx:W,autoFocus:j,disableIgnoringDatePartForTimeValidation:w,timeStep:P==null?void 0:P.minutes,skipDisabled:K,timezone:X}),renderMultiSectionDigitalClockTimeView=({view:r,onViewChange:e,focusedView:t,onFocusedViewChange:n,views:i,value:s,defaultValue:a,referenceDate:o,onChange:c,className:h,classes:f,disableFuture:m,disablePast:g,minTime:_,maxTime:E,shouldDisableTime:A,minutesStep:C,ampm:I,slots:b,slotProps:R,readOnly:V,disabled:U,sx:W,autoFocus:j,disableIgnoringDatePartForTimeValidation:w,timeSteps:P,skipDisabled:K,timezone:X})=>jsxRuntimeExports.jsx(MultiSectionDigitalClock,{view:r,onViewChange:e,focusedView:t&&isInternalTimeView(t)?t:null,onFocusedViewChange:n,views:i.filter(isTimeView),value:s,defaultValue:a,referenceDate:o,onChange:c,className:h,classes:f,disableFuture:m,disablePast:g,minTime:_,maxTime:E,shouldDisableTime:A,minutesStep:C,ampm:I,slots:b,slotProps:R,readOnly:V,disabled:U,sx:W,autoFocus:j,disableIgnoringDatePartForTimeValidation:w,timeSteps:P,skipDisabled:K,timezone:X}),_excluded$v=["views","format"],resolveDateTimeFormat=(r,e,t)=>{let{views:n,format:i}=e,s=_objectWithoutPropertiesLoose(e,_excluded$v);if(i)return i;const a=[],o=[];if(n.forEach(f=>{isTimeView(f)?o.push(f):isDatePickerView(f)&&a.push(f)}),o.length===0)return resolveDateFormat(r,_extends({views:a},s));if(a.length===0)return resolveTimeFormat(r,_extends({views:o},s));const c=resolveTimeFormat(r,_extends({views:o},s));return`${resolveDateFormat(r,_extends({views:a},s))} ${c}`},resolveViews=(r,e,t)=>t?e.filter(n=>!isInternalTimeView(n)||n==="hours"):r?[...e,"meridiem"]:e,resolveShouldRenderTimeInASingleColumn=(r,e)=>1440/((r.hours??1)*(r.minutes??5))<=e;function resolveTimeViewsResponse({thresholdToRenderTimeInASingleColumn:r,ampm:e,timeSteps:t,views:n}){const i=r??24,s=_extends({hours:1,minutes:5,seconds:5},t),a=resolveShouldRenderTimeInASingleColumn(s,i);return{thresholdToRenderTimeInASingleColumn:i,timeSteps:s,shouldRenderTimeInASingleColumn:a,views:resolveViews(e,n,a)}}function getDateTimePickerTabsUtilityClass(r){return generateUtilityClass("MuiDateTimePickerTabs",r)}generateUtilityClasses("MuiDateTimePickerTabs",["root"]);const viewToTab=r=>isDatePickerView(r)?"date":"time",tabToView=r=>r==="date"?"day":"hours",useUtilityClasses$f=r=>composeClasses({root:["root"]},getDateTimePickerTabsUtilityClass,r),DateTimePickerTabsRoot=styled(Tabs,{name:"MuiDateTimePickerTabs",slot:"Root"})(({theme:r})=>({boxShadow:`0 -1px 0 0 inset ${(r.vars||r).palette.divider}`,"&:last-child":{boxShadow:`0 1px 0 0 inset ${(r.vars||r).palette.divider}`,[`& .${tabsClasses.indicator}`]:{bottom:"auto",top:0}}})),DateTimePickerTabs=function r(e){const t=useThemeProps({props:e,name:"MuiDateTimePickerTabs"}),{dateIcon:n=jsxRuntimeExports.jsx(DateRangeIcon,{}),timeIcon:i=jsxRuntimeExports.jsx(TimeIcon,{}),hidden:s=typeof window>"u"||window.innerHeight<667,className:a,classes:o,sx:c}=t,h=usePickerTranslations(),{ownerState:f}=usePickerPrivateContext(),{view:m,setView:g}=usePickerContext(),_=useUtilityClasses$f(o),E=(A,C)=>{g(tabToView(C))};return s?null:jsxRuntimeExports.jsxs(DateTimePickerTabsRoot,{ownerState:f,variant:"fullWidth",value:viewToTab(m),onChange:E,className:clsx(a,_.root),sx:c,children:[jsxRuntimeExports.jsx(Tab,{value:"date","aria-label":h.dateTableLabel,icon:jsxRuntimeExports.jsx(reactExports.Fragment,{children:n})}),jsxRuntimeExports.jsx(Tab,{value:"time","aria-label":h.timeTableLabel,icon:jsxRuntimeExports.jsx(reactExports.Fragment,{children:i})})]})};function getDateTimePickerToolbarUtilityClass(r){return generateUtilityClass("MuiDateTimePickerToolbar",r)}const dateTimePickerToolbarClasses=generateUtilityClasses("MuiDateTimePickerToolbar",["root","dateContainer","timeContainer","timeDigitsContainer","separator","timeLabelReverse","ampmSelection","ampmLandscape","ampmLabel"]),_excluded$u=["ampm","ampmInClock","toolbarFormat","toolbarPlaceholder","toolbarTitle","className","classes"],useUtilityClasses$e=(r,e)=>{const{pickerOrientation:t,toolbarDirection:n}=e;return composeClasses({root:["root"],dateContainer:["dateContainer"],timeContainer:["timeContainer",n==="rtl"&&"timeLabelReverse"],timeDigitsContainer:["timeDigitsContainer",n==="rtl"&&"timeLabelReverse"],separator:["separator"],ampmSelection:["ampmSelection",t==="landscape"&&"ampmLandscape"],ampmLabel:["ampmLabel"]},getDateTimePickerToolbarUtilityClass,r)},DateTimePickerToolbarRoot=styled(PickersToolbar,{name:"MuiDateTimePickerToolbar",slot:"Root",shouldForwardProp:r=>shouldForwardProp(r)&&r!=="toolbarVariant"})(({theme:r})=>({paddingLeft:16,paddingRight:16,justifyContent:"space-around",position:"relative",variants:[{props:{toolbarVariant:"desktop"},style:{borderBottom:`1px solid ${(r.vars||r).palette.divider}`,[`& .${pickersToolbarClasses.content} .${pickersToolbarTextClasses.root}[data-selected]`]:{color:(r.vars||r).palette.primary.main,fontWeight:r.typography.fontWeightBold}}},{props:{toolbarVariant:"desktop",pickerOrientation:"landscape"},style:{borderRight:`1px solid ${(r.vars||r).palette.divider}`}},{props:{toolbarVariant:"desktop",pickerOrientation:"portrait"},style:{paddingLeft:24,paddingRight:0}}]})),DateTimePickerToolbarDateContainer=styled("div",{name:"MuiDateTimePickerToolbar",slot:"DateContainer"})({display:"flex",flexDirection:"column",alignItems:"flex-start"}),DateTimePickerToolbarTimeContainer=styled("div",{name:"MuiDateTimePickerToolbar",slot:"TimeContainer",shouldForwardProp:r=>shouldForwardProp(r)&&r!=="toolbarVariant"})({display:"flex",flexDirection:"row",variants:[{props:{toolbarDirection:"rtl"},style:{flexDirection:"row-reverse"}},{props:{toolbarVariant:"desktop",pickerOrientation:"portrait"},style:{gap:9,marginRight:4,alignSelf:"flex-end"}},{props:({pickerOrientation:r,toolbarVariant:e})=>r==="landscape"&&e!=="desktop",style:{flexDirection:"column"}},{props:({pickerOrientation:r,toolbarVariant:e,toolbarDirection:t})=>r==="landscape"&&e!=="desktop"&&t==="rtl",style:{flexDirection:"column-reverse"}}]}),DateTimePickerToolbarTimeDigitsContainer=styled("div",{name:"MuiDateTimePickerToolbar",slot:"TimeDigitsContainer",shouldForwardProp:r=>shouldForwardProp(r)&&r!=="toolbarVariant"})({display:"flex",variants:[{props:{toolbarDirection:"rtl"},style:{flexDirection:"row-reverse"}},{props:{toolbarVariant:"desktop"},style:{gap:1.5}}]}),DateTimePickerToolbarSeparator=styled(PickersToolbarText,{name:"MuiDateTimePickerToolbar",slot:"Separator",shouldForwardProp:r=>shouldForwardProp(r)&&r!=="toolbarVariant"})({margin:"0 4px 0 2px",cursor:"default",variants:[{props:{toolbarVariant:"desktop"},style:{margin:0}}]}),DateTimePickerToolbarAmPmSelection=styled("div",{name:"MuiDateTimePickerToolbar",slot:"AmPmSelection",overridesResolver:(r,e)=>[{[`.${dateTimePickerToolbarClasses.ampmLabel}`]:e.ampmLabel},{[`&.${dateTimePickerToolbarClasses.ampmLandscape}`]:e.ampmLandscape},e.ampmSelection]})({display:"flex",flexDirection:"column",marginRight:"auto",marginLeft:12,[`& .${dateTimePickerToolbarClasses.ampmLabel}`]:{fontSize:17},variants:[{props:{pickerOrientation:"landscape"},style:{margin:"4px 0 auto",flexDirection:"row",justifyContent:"space-around",width:"100%"}}]}),DateTimePickerToolbarOverrideContext=reactExports.createContext(null);function DateTimePickerToolbar(r){const e=useThemeProps({props:r,name:"MuiDateTimePickerToolbar"}),{ampm:t,ampmInClock:n,toolbarFormat:i,toolbarPlaceholder:s="––",toolbarTitle:a,className:o,classes:c}=e,h=_objectWithoutPropertiesLoose(e,_excluded$u),{value:f,setValue:m,disabled:g,readOnly:_,variant:E,orientation:A,view:C,setView:I,views:b}=usePickerContext(),R=usePickerTranslations(),V=useToolbarOwnerState(),U=useUtilityClasses$e(c,V),W=usePickerAdapter(),j=reactExports.useContext(DateTimePickerToolbarOverrideContext),w=j?j.value:f,P=j?j.setValue:m,K=j?j.view:C,X=j?j.setView:I,{meridiemMode:Y,handleMeridiemChange:Z}=useMeridiemMode(w,t,Ae=>P(Ae,{changeImportance:"set"})),ae=j!=null&&j.forceDesktopVariant?"desktop":E,le=ae==="desktop",ie=!!(t&&!n),se=a??R.dateTimePickerToolbarTitle,ce=reactExports.useMemo(()=>W.isValid(w)?i?W.formatByString(w,i):W.format(w,"shortDate"):s,[w,i,s,W]),ue=(Ae,Se)=>W.isValid(w)?W.format(w,Ae):Se;return jsxRuntimeExports.jsxs(DateTimePickerToolbarRoot,_extends({className:clsx(U.root,o),toolbarTitle:se,toolbarVariant:ae},h,{ownerState:V,children:[jsxRuntimeExports.jsxs(DateTimePickerToolbarDateContainer,{className:U.dateContainer,ownerState:V,children:[b.includes("year")&&jsxRuntimeExports.jsx(PickersToolbarButton,{tabIndex:-1,variant:"subtitle1",onClick:()=>X("year"),selected:K==="year",value:ue("year","–")}),b.includes("day")&&jsxRuntimeExports.jsx(PickersToolbarButton,{tabIndex:-1,variant:le?"h5":"h4",onClick:()=>X("day"),selected:K==="day",value:ce})]}),jsxRuntimeExports.jsxs(DateTimePickerToolbarTimeContainer,{className:U.timeContainer,ownerState:V,toolbarVariant:ae,children:[jsxRuntimeExports.jsxs(DateTimePickerToolbarTimeDigitsContainer,{className:U.timeDigitsContainer,ownerState:V,toolbarVariant:ae,children:[b.includes("hours")&&jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(PickersToolbarButton,{variant:le?"h5":"h3",width:le&&A==="portrait"?MULTI_SECTION_CLOCK_SECTION_WIDTH:void 0,onClick:()=>X("hours"),selected:K==="hours",value:ue(t?"hours12h":"hours24h","--")}),jsxRuntimeExports.jsx(DateTimePickerToolbarSeparator,{variant:le?"h5":"h3",value:":",className:U.separator,ownerState:V,toolbarVariant:ae}),jsxRuntimeExports.jsx(PickersToolbarButton,{variant:le?"h5":"h3",width:le&&A==="portrait"?MULTI_SECTION_CLOCK_SECTION_WIDTH:void 0,onClick:()=>X("minutes"),selected:K==="minutes"||!b.includes("minutes")&&K==="hours",value:ue("minutes","--"),disabled:!b.includes("minutes")})]}),b.includes("seconds")&&jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(DateTimePickerToolbarSeparator,{variant:le?"h5":"h3",value:":",className:U.separator,ownerState:V,toolbarVariant:ae}),jsxRuntimeExports.jsx(PickersToolbarButton,{variant:le?"h5":"h3",width:le&&A==="portrait"?MULTI_SECTION_CLOCK_SECTION_WIDTH:void 0,onClick:()=>X("seconds"),selected:K==="seconds",value:ue("seconds","--")})]})]}),ie&&!le&&jsxRuntimeExports.jsxs(DateTimePickerToolbarAmPmSelection,{className:U.ampmSelection,ownerState:V,children:[jsxRuntimeExports.jsx(PickersToolbarButton,{variant:"subtitle2",selected:Y==="am",typographyClassName:U.ampmLabel,value:formatMeridiem(W,"am"),onClick:_?void 0:()=>Z("am"),disabled:g}),jsxRuntimeExports.jsx(PickersToolbarButton,{variant:"subtitle2",selected:Y==="pm",typographyClassName:U.ampmLabel,value:formatMeridiem(W,"pm"),onClick:_?void 0:()=>Z("pm"),disabled:g})]}),t&&le&&jsxRuntimeExports.jsx(PickersToolbarButton,{variant:"h5",onClick:()=>X("meridiem"),selected:K==="meridiem",value:w&&Y?formatMeridiem(W,Y):"--",width:MULTI_SECTION_CLOCK_SECTION_WIDTH})]})]}))}function useDateTimePickerDefaultizedProps(r,e){var _;const t=usePickerAdapter(),n=useThemeProps({props:r,name:e}),i=useApplyDefaultValuesToDateTimeValidationProps(n),s=n.ampm??t.is12HourCycleInCurrentLocale(),a=reactExports.useMemo(()=>{var E;return((E=n.localeText)==null?void 0:E.toolbarTitle)==null?n.localeText:_extends({},n.localeText,{dateTimePickerToolbarTitle:n.localeText.toolbarTitle})},[n.localeText]),{openTo:o,views:c}=applyDefaultViewProps({views:n.views,openTo:n.openTo,defaultViews:["year","day","hours","minutes"],defaultOpenTo:"day"}),{shouldRenderTimeInASingleColumn:h,thresholdToRenderTimeInASingleColumn:f,views:m,timeSteps:g}=resolveTimeViewsResponse({thresholdToRenderTimeInASingleColumn:n.thresholdToRenderTimeInASingleColumn,ampm:s,timeSteps:n.timeSteps,views:c});return _extends({},n,i,{timeSteps:g,openTo:o,shouldRenderTimeInASingleColumn:h,thresholdToRenderTimeInASingleColumn:f,views:m,ampm:s,localeText:a,orientation:n.orientation??"portrait",slots:_extends({toolbar:DateTimePickerToolbar,tabs:DateTimePickerTabs},n.slots),slotProps:_extends({},n.slotProps,{toolbar:_extends({ampm:s},(_=n.slotProps)==null?void 0:_.toolbar)})})}const DesktopDateTimePickerLayout=reactExports.forwardRef(function r(e,t){var E;const{toolbar:n,tabs:i,content:s,actionBar:a,shortcuts:o,ownerState:c}=usePickerLayout(e),{orientation:h}=usePickerContext(),{sx:f,className:m,classes:g}=e,_=a&&(((E=a.props.actions)==null?void 0:E.length)??0)>0;return jsxRuntimeExports.jsxs(PickersLayoutRoot,{ref:t,className:clsx(pickersLayoutClasses.root,g==null?void 0:g.root,m),sx:[{[`& .${pickersLayoutClasses.tabs}`]:{gridRow:4,gridColumn:"1 / 4"},[`& .${pickersLayoutClasses.actionBar}`]:{gridRow:5}},...Array.isArray(f)?f:[f]],ownerState:c,children:[h==="landscape"?o:n,h==="landscape"?n:o,jsxRuntimeExports.jsxs(PickersLayoutContentWrapper,{className:clsx(pickersLayoutClasses.contentWrapper,g==null?void 0:g.contentWrapper),ownerState:c,sx:{display:"grid"},children:[s,i,_&&jsxRuntimeExports.jsx(Divider,{sx:{gridRow:3,gridColumn:"1 / 4"}})]}),a]})}),_excluded$t=["openTo","focusedView","timeViewsCount"],rendererInterceptor=function r(e){var _,E;const{viewRenderers:t,popperView:n,rendererProps:i}=e,{openTo:s,focusedView:a,timeViewsCount:o}=i,c=_objectWithoutPropertiesLoose(i,_excluded$t),h=_extends({},c,{autoFocus:!1,focusedView:null,sx:[{[`&.${multiSectionDigitalClockClasses.root}`]:{borderBottom:0},[`&.${multiSectionDigitalClockClasses.root}, .${multiSectionDigitalClockSectionClasses.root}, &.${digitalClockClasses.root}`]:{maxHeight:VIEW_HEIGHT}}]}),f=isInternalTimeView(n),m=f?"day":n,g=f?n:"hours";return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[(_=t[m])==null?void 0:_.call(t,_extends({},i,{view:f?"day":n,focusedView:a&&isDatePickerView(a)?a:null,views:i.views.filter(isDatePickerView),sx:[{gridColumn:1},...h.sx]})),o>0&&jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(Divider,{orientation:"vertical",sx:{gridColumn:2}}),(E=t[g])==null?void 0:E.call(t,_extends({},h,{view:f?n:"hours",focusedView:a&&isInternalTimeView(a)?a:null,openTo:isInternalTimeView(s)?s:"hours",views:i.views.filter(isInternalTimeView),sx:[{gridColumn:3},...h.sx]}))]})]})},DesktopDateTimePicker=reactExports.forwardRef(function r(e,t){var g,_,E;const n=usePickerAdapter(),i=useDateTimePickerDefaultizedProps(e,"MuiDesktopDateTimePicker"),s=i.shouldRenderTimeInASingleColumn?renderDigitalClockTimeView:renderMultiSectionDigitalClockTimeView,a=_extends({day:renderDateViewCalendar,month:renderDateViewCalendar,year:renderDateViewCalendar,hours:s,minutes:s,seconds:s,meridiem:s},i.viewRenderers),o=i.ampmInClock??!0,h=((g=a.hours)==null?void 0:g.name)===renderMultiSectionDigitalClockTimeView.name?i.views:i.views.filter(A=>A!=="meridiem"),f=_extends({},i,{viewRenderers:a,format:resolveDateTimeFormat(n,i),views:h,yearsPerRow:i.yearsPerRow??4,ampmInClock:o,slots:_extends({field:DateTimeField,layout:DesktopDateTimePickerLayout},i.slots),slotProps:_extends({},i.slotProps,{field:A=>{var C;return _extends({},resolveComponentProps((C=i.slotProps)==null?void 0:C.field,A),extractValidationProps(i))},toolbar:_extends({hidden:!0,ampmInClock:o},(_=i.slotProps)==null?void 0:_.toolbar),tabs:_extends({hidden:!0},(E=i.slotProps)==null?void 0:E.tabs)})}),{renderPicker:m}=useDesktopPicker({ref:t,props:f,valueManager:singleItemValueManager,valueType:"date-time",validator:validateDateTime,rendererInterceptor,steps:null});return m()});DesktopDateTimePicker.propTypes={ampm:PropTypes.bool,ampmInClock:PropTypes.bool,autoFocus:PropTypes.bool,className:PropTypes.string,closeOnSelect:PropTypes.bool,dayOfWeekFormatter:PropTypes.func,defaultValue:PropTypes.object,disabled:PropTypes.bool,disableFuture:PropTypes.bool,disableHighlightToday:PropTypes.bool,disableIgnoringDatePartForTimeValidation:PropTypes.bool,disableOpenPicker:PropTypes.bool,disablePast:PropTypes.bool,displayWeekNumber:PropTypes.bool,enableAccessibleFieldDOMStructure:PropTypes.any,fixedWeekNumber:PropTypes.number,format:PropTypes.string,formatDensity:PropTypes.oneOf(["dense","spacious"]),inputRef:refType,label:PropTypes.node,loading:PropTypes.bool,localeText:PropTypes.object,maxDate:PropTypes.object,maxDateTime:PropTypes.object,maxTime:PropTypes.object,minDate:PropTypes.object,minDateTime:PropTypes.object,minTime:PropTypes.object,minutesStep:PropTypes.number,monthsPerRow:PropTypes.oneOf([3,4]),name:PropTypes.string,onAccept:PropTypes.func,onChange:PropTypes.func,onClose:PropTypes.func,onError:PropTypes.func,onMonthChange:PropTypes.func,onOpen:PropTypes.func,onSelectedSectionsChange:PropTypes.func,onViewChange:PropTypes.func,onYearChange:PropTypes.func,open:PropTypes.bool,openTo:PropTypes.oneOf(["day","hours","meridiem","minutes","month","seconds","year"]),orientation:PropTypes.oneOf(["landscape","portrait"]),readOnly:PropTypes.bool,reduceAnimations:PropTypes.bool,referenceDate:PropTypes.object,renderLoading:PropTypes.func,selectedSections:PropTypes.oneOfType([PropTypes.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),PropTypes.number]),shouldDisableDate:PropTypes.func,shouldDisableMonth:PropTypes.func,shouldDisableTime:PropTypes.func,shouldDisableYear:PropTypes.func,showDaysOutsideCurrentMonth:PropTypes.bool,skipDisabled:PropTypes.bool,slotProps:PropTypes.object,slots:PropTypes.object,sx:PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.func,PropTypes.object,PropTypes.bool])),PropTypes.func,PropTypes.object]),thresholdToRenderTimeInASingleColumn:PropTypes.number,timeSteps:PropTypes.shape({hours:PropTypes.number,minutes:PropTypes.number,seconds:PropTypes.number}),timezone:PropTypes.string,value:PropTypes.object,view:PropTypes.oneOf(["day","hours","meridiem","minutes","month","seconds","year"]),viewRenderers:PropTypes.shape({day:PropTypes.func,hours:PropTypes.func,meridiem:PropTypes.func,minutes:PropTypes.func,month:PropTypes.func,seconds:PropTypes.func,year:PropTypes.func}),views:PropTypes.arrayOf(PropTypes.oneOf(["day","hours","minutes","month","seconds","year"]).isRequired),yearsOrder:PropTypes.oneOf(["asc","desc"]),yearsPerRow:PropTypes.oneOf([3,4])};const STEPS=[{views:DATE_VIEWS},{views:EXPORTED_TIME_VIEWS}],MobileDateTimePicker=reactExports.forwardRef(function r(e,t){var g,_,E,A,C,I;const n=usePickerAdapter(),i=useDateTimePickerDefaultizedProps(e,"MuiMobileDateTimePicker"),s=i.shouldRenderTimeInASingleColumn?renderDigitalClockTimeView:renderMultiSectionDigitalClockTimeView,a=_extends({day:renderDateViewCalendar,month:renderDateViewCalendar,year:renderDateViewCalendar,hours:s,minutes:s,seconds:s,meridiem:s},i.viewRenderers),o=i.ampmInClock??!1,h=((g=a.hours)==null?void 0:g.name)===renderMultiSectionDigitalClockTimeView.name?i.views:i.views.filter(b=>b!=="meridiem"),f=_extends({},i,{viewRenderers:a,format:resolveDateTimeFormat(n,i),views:h,ampmInClock:o,slots:_extends({field:DateTimeField},i.slots),slotProps:_extends({},i.slotProps,{field:b=>{var R;return _extends({},resolveComponentProps((R=i.slotProps)==null?void 0:R.field,b),extractValidationProps(i))},toolbar:_extends({hidden:!1,ampmInClock:o},(_=i.slotProps)==null?void 0:_.toolbar),tabs:_extends({hidden:!1},(E=i.slotProps)==null?void 0:E.tabs),layout:_extends({},(A=i.slotProps)==null?void 0:A.layout,{sx:mergeSx([{[`& .${multiSectionDigitalClockClasses.root}`]:{width:DIALOG_WIDTH},[`& .${multiSectionDigitalClockSectionClasses.root}`]:{flex:1,maxHeight:VIEW_HEIGHT-1,[`.${multiSectionDigitalClockSectionClasses.item}`]:{width:"auto"}},[`& .${digitalClockClasses.root}`]:{width:DIALOG_WIDTH,maxHeight:VIEW_HEIGHT,flex:1,[`.${digitalClockClasses.item}`]:{justifyContent:"center"}}}],(I=(C=i.slotProps)==null?void 0:C.layout)==null?void 0:I.sx)})})}),{renderPicker:m}=useMobilePicker({ref:t,props:f,valueManager:singleItemValueManager,valueType:"date-time",validator:validateDateTime,steps:STEPS});return m()});MobileDateTimePicker.propTypes={ampm:PropTypes.bool,ampmInClock:PropTypes.bool,autoFocus:PropTypes.bool,className:PropTypes.string,closeOnSelect:PropTypes.bool,dayOfWeekFormatter:PropTypes.func,defaultValue:PropTypes.object,disabled:PropTypes.bool,disableFuture:PropTypes.bool,disableHighlightToday:PropTypes.bool,disableIgnoringDatePartForTimeValidation:PropTypes.bool,disableOpenPicker:PropTypes.bool,disablePast:PropTypes.bool,displayWeekNumber:PropTypes.bool,enableAccessibleFieldDOMStructure:PropTypes.any,fixedWeekNumber:PropTypes.number,format:PropTypes.string,formatDensity:PropTypes.oneOf(["dense","spacious"]),inputRef:refType,label:PropTypes.node,loading:PropTypes.bool,localeText:PropTypes.object,maxDate:PropTypes.object,maxDateTime:PropTypes.object,maxTime:PropTypes.object,minDate:PropTypes.object,minDateTime:PropTypes.object,minTime:PropTypes.object,minutesStep:PropTypes.number,monthsPerRow:PropTypes.oneOf([3,4]),name:PropTypes.string,onAccept:PropTypes.func,onChange:PropTypes.func,onClose:PropTypes.func,onError:PropTypes.func,onMonthChange:PropTypes.func,onOpen:PropTypes.func,onSelectedSectionsChange:PropTypes.func,onViewChange:PropTypes.func,onYearChange:PropTypes.func,open:PropTypes.bool,openTo:PropTypes.oneOf(["day","hours","meridiem","minutes","month","seconds","year"]),orientation:PropTypes.oneOf(["landscape","portrait"]),readOnly:PropTypes.bool,reduceAnimations:PropTypes.bool,referenceDate:PropTypes.object,renderLoading:PropTypes.func,selectedSections:PropTypes.oneOfType([PropTypes.oneOf(["all","day","empty","hours","meridiem","minutes","month","seconds","weekDay","year"]),PropTypes.number]),shouldDisableDate:PropTypes.func,shouldDisableMonth:PropTypes.func,shouldDisableTime:PropTypes.func,shouldDisableYear:PropTypes.func,showDaysOutsideCurrentMonth:PropTypes.bool,skipDisabled:PropTypes.bool,slotProps:PropTypes.object,slots:PropTypes.object,sx:PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.func,PropTypes.object,PropTypes.bool])),PropTypes.func,PropTypes.object]),thresholdToRenderTimeInASingleColumn:PropTypes.number,timeSteps:PropTypes.shape({hours:PropTypes.number,minutes:PropTypes.number,seconds:PropTypes.number}),timezone:PropTypes.string,value:PropTypes.object,view:PropTypes.oneOf(["day","hours","meridiem","minutes","month","seconds","year"]),viewRenderers:PropTypes.shape({day:PropTypes.func,hours:PropTypes.func,meridiem:PropTypes.func,minutes:PropTypes.func,month:PropTypes.func,seconds:PropTypes.func,year:PropTypes.func}),views:PropTypes.arrayOf(PropTypes.oneOf(["day","hours","minutes","month","seconds","year"]).isRequired),yearsOrder:PropTypes.oneOf(["asc","desc"]),yearsPerRow:PropTypes.oneOf([3,4])};const _excluded$s=["desktopModeMediaQuery"],DateTimePicker=reactExports.forwardRef(function r(e,t){const n=useThemeProps({props:e,name:"MuiDateTimePicker"}),{desktopModeMediaQuery:i=DEFAULT_DESKTOP_MODE_MEDIA_QUERY}=n,s=_objectWithoutPropertiesLoose(n,_excluded$s);return useMediaQuery(i,{defaultMatches:!0})?jsxRuntimeExports.jsx(DesktopDateTimePicker,_extends({ref:t},s)):jsxRuntimeExports.jsx(MobileDateTimePicker,_extends({ref:t},s))}),millisecondsInWeek=6048e5,millisecondsInDay=864e5,millisecondsInMinute=6e4,millisecondsInHour=36e5,millisecondsInSecond=1e3,constructFromSymbol=Symbol.for("constructDateFrom");function constructFrom(r,e){return typeof r=="function"?r(e):r&&typeof r=="object"&&constructFromSymbol in r?r[constructFromSymbol](e):r instanceof Date?new r.constructor(e):new Date(e)}function toDate(r,e){return constructFrom(e||r,r)}function addDays(r,e,t){const n=toDate(r,t==null?void 0:t.in);return isNaN(e)?constructFrom((t==null?void 0:t.in)||r,NaN):(e&&n.setDate(n.getDate()+e),n)}function addMilliseconds(r,e,t){return constructFrom(r,+toDate(r)+e)}function addSeconds(r,e,t){return addMilliseconds(r,e*1e3)}function addMinutes(r,e,t){const n=toDate(r,t==null?void 0:t.in);return n.setTime(n.getTime()+e*millisecondsInMinute),n}function addHours(r,e,t){return addMilliseconds(r,e*millisecondsInHour)}function addWeeks(r,e,t){return addDays(r,e*7,t)}function addMonths(r,e,t){const n=toDate(r,t==null?void 0:t.in);if(isNaN(e))return constructFrom(r,NaN);if(!e)return n;const i=n.getDate(),s=constructFrom(r,n.getTime());s.setMonth(n.getMonth()+e+1,0);const a=s.getDate();return i>=a?s:(n.setFullYear(s.getFullYear(),s.getMonth(),i),n)}function addYears(r,e,t){return addMonths(r,e*12,t)}function endOfDay(r,e){const t=toDate(r,e==null?void 0:e.in);return t.setHours(23,59,59,999),t}let defaultOptions={};function getDefaultOptions$1(){return defaultOptions}function endOfWeek(r,e){var o,c,h,f;const t=getDefaultOptions$1(),n=(e==null?void 0:e.weekStartsOn)??((c=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??t.weekStartsOn??((f=(h=t.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??0,i=toDate(r,e==null?void 0:e.in),s=i.getDay(),a=(s<n?-7:0)+6-(s-n);return i.setDate(i.getDate()+a),i.setHours(23,59,59,999),i}function endOfYear(r,e){const t=toDate(r,e==null?void 0:e.in),n=t.getFullYear();return t.setFullYear(n+1,0,0),t.setHours(23,59,59,999),t}const formatDistanceLocale$1={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},formatDistance$1=(r,e,t)=>{let n;const i=formatDistanceLocale$1[r];return typeof i=="string"?n=i:e===1?n=i.one:n=i.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+n:n+" ago":n};function buildFormatLongFn(r){return(e={})=>{const t=e.width?String(e.width):r.defaultWidth;return r.formats[t]||r.formats[r.defaultWidth]}}const dateFormats$1={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},timeFormats$1={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dateTimeFormats$1={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},formatLong$1={date:buildFormatLongFn({formats:dateFormats$1,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats$1,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats$1,defaultWidth:"full"})},formatRelativeLocale$1={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},formatRelative$1=(r,e,t,n)=>formatRelativeLocale$1[r];function buildLocalizeFn(r){return(e,t)=>{const n=t!=null&&t.context?String(t.context):"standalone";let i;if(n==="formatting"&&r.formattingValues){const a=r.defaultFormattingWidth||r.defaultWidth,o=t!=null&&t.width?String(t.width):a;i=r.formattingValues[o]||r.formattingValues[a]}else{const a=r.defaultWidth,o=t!=null&&t.width?String(t.width):r.defaultWidth;i=r.values[o]||r.values[a]}const s=r.argumentCallback?r.argumentCallback(e):e;return i[s]}}const eraValues$1={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},quarterValues$1={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},monthValues$1={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dayValues$1={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dayPeriodValues$1={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},formattingDayPeriodValues$1={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ordinalNumber$1=(r,e)=>{const t=Number(r),n=t%100;if(n>20||n<10)switch(n%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},localize$1={ordinalNumber:ordinalNumber$1,era:buildLocalizeFn({values:eraValues$1,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues$1,defaultWidth:"wide",argumentCallback:r=>r-1}),month:buildLocalizeFn({values:monthValues$1,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues$1,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues$1,defaultWidth:"wide",formattingValues:formattingDayPeriodValues$1,defaultFormattingWidth:"wide"})};function buildMatchFn(r){return(e,t={})=>{const n=t.width,i=n&&r.matchPatterns[n]||r.matchPatterns[r.defaultMatchWidth],s=e.match(i);if(!s)return null;const a=s[0],o=n&&r.parsePatterns[n]||r.parsePatterns[r.defaultParseWidth],c=Array.isArray(o)?findIndex(o,m=>m.test(a)):findKey(o,m=>m.test(a));let h;h=r.valueCallback?r.valueCallback(c):c,h=t.valueCallback?t.valueCallback(h):h;const f=e.slice(a.length);return{value:h,rest:f}}}function findKey(r,e){for(const t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&e(r[t]))return t}function findIndex(r,e){for(let t=0;t<r.length;t++)if(e(r[t]))return t}function buildMatchPatternFn(r){return(e,t={})=>{const n=e.match(r.matchPattern);if(!n)return null;const i=n[0],s=e.match(r.parsePattern);if(!s)return null;let a=r.valueCallback?r.valueCallback(s[0]):s[0];a=t.valueCallback?t.valueCallback(a):a;const o=e.slice(i.length);return{value:a,rest:o}}}const matchOrdinalNumberPattern$1=/^(\d+)(th|st|nd|rd)?/i,parseOrdinalNumberPattern$1=/\d+/i,matchEraPatterns$1={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},parseEraPatterns$1={any:[/^b/i,/^(a|c)/i]},matchQuarterPatterns$1={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},parseQuarterPatterns$1={any:[/1/i,/2/i,/3/i,/4/i]},matchMonthPatterns$1={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},parseMonthPatterns$1={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},matchDayPatterns$1={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},parseDayPatterns$1={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},matchDayPeriodPatterns$1={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},parseDayPeriodPatterns$1={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},match$1={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern$1,parsePattern:parseOrdinalNumberPattern$1,valueCallback:r=>parseInt(r,10)}),era:buildMatchFn({matchPatterns:matchEraPatterns$1,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns$1,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns$1,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns$1,defaultParseWidth:"any",valueCallback:r=>r+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns$1,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns$1,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns$1,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns$1,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns$1,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns$1,defaultParseWidth:"any"})},enUS={code:"en-US",formatDistance:formatDistance$1,formatLong:formatLong$1,formatRelative:formatRelative$1,localize:localize$1,match:match$1,options:{weekStartsOn:0,firstWeekContainsDate:1}};function getTimezoneOffsetInMilliseconds(r){const e=toDate(r),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+r-+t}function normalizeDates(r,...e){const t=constructFrom.bind(null,e.find(n=>typeof n=="object"));return e.map(t)}function startOfDay(r,e){const t=toDate(r,e==null?void 0:e.in);return t.setHours(0,0,0,0),t}function differenceInCalendarDays(r,e,t){const[n,i]=normalizeDates(t==null?void 0:t.in,r,e),s=startOfDay(n),a=startOfDay(i),o=+s-getTimezoneOffsetInMilliseconds(s),c=+a-getTimezoneOffsetInMilliseconds(a);return Math.round((o-c)/millisecondsInDay)}function startOfYear(r,e){const t=toDate(r,e==null?void 0:e.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function getDayOfYear(r,e){const t=toDate(r,e==null?void 0:e.in);return differenceInCalendarDays(t,startOfYear(t))+1}function startOfWeek(r,e){var o,c,h,f;const t=getDefaultOptions$1(),n=(e==null?void 0:e.weekStartsOn)??((c=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??t.weekStartsOn??((f=(h=t.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??0,i=toDate(r,e==null?void 0:e.in),s=i.getDay(),a=(s<n?7:0)+s-n;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function startOfISOWeek(r,e){return startOfWeek(r,{...e,weekStartsOn:1})}function getISOWeekYear(r,e){const t=toDate(r,e==null?void 0:e.in),n=t.getFullYear(),i=constructFrom(t,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const s=startOfISOWeek(i),a=constructFrom(t,0);a.setFullYear(n,0,4),a.setHours(0,0,0,0);const o=startOfISOWeek(a);return t.getTime()>=s.getTime()?n+1:t.getTime()>=o.getTime()?n:n-1}function startOfISOWeekYear(r,e){const t=getISOWeekYear(r,e),n=constructFrom(r,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),startOfISOWeek(n)}function getISOWeek(r,e){const t=toDate(r,e==null?void 0:e.in),n=+startOfISOWeek(t)-+startOfISOWeekYear(t);return Math.round(n/millisecondsInWeek)+1}function getWeekYear(r,e){var f,m,g,_;const t=toDate(r,e==null?void 0:e.in),n=t.getFullYear(),i=getDefaultOptions$1(),s=(e==null?void 0:e.firstWeekContainsDate)??((m=(f=e==null?void 0:e.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??i.firstWeekContainsDate??((_=(g=i.locale)==null?void 0:g.options)==null?void 0:_.firstWeekContainsDate)??1,a=constructFrom((e==null?void 0:e.in)||r,0);a.setFullYear(n+1,0,s),a.setHours(0,0,0,0);const o=startOfWeek(a,e),c=constructFrom((e==null?void 0:e.in)||r,0);c.setFullYear(n,0,s),c.setHours(0,0,0,0);const h=startOfWeek(c,e);return+t>=+o?n+1:+t>=+h?n:n-1}function startOfWeekYear(r,e){var o,c,h,f;const t=getDefaultOptions$1(),n=(e==null?void 0:e.firstWeekContainsDate)??((c=(o=e==null?void 0:e.locale)==null?void 0:o.options)==null?void 0:c.firstWeekContainsDate)??t.firstWeekContainsDate??((f=(h=t.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1,i=getWeekYear(r,e),s=constructFrom((e==null?void 0:e.in)||r,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),startOfWeek(s,e)}function getWeek(r,e){const t=toDate(r,e==null?void 0:e.in),n=+startOfWeek(t,e)-+startOfWeekYear(t,e);return Math.round(n/millisecondsInWeek)+1}function addLeadingZeros(r,e){const t=r<0?"-":"",n=Math.abs(r).toString().padStart(e,"0");return t+n}const lightFormatters={y(r,e){const t=r.getFullYear(),n=t>0?t:1-t;return addLeadingZeros(e==="yy"?n%100:n,e.length)},M(r,e){const t=r.getMonth();return e==="M"?String(t+1):addLeadingZeros(t+1,2)},d(r,e){return addLeadingZeros(r.getDate(),e.length)},a(r,e){const t=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(r,e){return addLeadingZeros(r.getHours()%12||12,e.length)},H(r,e){return addLeadingZeros(r.getHours(),e.length)},m(r,e){return addLeadingZeros(r.getMinutes(),e.length)},s(r,e){return addLeadingZeros(r.getSeconds(),e.length)},S(r,e){const t=e.length,n=r.getMilliseconds(),i=Math.trunc(n*Math.pow(10,t-3));return addLeadingZeros(i,e.length)}},dayPeriodEnum={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},formatters={G:function(r,e,t){const n=r.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(r,e,t){if(e==="yo"){const n=r.getFullYear(),i=n>0?n:1-n;return t.ordinalNumber(i,{unit:"year"})}return lightFormatters.y(r,e)},Y:function(r,e,t,n){const i=getWeekYear(r,n),s=i>0?i:1-i;if(e==="YY"){const a=s%100;return addLeadingZeros(a,2)}return e==="Yo"?t.ordinalNumber(s,{unit:"year"}):addLeadingZeros(s,e.length)},R:function(r,e){const t=getISOWeekYear(r);return addLeadingZeros(t,e.length)},u:function(r,e){const t=r.getFullYear();return addLeadingZeros(t,e.length)},Q:function(r,e,t){const n=Math.ceil((r.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return addLeadingZeros(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(r,e,t){const n=Math.ceil((r.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return addLeadingZeros(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(r,e,t){const n=r.getMonth();switch(e){case"M":case"MM":return lightFormatters.M(r,e);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(r,e,t){const n=r.getMonth();switch(e){case"L":return String(n+1);case"LL":return addLeadingZeros(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(r,e,t,n){const i=getWeek(r,n);return e==="wo"?t.ordinalNumber(i,{unit:"week"}):addLeadingZeros(i,e.length)},I:function(r,e,t){const n=getISOWeek(r);return e==="Io"?t.ordinalNumber(n,{unit:"week"}):addLeadingZeros(n,e.length)},d:function(r,e,t){return e==="do"?t.ordinalNumber(r.getDate(),{unit:"date"}):lightFormatters.d(r,e)},D:function(r,e,t){const n=getDayOfYear(r);return e==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):addLeadingZeros(n,e.length)},E:function(r,e,t){const n=r.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(r,e,t,n){const i=r.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(s);case"ee":return addLeadingZeros(s,2);case"eo":return t.ordinalNumber(s,{unit:"day"});case"eee":return t.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(i,{width:"short",context:"formatting"});case"eeee":default:return t.day(i,{width:"wide",context:"formatting"})}},c:function(r,e,t,n){const i=r.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(s);case"cc":return addLeadingZeros(s,e.length);case"co":return t.ordinalNumber(s,{unit:"day"});case"ccc":return t.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(i,{width:"narrow",context:"standalone"});case"cccccc":return t.day(i,{width:"short",context:"standalone"});case"cccc":default:return t.day(i,{width:"wide",context:"standalone"})}},i:function(r,e,t){const n=r.getDay(),i=n===0?7:n;switch(e){case"i":return String(i);case"ii":return addLeadingZeros(i,e.length);case"io":return t.ordinalNumber(i,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(r,e,t){const i=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(r,e,t){const n=r.getHours();let i;switch(n===12?i=dayPeriodEnum.noon:n===0?i=dayPeriodEnum.midnight:i=n/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(r,e,t){const n=r.getHours();let i;switch(n>=17?i=dayPeriodEnum.evening:n>=12?i=dayPeriodEnum.afternoon:n>=4?i=dayPeriodEnum.morning:i=dayPeriodEnum.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(i,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(r,e,t){if(e==="ho"){let n=r.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return lightFormatters.h(r,e)},H:function(r,e,t){return e==="Ho"?t.ordinalNumber(r.getHours(),{unit:"hour"}):lightFormatters.H(r,e)},K:function(r,e,t){const n=r.getHours()%12;return e==="Ko"?t.ordinalNumber(n,{unit:"hour"}):addLeadingZeros(n,e.length)},k:function(r,e,t){let n=r.getHours();return n===0&&(n=24),e==="ko"?t.ordinalNumber(n,{unit:"hour"}):addLeadingZeros(n,e.length)},m:function(r,e,t){return e==="mo"?t.ordinalNumber(r.getMinutes(),{unit:"minute"}):lightFormatters.m(r,e)},s:function(r,e,t){return e==="so"?t.ordinalNumber(r.getSeconds(),{unit:"second"}):lightFormatters.s(r,e)},S:function(r,e){return lightFormatters.S(r,e)},X:function(r,e,t){const n=r.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return formatTimezoneWithOptionalMinutes(n);case"XXXX":case"XX":return formatTimezone(n);case"XXXXX":case"XXX":default:return formatTimezone(n,":")}},x:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"x":return formatTimezoneWithOptionalMinutes(n);case"xxxx":case"xx":return formatTimezone(n);case"xxxxx":case"xxx":default:return formatTimezone(n,":")}},O:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+formatTimezoneShort(n,":");case"OOOO":default:return"GMT"+formatTimezone(n,":")}},z:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+formatTimezoneShort(n,":");case"zzzz":default:return"GMT"+formatTimezone(n,":")}},t:function(r,e,t){const n=Math.trunc(+r/1e3);return addLeadingZeros(n,e.length)},T:function(r,e,t){return addLeadingZeros(+r,e.length)}};function formatTimezoneShort(r,e=""){const t=r>0?"-":"+",n=Math.abs(r),i=Math.trunc(n/60),s=n%60;return s===0?t+String(i):t+String(i)+e+addLeadingZeros(s,2)}function formatTimezoneWithOptionalMinutes(r,e){return r%60===0?(r>0?"-":"+")+addLeadingZeros(Math.abs(r)/60,2):formatTimezone(r,e)}function formatTimezone(r,e=""){const t=r>0?"-":"+",n=Math.abs(r),i=addLeadingZeros(Math.trunc(n/60),2),s=addLeadingZeros(n%60,2);return t+i+e+s}const dateLongFormatter=(r,e)=>{switch(r){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},timeLongFormatter=(r,e)=>{switch(r){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},dateTimeLongFormatter=(r,e)=>{const t=r.match(/(P+)(p+)?/)||[],n=t[1],i=t[2];if(!i)return dateLongFormatter(r,e);let s;switch(n){case"P":s=e.dateTime({width:"short"});break;case"PP":s=e.dateTime({width:"medium"});break;case"PPP":s=e.dateTime({width:"long"});break;case"PPPP":default:s=e.dateTime({width:"full"});break}return s.replace("{{date}}",dateLongFormatter(n,e)).replace("{{time}}",timeLongFormatter(i,e))},longFormatters={p:timeLongFormatter,P:dateTimeLongFormatter},dayOfYearTokenRE=/^D+$/,weekYearTokenRE=/^Y+$/,throwTokens=["D","DD","YY","YYYY"];function isProtectedDayOfYearToken(r){return dayOfYearTokenRE.test(r)}function isProtectedWeekYearToken(r){return weekYearTokenRE.test(r)}function warnOrThrowProtectedError(r,e,t){const n=message(r,e,t);if(console.warn(n),throwTokens.includes(r))throw new RangeError(n)}function message(r,e,t){const n=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${e}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}function isDate(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function isValid(r){return!(!isDate(r)&&typeof r!="number"||isNaN(+toDate(r)))}const formattingTokensRegExp$1=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp$1=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp$1=/^'([^]*?)'?$/,doubleQuoteRegExp$1=/''/g,unescapedLatinCharacterRegExp$1=/[a-zA-Z]/;function format$1(r,e,t){var f,m,g,_,E,A,C,I;const n=getDefaultOptions$1(),i=(t==null?void 0:t.locale)??n.locale??enUS,s=(t==null?void 0:t.firstWeekContainsDate)??((m=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??n.firstWeekContainsDate??((_=(g=n.locale)==null?void 0:g.options)==null?void 0:_.firstWeekContainsDate)??1,a=(t==null?void 0:t.weekStartsOn)??((A=(E=t==null?void 0:t.locale)==null?void 0:E.options)==null?void 0:A.weekStartsOn)??n.weekStartsOn??((I=(C=n.locale)==null?void 0:C.options)==null?void 0:I.weekStartsOn)??0,o=toDate(r,t==null?void 0:t.in);if(!isValid(o))throw new RangeError("Invalid time value");let c=e.match(longFormattingTokensRegExp$1).map(b=>{const R=b[0];if(R==="p"||R==="P"){const V=longFormatters[R];return V(b,i.formatLong)}return b}).join("").match(formattingTokensRegExp$1).map(b=>{if(b==="''")return{isToken:!1,value:"'"};const R=b[0];if(R==="'")return{isToken:!1,value:cleanEscapedString$1(b)};if(formatters[R])return{isToken:!0,value:b};if(R.match(unescapedLatinCharacterRegExp$1))throw new RangeError("Format string contains an unescaped latin alphabet character `"+R+"`");return{isToken:!1,value:b}});i.localize.preprocessor&&(c=i.localize.preprocessor(o,c));const h={firstWeekContainsDate:s,weekStartsOn:a,locale:i};return c.map(b=>{if(!b.isToken)return b.value;const R=b.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&isProtectedWeekYearToken(R)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&isProtectedDayOfYearToken(R))&&warnOrThrowProtectedError(R,e,String(r));const V=formatters[R[0]];return V(o,R,i.localize,h)}).join("")}function cleanEscapedString$1(r){const e=r.match(escapedStringRegExp$1);return e?e[1].replace(doubleQuoteRegExp$1,"'"):r}function getDate(r,e){return toDate(r,e==null?void 0:e.in).getDate()}function getDaysInMonth(r,e){const t=toDate(r,e==null?void 0:e.in),n=t.getFullYear(),i=t.getMonth(),s=constructFrom(t,0);return s.setFullYear(n,i+1,0),s.setHours(0,0,0,0),s.getDate()}function getHours(r,e){return toDate(r,e==null?void 0:e.in).getHours()}function getMinutes(r,e){return toDate(r,e==null?void 0:e.in).getMinutes()}function getMonth(r,e){return toDate(r,e==null?void 0:e.in).getMonth()}function getSeconds(r){return toDate(r).getSeconds()}function getMilliseconds(r){return toDate(r).getMilliseconds()}function getYear(r,e){return toDate(r,e==null?void 0:e.in).getFullYear()}function isAfter(r,e){return+toDate(r)>+toDate(e)}function isBefore(r,e){return+toDate(r)<+toDate(e)}function isEqual(r,e){return+toDate(r)==+toDate(e)}function isSameDay(r,e,t){const[n,i]=normalizeDates(t==null?void 0:t.in,r,e);return+startOfDay(n)==+startOfDay(i)}function isSameYear(r,e,t){const[n,i]=normalizeDates(t==null?void 0:t.in,r,e);return n.getFullYear()===i.getFullYear()}function isSameMonth(r,e,t){const[n,i]=normalizeDates(t==null?void 0:t.in,r,e);return n.getFullYear()===i.getFullYear()&&n.getMonth()===i.getMonth()}function startOfHour(r,e){const t=toDate(r,e==null?void 0:e.in);return t.setMinutes(0,0,0),t}function isSameHour(r,e,t){const[n,i]=normalizeDates(t==null?void 0:t.in,r,e);return+startOfHour(n)==+startOfHour(i)}function getDefaultOptions(){return Object.assign({},getDefaultOptions$1())}function transpose(r,e){const t=isConstructor(e)?new e(0):constructFrom(e,0);return t.setFullYear(r.getFullYear(),r.getMonth(),r.getDate()),t.setHours(r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),t}function isConstructor(r){var e;return typeof r=="function"&&((e=r.prototype)==null?void 0:e.constructor)===r}const TIMEZONE_UNIT_PRIORITY=10;class Setter{constructor(){be(this,"subPriority",0)}validate(e,t){return!0}}class ValueSetter extends Setter{constructor(e,t,n,i,s){super(),this.value=e,this.validateValue=t,this.setValue=n,this.priority=i,s&&(this.subPriority=s)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,n){return this.setValue(e,t,this.value,n)}}class DateTimezoneSetter extends Setter{constructor(t,n){super();be(this,"priority",TIMEZONE_UNIT_PRIORITY);be(this,"subPriority",-1);this.context=t||(i=>constructFrom(n,i))}set(t,n){return n.timestampIsSet?t:constructFrom(t,transpose(t,this.context))}}class Parser{run(e,t,n,i){const s=this.parse(e,t,n,i);return s?{setter:new ValueSetter(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(e,t,n){return!0}}class EraParser extends Parser{constructor(){super(...arguments);be(this,"priority",140);be(this,"incompatibleTokens",["R","u","t","T"])}parse(t,n,i){switch(n){case"G":case"GG":case"GGG":return i.era(t,{width:"abbreviated"})||i.era(t,{width:"narrow"});case"GGGGG":return i.era(t,{width:"narrow"});case"GGGG":default:return i.era(t,{width:"wide"})||i.era(t,{width:"abbreviated"})||i.era(t,{width:"narrow"})}}set(t,n,i){return n.era=i,t.setFullYear(i,0,1),t.setHours(0,0,0,0),t}}const numericPatterns={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},timezonePatterns={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function mapValue(r,e){return r&&{value:e(r.value),rest:r.rest}}function parseNumericPattern(r,e){const t=e.match(r);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function parseTimezonePattern(r,e){const t=e.match(r);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const n=t[1]==="+"?1:-1,i=t[2]?parseInt(t[2],10):0,s=t[3]?parseInt(t[3],10):0,a=t[5]?parseInt(t[5],10):0;return{value:n*(i*millisecondsInHour+s*millisecondsInMinute+a*millisecondsInSecond),rest:e.slice(t[0].length)}}function parseAnyDigitsSigned(r){return parseNumericPattern(numericPatterns.anyDigitsSigned,r)}function parseNDigits(r,e){switch(r){case 1:return parseNumericPattern(numericPatterns.singleDigit,e);case 2:return parseNumericPattern(numericPatterns.twoDigits,e);case 3:return parseNumericPattern(numericPatterns.threeDigits,e);case 4:return parseNumericPattern(numericPatterns.fourDigits,e);default:return parseNumericPattern(new RegExp("^\\d{1,"+r+"}"),e)}}function parseNDigitsSigned(r,e){switch(r){case 1:return parseNumericPattern(numericPatterns.singleDigitSigned,e);case 2:return parseNumericPattern(numericPatterns.twoDigitsSigned,e);case 3:return parseNumericPattern(numericPatterns.threeDigitsSigned,e);case 4:return parseNumericPattern(numericPatterns.fourDigitsSigned,e);default:return parseNumericPattern(new RegExp("^-?\\d{1,"+r+"}"),e)}}function dayPeriodEnumToHours(r){switch(r){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function normalizeTwoDigitYear(r,e){const t=e>0,n=t?e:1-e;let i;if(n<=50)i=r||100;else{const s=n+50,a=Math.trunc(s/100)*100,o=r>=s%100;i=r+a-(o?100:0)}return t?i:1-i}function isLeapYearIndex(r){return r%400===0||r%4===0&&r%100!==0}class YearParser extends Parser{constructor(){super(...arguments);be(this,"priority",130);be(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(t,n,i){const s=a=>({year:a,isTwoDigitYear:n==="yy"});switch(n){case"y":return mapValue(parseNDigits(4,t),s);case"yo":return mapValue(i.ordinalNumber(t,{unit:"year"}),s);default:return mapValue(parseNDigits(n.length,t),s)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,i){const s=t.getFullYear();if(i.isTwoDigitYear){const o=normalizeTwoDigitYear(i.year,s);return t.setFullYear(o,0,1),t.setHours(0,0,0,0),t}const a=!("era"in n)||n.era===1?i.year:1-i.year;return t.setFullYear(a,0,1),t.setHours(0,0,0,0),t}}class LocalWeekYearParser extends Parser{constructor(){super(...arguments);be(this,"priority",130);be(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(t,n,i){const s=a=>({year:a,isTwoDigitYear:n==="YY"});switch(n){case"Y":return mapValue(parseNDigits(4,t),s);case"Yo":return mapValue(i.ordinalNumber(t,{unit:"year"}),s);default:return mapValue(parseNDigits(n.length,t),s)}}validate(t,n){return n.isTwoDigitYear||n.year>0}set(t,n,i,s){const a=getWeekYear(t,s);if(i.isTwoDigitYear){const c=normalizeTwoDigitYear(i.year,a);return t.setFullYear(c,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),startOfWeek(t,s)}const o=!("era"in n)||n.era===1?i.year:1-i.year;return t.setFullYear(o,0,s.firstWeekContainsDate),t.setHours(0,0,0,0),startOfWeek(t,s)}}class ISOWeekYearParser extends Parser{constructor(){super(...arguments);be(this,"priority",130);be(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(t,n){return parseNDigitsSigned(n==="R"?4:n.length,t)}set(t,n,i){const s=constructFrom(t,0);return s.setFullYear(i,0,4),s.setHours(0,0,0,0),startOfISOWeek(s)}}class ExtendedYearParser extends Parser{constructor(){super(...arguments);be(this,"priority",130);be(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(t,n){return parseNDigitsSigned(n==="u"?4:n.length,t)}set(t,n,i){return t.setFullYear(i,0,1),t.setHours(0,0,0,0),t}}class QuarterParser extends Parser{constructor(){super(...arguments);be(this,"priority",120);be(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,i){switch(n){case"Q":case"QQ":return parseNDigits(n.length,t);case"Qo":return i.ordinalNumber(t,{unit:"quarter"});case"QQQ":return i.quarter(t,{width:"abbreviated",context:"formatting"})||i.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return i.quarter(t,{width:"wide",context:"formatting"})||i.quarter(t,{width:"abbreviated",context:"formatting"})||i.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=1&&n<=4}set(t,n,i){return t.setMonth((i-1)*3,1),t.setHours(0,0,0,0),t}}class StandAloneQuarterParser extends Parser{constructor(){super(...arguments);be(this,"priority",120);be(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,n,i){switch(n){case"q":case"qq":return parseNDigits(n.length,t);case"qo":return i.ordinalNumber(t,{unit:"quarter"});case"qqq":return i.quarter(t,{width:"abbreviated",context:"standalone"})||i.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return i.quarter(t,{width:"wide",context:"standalone"})||i.quarter(t,{width:"abbreviated",context:"standalone"})||i.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=1&&n<=4}set(t,n,i){return t.setMonth((i-1)*3,1),t.setHours(0,0,0,0),t}}class MonthParser extends Parser{constructor(){super(...arguments);be(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);be(this,"priority",110)}parse(t,n,i){const s=a=>a-1;switch(n){case"M":return mapValue(parseNumericPattern(numericPatterns.month,t),s);case"MM":return mapValue(parseNDigits(2,t),s);case"Mo":return mapValue(i.ordinalNumber(t,{unit:"month"}),s);case"MMM":return i.month(t,{width:"abbreviated",context:"formatting"})||i.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return i.month(t,{width:"wide",context:"formatting"})||i.month(t,{width:"abbreviated",context:"formatting"})||i.month(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=11}set(t,n,i){return t.setMonth(i,1),t.setHours(0,0,0,0),t}}class StandAloneMonthParser extends Parser{constructor(){super(...arguments);be(this,"priority",110);be(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(t,n,i){const s=a=>a-1;switch(n){case"L":return mapValue(parseNumericPattern(numericPatterns.month,t),s);case"LL":return mapValue(parseNDigits(2,t),s);case"Lo":return mapValue(i.ordinalNumber(t,{unit:"month"}),s);case"LLL":return i.month(t,{width:"abbreviated",context:"standalone"})||i.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return i.month(t,{width:"wide",context:"standalone"})||i.month(t,{width:"abbreviated",context:"standalone"})||i.month(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=11}set(t,n,i){return t.setMonth(i,1),t.setHours(0,0,0,0),t}}function setWeek(r,e,t){const n=toDate(r,t==null?void 0:t.in),i=getWeek(n,t)-e;return n.setDate(n.getDate()-i*7),toDate(n,t==null?void 0:t.in)}class LocalWeekParser extends Parser{constructor(){super(...arguments);be(this,"priority",100);be(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(t,n,i){switch(n){case"w":return parseNumericPattern(numericPatterns.week,t);case"wo":return i.ordinalNumber(t,{unit:"week"});default:return parseNDigits(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,i,s){return startOfWeek(setWeek(t,i,s),s)}}function setISOWeek(r,e,t){const n=toDate(r,t==null?void 0:t.in),i=getISOWeek(n,t)-e;return n.setDate(n.getDate()-i*7),n}class ISOWeekParser extends Parser{constructor(){super(...arguments);be(this,"priority",100);be(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(t,n,i){switch(n){case"I":return parseNumericPattern(numericPatterns.week,t);case"Io":return i.ordinalNumber(t,{unit:"week"});default:return parseNDigits(n.length,t)}}validate(t,n){return n>=1&&n<=53}set(t,n,i){return startOfISOWeek(setISOWeek(t,i))}}const DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],DAYS_IN_MONTH_LEAP_YEAR=[31,29,31,30,31,30,31,31,30,31,30,31];class DateParser extends Parser{constructor(){super(...arguments);be(this,"priority",90);be(this,"subPriority",1);be(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(t,n,i){switch(n){case"d":return parseNumericPattern(numericPatterns.date,t);case"do":return i.ordinalNumber(t,{unit:"date"});default:return parseNDigits(n.length,t)}}validate(t,n){const i=t.getFullYear(),s=isLeapYearIndex(i),a=t.getMonth();return s?n>=1&&n<=DAYS_IN_MONTH_LEAP_YEAR[a]:n>=1&&n<=DAYS_IN_MONTH[a]}set(t,n,i){return t.setDate(i),t.setHours(0,0,0,0),t}}class DayOfYearParser extends Parser{constructor(){super(...arguments);be(this,"priority",90);be(this,"subpriority",1);be(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(t,n,i){switch(n){case"D":case"DD":return parseNumericPattern(numericPatterns.dayOfYear,t);case"Do":return i.ordinalNumber(t,{unit:"date"});default:return parseNDigits(n.length,t)}}validate(t,n){const i=t.getFullYear();return isLeapYearIndex(i)?n>=1&&n<=366:n>=1&&n<=365}set(t,n,i){return t.setMonth(0,i),t.setHours(0,0,0,0),t}}function setDay(r,e,t){var m,g,_,E;const n=getDefaultOptions$1(),i=(t==null?void 0:t.weekStartsOn)??((g=(m=t==null?void 0:t.locale)==null?void 0:m.options)==null?void 0:g.weekStartsOn)??n.weekStartsOn??((E=(_=n.locale)==null?void 0:_.options)==null?void 0:E.weekStartsOn)??0,s=toDate(r,t==null?void 0:t.in),a=s.getDay(),c=(e%7+7)%7,h=7-i,f=e<0||e>6?e-(a+h)%7:(c+h)%7-(a+h)%7;return addDays(s,f,t)}class DayParser extends Parser{constructor(){super(...arguments);be(this,"priority",90);be(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(t,n,i){switch(n){case"E":case"EE":case"EEE":return i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return i.day(t,{width:"wide",context:"formatting"})||i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,i,s){return t=setDay(t,i,s),t.setHours(0,0,0,0),t}}class LocalDayParser extends Parser{constructor(){super(...arguments);be(this,"priority",90);be(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(t,n,i,s){const a=o=>{const c=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+c};switch(n){case"e":case"ee":return mapValue(parseNDigits(n.length,t),a);case"eo":return mapValue(i.ordinalNumber(t,{unit:"day"}),a);case"eee":return i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});case"eeeee":return i.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return i.day(t,{width:"wide",context:"formatting"})||i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"})}}validate(t,n){return n>=0&&n<=6}set(t,n,i,s){return t=setDay(t,i,s),t.setHours(0,0,0,0),t}}class StandAloneLocalDayParser extends Parser{constructor(){super(...arguments);be(this,"priority",90);be(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(t,n,i,s){const a=o=>{const c=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+c};switch(n){case"c":case"cc":return mapValue(parseNDigits(n.length,t),a);case"co":return mapValue(i.ordinalNumber(t,{unit:"day"}),a);case"ccc":return i.day(t,{width:"abbreviated",context:"standalone"})||i.day(t,{width:"short",context:"standalone"})||i.day(t,{width:"narrow",context:"standalone"});case"ccccc":return i.day(t,{width:"narrow",context:"standalone"});case"cccccc":return i.day(t,{width:"short",context:"standalone"})||i.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return i.day(t,{width:"wide",context:"standalone"})||i.day(t,{width:"abbreviated",context:"standalone"})||i.day(t,{width:"short",context:"standalone"})||i.day(t,{width:"narrow",context:"standalone"})}}validate(t,n){return n>=0&&n<=6}set(t,n,i,s){return t=setDay(t,i,s),t.setHours(0,0,0,0),t}}function getISODay(r,e){const t=toDate(r,e==null?void 0:e.in).getDay();return t===0?7:t}function setISODay(r,e,t){const n=toDate(r,t==null?void 0:t.in),i=getISODay(n,t),s=e-i;return addDays(n,s,t)}class ISODayParser extends Parser{constructor(){super(...arguments);be(this,"priority",90);be(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(t,n,i){const s=a=>a===0?7:a;switch(n){case"i":case"ii":return parseNDigits(n.length,t);case"io":return i.ordinalNumber(t,{unit:"day"});case"iii":return mapValue(i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"}),s);case"iiiii":return mapValue(i.day(t,{width:"narrow",context:"formatting"}),s);case"iiiiii":return mapValue(i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"}),s);case"iiii":default:return mapValue(i.day(t,{width:"wide",context:"formatting"})||i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"}),s)}}validate(t,n){return n>=1&&n<=7}set(t,n,i){return t=setISODay(t,i),t.setHours(0,0,0,0),t}}class AMPMParser extends Parser{constructor(){super(...arguments);be(this,"priority",80);be(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(t,n,i){switch(n){case"a":case"aa":case"aaa":return i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return i.dayPeriod(t,{width:"wide",context:"formatting"})||i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,i){return t.setHours(dayPeriodEnumToHours(i),0,0,0),t}}class AMPMMidnightParser extends Parser{constructor(){super(...arguments);be(this,"priority",80);be(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(t,n,i){switch(n){case"b":case"bb":case"bbb":return i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return i.dayPeriod(t,{width:"wide",context:"formatting"})||i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,i){return t.setHours(dayPeriodEnumToHours(i),0,0,0),t}}class DayPeriodParser extends Parser{constructor(){super(...arguments);be(this,"priority",80);be(this,"incompatibleTokens",["a","b","t","T"])}parse(t,n,i){switch(n){case"B":case"BB":case"BBB":return i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return i.dayPeriod(t,{width:"wide",context:"formatting"})||i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,n,i){return t.setHours(dayPeriodEnumToHours(i),0,0,0),t}}class Hour1to12Parser extends Parser{constructor(){super(...arguments);be(this,"priority",70);be(this,"incompatibleTokens",["H","K","k","t","T"])}parse(t,n,i){switch(n){case"h":return parseNumericPattern(numericPatterns.hour12h,t);case"ho":return i.ordinalNumber(t,{unit:"hour"});default:return parseNDigits(n.length,t)}}validate(t,n){return n>=1&&n<=12}set(t,n,i){const s=t.getHours()>=12;return s&&i<12?t.setHours(i+12,0,0,0):!s&&i===12?t.setHours(0,0,0,0):t.setHours(i,0,0,0),t}}class Hour0to23Parser extends Parser{constructor(){super(...arguments);be(this,"priority",70);be(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(t,n,i){switch(n){case"H":return parseNumericPattern(numericPatterns.hour23h,t);case"Ho":return i.ordinalNumber(t,{unit:"hour"});default:return parseNDigits(n.length,t)}}validate(t,n){return n>=0&&n<=23}set(t,n,i){return t.setHours(i,0,0,0),t}}class Hour0To11Parser extends Parser{constructor(){super(...arguments);be(this,"priority",70);be(this,"incompatibleTokens",["h","H","k","t","T"])}parse(t,n,i){switch(n){case"K":return parseNumericPattern(numericPatterns.hour11h,t);case"Ko":return i.ordinalNumber(t,{unit:"hour"});default:return parseNDigits(n.length,t)}}validate(t,n){return n>=0&&n<=11}set(t,n,i){return t.getHours()>=12&&i<12?t.setHours(i+12,0,0,0):t.setHours(i,0,0,0),t}}class Hour1To24Parser extends Parser{constructor(){super(...arguments);be(this,"priority",70);be(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(t,n,i){switch(n){case"k":return parseNumericPattern(numericPatterns.hour24h,t);case"ko":return i.ordinalNumber(t,{unit:"hour"});default:return parseNDigits(n.length,t)}}validate(t,n){return n>=1&&n<=24}set(t,n,i){const s=i<=24?i%24:i;return t.setHours(s,0,0,0),t}}class MinuteParser extends Parser{constructor(){super(...arguments);be(this,"priority",60);be(this,"incompatibleTokens",["t","T"])}parse(t,n,i){switch(n){case"m":return parseNumericPattern(numericPatterns.minute,t);case"mo":return i.ordinalNumber(t,{unit:"minute"});default:return parseNDigits(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,i){return t.setMinutes(i,0,0),t}}class SecondParser extends Parser{constructor(){super(...arguments);be(this,"priority",50);be(this,"incompatibleTokens",["t","T"])}parse(t,n,i){switch(n){case"s":return parseNumericPattern(numericPatterns.second,t);case"so":return i.ordinalNumber(t,{unit:"second"});default:return parseNDigits(n.length,t)}}validate(t,n){return n>=0&&n<=59}set(t,n,i){return t.setSeconds(i,0),t}}class FractionOfSecondParser extends Parser{constructor(){super(...arguments);be(this,"priority",30);be(this,"incompatibleTokens",["t","T"])}parse(t,n){const i=s=>Math.trunc(s*Math.pow(10,-n.length+3));return mapValue(parseNDigits(n.length,t),i)}set(t,n,i){return t.setMilliseconds(i),t}}class ISOTimezoneWithZParser extends Parser{constructor(){super(...arguments);be(this,"priority",10);be(this,"incompatibleTokens",["t","T","x"])}parse(t,n){switch(n){case"X":return parseTimezonePattern(timezonePatterns.basicOptionalMinutes,t);case"XX":return parseTimezonePattern(timezonePatterns.basic,t);case"XXXX":return parseTimezonePattern(timezonePatterns.basicOptionalSeconds,t);case"XXXXX":return parseTimezonePattern(timezonePatterns.extendedOptionalSeconds,t);case"XXX":default:return parseTimezonePattern(timezonePatterns.extended,t)}}set(t,n,i){return n.timestampIsSet?t:constructFrom(t,t.getTime()-getTimezoneOffsetInMilliseconds(t)-i)}}class ISOTimezoneParser extends Parser{constructor(){super(...arguments);be(this,"priority",10);be(this,"incompatibleTokens",["t","T","X"])}parse(t,n){switch(n){case"x":return parseTimezonePattern(timezonePatterns.basicOptionalMinutes,t);case"xx":return parseTimezonePattern(timezonePatterns.basic,t);case"xxxx":return parseTimezonePattern(timezonePatterns.basicOptionalSeconds,t);case"xxxxx":return parseTimezonePattern(timezonePatterns.extendedOptionalSeconds,t);case"xxx":default:return parseTimezonePattern(timezonePatterns.extended,t)}}set(t,n,i){return n.timestampIsSet?t:constructFrom(t,t.getTime()-getTimezoneOffsetInMilliseconds(t)-i)}}class TimestampSecondsParser extends Parser{constructor(){super(...arguments);be(this,"priority",40);be(this,"incompatibleTokens","*")}parse(t){return parseAnyDigitsSigned(t)}set(t,n,i){return[constructFrom(t,i*1e3),{timestampIsSet:!0}]}}class TimestampMillisecondsParser extends Parser{constructor(){super(...arguments);be(this,"priority",20);be(this,"incompatibleTokens","*")}parse(t){return parseAnyDigitsSigned(t)}set(t,n,i){return[constructFrom(t,i),{timestampIsSet:!0}]}}const parsers={G:new EraParser,y:new YearParser,Y:new LocalWeekYearParser,R:new ISOWeekYearParser,u:new ExtendedYearParser,Q:new QuarterParser,q:new StandAloneQuarterParser,M:new MonthParser,L:new StandAloneMonthParser,w:new LocalWeekParser,I:new ISOWeekParser,d:new DateParser,D:new DayOfYearParser,E:new DayParser,e:new LocalDayParser,c:new StandAloneLocalDayParser,i:new ISODayParser,a:new AMPMParser,b:new AMPMMidnightParser,B:new DayPeriodParser,h:new Hour1to12Parser,H:new Hour0to23Parser,K:new Hour0To11Parser,k:new Hour1To24Parser,m:new MinuteParser,s:new SecondParser,S:new FractionOfSecondParser,X:new ISOTimezoneWithZParser,x:new ISOTimezoneParser,t:new TimestampSecondsParser,T:new TimestampMillisecondsParser},formattingTokensRegExp=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,longFormattingTokensRegExp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,escapedStringRegExp=/^'([^]*?)'?$/,doubleQuoteRegExp=/''/g,notWhitespaceRegExp=/\S/,unescapedLatinCharacterRegExp=/[a-zA-Z]/;function parse(r,e,t,n){var C,I,b,R,V,U,W,j;const i=()=>constructFrom((n==null?void 0:n.in)||t,NaN),s=getDefaultOptions(),a=(n==null?void 0:n.locale)??s.locale??enUS,o=(n==null?void 0:n.firstWeekContainsDate)??((I=(C=n==null?void 0:n.locale)==null?void 0:C.options)==null?void 0:I.firstWeekContainsDate)??s.firstWeekContainsDate??((R=(b=s.locale)==null?void 0:b.options)==null?void 0:R.firstWeekContainsDate)??1,c=(n==null?void 0:n.weekStartsOn)??((U=(V=n==null?void 0:n.locale)==null?void 0:V.options)==null?void 0:U.weekStartsOn)??s.weekStartsOn??((j=(W=s.locale)==null?void 0:W.options)==null?void 0:j.weekStartsOn)??0;if(!e)return r?i():toDate(t,n==null?void 0:n.in);const h={firstWeekContainsDate:o,weekStartsOn:c,locale:a},f=[new DateTimezoneSetter(n==null?void 0:n.in,t)],m=e.match(longFormattingTokensRegExp).map(w=>{const P=w[0];if(P in longFormatters){const K=longFormatters[P];return K(w,a.formatLong)}return w}).join("").match(formattingTokensRegExp),g=[];for(let w of m){!(n!=null&&n.useAdditionalWeekYearTokens)&&isProtectedWeekYearToken(w)&&warnOrThrowProtectedError(w,e,r),!(n!=null&&n.useAdditionalDayOfYearTokens)&&isProtectedDayOfYearToken(w)&&warnOrThrowProtectedError(w,e,r);const P=w[0],K=parsers[P];if(K){const{incompatibleTokens:X}=K;if(Array.isArray(X)){const Z=g.find(ae=>X.includes(ae.token)||ae.token===P);if(Z)throw new RangeError(`The format string mustn't contain \`${Z.fullToken}\` and \`${w}\` at the same time`)}else if(K.incompatibleTokens==="*"&&g.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);g.push({token:P,fullToken:w});const Y=K.run(r,w,a.match,h);if(!Y)return i();f.push(Y.setter),r=Y.rest}else{if(P.match(unescapedLatinCharacterRegExp))throw new RangeError("Format string contains an unescaped latin alphabet character `"+P+"`");if(w==="''"?w="'":P==="'"&&(w=cleanEscapedString(w)),r.indexOf(w)===0)r=r.slice(w.length);else return i()}}if(r.length>0&&notWhitespaceRegExp.test(r))return i();const _=f.map(w=>w.priority).sort((w,P)=>P-w).filter((w,P,K)=>K.indexOf(w)===P).map(w=>f.filter(P=>P.priority===w).sort((P,K)=>K.subPriority-P.subPriority)).map(w=>w[0]);let E=toDate(t,n==null?void 0:n.in);if(isNaN(+E))return i();const A={};for(const w of _){if(!w.validate(E,h))return i();const P=w.set(E,A,h);Array.isArray(P)?(E=P[0],Object.assign(A,P[1])):E=P}return E}function cleanEscapedString(r){return r.match(escapedStringRegExp)[1].replace(doubleQuoteRegExp,"'")}function setDate(r,e,t){const n=toDate(r,t==null?void 0:t.in);return n.setDate(e),n}function setHours(r,e,t){const n=toDate(r,t==null?void 0:t.in);return n.setHours(e),n}function setMinutes(r,e,t){const n=toDate(r,t==null?void 0:t.in);return n.setMinutes(e),n}function setMonth(r,e,t){const n=toDate(r,t==null?void 0:t.in),i=n.getFullYear(),s=n.getDate(),a=constructFrom(r,0);a.setFullYear(i,e,15),a.setHours(0,0,0,0);const o=getDaysInMonth(a);return n.setMonth(e,Math.min(s,o)),n}function setSeconds(r,e,t){const n=toDate(r,t==null?void 0:t.in);return n.setSeconds(e),n}function setMilliseconds(r,e,t){const n=toDate(r,t==null?void 0:t.in);return n.setMilliseconds(e),n}function setYear(r,e,t){const n=toDate(r,t==null?void 0:t.in);return isNaN(+n)?constructFrom(r,NaN):(n.setFullYear(e),n)}function startOfMonth(r,e){const t=toDate(r,e==null?void 0:e.in);return t.setDate(1),t.setHours(0,0,0,0),t}function endOfMonth(r,e){const t=toDate(r,e==null?void 0:e.in),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function isWithinInterval(r,e,t){const n=+toDate(r,t==null?void 0:t.in),[i,s]=[+toDate(e.start,t==null?void 0:t.in),+toDate(e.end,t==null?void 0:t.in)].sort((a,o)=>a-o);return n>=i&&n<=s}const formatTokenMap={y:{sectionType:"year",contentType:"digit",maxLength:4},yy:"year",yyy:{sectionType:"year",contentType:"digit",maxLength:4},yyyy:"year",M:{sectionType:"month",contentType:"digit",maxLength:2},MM:"month",MMMM:{sectionType:"month",contentType:"letter"},MMM:{sectionType:"month",contentType:"letter"},L:{sectionType:"month",contentType:"digit",maxLength:2},LL:"month",LLL:{sectionType:"month",contentType:"letter"},LLLL:{sectionType:"month",contentType:"letter"},d:{sectionType:"day",contentType:"digit",maxLength:2},dd:"day",do:{sectionType:"day",contentType:"digit-with-letter"},E:{sectionType:"weekDay",contentType:"letter"},EE:{sectionType:"weekDay",contentType:"letter"},EEE:{sectionType:"weekDay",contentType:"letter"},EEEE:{sectionType:"weekDay",contentType:"letter"},EEEEE:{sectionType:"weekDay",contentType:"letter"},i:{sectionType:"weekDay",contentType:"digit",maxLength:1},ii:"weekDay",iii:{sectionType:"weekDay",contentType:"letter"},iiii:{sectionType:"weekDay",contentType:"letter"},e:{sectionType:"weekDay",contentType:"digit",maxLength:1},ee:"weekDay",eee:{sectionType:"weekDay",contentType:"letter"},eeee:{sectionType:"weekDay",contentType:"letter"},eeeee:{sectionType:"weekDay",contentType:"letter"},eeeeee:{sectionType:"weekDay",contentType:"letter"},c:{sectionType:"weekDay",contentType:"digit",maxLength:1},cc:"weekDay",ccc:{sectionType:"weekDay",contentType:"letter"},cccc:{sectionType:"weekDay",contentType:"letter"},ccccc:{sectionType:"weekDay",contentType:"letter"},cccccc:{sectionType:"weekDay",contentType:"letter"},a:"meridiem",aa:"meridiem",aaa:"meridiem",H:{sectionType:"hours",contentType:"digit",maxLength:2},HH:"hours",h:{sectionType:"hours",contentType:"digit",maxLength:2},hh:"hours",m:{sectionType:"minutes",contentType:"digit",maxLength:2},mm:"minutes",s:{sectionType:"seconds",contentType:"digit",maxLength:2},ss:"seconds"},defaultFormats={year:"yyyy",month:"LLLL",monthShort:"MMM",dayOfMonth:"d",dayOfMonthFull:"do",weekday:"EEEE",weekdayShort:"EEEEEE",hours24h:"HH",hours12h:"hh",meridiem:"aa",minutes:"mm",seconds:"ss",fullDate:"PP",keyboardDate:"P",shortDate:"MMM d",normalDate:"d MMMM",normalDateWithWeekday:"EEE, MMM d",fullTime12h:"hh:mm aa",fullTime24h:"HH:mm",keyboardDateTime12h:"P hh:mm aa",keyboardDateTime24h:"P HH:mm"};class AdapterDateFnsBase{constructor(e){be(this,"isMUIAdapter",!0);be(this,"isTimezoneCompatible",!1);be(this,"formatTokenMap",formatTokenMap);be(this,"escapedCharacters",{start:"'",end:"'"});be(this,"date",e=>typeof e>"u"?new Date:e===null?null:new Date(e));be(this,"getInvalidDate",()=>new Date("Invalid Date"));be(this,"getTimezone",()=>"default");be(this,"setTimezone",e=>e);be(this,"toJsDate",e=>e);be(this,"getCurrentLocaleCode",()=>this.locale.code);be(this,"is12HourCycleInCurrentLocale",()=>/a/.test(this.locale.formatLong.time({width:"short"})));be(this,"expandFormat",e=>{const t=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;return e.match(t).map(n=>{const i=n[0];if(i==="p"||i==="P"){const s=this.longFormatters[i];return s(n,this.locale.formatLong)}return n}).join("")});be(this,"formatNumber",e=>e);be(this,"getDayOfWeek",e=>e.getDay()+1);const{locale:t,formats:n,longFormatters:i,lib:s}=e;this.locale=t,this.formats=_extends({},defaultFormats,n),this.longFormatters=i,this.lib=s||"date-fns"}}class AdapterDateFns extends AdapterDateFnsBase{constructor({locale:t,formats:n}={}){super({locale:t??enUS,formats:n,longFormatters});be(this,"parse",(t,n)=>t===""?null:parse(t,n,new Date,{locale:this.locale}));be(this,"isValid",t=>t==null?!1:isValid(t));be(this,"format",(t,n)=>this.formatByString(t,this.formats[n]));be(this,"formatByString",(t,n)=>format$1(t,n,{locale:this.locale}));be(this,"isEqual",(t,n)=>t===null&&n===null?!0:t===null||n===null?!1:isEqual(t,n));be(this,"isSameYear",(t,n)=>isSameYear(t,n));be(this,"isSameMonth",(t,n)=>isSameMonth(t,n));be(this,"isSameDay",(t,n)=>isSameDay(t,n));be(this,"isSameHour",(t,n)=>isSameHour(t,n));be(this,"isAfter",(t,n)=>isAfter(t,n));be(this,"isAfterYear",(t,n)=>isAfter(t,endOfYear(n)));be(this,"isAfterDay",(t,n)=>isAfter(t,endOfDay(n)));be(this,"isBefore",(t,n)=>isBefore(t,n));be(this,"isBeforeYear",(t,n)=>isBefore(t,this.startOfYear(n)));be(this,"isBeforeDay",(t,n)=>isBefore(t,this.startOfDay(n)));be(this,"isWithinRange",(t,[n,i])=>isWithinInterval(t,{start:n,end:i}));be(this,"startOfYear",t=>startOfYear(t));be(this,"startOfMonth",t=>startOfMonth(t));be(this,"startOfWeek",t=>startOfWeek(t,{locale:this.locale}));be(this,"startOfDay",t=>startOfDay(t));be(this,"endOfYear",t=>endOfYear(t));be(this,"endOfMonth",t=>endOfMonth(t));be(this,"endOfWeek",t=>endOfWeek(t,{locale:this.locale}));be(this,"endOfDay",t=>endOfDay(t));be(this,"addYears",(t,n)=>addYears(t,n));be(this,"addMonths",(t,n)=>addMonths(t,n));be(this,"addWeeks",(t,n)=>addWeeks(t,n));be(this,"addDays",(t,n)=>addDays(t,n));be(this,"addHours",(t,n)=>addHours(t,n));be(this,"addMinutes",(t,n)=>addMinutes(t,n));be(this,"addSeconds",(t,n)=>addSeconds(t,n));be(this,"getYear",t=>getYear(t));be(this,"getMonth",t=>getMonth(t));be(this,"getDate",t=>getDate(t));be(this,"getHours",t=>getHours(t));be(this,"getMinutes",t=>getMinutes(t));be(this,"getSeconds",t=>getSeconds(t));be(this,"getMilliseconds",t=>getMilliseconds(t));be(this,"setYear",(t,n)=>setYear(t,n));be(this,"setMonth",(t,n)=>setMonth(t,n));be(this,"setDate",(t,n)=>setDate(t,n));be(this,"setHours",(t,n)=>setHours(t,n));be(this,"setMinutes",(t,n)=>setMinutes(t,n));be(this,"setSeconds",(t,n)=>setSeconds(t,n));be(this,"setMilliseconds",(t,n)=>setMilliseconds(t,n));be(this,"getDaysInMonth",t=>getDaysInMonth(t));be(this,"getWeekArray",t=>{const n=this.startOfWeek(this.startOfMonth(t)),i=this.endOfWeek(this.endOfMonth(t));let s=0,a=n;const o=[];for(;this.isBefore(a,i);){const c=Math.floor(s/7);o[c]=o[c]||[],o[c].push(a),a=this.addDays(a,1),s+=1}return o});be(this,"getWeekNumber",t=>getWeek(t,{locale:this.locale}));be(this,"getYearRange",([t,n])=>{const i=this.startOfYear(t),s=this.endOfYear(n),a=[];let o=i;for(;this.isBefore(o,s);)a.push(o),o=this.addYears(o,1);return a})}}const formatDistanceLocale={lessThanXSeconds:{one:"1秒未満",other:"{{count}}秒未満",oneWithSuffix:"約1秒",otherWithSuffix:"約{{count}}秒"},xSeconds:{one:"1秒",other:"{{count}}秒"},halfAMinute:"30秒",lessThanXMinutes:{one:"1分未満",other:"{{count}}分未満",oneWithSuffix:"約1分",otherWithSuffix:"約{{count}}分"},xMinutes:{one:"1分",other:"{{count}}分"},aboutXHours:{one:"約1時間",other:"約{{count}}時間"},xHours:{one:"1時間",other:"{{count}}時間"},xDays:{one:"1日",other:"{{count}}日"},aboutXWeeks:{one:"約1週間",other:"約{{count}}週間"},xWeeks:{one:"1週間",other:"{{count}}週間"},aboutXMonths:{one:"約1か月",other:"約{{count}}か月"},xMonths:{one:"1か月",other:"{{count}}か月"},aboutXYears:{one:"約1年",other:"約{{count}}年"},xYears:{one:"1年",other:"{{count}}年"},overXYears:{one:"1年以上",other:"{{count}}年以上"},almostXYears:{one:"1年近く",other:"{{count}}年近く"}},formatDistance=(r,e,t)=>{t=t||{};let n;const i=formatDistanceLocale[r];return typeof i=="string"?n=i:e===1?t.addSuffix&&i.oneWithSuffix?n=i.oneWithSuffix:n=i.one:t.addSuffix&&i.otherWithSuffix?n=i.otherWithSuffix.replace("{{count}}",String(e)):n=i.other.replace("{{count}}",String(e)),t.addSuffix?t.comparison&&t.comparison>0?n+"後":n+"前":n},dateFormats={full:"y年M月d日EEEE",long:"y年M月d日",medium:"y/MM/dd",short:"y/MM/dd"},timeFormats={full:"H時mm分ss秒 zzzz",long:"H:mm:ss z",medium:"H:mm:ss",short:"H:mm"},dateTimeFormats={full:"{{date}} {{time}}",long:"{{date}} {{time}}",medium:"{{date}} {{time}}",short:"{{date}} {{time}}"},formatLong={date:buildFormatLongFn({formats:dateFormats,defaultWidth:"full"}),time:buildFormatLongFn({formats:timeFormats,defaultWidth:"full"}),dateTime:buildFormatLongFn({formats:dateTimeFormats,defaultWidth:"full"})},formatRelativeLocale={lastWeek:"先週のeeeeのp",yesterday:"昨日のp",today:"今日のp",tomorrow:"明日のp",nextWeek:"翌週のeeeeのp",other:"P"},formatRelative=(r,e,t,n)=>formatRelativeLocale[r],eraValues={narrow:["BC","AC"],abbreviated:["紀元前","西暦"],wide:["紀元前","西暦"]},quarterValues={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["第1四半期","第2四半期","第3四半期","第4四半期"]},monthValues={narrow:["1","2","3","4","5","6","7","8","9","10","11","12"],abbreviated:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],wide:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]},dayValues={narrow:["日","月","火","水","木","金","土"],short:["日","月","火","水","木","金","土"],abbreviated:["日","月","火","水","木","金","土"],wide:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"]},dayPeriodValues={narrow:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},abbreviated:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},wide:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"}},formattingDayPeriodValues={narrow:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},abbreviated:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"},wide:{am:"午前",pm:"午後",midnight:"深夜",noon:"正午",morning:"朝",afternoon:"午後",evening:"夜",night:"深夜"}},ordinalNumber=(r,e)=>{const t=Number(r);switch(String(e==null?void 0:e.unit)){case"year":return`${t}年`;case"quarter":return`第${t}四半期`;case"month":return`${t}月`;case"week":return`第${t}週`;case"date":return`${t}日`;case"hour":return`${t}時`;case"minute":return`${t}分`;case"second":return`${t}秒`;default:return`${t}`}},localize={ordinalNumber,era:buildLocalizeFn({values:eraValues,defaultWidth:"wide"}),quarter:buildLocalizeFn({values:quarterValues,defaultWidth:"wide",argumentCallback:r=>Number(r)-1}),month:buildLocalizeFn({values:monthValues,defaultWidth:"wide"}),day:buildLocalizeFn({values:dayValues,defaultWidth:"wide"}),dayPeriod:buildLocalizeFn({values:dayPeriodValues,defaultWidth:"wide",formattingValues:formattingDayPeriodValues,defaultFormattingWidth:"wide"})},matchOrdinalNumberPattern=/^第?\d+(年|四半期|月|週|日|時|分|秒)?/i,parseOrdinalNumberPattern=/\d+/i,matchEraPatterns={narrow:/^(B\.?C\.?|A\.?D\.?)/i,abbreviated:/^(紀元[前後]|西暦)/i,wide:/^(紀元[前後]|西暦)/i},parseEraPatterns={narrow:[/^B/i,/^A/i],any:[/^(紀元前)/i,/^(西暦|紀元後)/i]},matchQuarterPatterns={narrow:/^[1234]/i,abbreviated:/^Q[1234]/i,wide:/^第[1234一二三四１２３４]四半期/i},parseQuarterPatterns={any:[/(1|一|１)/i,/(2|二|２)/i,/(3|三|３)/i,/(4|四|４)/i]},matchMonthPatterns={narrow:/^([123456789]|1[012])/,abbreviated:/^([123456789]|1[012])月/i,wide:/^([123456789]|1[012])月/i},parseMonthPatterns={any:[/^1\D/,/^2/,/^3/,/^4/,/^5/,/^6/,/^7/,/^8/,/^9/,/^10/,/^11/,/^12/]},matchDayPatterns={narrow:/^[日月火水木金土]/,short:/^[日月火水木金土]/,abbreviated:/^[日月火水木金土]/,wide:/^[日月火水木金土]曜日/},parseDayPatterns={any:[/^日/,/^月/,/^火/,/^水/,/^木/,/^金/,/^土/]},matchDayPeriodPatterns={any:/^(AM|PM|午前|午後|正午|深夜|真夜中|夜|朝)/i},parseDayPeriodPatterns={any:{am:/^(A|午前)/i,pm:/^(P|午後)/i,midnight:/^深夜|真夜中/i,noon:/^正午/i,morning:/^朝/i,afternoon:/^午後/i,evening:/^夜/i,night:/^深夜/i}},match={ordinalNumber:buildMatchPatternFn({matchPattern:matchOrdinalNumberPattern,parsePattern:parseOrdinalNumberPattern,valueCallback:function(r){return parseInt(r,10)}}),era:buildMatchFn({matchPatterns:matchEraPatterns,defaultMatchWidth:"wide",parsePatterns:parseEraPatterns,defaultParseWidth:"any"}),quarter:buildMatchFn({matchPatterns:matchQuarterPatterns,defaultMatchWidth:"wide",parsePatterns:parseQuarterPatterns,defaultParseWidth:"any",valueCallback:r=>r+1}),month:buildMatchFn({matchPatterns:matchMonthPatterns,defaultMatchWidth:"wide",parsePatterns:parseMonthPatterns,defaultParseWidth:"any"}),day:buildMatchFn({matchPatterns:matchDayPatterns,defaultMatchWidth:"wide",parsePatterns:parseDayPatterns,defaultParseWidth:"any"}),dayPeriod:buildMatchFn({matchPatterns:matchDayPeriodPatterns,defaultMatchWidth:"any",parsePatterns:parseDayPeriodPatterns,defaultParseWidth:"any"})},ja={code:"ja",formatDistance,formatLong,formatRelative,localize,match,options:{weekStartsOn:0,firstWeekContainsDate:1}};function useHistoryValidation(){return{validate:reactExports.useCallback((e,t,n,i=[])=>{if(!e)throw new Error("日時を選択してください");if(e>new Date)throw new Error("未来の日時は設定できません");if(!isValidBookStatus(t))throw new Error("無効なステータスです");if((i||[]).some(o=>{var h;const c=(h=o==null?void 0:o.changedAt)!=null&&h.toDate?o.changedAt.toDate():o!=null&&o.changedAt?new Date(o.changedAt):null;return c?Math.abs(c-e)<6e4:!1}))throw new Error("同じ日時の履歴が既に存在します")},[])}}const ManualHistoryAddDialog=({open:r,onClose:e,onAdd:t,bookId:n,existingHistory:i=[],currentBookStatus:s=null})=>{const[a,o]=reactExports.useState(new Date),[c,h]=reactExports.useState(BOOK_STATUS.READING),[f,m]=reactExports.useState(""),[g,_]=reactExports.useState(!1),[E,A]=reactExports.useState(""),{validate:C}=useHistoryValidation(),I=()=>Object.values(BOOK_STATUS).filter(V=>V!==c);React.useEffect(()=>{f===c&&m("")},[c,f]),React.useEffect(()=>{r&&m(s&&s!==c?s:"")},[r,s,c]);const b=async()=>{A(""),_(!0);try{C(a,c,f,i),await t(a,c,f,i),R()}catch(V){A(V.message)}finally{_(!1)}},R=()=>{o(new Date),h(BOOK_STATUS.READING),m(""),A(""),_(!1),e()};return jsxRuntimeExports.jsx(LocalizationProvider,{dateAdapter:AdapterDateFns,adapterLocale:ja,children:jsxRuntimeExports.jsxs(Dialog,{open:r,onClose:R,maxWidth:"sm",fullWidth:!0,children:[jsxRuntimeExports.jsx(DialogTitle,{children:"📝 ステータス履歴を追加"}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",flexDirection:"column",gap:2,mt:1},children:[jsxRuntimeExports.jsx(DateTimePicker,{label:"日時",value:a,onChange:V=>o(V),maxDateTime:new Date,slotProps:{textField:{fullWidth:!0}}}),jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,children:[jsxRuntimeExports.jsx(InputLabel,{children:"ステータス"}),jsxRuntimeExports.jsx(Select,{value:c,onChange:V=>h(V.target.value),label:"ステータス",children:Object.entries(BOOK_STATUS_LABELS).map(([V,U])=>jsxRuntimeExports.jsx(MenuItem,{value:V,children:U},V))})]}),jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,children:[jsxRuntimeExports.jsx(InputLabel,{children:"前のステータス"}),jsxRuntimeExports.jsxs(Select,{value:f,onChange:V=>m(V.target.value),label:"前のステータス",children:[jsxRuntimeExports.jsx(MenuItem,{value:"",children:jsxRuntimeExports.jsx("em",{children:"なし"})}),I().map(V=>jsxRuntimeExports.jsx(MenuItem,{value:V,children:BOOK_STATUS_LABELS[V]},V))]})]}),E&&jsxRuntimeExports.jsx(Typography,{color:"error",variant:"body2",children:E})]})}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:R,disabled:g,children:"キャンセル"}),jsxRuntimeExports.jsx(Button,{onClick:b,variant:"contained",disabled:g,children:g?"保存中...":"保存"})]})]})})},StatusHistoryTimeline=({history:r=[],loading:e=!1,error:t=null,importantDates:n={},readingDuration:i=null,showAddButton:s=!1,bookId:a=null,onAddHistory:o=null,currentBookStatus:c=null})=>{const[h,f]=reactExports.useState(!1),m=async(A,C,I,b)=>{o&&await o(A,C,I,b)},g=A=>{switch(A){case BOOK_STATUS.TSUNDOKU:return jsxRuntimeExports.jsx(BookmarkAdded,{});case BOOK_STATUS.READING:return jsxRuntimeExports.jsx(PlayArrow,{});case BOOK_STATUS.RE_READING:return jsxRuntimeExports.jsx(Refresh,{});case BOOK_STATUS.FINISHED:return jsxRuntimeExports.jsx(CheckCircle,{});default:return jsxRuntimeExports.jsx(BookmarkAdded,{})}},_=A=>A?(A.toDate?A.toDate():new Date(A)).toLocaleDateString("ja-JP",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",E=()=>!n||Object.keys(n).length===0?null:jsxRuntimeExports.jsxs(Box,{sx:{mb:3},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",gutterBottom:!0,children:"重要日付"}),jsxRuntimeExports.jsxs(Paper,{sx:{p:2,mb:2},children:[n.readingStartedAt&&jsxRuntimeExports.jsxs(Box,{sx:{mb:1},children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"読書開始日"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",children:_(n.readingStartedAt)})]}),n.reReadingStartedAt&&jsxRuntimeExports.jsxs(Box,{sx:{mb:1},children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"再読開始日"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",children:_(n.reReadingStartedAt)})]}),n.finishedAt&&jsxRuntimeExports.jsxs(Box,{sx:{mb:1},children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"読了日"}),jsxRuntimeExports.jsx(Typography,{variant:"body1",children:_(n.finishedAt)})]}),i&&jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"読書期間"}),jsxRuntimeExports.jsxs(Typography,{variant:"body1",children:[i,"日間"]})]})]})]});return e?jsxRuntimeExports.jsx(Box,{sx:{p:2},children:jsxRuntimeExports.jsx(Typography,{children:"履歴を読み込み中..."})}):t?jsxRuntimeExports.jsx(Box,{sx:{p:2},children:jsxRuntimeExports.jsxs(Typography,{color:"error",children:["エラー: ",t]})}):jsxRuntimeExports.jsxs(Box,{sx:{p:2},children:[E(),jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",children:"ステータス変更履歴"}),s&&jsxRuntimeExports.jsx(Button,{variant:"outlined",size:"small",startIcon:jsxRuntimeExports.jsx(AddIcon,{}),onClick:()=>f(!0),"data-testid":"add-history-button",children:"履歴追加"})]}),(!r||r.length===0)&&jsxRuntimeExports.jsxs(Box,{sx:{textAlign:"center",py:4},children:[jsxRuntimeExports.jsx(Typography,{variant:"body1",color:"text.secondary",gutterBottom:!0,children:"履歴がありません"}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"過去のステータス変更履歴を追加できます"})]}),jsxRuntimeExports.jsx(List,{children:(r||[]).map((A,C)=>jsxRuntimeExports.jsxs(ListItem,{sx:{flexDirection:"column",alignItems:"flex-start"},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center",gap:1,mb:1,width:"100%"},children:[jsxRuntimeExports.jsx(ListItemIcon,{sx:{minWidth:"auto"},children:jsxRuntimeExports.jsx(Avatar,{sx:{bgcolor:getBookStatusColor(A.status)==="primary"?"primary.main":getBookStatusColor(A.status)==="secondary"?"secondary.main":getBookStatusColor(A.status)==="success"?"success.main":"default",width:32,height:32},children:g(A.status)})}),jsxRuntimeExports.jsxs(Box,{sx:{flexGrow:1},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[jsxRuntimeExports.jsx(Chip,{label:getBookStatusLabel(A.status),color:getBookStatusColor(A.status),size:"small"}),A.previousStatus&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"←"}),jsxRuntimeExports.jsx(Chip,{label:getBookStatusLabel(A.previousStatus),color:getBookStatusColor(A.previousStatus),size:"small",variant:"outlined"})]})]}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:_(A.changedAt)}),A.notes&&jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mt:1},children:A.notes})]})]}),C<r.length-1&&jsxRuntimeExports.jsx(Divider,{sx:{width:"100%",mt:1}})]},A.id))}),s&&jsxRuntimeExports.jsx(ManualHistoryAddDialog,{open:h,onClose:()=>f(!1),onAdd:m,bookId:a,existingHistory:r,currentBookStatus:c})]})},LatestStatusHistory=({bookId:r})=>{const{latestHistory:e,loading:t,error:n}=useBookStatusHistory(r);if(t)return jsxRuntimeExports.jsxs(Paper,{sx:{p:2,mb:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",gutterBottom:!0,children:"📊 最新ステータス履歴"}),jsxRuntimeExports.jsx(Skeleton,{variant:"rectangular",height:40})]});if(n)return jsxRuntimeExports.jsxs(Paper,{sx:{p:2,mb:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",gutterBottom:!0,children:"📊 最新ステータス履歴"}),jsxRuntimeExports.jsx(Typography,{color:"error",children:"履歴の取得に失敗しました"})]});if(!e)return jsxRuntimeExports.jsxs(Paper,{sx:{p:2,mb:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",gutterBottom:!0,children:"📊 最新ステータス履歴"}),jsxRuntimeExports.jsx(Typography,{color:"text.secondary",children:"履歴がありません"})]});const i=s=>s?(s.toDate?s.toDate():new Date(s)).toLocaleDateString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"";return jsxRuntimeExports.jsxs(Paper,{sx:{p:2,mb:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",gutterBottom:!0,children:"📊 最新ステータス履歴"}),jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center",gap:1,flexWrap:"wrap"},children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:i(e.changedAt)}),jsxRuntimeExports.jsx(Chip,{label:getBookStatusLabel(e.status),color:getBookStatusColor(e.status),size:"small"}),e.previousStatus&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"←"}),jsxRuntimeExports.jsx(Chip,{label:getBookStatusLabel(e.previousStatus),color:getBookStatusColor(e.previousStatus),size:"small",variant:"outlined"})]})]})]})},useBook=r=>{const{user:e}=useAuth(),t=reactExports.useContext(ErrorDialogContext),n=(t==null?void 0:t.setGlobalError)||(()=>{}),[i,s]=reactExports.useState(null),[a,o]=reactExports.useState(!0),[c,h]=reactExports.useState(null),f=reactExports.useCallback(async()=>{if(!e||!r){o(!1);return}try{o(!0),h(null);const E=doc(db,"books",r),A=await getDoc(E);A.exists()&&A.data().userId===e.uid?s({id:A.id,...A.data()}):(console.error("No such document or access denied!"),n("書籍が見つからないか、アクセス権限がありません。"),s(null),h("書籍が見つからないか、アクセス権限がありません。"))}catch(E){console.error("Error fetching document:",E),n("書籍情報の取得に失敗しました。"),h("書籍情報の取得に失敗しました。")}finally{o(!1)}},[r,e]),m=reactExports.useCallback(async E=>{if(!e||!r)throw new Error("ユーザーまたは書籍IDが無効です。");try{const A=doc(db,"books",r);return await updateDoc(A,{...E,updatedAt:serverTimestamp()}),s(C=>({...C,...E})),!0}catch(A){throw console.error("Error updating book:",A),n("書籍情報の更新に失敗しました。"),A}},[r,e]),g=reactExports.useCallback(async E=>await m({status:E}),[m]),_=reactExports.useCallback(async E=>await m({tags:E}),[m]);return reactExports.useEffect(()=>{f()},[f]),{book:i,loading:a,error:c,fetchBook:f,updateBook:m,updateBookStatus:g,updateBookTags:_}},convertToDate=r=>r&&typeof r.toDate=="function"?r.toDate():r instanceof Date?r:new Date(r),useBookStatusManager=(r,e,t)=>({handleAddManualHistory:reactExports.useCallback(async(i,s,a,o=[])=>{try{await e(i,s,a),logger.status.info("Manual history added successfully");const c=[...o],h={status:s,previousStatus:a,changedAt:i};c.push(h),c.sort((m,g)=>convertToDate(g.changedAt)-convertToDate(m.changedAt));const f=c.length>0&&convertToDate(c[0].changedAt).getTime()===convertToDate(i).getTime();if(!r)return;f&&s!==r.status&&await t(s)}catch(c){throw logger.status.error("Failed to add manual history",c),c}},[r,e,t])}),BookDetail=()=>{const{id:r}=useParams();useLocation();const{book:e,loading:t,error:n,updateBookStatus:i,updateBookTags:s}=useBook(r),{history:a,loading:o,error:c,addManualStatusHistory:h,getImportantDates:f,getReadingDuration:m}=useBookStatusHistory(r),{handleAddManualHistory:g}=useBookStatusManager(e,h,i),[_,E]=reactExports.useState(0),[A,C]=reactExports.useState(!1),[I,b]=reactExports.useState(0),R=X=>{i(X)},V=X=>{s(X)},U=()=>{E(X=>X+1),C(!1)},W=()=>{E(X=>X+1)},j=()=>{C(!0)},w=()=>{C(!1)},P=(X,Y)=>{b(Y)},K=()=>{switch(I){case 0:return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,sx:{mb:{xs:1,sm:2}},"data-testid":"memo-list-title",children:"メモ一覧"}),jsxRuntimeExports.jsx(MemoList,{bookId:e.id,onMemoUpdated:W},_)]});case 1:return jsxRuntimeExports.jsx(StatusHistoryTimeline,{history:a,loading:o,error:c,importantDates:f(),readingDuration:m(),showAddButton:!0,bookId:r,onAddHistory:g,currentBookStatus:e==null?void 0:e.status});default:return null}};return t?jsxRuntimeExports.jsx("div",{"data-testid":"book-detail-loading",children:"Loading..."}):n?(console.error("📖 BookDetail error:",n),jsxRuntimeExports.jsxs("div",{"data-testid":"book-detail-error",children:["エラーが発生しました: ",n]})):e?jsxRuntimeExports.jsxs(Box,{sx:{maxWidth:800,mx:"auto",mt:{xs:2,sm:4},pb:"80px",px:{xs:2,sm:0}},"data-testid":"book-detail",children:[jsxRuntimeExports.jsxs(Paper,{sx:{p:{xs:2,sm:3}},children:[jsxRuntimeExports.jsx(BookInfo,{book:e,bookId:r,onStatusChange:R}),jsxRuntimeExports.jsx(LatestStatusHistory,{bookId:r}),jsxRuntimeExports.jsx(BookTagEditor,{book:e,bookId:r,onTagsChange:V}),jsxRuntimeExports.jsx(Divider,{sx:{my:{xs:1,sm:2}}}),jsxRuntimeExports.jsx(Box,{sx:{borderBottom:1,borderColor:"divider",mb:2},children:jsxRuntimeExports.jsxs(Tabs,{value:I,onChange:P,"aria-label":"book detail tabs","data-testid":"book-detail-tabs",children:[jsxRuntimeExports.jsx(Tab,{label:"メモ一覧","data-testid":"memo-list-tab"}),jsxRuntimeExports.jsx(Tab,{label:"ステータス履歴","data-testid":"status-history-tab"})]})}),K()]}),jsxRuntimeExports.jsx(Fab,{color:"primary","aria-label":"メモを追加",sx:{position:"fixed",bottom:{xs:72,sm:16},right:{xs:16,sm:16}},onClick:j,"data-testid":"memo-add-fab",children:jsxRuntimeExports.jsx(AddIcon,{})}),jsxRuntimeExports.jsx(Dialog,{open:A,onClose:w,maxWidth:"sm",fullWidth:!0,"data-testid":"memo-add-dialog",children:jsxRuntimeExports.jsx(MemoAdd,{bookId:e.id,bookTags:e.tags||[],onMemoAdded:U,onClose:w})})]}):(console.warn("📖 BookDetail: Book not found for ID:",r),jsxRuntimeExports.jsx("div",{"data-testid":"book-detail-not-found",children:"本が見つかりません。"}))};function TabPanel({children:r,value:e,index:t,...n}){return jsxRuntimeExports.jsx("div",{role:"tabpanel",hidden:e!==t,id:`tabpanel-${t}`,"aria-labelledby":`tab-${t}`,...n,children:e===t&&jsxRuntimeExports.jsx(Box,{sx:{p:3},children:r})})}const useTagStats=r=>{const[e,t]=reactExports.useState({}),[n,i]=reactExports.useState(!1),[s,a]=reactExports.useState(null),o=reactExports.useCallback(async()=>{if(r!=null&&r.uid)try{i(!0),a(null),console.log("useTagStats: タグ統計取得開始, userId:",r.uid);const[m,g]=await Promise.all([getDocs(query(collection(db,"books"),where("userId","==",r.uid))),getDocs(query(collectionGroup(db,"memos"),where("userId","==",r.uid)))]);console.log("useTagStats: データ取得完了, 本:",m.size,"メモ:",g.size);const _={};m.forEach(E=>{const A=E.data();console.log("useTagStats: 本データ:",{id:E.id,title:A.title,tags:A.tags}),A.tags&&Array.isArray(A.tags)&&A.tags.forEach(C=>{var b,R;_[C]||(_[C]={bookCount:0,memoCount:0,lastUsed:null}),_[C].bookCount++;const I=((R=(b=A.updatedAt)==null?void 0:b.toDate)==null?void 0:R.call(b))||new Date;(!_[C].lastUsed||I>_[C].lastUsed)&&(_[C].lastUsed=I)})}),console.log("useTagStats: 本のタグ集計完了"),g.forEach(E=>{var C,I;const A=E.data();console.log("useTagStats: メモデータ:",{id:E.id,bookId:(C=E.ref.parent.parent)==null?void 0:C.id,tags:A.tags,text:((I=A.text)==null?void 0:I.substring(0,30))+"..."}),A.tags&&Array.isArray(A.tags)&&A.tags.forEach(b=>{var V,U;_[b]||(_[b]={bookCount:0,memoCount:0,lastUsed:null}),_[b].memoCount++;const R=((U=(V=A.updatedAt)==null?void 0:V.toDate)==null?void 0:U.call(V))||new Date;(!_[b].lastUsed||R>_[b].lastUsed)&&(_[b].lastUsed=R)})}),console.log("useTagStats: メモのタグ集計完了, 最終統計:",_),t(_),console.log("useTagStats: タグ統計設定完了")}catch(m){console.error("タグ統計の取得に失敗しました:",m),a(m)}finally{i(!1)}},[r==null?void 0:r.uid]),c=reactExports.useCallback((m="count",g="desc")=>Object.entries(e).map(([E,A])=>({tag:E,...A,totalCount:A.bookCount+A.memoCount,type:A.bookCount>0&&A.memoCount>0?"both":A.bookCount>0?"book":"memo"})).sort((E,A)=>{let C=0;switch(m){case"count":C=A.totalCount-E.totalCount;break;case"name":C=E.tag.localeCompare(A.tag,"ja");break;case"lastUsed":C=(A.lastUsed||0)-(E.lastUsed||0);break;default:C=A.totalCount-E.totalCount}return g==="asc"?-C:C}),[e]),h=reactExports.useCallback(m=>e[m]||null,[e]),f=reactExports.useCallback(()=>{t({}),a(null)},[]);return reactExports.useEffect(()=>{r!=null&&r.uid?o():f()},[r==null?void 0:r.uid,o,f]),{tagStats:e,loading:n,error:s,fetchTagStats:o,getSortedTagStats:c,getTagStat:h,clearStats:f}};function normalizeTag(r){var e,t;if(r==null)return"";try{return(((t=(e=String(r)).normalize)==null?void 0:t.call(e,"NFKC"))??String(r)).trim().replace(/\s+/g," ").toLowerCase()}catch{return String(r).trim().toLowerCase()}}function useTagManagement(){const{user:r}=useAuth(),e=reactExports.useContext(ErrorDialogContext),t=(e==null?void 0:e.setGlobalError)||(()=>{}),[n,i]=reactExports.useState(!1),s=async(f,m)=>{for(let _=0;_<f.length;_+=450){const E=f.slice(_,_+450),A=writeBatch(db);E.forEach(C=>m(A,C)),await A.commit()}},a=reactExports.useCallback(async(f,m)=>{if(!(r!=null&&r.uid))throw new Error("ユーザーが未認証です。");const g=normalizeTag(f),_=normalizeTag(m);if(!g||!_)throw new Error("タグ名が不正です。");if(g===_)return{booksUpdated:0,memosUpdated:0};i(!0);try{const E=query(collection(db,"books"),where("userId","==",r.uid)),A=await getDocs(E),C=[];A.forEach(V=>{const U=V.data(),W=Array.isArray(U.tags)?U.tags:[];if(W.includes(g)){const j=Array.from(new Set(W.map(w=>w===g?_:w)));C.push({ref:V.ref,tags:j})}});const I=query(collectionGroup(db,"memos"),where("userId","==",r.uid)),b=await getDocs(I),R=[];return b.forEach(V=>{const U=V.data(),W=Array.isArray(U.tags)?U.tags:[];if(W.includes(g)){const j=Array.from(new Set(W.map(w=>w===g?_:w)));R.push({ref:V.ref,tags:j})}}),await s(C,(V,U)=>{V.update(U.ref,{tags:U.tags})}),await s(R,(V,U)=>{V.update(U.ref,{tags:U.tags})}),{booksUpdated:C.length,memosUpdated:R.length}}catch(E){throw console.error("タグ名変更に失敗:",E),t("タグ名の変更に失敗しました。"),E}finally{i(!1)}},[r==null?void 0:r.uid]),o=reactExports.useCallback(async f=>{if(!(r!=null&&r.uid))throw new Error("ユーザーが未認証です。");const m=normalizeTag(f);if(!m)throw new Error("タグ名が不正です。");i(!0);try{const g=query(collection(db,"books"),where("userId","==",r.uid)),_=await getDocs(g),E=[];_.forEach(b=>{const R=b.data(),V=Array.isArray(R.tags)?R.tags:[];if(V.includes(m)){const U=V.filter(W=>W!==m);E.push({ref:b.ref,tags:U})}});const A=query(collectionGroup(db,"memos"),where("userId","==",r.uid)),C=await getDocs(A),I=[];return C.forEach(b=>{const R=b.data(),V=Array.isArray(R.tags)?R.tags:[];if(V.includes(m)){const U=V.filter(W=>W!==m);I.push({ref:b.ref,tags:U})}}),await s(E,(b,R)=>{b.update(R.ref,{tags:R.tags})}),await s(I,(b,R)=>{b.update(R.ref,{tags:R.tags})}),{booksUpdated:E.length,memosUpdated:I.length}}catch(g){throw console.error("タグ削除に失敗:",g),t("タグの削除に失敗しました。"),g}finally{i(!1)}},[r==null?void 0:r.uid]),c=reactExports.useCallback(async f=>{if(!(r!=null&&r.uid))throw new Error("ユーザーが未認証です。");const m=new Set((Array.isArray(f)?f:String(f||"").split(",")).map(g=>normalizeTag(g)).filter(g=>!!g));if(m.size===0)throw new Error("削除対象のタグがありません。");i(!0);try{const g=query(collection(db,"books"),where("userId","==",r.uid)),_=await getDocs(g),E=[];_.forEach(b=>{const R=b.data(),V=Array.isArray(R.tags)?R.tags:[],U=V.filter(W=>!m.has(normalizeTag(W)));U.length!==V.length&&E.push({ref:b.ref,tags:U})});const A=query(collectionGroup(db,"memos"),where("userId","==",r.uid)),C=await getDocs(A),I=[];return C.forEach(b=>{const R=b.data(),V=Array.isArray(R.tags)?R.tags:[],U=V.filter(W=>!m.has(normalizeTag(W)));U.length!==V.length&&I.push({ref:b.ref,tags:U})}),await s(E,(b,R)=>{b.update(R.ref,{tags:R.tags})}),await s(I,(b,R)=>{b.update(R.ref,{tags:R.tags})}),{booksUpdated:E.length,memosUpdated:I.length}}catch(g){throw console.error("タグ一括削除に失敗:",g),t("タグの一括削除に失敗しました。"),g}finally{i(!1)}},[r==null?void 0:r.uid]),h=reactExports.useCallback(async(f,m)=>{if(!(r!=null&&r.uid))throw new Error("ユーザーが未認証です。");const g=normalizeTag(m),_=Array.from(new Set(String(f||"").split(",").map(E=>normalizeTag(E)).filter(E=>!!E)));if(!g||_.length===0)throw new Error("統合先と別名を入力してください。");if(_.includes(g))throw new Error("統合先と別名が同一です。");i(!0);try{const E=query(collection(db,"books"),where("userId","==",r.uid)),A=await getDocs(E),C=[];A.forEach(V=>{const U=V.data(),W=Array.isArray(U.tags)?U.tags:[];if(W.some(w=>_.includes(w))){const w=W.filter(K=>!_.includes(K)),P=Array.from(new Set([...w,g]));P.join("|")!==W.join("|")&&C.push({ref:V.ref,tags:P})}});const I=query(collectionGroup(db,"memos"),where("userId","==",r.uid)),b=await getDocs(I),R=[];return b.forEach(V=>{const U=V.data(),W=Array.isArray(U.tags)?U.tags:[];if(W.some(w=>_.includes(w))){const w=W.filter(K=>!_.includes(K)),P=Array.from(new Set([...w,g]));P.join("|")!==W.join("|")&&R.push({ref:V.ref,tags:P})}}),await s(C,(V,U)=>{V.update(U.ref,{tags:U.tags})}),await s(R,(V,U)=>{V.update(U.ref,{tags:U.tags})}),{booksUpdated:C.length,memosUpdated:R.length}}catch(E){throw console.error("タグ統合に失敗:",E),t("タグの統合に失敗しました。"),E}finally{i(!1)}},[r==null?void 0:r.uid]);return{loading:n,renameTag:a,deleteTag:o,deleteTags:c,mergeTags:h}}function TagEditDialog({open:r,tag:e,onClose:t,onRename:n,onDelete:i,onMerge:s,busy:a=!1}){const[o,c]=reactExports.useState(e||""),[h,f]=reactExports.useState(""),[m,g]=reactExports.useState(""),_=()=>{c(e||""),t==null||t()};return jsxRuntimeExports.jsxs(Dialog,{open:r,onClose:_,maxWidth:"xs",fullWidth:!0,children:[jsxRuntimeExports.jsx(DialogTitle,{children:"タグを編集"}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"タグ名の変更またはタグの削除を行えます。"}),jsxRuntimeExports.jsx(TextField,{autoFocus:!0,fullWidth:!0,label:"新しいタグ名",value:o,onChange:E=>c(E.target.value),disabled:a}),jsxRuntimeExports.jsxs(Box,{sx:{mt:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mb:1},children:"類似タグの統合（カンマ区切りで別名を指定）"}),jsxRuntimeExports.jsx(TextField,{fullWidth:!0,label:"統合先（正規化タグ名）",value:h,onChange:E=>f(E.target.value),disabled:a}),jsxRuntimeExports.jsx(TextField,{fullWidth:!0,label:"別名（カンマ区切り）",value:m,onChange:E=>g(E.target.value),disabled:a,sx:{mt:1}})]})]}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:()=>i==null?void 0:i(e),color:"error",disabled:a,"data-testid":"tag-delete-button",children:"削除"}),jsxRuntimeExports.jsx(Button,{onClick:_,disabled:a,children:"キャンセル"}),jsxRuntimeExports.jsx(Button,{onClick:()=>n==null?void 0:n(e,o),variant:"contained",disabled:a,"data-testid":"tag-rename-button",children:"変更"}),jsxRuntimeExports.jsx(Button,{onClick:()=>s==null?void 0:s(m,h),variant:"outlined",disabled:a,"data-testid":"tag-merge-button",children:"統合"})]})]})}function BulkDeleteTagsDialog({open:r,onClose:e,onConfirm:t,busy:n=!1}){const{user:i}=useAuth(),{tagOptions:s,fetchTagHistory:a}=useTagHistory("book",i),{tagOptions:o,fetchTagHistory:c}=useTagHistory("memo",i),[h,f]=reactExports.useState([]),[m,g]=reactExports.useState("");reactExports.useEffect(()=>{r&&i&&(a(),c())},[r,i,a,c]),reactExports.useEffect(()=>{r||(f([]),g(""))},[r]);const _=reactExports.useMemo(()=>{const E=new Set([...s||[],...o||[]]);return Array.from(E).sort((A,C)=>A.localeCompare(C,"ja"))},[s,o]);return jsxRuntimeExports.jsxs(Dialog,{open:r,onClose:e,maxWidth:"sm",fullWidth:!0,children:[jsxRuntimeExports.jsx(DialogTitle,{children:"タグを一括削除"}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"削除するタグを選択または入力してください。複数選択できます。"}),jsxRuntimeExports.jsx(Autocomplete,{multiple:!0,freeSolo:!0,options:_,value:h,inputValue:m,onInputChange:(E,A)=>g(A),onChange:(E,A)=>f(A),renderTags:(E,A)=>E.map((C,I)=>{const{key:b,...R}=A({index:I});return jsxRuntimeExports.jsx(Chip,{label:C,...R,color:"error",variant:"outlined"},b)}),renderInput:E=>jsxRuntimeExports.jsx(TextField,{...E,label:"削除タグ",placeholder:"タグ名を入力...",fullWidth:!0,"data-testid":"bulk-delete-tags-input"}),"data-testid":"bulk-delete-tags-autocomplete"}),!!h.length&&jsxRuntimeExports.jsx(Box,{sx:{mt:1},children:jsxRuntimeExports.jsxs(Typography,{variant:"caption",color:"text.secondary",children:["削除対象: ",h.join(", ")]})})]}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:e,disabled:n,children:"キャンセル"}),jsxRuntimeExports.jsx(Button,{onClick:()=>t==null?void 0:t(h),color:"error",variant:"contained",disabled:n||h.length===0,"data-testid":"bulk-delete-confirm",children:"削除"})]})]})}function BulkMergeTagsDialog({open:r,onClose:e,onConfirm:t,busy:n=!1}){const{user:i}=useAuth(),{tagOptions:s,fetchTagHistory:a}=useTagHistory("book",i),{tagOptions:o,fetchTagHistory:c}=useTagHistory("memo",i),[h,f]=reactExports.useState(""),[m,g]=reactExports.useState([]),[_,E]=reactExports.useState("");reactExports.useEffect(()=>{r&&i&&(a(),c())},[r,i,a,c]),reactExports.useEffect(()=>{r||(f(""),g([]),E(""))},[r]);const A=reactExports.useMemo(()=>{const I=new Set([...s||[],...o||[]]);return Array.from(I).sort((b,R)=>b.localeCompare(R,"ja"))},[s,o]),C=h.trim().length>0&&m.length>0;return jsxRuntimeExports.jsxs(Dialog,{open:r,onClose:e,maxWidth:"sm",fullWidth:!0,children:[jsxRuntimeExports.jsx(DialogTitle,{children:"タグを一括統合"}),jsxRuntimeExports.jsxs(DialogContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"複数の別名タグを正規タグへ統合します。正規タグと、統合したい別名タグを選択してください。"}),jsxRuntimeExports.jsxs(Box,{sx:{mb:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle2",sx:{mb:1},children:"正規タグ"}),jsxRuntimeExports.jsx(Autocomplete,{freeSolo:!0,options:A,value:h,inputValue:_,onInputChange:(I,b)=>E(b),onChange:(I,b)=>f(b||_),renderInput:I=>jsxRuntimeExports.jsx(TextField,{...I,label:"正規タグ",placeholder:"統合先のタグ名",fullWidth:!0}),"data-testid":"bulk-merge-canonical"})]}),jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle2",sx:{mb:1},children:"別名タグ（複数可）"}),jsxRuntimeExports.jsx(Autocomplete,{multiple:!0,freeSolo:!0,options:A,value:m,onChange:(I,b)=>g(b),renderTags:(I,b)=>I.map((R,V)=>{const{key:U,...W}=b({index:V});return jsxRuntimeExports.jsx(Chip,{label:R,...W,color:"primary",variant:"outlined"},U)}),renderInput:I=>jsxRuntimeExports.jsx(TextField,{...I,label:"別名タグ",placeholder:"統合したい別名を入力...",fullWidth:!0}),"data-testid":"bulk-merge-aliases"})]})]}),jsxRuntimeExports.jsxs(DialogActions,{children:[jsxRuntimeExports.jsx(Button,{onClick:e,disabled:n,children:"キャンセル"}),jsxRuntimeExports.jsx(Button,{onClick:()=>t==null?void 0:t(m,h||_),variant:"contained",disabled:n||!C,"data-testid":"bulk-merge-confirm",children:"統合"})]})]})}function TagStats({onTagClick:r}){const{user:e}=useAuth(),{tagStats:t,loading:n,error:i,getSortedTagStats:s,fetchTagStats:a}=useTagStats(e),{loading:o,renameTag:c,deleteTag:h,deleteTags:f,mergeTags:m}=useTagManagement(),[g,_]=reactExports.useState("count"),[E,A]=reactExports.useState("desc"),[C,I]=reactExports.useState(!1),[b,R]=reactExports.useState(""),[V,U]=reactExports.useState(!1),[W,j]=reactExports.useState(!1),w=s(g,E),P=Object.keys(t).length,K=Object.values(t).reduce((Y,Z)=>Y+Z.bookCount,0),X=Object.values(t).reduce((Y,Z)=>Y+Z.memoCount,0);return n?jsxRuntimeExports.jsx(Box,{sx:{display:"flex",justifyContent:"center",p:3},children:jsxRuntimeExports.jsx(CircularProgress,{})}):i?jsxRuntimeExports.jsx(Box,{sx:{p:2},children:jsxRuntimeExports.jsxs(Alert,{severity:"error",children:["タグ統計の取得に失敗しました: ",i.message]})}):P===0?jsxRuntimeExports.jsx(Box,{sx:{p:3},children:jsxRuntimeExports.jsx(Alert,{severity:"info",children:"タグがまだ登録されていません。本にタグを追加すると、ここに統計が表示されます。"})}):jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsxs(Paper,{sx:{p:2,mb:3},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",gutterBottom:!0,children:"タグ統計サマリー"}),jsxRuntimeExports.jsxs(Box,{sx:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:2},children:[jsxRuntimeExports.jsxs(Box,{sx:{textAlign:"center"},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",color:"primary",children:P}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"総タグ数"})]}),jsxRuntimeExports.jsxs(Box,{sx:{textAlign:"center"},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",color:"secondary",children:K}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"本の総件数"})]}),jsxRuntimeExports.jsxs(Box,{sx:{textAlign:"center"},children:[jsxRuntimeExports.jsx(Typography,{variant:"h4",color:"info.main",children:X}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"メモの総件数"})]})]})]}),jsxRuntimeExports.jsxs(Box,{sx:{mb:2,display:"flex",gap:2,alignItems:"center",flexWrap:"wrap"},children:[jsxRuntimeExports.jsxs(Typography,{variant:"h6",children:["タグ一覧 (",P,"件)"]}),jsxRuntimeExports.jsx(Chip,{label:"一括削除",size:"small",color:"error",variant:"outlined",onClick:()=>U(!0),"data-testid":"open-bulk-delete"}),jsxRuntimeExports.jsx(Chip,{label:"一括統合",size:"small",color:"primary",variant:"outlined",onClick:()=>j(!0),"data-testid":"open-bulk-merge"}),jsxRuntimeExports.jsxs(FormControl,{size:"small",sx:{minWidth:120},children:[jsxRuntimeExports.jsx(InputLabel,{children:"ソート基準"}),jsxRuntimeExports.jsxs(Select,{value:g,label:"ソート基準",onChange:Y=>_(Y.target.value),children:[jsxRuntimeExports.jsx(MenuItem,{value:"count",children:"使用頻度"}),jsxRuntimeExports.jsx(MenuItem,{value:"name",children:"名前順"}),jsxRuntimeExports.jsx(MenuItem,{value:"lastUsed",children:"最終使用日"})]})]}),jsxRuntimeExports.jsxs(FormControl,{size:"small",sx:{minWidth:100},children:[jsxRuntimeExports.jsx(InputLabel,{children:"順序"}),jsxRuntimeExports.jsxs(Select,{value:E,label:"順序",onChange:Y=>A(Y.target.value),children:[jsxRuntimeExports.jsx(MenuItem,{value:"desc",children:"降順"}),jsxRuntimeExports.jsx(MenuItem,{value:"asc",children:"昇順"})]})]})]}),jsxRuntimeExports.jsx(Box,{className:"tag-stats-grid",children:w.map(Y=>jsxRuntimeExports.jsx(Card,{"data-testid":`tag-stat-card-${Y.tag}`,onClick:()=>r==null?void 0:r(Y.tag),className:"tag-stat-card",children:jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",component:"div",sx:{wordBreak:"break-all"},children:Y.tag}),jsxRuntimeExports.jsx(Chip,{label:Y.type,size:"small",color:Y.type==="both"?"primary":Y.type==="book"?"secondary":"info",variant:"outlined"})]}),jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"text.secondary",children:["本: ",Y.bookCount,"件"]}),jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"text.secondary",children:["メモ: ",Y.memoCount,"件"]})]}),jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"primary",sx:{fontWeight:"bold"},children:["合計: ",Y.totalCount,"件"]}),jsxRuntimeExports.jsx(Box,{sx:{display:"flex",gap:1},children:jsxRuntimeExports.jsx(Chip,{size:"small",label:"編集",onClick:Z=>{Z.stopPropagation(),R(Y.tag),I(!0)},clickable:!0,color:"primary",variant:"outlined","data-testid":`tag-edit-${Y.tag}`})})]}),Y.lastUsed&&jsxRuntimeExports.jsxs(Typography,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:1},children:["最終使用: ",Y.lastUsed.toLocaleDateString("ja-JP")]})]})},Y.tag))}),jsxRuntimeExports.jsx(TagEditDialog,{open:C,tag:b,busy:o,onClose:()=>I(!1),onRename:async(Y,Z)=>{await c(Y,Z),await a(),I(!1)},onDelete:async Y=>{await h(Y),await a(),I(!1)},onMerge:async(Y,Z)=>{await m(Y,Z),await a(),I(!1)}}),jsxRuntimeExports.jsx(BulkDeleteTagsDialog,{open:V,onClose:()=>U(!1),busy:o,onConfirm:async Y=>{!Y||Y.length===0||(await f(Y),await a(),U(!1))}}),jsxRuntimeExports.jsx(BulkMergeTagsDialog,{open:W,onClose:()=>j(!1),busy:o,onConfirm:async(Y,Z)=>{!Y||Y.length===0||!Z||(await m(Y.join(","),Z),await a(),j(!1))}})]})}function DateRangeSelector({value:r,onChange:e}){const[t,n]=reactExports.useState((r==null?void 0:r.type)||"none"),[i,s]=reactExports.useState((r==null?void 0:r.year)||new Date().getFullYear()),[a,o]=reactExports.useState((r==null?void 0:r.month)||1),[c,h]=reactExports.useState((r==null?void 0:r.quarter)||1),[f,m]=reactExports.useState((r==null?void 0:r.startDate)||""),[g,_]=reactExports.useState((r==null?void 0:r.endDate)||""),E=V=>{const U=V.target.value;n(U);let W={type:U};switch(U){case"year":W.year=i;break;case"month":W.year=i,W.month=a;break;case"quarter":W.year=i,W.quarter=c;break;case"custom":W.startDate=f,W.endDate=g;break}e==null||e(W)},A=V=>{const U=V.target.value;s(U),e==null||e({...r,year:U})},C=V=>{const U=V.target.value;o(U),e==null||e({...r,month:U})},I=V=>{const U=V.target.value;h(U),e==null||e({...r,quarter:U})},b=V=>{const U=V.target.value;m(U),e==null||e({...r,startDate:U})},R=V=>{const U=V.target.value;_(U),e==null||e({...r,endDate:U})};return jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle2",gutterBottom:!0,children:"読了日時"}),jsxRuntimeExports.jsxs(Paper,{sx:{p:2},children:[jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,margin:"normal",children:[jsxRuntimeExports.jsx(InputLabel,{children:"日時範囲"}),jsxRuntimeExports.jsxs(Select,{value:t,onChange:E,label:"日時範囲","data-testid":"date-range-type-select",children:[jsxRuntimeExports.jsx(MenuItem,{value:"none",children:"指定なし"}),jsxRuntimeExports.jsx(MenuItem,{value:"year",children:"年別"}),jsxRuntimeExports.jsx(MenuItem,{value:"month",children:"年月別"}),jsxRuntimeExports.jsx(MenuItem,{value:"quarter",children:"四半期別"}),jsxRuntimeExports.jsx(MenuItem,{value:"custom",children:"カスタム期間"})]})]}),(t==="year"||t==="month"||t==="quarter")&&jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,margin:"normal",children:[jsxRuntimeExports.jsx(InputLabel,{children:"年"}),jsxRuntimeExports.jsx(Select,{value:i,onChange:A,label:"年","data-testid":"year-select",children:Array.from({length:10},(V,U)=>new Date().getFullYear()-U).map(V=>jsxRuntimeExports.jsxs(MenuItem,{value:V,children:[V,"年"]},V))})]}),t==="month"&&jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,margin:"normal",children:[jsxRuntimeExports.jsx(InputLabel,{children:"月"}),jsxRuntimeExports.jsx(Select,{value:a,onChange:C,label:"月","data-testid":"month-select",children:Array.from({length:12},(V,U)=>U+1).map(V=>jsxRuntimeExports.jsxs(MenuItem,{value:V,children:[V,"月"]},V))})]}),t==="quarter"&&jsxRuntimeExports.jsxs(FormControl,{fullWidth:!0,margin:"normal",children:[jsxRuntimeExports.jsx(InputLabel,{children:"四半期"}),jsxRuntimeExports.jsxs(Select,{value:c,onChange:I,label:"四半期","data-testid":"quarter-select",children:[jsxRuntimeExports.jsx(MenuItem,{value:1,children:"第1四半期（1-3月）"}),jsxRuntimeExports.jsx(MenuItem,{value:2,children:"第2四半期（4-6月）"}),jsxRuntimeExports.jsx(MenuItem,{value:3,children:"第3四半期（7-9月）"}),jsxRuntimeExports.jsx(MenuItem,{value:4,children:"第4四半期（10-12月）"})]})]}),t==="custom"&&jsxRuntimeExports.jsxs(Box,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:2,mt:1},"data-testid":"custom-date-range-grid",children:[jsxRuntimeExports.jsx(Box,{"data-testid":"start-date-grid-item",children:jsxRuntimeExports.jsx(TextField,{label:"開始日",type:"date",value:f,onChange:b,fullWidth:!0,InputLabelProps:{shrink:!0},inputProps:{"data-testid":"start-date-input"}})}),jsxRuntimeExports.jsx(Box,{"data-testid":"end-date-grid-item",children:jsxRuntimeExports.jsx(TextField,{label:"終了日",type:"date",value:g,onChange:R,fullWidth:!0,InputLabelProps:{shrink:!0},inputProps:{"data-testid":"end-date-input"}})})]}),t!=="none"&&jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"text.secondary",sx:{mt:1},children:[t==="year"&&`${i}年に読了した本を検索します`,t==="month"&&`${i}年${a}月に読了した本を検索します`,t==="quarter"&&`${i}年第${c}四半期に読了した本を検索します`,t==="custom"&&"指定した期間に読了した本を検索します"]})]})]})}function TagSearchField({selectedTags:r=[],onTagsChange:e,type:t="book"}){const{user:n}=useAuth(),{tagOptions:i,loading:s,fetchTagHistory:a}=useTagHistory(t,n),[o,c]=reactExports.useState("");reactExports.useEffect(()=>{n&&a()},[n,a]);const h=(g,_)=>{if(_&&!r.includes(_)){const E=[...r,_];e==null||e(E),c("")}},f=g=>{const _=r.filter(E=>E!==g);e==null||e(_)},m=(g,_)=>{c(_)};return jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle2",gutterBottom:!0,children:"タグ検索"}),jsxRuntimeExports.jsxs(Paper,{sx:{p:2},children:[jsxRuntimeExports.jsx(Autocomplete,{freeSolo:!0,multiple:!0,options:i||[],value:r,inputValue:o,onInputChange:m,onChange:h,renderTags:(g,_)=>g.map((E,A)=>{const{key:C,...I}=_({index:A});return jsxRuntimeExports.jsx(Chip,{label:E,...I,onDelete:()=>f(E),color:"primary",variant:"outlined","data-testid":`selected-tag-${E}`},C)}),renderInput:g=>jsxRuntimeExports.jsx(TextField,{...g,label:"タグを選択または入力",placeholder:"タグを入力...",fullWidth:!0,"data-testid":"tag-search-input"}),loading:s,noOptionsText:"タグが見つかりません","data-testid":"tag-autocomplete"}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mt:1},children:r.length>0?`選択されたタグ: ${r.join(", ")}`:"タグを選択すると、そのタグを持つ本やメモを検索できます"})]})]})}function AdvancedSearchForm({searchConditions:r,onSearchConditionsChange:e,onSearch:t}){const[n,i]=reactExports.useState(FILTER_STATUSES.ALL),s=f=>{e==null||e({...r,text:f.target.value})},a=(f,m)=>{i(m),e==null||e({...r,status:m})},o=f=>{e==null||e({...r,dateRange:f})},c=f=>{e==null||e({...r,selectedTags:f})},h=()=>{t==null||t(r)};return jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",gutterBottom:!0,children:"検索条件"}),jsxRuntimeExports.jsxs(Paper,{sx:{p:2,mb:2},children:[jsxRuntimeExports.jsx(TextField,{label:"テキスト検索（タイトル・著者・メモ内容・タグ）",value:(r==null?void 0:r.text)||"",onChange:s,fullWidth:!0,margin:"normal",placeholder:"検索したいキーワードを入力","data-testid":"text-search-field"}),jsxRuntimeExports.jsxs(Box,{sx:{mt:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle2",gutterBottom:!0,children:"ステータス"}),jsxRuntimeExports.jsx(Box,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:Object.values(FILTER_STATUSES).map(f=>jsxRuntimeExports.jsx(Button,{variant:n===f?"contained":"outlined",size:"small",onClick:()=>a(null,f),"data-testid":`status-filter-${f}`,children:FILTER_LABELS[f]},f))})]}),jsxRuntimeExports.jsx(Box,{sx:{mt:2},children:jsxRuntimeExports.jsx(DateRangeSelector,{dateRange:(r==null?void 0:r.dateRange)||{type:"none"},onDateRangeChange:o})}),jsxRuntimeExports.jsx(Box,{sx:{mt:2},children:jsxRuntimeExports.jsx(TagSearchField,{selectedTags:(r==null?void 0:r.selectedTags)||[],onTagsChange:c,type:"book"})})]}),jsxRuntimeExports.jsx(Box,{sx:{display:"flex",justifyContent:"center"},children:jsxRuntimeExports.jsx(Button,{variant:"contained",onClick:h,"data-testid":"search-button",children:"検索実行"})})]})}function SearchResults({results:r=[],loading:e=!1,searchQuery:t="",onResultClick:n}){const{user:i}=useAuth();if(e)return jsxRuntimeExports.jsx(Box,{sx:{display:"flex",justifyContent:"center",p:4},children:jsxRuntimeExports.jsx(CircularProgress,{})});if(!r||r.length===0)return jsxRuntimeExports.jsx(Box,{sx:{p:3},children:jsxRuntimeExports.jsx(Alert,{severity:"info",children:t?`「${t}」に一致する結果が見つかりませんでした。`:"検索条件を設定して検索を実行してください。"})});const s=r.filter(h=>h.type==="book"),a=r.filter(h=>h.type==="memo"),o=h=>jsxRuntimeExports.jsx(Card,{sx:{cursor:"pointer","&:hover":{boxShadow:3},height:"100%",display:"flex",flexDirection:"column",border:"2px solid",borderColor:"purple.300",backgroundColor:"purple.50"},onClick:()=>n==null?void 0:n("memo",h.bookId,h.id),"data-testid":`memo-result-${h.id}`,children:jsxRuntimeExports.jsxs(CardContent,{sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[jsxRuntimeExports.jsx(Box,{sx:{mb:2},children:jsxRuntimeExports.jsxs(Typography,{variant:"h6",component:"h3",gutterBottom:!0,sx:{fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:[jsxRuntimeExports.jsx("span",{children:"📝"}),jsxRuntimeExports.jsxs("span",{children:[h.bookTitle||"メモ"," - ページ",h.page||"未設定"]})]})}),h.text&&jsxRuntimeExports.jsx(Box,{sx:{mb:2,flexGrow:1},children:jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{backgroundColor:"grey.50",p:1,borderRadius:1,border:"1px solid",borderColor:"grey.200",fontStyle:"italic"},children:h.text.length>120?`${h.text.substring(0,120)}...`:h.text})}),h.comment&&jsxRuntimeExports.jsx(Box,{sx:{mb:2},children:jsxRuntimeExports.jsxs(Typography,{variant:"body2",sx:{backgroundColor:"primary.50",p:1,borderRadius:1,border:"1px solid",borderColor:"primary.200"},children:["💭 ",h.comment.length>100?`${h.comment.substring(0,100)}...`:h.comment]})}),h.tags&&h.tags.length>0&&jsxRuntimeExports.jsx(Box,{sx:{mb:2},children:jsxRuntimeExports.jsx(Box,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:h.tags.map((f,m)=>jsxRuntimeExports.jsx(Chip,{label:f,size:"small",variant:"outlined",sx:{fontSize:"0.75rem"}},m))})}),jsxRuntimeExports.jsx(Box,{sx:{mt:"auto"},children:jsxRuntimeExports.jsxs(Typography,{variant:"caption",color:"text.secondary",children:["作成日: ",h.createdAt?new Date(h.createdAt.toDate()).toLocaleDateString("ja-JP"):"不明"]})})]})},h.id),c=h=>jsxRuntimeExports.jsx(Card,{sx:{cursor:"pointer","&:hover":{boxShadow:3},height:"100%",display:"flex",flexDirection:"column",border:"2px solid",borderColor:"blue.300",backgroundColor:"blue.50"},onClick:()=>n==null?void 0:n("book",h.id),"data-testid":`book-result-${h.id}`,children:jsxRuntimeExports.jsxs(CardContent,{sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[jsxRuntimeExports.jsx(Box,{sx:{mb:2},children:jsxRuntimeExports.jsxs(Typography,{variant:"h6",component:"h3",gutterBottom:!0,sx:{fontWeight:"bold",display:"flex",alignItems:"center",gap:1},children:[jsxRuntimeExports.jsx("span",{children:"📚"}),jsxRuntimeExports.jsx("span",{children:h.title})]})}),jsxRuntimeExports.jsxs(Box,{sx:{mb:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mb:1},children:h.author||"著者不明"}),jsxRuntimeExports.jsx(Chip,{label:getBookStatusLabel(h.status),size:"small",color:getBookStatusColor(h.status),sx:{fontSize:"0.75rem"}})]}),h.tags&&h.tags.length>0&&jsxRuntimeExports.jsx(Box,{sx:{mb:2},children:jsxRuntimeExports.jsx(Box,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:h.tags.map((f,m)=>jsxRuntimeExports.jsx(Chip,{label:f,size:"small",variant:"outlined",sx:{fontSize:"0.75rem"}},m))})}),jsxRuntimeExports.jsx(Box,{sx:{mt:"auto"},children:jsxRuntimeExports.jsxs(Typography,{variant:"caption",color:"text.secondary",children:["更新日: ",h.updatedAt?new Date(h.updatedAt.toDate()).toLocaleDateString("ja-JP"):"不明"]})})]})},h.id);return jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsxs(Box,{sx:{mb:3},children:[jsxRuntimeExports.jsxs(Typography,{variant:"h6",gutterBottom:!0,children:["検索結果 (",r.length,"件)"]}),jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"text.secondary",children:["📚 書籍: ",s.length,"件, 📝 メモ: ",a.length,"件"]})]}),jsxRuntimeExports.jsx(Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr",md:"repeat(3, 1fr)"},gap:2},children:r.map(h=>jsxRuntimeExports.jsx(Box,{children:h.type==="book"?c(h):o(h)},`${h.type}-${h.id}`))})]})}function getDateRangeFilter(r){const e=new Date;let t=null,n=null;if(!r||!r.type||r.type==="none")return{startDate:t,endDate:n};switch(r.type){case"year":r.year&&(t=new Date(r.year,0,1),n=new Date(r.year,11,31,23,59,59));break;case"month":r.year&&r.month&&(t=new Date(r.year,r.month-1,1),n=new Date(r.year,r.month,0,23,59,59));break;case"quarter":if(r.year&&r.quarter){const i=(r.quarter-1)*3;t=new Date(r.year,i,1),n=new Date(r.year,i+3,0,23,59,59)}break;case"custom":r.startDate&&(t=new Date(r.startDate)),r.endDate&&(n=new Date(r.endDate),n.setHours(23,59,59));break;case"recent":r.months&&(t=new Date(e.getFullYear(),e.getMonth()-r.months,e.getDate()),n=e);break}return{startDate:t,endDate:n}}function buildSearchQueries(r,e,t,n=50){if(!e)return[];const{status:i,dateRange:s,selectedTags:a}=t||{},o=[],c=[where("userId","==",e.uid)];if(i&&i!=="all"&&c.push(where("status","==",i)),s&&s.type!=="none"){const{startDate:m,endDate:g}=getDateRangeFilter(s);m&&c.push(where("updatedAt",">=",m)),g&&c.push(where("updatedAt","<=",g))}a&&a.length>0&&Array.isArray(a)&&!a.some(m=>Array.isArray(m))&&c.push(where("tags","array-contains-any",a));const h=query(collection(r,"books"),...c,orderBy("updatedAt","desc"),limit(n));o.push({type:"book",query:h});const f=query(collectionGroup(r,"memos"),where("userId","==",e.uid),limit(n*3));return o.push({type:"memo",query:f}),o}async function executeSearchQueries({db:r,user:e,queries:t,resultLimit:n=50}){var s,a;const i=[];for(const{type:o,query:c}of t)try{const h=await getDocs(c);if(o==="memo")for(const f of h.docs){const m=f.data(),g=(s=f.ref.parent.parent)==null?void 0:s.id;let _="メモ";if(g)try{const E=await getDocs(query(collection(r,"books"),where("__name__","==",g),where("userId","==",e.uid)));E.empty||(_=E.docs[0].data().title||"メモ")}catch{}i.push({id:f.id,type:o,bookId:g,bookTitle:_,...m})}else h.forEach(f=>{const m=f.data();i.push({id:f.id,type:o,...m})})}catch(h){const f=String((h==null?void 0:h.message)||"");if(h.code==="failed-precondition"||f.includes("index")||f.includes("array-contains-any"))if(o==="memo"){const m=query(collectionGroup(r,"memos"),where("userId","==",e.uid),limit(n*2)),g=await getDocs(m);for(const _ of g.docs){const E=_.data(),A=(a=_.ref.parent.parent)==null?void 0:a.id;let C="メモ";if(A)try{const I=await getDocs(query(collection(r,"books"),where("__name__","==",A),where("userId","==",e.uid)));I.empty||(C=I.docs[0].data().title||"メモ")}catch{}i.push({id:_.id,type:o,bookId:A,bookTitle:C,...E})}}else{const m=query(collection(r,"books"),where("userId","==",e.uid),limit(n*2));(await getDocs(m)).forEach(_=>{const E=_.data();i.push({id:_.id,type:o,...E})})}else throw h}return i}function filterByText(r,e){if(!e)return r;const t=String(e).toLowerCase();return(r||[]).filter(n=>n.type==="book"?n.title&&String(n.title).toLowerCase().includes(t)||n.author&&String(n.author).toLowerCase().includes(t)||n.tags&&Array.isArray(n.tags)&&n.tags.some(i=>String(i).toLowerCase().includes(t)):n.type==="memo"?n.text&&String(n.text).toLowerCase().includes(t)||n.comment&&String(n.comment).toLowerCase().includes(t)||n.tags&&Array.isArray(n.tags)&&n.tags.some(i=>String(i).toLowerCase().includes(t)):!1)}function filterByTags(r,e){if(!e||e.length===0)return r;const t=i=>{if(!Array.isArray(i))return[];const s=[],a=o=>{Array.isArray(o)?o.forEach(a):typeof o=="string"&&o.trim()&&s.push(o.toLowerCase().trim())};return i.forEach(a),s},n=t(e);return(r||[]).filter(i=>!i.tags||!Array.isArray(i.tags)?!1:t(i.tags).some(a=>n.includes(a)))}function filterByMemoContent(r,e){if(!e)return r;const t=String(e).toLowerCase();return(r||[]).filter(n=>n.text&&String(n.text).toLowerCase().includes(t)||n.comment&&String(n.comment).toLowerCase().includes(t))}function sortResults(r,e="updatedAt",t="desc"){const n=[...r||[]];return n.sort((i,s)=>{let a=i[e],o=s[e];return(e==="updatedAt"||e==="createdAt")&&(a=a!=null&&a.toDate?a.toDate():a?new Date(a):new Date(0),o=o!=null&&o.toDate?o.toDate():o?new Date(o):new Date(0)),typeof a=="string"&&typeof o=="string"&&(a=a.toLowerCase(),o=o.toLowerCase()),t==="asc"?a>o?1:-1:a<o?1:-1}),n}function processSearchResults(r,e={}){const{text:t,selectedTags:n,memoContent:i,sortBy:s="updatedAt",sortOrder:a="desc"}=e;let o=filterByText(r,t);if(n&&n.length>0&&(o=filterByTags(o,n)),i){const c=o.filter(f=>f.type==="book"),h=filterByMemoContent(o.filter(f=>f.type==="memo"),i);o=[...c,...h]}return sortResults(o,s,a)}function useSearch(r={}){const{user:e}=useAuth(),[t,n]=reactExports.useState([]),[i,s]=reactExports.useState(!1),[a,o]=reactExports.useState(null),{limit:c=50}=r,h=reactExports.useCallback(g=>buildSearchQueries(db,e,g,c),[e,c]),f=reactExports.useCallback(async g=>{if(!e){o("ユーザーが認証されていません");return}s(!0),o(null);try{console.log("検索条件:",g);const _=h(g),E=await executeSearchQueries({db,user:e,queries:_,resultLimit:c});console.log("全クエリ実行完了, 総結果数:",E.length),console.log("結果の内訳:",{books:E.filter(C=>C.type==="book").length,memos:E.filter(C=>C.type==="memo").length});const A=processSearchResults(E,g);n(A)}catch(_){console.error("検索エラー:",_),o("検索中にエラーが発生しました")}finally{s(!1)}},[e,h]),m=reactExports.useCallback(()=>{n([]),o(null)},[]);return{results:t,loading:i,error:a,executeSearch:f,clearResults:m}}function TagSearch(){const{user:r}=useAuth(),e=useNavigate(),[t,n]=reactExports.useState(0),[i,s]=reactExports.useState({text:"",status:"all",dateRange:{type:"none"},selectedTags:[],sortBy:"updatedAt",sortOrder:"desc"}),{results:a,loading:o,error:c,executeSearch:h,clearResults:f}=useSearch(),[m,g]=reactExports.useState(!1),[_,E]=reactExports.useState(null),[A,C]=reactExports.useState(null),I=(w,P)=>{n(P)},b=w=>{s(w)},R=w=>{console.log("検索実行:",w),h(w)},V=(w,P,K)=>{if(w==="book")e(`/book/${P}`);else if(w==="memo"){const X=(a||[]).find(Y=>Y.type==="memo"&&Y.id===K);X?(E(X),C(P),g(!0)):e(`/book/${P}?memo=${K}`)}},U=()=>{g(!1),E(null),C(null)},W=()=>{f(),s({text:"",status:"all",dateRange:{type:"none"},selectedTags:[],sortBy:"updatedAt",sortOrder:"desc"})},j=w=>{console.log("タグがクリックされました:",w);const P={...i,selectedTags:[w],text:""};s(P),n(0),h(P)};return r?jsxRuntimeExports.jsxs(Box,{sx:{maxWidth:1e3,mx:"auto",mb:4,pb:"56px"},children:[jsxRuntimeExports.jsx(PageHeader,{title:"検索・タグ",subtitle:"高度な検索とタグ管理"}),jsxRuntimeExports.jsxs(Box,{sx:{px:{xs:1.5,sm:2,md:0}},children:[jsxRuntimeExports.jsx(Box,{sx:{borderBottom:1,borderColor:"divider",mb:2,position:"sticky",top:0,zIndex:1100,backgroundColor:"background.paper"},"data-testid":"tag-search-tabs-container",style:{position:"sticky",top:0,zIndex:1100},children:jsxRuntimeExports.jsxs(Tabs,{value:t,onChange:I,centered:!0,"data-testid":"tag-search-tabs",children:[jsxRuntimeExports.jsx(Tab,{label:"高度な検索",id:"tag-search-tab-0","aria-controls":"tag-search-tabpanel-0","data-testid":"search-tab"}),jsxRuntimeExports.jsx(Tab,{label:"タグ管理",id:"tag-search-tab-1","aria-controls":"tag-search-tabpanel-1","data-testid":"tag-management-tab"})]})}),jsxRuntimeExports.jsx(TabPanel,{value:t,index:0,"data-testid":"search-tab-panel",children:jsxRuntimeExports.jsx(SearchTab,{searchConditions:i,onSearchConditionsChange:b,onSearch:R,results:a,loading:o,error:c,onResultClick:V,onClearSearch:W})}),jsxRuntimeExports.jsx(TabPanel,{value:t,index:1,"data-testid":"tag-management-tab-panel",children:jsxRuntimeExports.jsx(TagManagementTab,{onTagClick:j})}),jsxRuntimeExports.jsx(MemoEditor,{open:m,memo:_,bookId:A,onClose:U,onUpdate:U,onDelete:U})]})]}):jsxRuntimeExports.jsx(Box,{sx:{maxWidth:600,mx:"auto",mt:4,p:2},children:jsxRuntimeExports.jsx(Typography,{variant:"h6",color:"error",children:"ログインが必要です"})})}function SearchTab({searchConditions:r,onSearchConditionsChange:e,onSearch:t,results:n,loading:i,error:s,onResultClick:a,onClearSearch:o}){return jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"高度な検索"}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"タイトル・著者・タグ・メモ内容で絞り込みできます。"}),jsxRuntimeExports.jsx(AdvancedSearchForm,{searchConditions:r,onSearchConditionsChange:e,onSearch:t}),s&&jsxRuntimeExports.jsx(Box,{sx:{mt:2},children:jsxRuntimeExports.jsx(Alert,{severity:"error",children:s})}),(n.length>0||i)&&jsxRuntimeExports.jsx(Box,{sx:{mt:4},children:jsxRuntimeExports.jsx(SearchResults,{results:n,loading:i,searchQuery:r.text,onResultClick:a})}),n.length>0&&!i&&jsxRuntimeExports.jsx(Box,{sx:{mt:2,textAlign:"center"},children:jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"primary",sx:{cursor:"pointer",textDecoration:"underline"},onClick:o,children:"検索結果をクリア"})})]})}function TagManagementTab({onTagClick:r}){return jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Typography,{variant:"h5",gutterBottom:!0,children:"タグ管理"}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"統計を確認し、タグクリックで検索できます。"}),jsxRuntimeExports.jsx(TagStats,{onTagClick:r})]})}function incrementCount(r,e,t=1){if(!e)return;const n=r.get(e)||0;r.set(e,n+t)}function useStats(){const{user:r}=useAuth(),e=reactExports.useContext(ErrorDialogContext),t=(e==null?void 0:e.setGlobalError)||(()=>{}),[n,i]=reactExports.useState(!0),[s,a]=reactExports.useState(null),[o,c]=reactExports.useState([]),[h,f]=reactExports.useState([]);reactExports.useEffect(()=>{let R=!1;async function V(){if(!r){c([]),f([]),i(!1);return}i(!0),a(null);try{const U=query(collection(db,"books"),where("userId","==",r.uid)),j=(await getDocs(U)).docs.map(X=>({id:X.id,...X.data()})),w=query(collectionGroup(db,"memos"),where("userId","==",r.uid)),K=(await getDocs(w)).docs.map(X=>({id:X.id,...X.data()}));R||(c(j),f(K))}catch(U){console.error("Failed to load stats:",U),R||(a("統計情報の取得に失敗しました。"),t("統計情報の取得に失敗しました。"))}finally{R||i(!1)}}return V(),()=>{R=!0}},[r]);const m=reactExports.useMemo(()=>{const R=o.length,V=o.filter(w=>(w.status||DEFAULT_BOOK_STATUS)===BOOK_STATUS.TSUNDOKU).length,U=o.filter(w=>(w.status||DEFAULT_BOOK_STATUS)===BOOK_STATUS.READING).length,W=o.filter(w=>(w.status||DEFAULT_BOOK_STATUS)===BOOK_STATUS.RE_READING).length,j=o.filter(w=>(w.status||DEFAULT_BOOK_STATUS)===BOOK_STATUS.FINISHED).length;return{totalBooks:R,tsundokuBooks:V,readingBooks:U,reReadingBooks:W,finishedBooks:j}},[o]),g=reactExports.useMemo(()=>{const R=o.filter(j=>(j.status||DEFAULT_BOOK_STATUS)===BOOK_STATUS.TSUNDOKU).length,V=o.filter(j=>(j.status||DEFAULT_BOOK_STATUS)===BOOK_STATUS.READING).length,U=o.filter(j=>(j.status||DEFAULT_BOOK_STATUS)===BOOK_STATUS.RE_READING).length,W=o.filter(j=>(j.status||DEFAULT_BOOK_STATUS)===BOOK_STATUS.FINISHED).length;return{tsundoku:R,reading:V,reReading:U,finished:W}},[o]),_=reactExports.useMemo(()=>{const R=new Map,V=new Map;for(const j of o){const w=Array.isArray(j.tags)?j.tags:[];for(const P of w)incrementCount(R,String(P).trim())}for(const j of h){const w=Array.isArray(j.tags)?j.tags:[];for(const P of w)incrementCount(V,String(P).trim())}const U=new Set([...R.keys(),...V.keys()]),W=[];for(const j of U){const w=R.get(j)||0,P=V.get(j)||0;W.push({tag:j,bookCount:w,memoCount:P,totalCount:w+P})}return W.sort((j,w)=>w.totalCount-j.totalCount||j.tag.localeCompare(w.tag)),W},[o,h]),E=reactExports.useMemo(()=>{var W;const R=new Date,V=[],U=new Map;for(let j=11;j>=0;j-=1){const w=new Date(R.getFullYear(),R.getMonth()-j,1),P=`${w.getFullYear()}-${String(w.getMonth()+1).padStart(2,"0")}`;U.set(P,V.length),V.push({key:P,year:w.getFullYear(),month:w.getMonth()+1,count:0})}for(const j of o){const w=j.status||"reading",P=j.finishedAt||j.updatedAt||j.createdAt;if(!P||w!=="finished")continue;const K=typeof(P==null?void 0:P.toDate)=="function"?P.toDate():new Date(P);if(Number.isNaN((W=K==null?void 0:K.getTime)==null?void 0:W.call(K)))continue;const X=`${K.getFullYear()}-${String(K.getMonth()+1).padStart(2,"0")}`;if(!U.has(X))continue;const Y=U.get(X);V[Y].count+=1}return V},[o]),A=reactExports.useMemo(()=>{var W;const R=new Date,V=[],U=new Map;for(let j=11;j>=0;j-=1){const w=new Date(R.getFullYear(),R.getMonth()-j,1),P=`${w.getFullYear()}-${String(w.getMonth()+1).padStart(2,"0")}`;U.set(P,V.length),V.push({key:P,year:w.getFullYear(),month:w.getMonth()+1,count:0})}for(const j of o){const w=j.createdAt||j.updatedAt||j.finishedAt;if(!w)continue;const P=typeof(w==null?void 0:w.toDate)=="function"?w.toDate():new Date(w);if(Number.isNaN((W=P==null?void 0:P.getTime)==null?void 0:W.call(P)))continue;const K=`${P.getFullYear()}-${String(P.getMonth()+1).padStart(2,"0")}`;if(!U.has(K))continue;const X=U.get(K);V[X].count+=1}return V},[o]),C=reactExports.useMemo(()=>{var W;const R=new Date,V=[],U=new Map;for(let j=11;j>=0;j-=1){const w=new Date(R.getFullYear(),R.getMonth()-j,1),P=`${w.getFullYear()}-${String(w.getMonth()+1).padStart(2,"0")}`;U.set(P,V.length),V.push({key:P,year:w.getFullYear(),month:w.getMonth()+1,count:0})}for(const j of h){const w=j.createdAt||j.updatedAt;if(!w)continue;const P=typeof(w==null?void 0:w.toDate)=="function"?w.toDate():new Date(w);if(Number.isNaN((W=P==null?void 0:P.getTime)==null?void 0:W.call(P)))continue;const K=`${P.getFullYear()}-${String(P.getMonth()+1).padStart(2,"0")}`;if(!U.has(K))continue;const X=U.get(K);V[X].count+=1}return V},[h]),I=reactExports.useMemo(()=>{const R=new Map;for(const U of o){const W=(U.author||"").toString().trim();W&&incrementCount(R,W)}const V=[...R.entries()].map(([U,W])=>({author:U,total:W}));return V.sort((U,W)=>W.total-U.total||U.author.localeCompare(W.author)),V},[o]),b=reactExports.useMemo(()=>{const R=new Map;for(const U of o){const W=(U.publisher||"").toString().trim();W&&incrementCount(R,W)}const V=[...R.entries()].map(([U,W])=>({publisher:U,total:W}));return V.sort((U,W)=>W.total-U.total||U.publisher.localeCompare(W.publisher)),V},[o]);return{loading:n,error:s,summary:m,tagStats:_,monthlyFinished:E,monthlyAddedBooks:A,monthlyMemos:C,topAuthors:I,topPublishers:b,statusDistribution:g}}const DEFAULT_X_AXIS_KEY="DEFAULT_X_AXIS_KEY",DEFAULT_Y_AXIS_KEY="DEFAULT_Y_AXIS_KEY",DEFAULT_MARGINS={top:20,bottom:20,left:20,right:20},DEFAULT_AXIS_SIZE_WIDTH=45,DEFAULT_AXIS_SIZE_HEIGHT=25,AXIS_LABEL_DEFAULT_HEIGHT=20;class ChartStore{constructor(e){this.value=void 0,this.listeners=void 0,this.subscribe=t=>(this.listeners.add(t),()=>{this.listeners.delete(t)}),this.getSnapshot=()=>this.value,this.update=t=>{const n=t(this.value);n!==this.value&&(this.value=n,this.listeners.forEach(i=>i(n)))},this.value=e,this.listeners=new Set}}const useChartAnimation=({params:r,store:e})=>{reactExports.useEffect(()=>{e.update(n=>_extends({},n,{animation:_extends({},n.animation,{skip:r.skipAnimation})}))},[e,r.skipAnimation]);const t=reactExports.useCallback(()=>{let n=!1;return e.update(i=>_extends({},i,{animation:_extends({},i.animation,{skipAnimationRequests:i.animation.skipAnimationRequests+1})})),()=>{n||(n=!0,e.update(i=>_extends({},i,{animation:_extends({},i.animation,{skipAnimationRequests:i.animation.skipAnimationRequests-1})})))}},[e]);return useEnhancedEffect(()=>{if(typeof window>"u"||!(window!=null&&window.matchMedia))return;let i;const s=o=>{o.matches?i=t():i==null||i()},a=window.matchMedia("(prefers-reduced-motion)");return s(a),a.addEventListener("change",s),()=>{a.removeEventListener("change",s)}},[t,e]),{instance:{disableAnimation:t}}};useChartAnimation.params={skipAnimation:!0};useChartAnimation.getDefaultizedParams=({params:r})=>_extends({},r,{skipAnimation:r.skipAnimation??!1});useChartAnimation.getInitialState=({skipAnimation:r})=>({animation:{skip:r,skipAnimationRequests:0}});var NOT_FOUND=Symbol("NOT_FOUND");function assertIsFunction(r,e=`expected a function, instead received ${typeof r}`){if(typeof r!="function")throw new TypeError(e)}function assertIsObject(r,e=`expected an object, instead received ${typeof r}`){if(typeof r!="object")throw new TypeError(e)}function assertIsArrayOfFunctions(r,e="expected all items to be functions, instead received the following types: "){if(!r.every(t=>typeof t=="function")){const t=r.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${e}[${t}]`)}}var ensureIsArray=r=>Array.isArray(r)?r:[r];function getDependencies(r){const e=Array.isArray(r[0])?r[0]:r;return assertIsArrayOfFunctions(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function collectInputSelectorResults(r,e){const t=[],{length:n}=r;for(let i=0;i<n;i++)t.push(r[i].apply(null,e));return t}function createSingletonCache(r){let e;return{get(t){return e&&r(e.key,t)?e.value:NOT_FOUND},put(t,n){e={key:t,value:n}},getEntries(){return e?[e]:[]},clear(){e=void 0}}}function createLruCache(r,e){let t=[];function n(o){const c=t.findIndex(h=>e(o,h.key));if(c>-1){const h=t[c];return c>0&&(t.splice(c,1),t.unshift(h)),h.value}return NOT_FOUND}function i(o,c){n(o)===NOT_FOUND&&(t.unshift({key:o,value:c}),t.length>r&&t.pop())}function s(){return t}function a(){t=[]}return{get:n,put:i,getEntries:s,clear:a}}var referenceEqualityCheck=(r,e)=>r===e;function createCacheKeyComparator(r){return function(t,n){if(t===null||n===null||t.length!==n.length)return!1;const{length:i}=t;for(let s=0;s<i;s++)if(!r(t[s],n[s]))return!1;return!0}}function lruMemoize(r,e){const t=typeof e=="object"?e:{equalityCheck:e},{equalityCheck:n=referenceEqualityCheck,maxSize:i=1,resultEqualityCheck:s}=t,a=createCacheKeyComparator(n);let o=0;const c=i<=1?createSingletonCache(a):createLruCache(i,a);function h(){let f=c.get(arguments);if(f===NOT_FOUND){if(f=r.apply(null,arguments),o++,s){const g=c.getEntries().find(_=>s(_.value,f));g&&(f=g.value,o!==0&&o--)}c.put(arguments,f)}return f}return h.clearCache=()=>{c.clear(),h.resetResultsCount()},h.resultsCount=()=>o,h.resetResultsCount=()=>{o=0},h}var StrongRef=class{constructor(r){this.value=r}deref(){return this.value}},Ref=typeof WeakRef<"u"?WeakRef:StrongRef,UNTERMINATED=0,TERMINATED=1;function createCacheNode(){return{s:UNTERMINATED,v:void 0,o:null,p:null}}function weakMapMemoize(r,e={}){let t=createCacheNode();const{resultEqualityCheck:n}=e;let i,s=0;function a(){var m;let o=t;const{length:c}=arguments;for(let g=0,_=c;g<_;g++){const E=arguments[g];if(typeof E=="function"||typeof E=="object"&&E!==null){let A=o.o;A===null&&(o.o=A=new WeakMap);const C=A.get(E);C===void 0?(o=createCacheNode(),A.set(E,o)):o=C}else{let A=o.p;A===null&&(o.p=A=new Map);const C=A.get(E);C===void 0?(o=createCacheNode(),A.set(E,o)):o=C}}const h=o;let f;if(o.s===TERMINATED)f=o.v;else if(f=r.apply(null,arguments),s++,n){const g=((m=i==null?void 0:i.deref)==null?void 0:m.call(i))??i;g!=null&&n(g,f)&&(f=g,s!==0&&s--),i=typeof f=="object"&&f!==null||typeof f=="function"?new Ref(f):f}return h.s=TERMINATED,h.v=f,f}return a.clearCache=()=>{t=createCacheNode(),a.resetResultsCount()},a.resultsCount=()=>s,a.resetResultsCount=()=>{s=0},a}function createSelectorCreator(r,...e){const t=typeof r=="function"?{memoize:r,memoizeOptions:e}:r,n=(...i)=>{let s=0,a=0,o,c={},h=i.pop();typeof h=="object"&&(c=h,h=i.pop()),assertIsFunction(h,`createSelector expects an output function after the inputs, but received: [${typeof h}]`);const f={...t,...c},{memoize:m,memoizeOptions:g=[],argsMemoize:_=weakMapMemoize,argsMemoizeOptions:E=[]}=f,A=ensureIsArray(g),C=ensureIsArray(E),I=getDependencies(i),b=m(function(){return s++,h.apply(null,arguments)},...A),R=_(function(){a++;const U=collectInputSelectorResults(I,arguments);return o=b.apply(null,U),o},...C);return Object.assign(R,{resultFunc:h,memoizedResultFunc:b,dependencies:I,dependencyRecomputations:()=>a,resetDependencyRecomputations:()=>{a=0},lastResult:()=>o,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:m,argsMemoize:_})};return Object.assign(n,{withTypes:()=>n}),n}var createSelector$1=createSelectorCreator(weakMapMemoize),createStructuredSelector=Object.assign((r,e=createSelector$1)=>{assertIsObject(r,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof r}`);const t=Object.keys(r),n=t.map(s=>r[s]);return e(n,(...s)=>s.reduce((a,o,c)=>(a[t[c]]=o,a),{}))},{withTypes:()=>createStructuredSelector});const reselectCreateSelector=createSelectorCreator({memoize:lruMemoize,memoizeOptions:{maxSize:1,equalityCheck:Object.is}}),cache=new WeakMap,createSelector=(...r)=>(t,...n)=>{const i=t.cacheKey;let s=cache.get(i);s||(s=new Map,cache.set(i,s));const a=s.get(r);if(a)return a(t,...n);const o=reselectCreateSelector(...r);return s.set(r,o),o(t,...n)},selectorChartAnimationState=r=>r.animation,selectorChartSkipAnimation=createSelector([selectorChartAnimationState],r=>r.skip||r.skipAnimationRequests>0);var withSelector={exports:{}},withSelector_production={},shim={exports:{}},useSyncExternalStoreShim_production={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredUseSyncExternalStoreShim_production;function requireUseSyncExternalStoreShim_production(){if(hasRequiredUseSyncExternalStoreShim_production)return useSyncExternalStoreShim_production;hasRequiredUseSyncExternalStoreShim_production=1;var r=requireReact();function e(m,g){return m===g&&(m!==0||1/m===1/g)||m!==m&&g!==g}var t=typeof Object.is=="function"?Object.is:e,n=r.useState,i=r.useEffect,s=r.useLayoutEffect,a=r.useDebugValue;function o(m,g){var _=g(),E=n({inst:{value:_,getSnapshot:g}}),A=E[0].inst,C=E[1];return s(function(){A.value=_,A.getSnapshot=g,c(A)&&C({inst:A})},[m,_,g]),i(function(){return c(A)&&C({inst:A}),m(function(){c(A)&&C({inst:A})})},[m]),a(_),_}function c(m){var g=m.getSnapshot;m=m.value;try{var _=g();return!t(m,_)}catch{return!0}}function h(m,g){return g()}var f=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?h:o;return useSyncExternalStoreShim_production.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:f,useSyncExternalStoreShim_production}var hasRequiredShim;function requireShim(){return hasRequiredShim||(hasRequiredShim=1,shim.exports=requireUseSyncExternalStoreShim_production()),shim.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredWithSelector_production;function requireWithSelector_production(){if(hasRequiredWithSelector_production)return withSelector_production;hasRequiredWithSelector_production=1;var r=requireReact(),e=requireShim();function t(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var n=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=r.useRef,a=r.useEffect,o=r.useMemo,c=r.useDebugValue;return withSelector_production.useSyncExternalStoreWithSelector=function(h,f,m,g,_){var E=s(null);if(E.current===null){var A={hasValue:!1,value:null};E.current=A}else A=E.current;E=o(function(){function I(W){if(!b){if(b=!0,R=W,W=g(W),_!==void 0&&A.hasValue){var j=A.value;if(_(j,W))return V=j}return V=W}if(j=V,n(R,W))return j;var w=g(W);return _!==void 0&&_(j,w)?(R=W,j):(R=W,V=w)}var b=!1,R,V,U=m===void 0?null:m;return[function(){return I(f())},U===null?void 0:function(){return I(U())}]},[f,m,g,_]);var C=i(h,E[0],E[1]);return a(function(){A.hasValue=!0,A.value=C},[C]),c(C),C},withSelector_production}var hasRequiredWithSelector;function requireWithSelector(){return hasRequiredWithSelector||(hasRequiredWithSelector=1,withSelector.exports=requireWithSelector_production()),withSelector.exports}var withSelectorExports=requireWithSelector();const defaultCompare=Object.is,useSelector=(r,e,t=[],n=defaultCompare)=>{const i=s=>e(s,...t);return withSelectorExports.useSyncExternalStoreWithSelector(r.subscribe,r.getSnapshot,r.getSnapshot,i,n)},selectorChartRawXAxis=r=>{var e;return(e=r.cartesianAxis)==null?void 0:e.x},selectorChartRawYAxis=r=>{var e;return(e=r.cartesianAxis)==null?void 0:e.y},selectorChartLeftAxisSize=createSelector([selectorChartRawYAxis],r=>(r??[]).reduce((e,t)=>{var n;return t.position==="left"?e+(t.width||0)+((n=t.zoom)!=null&&n.slider.enabled?t.zoom.slider.size:0):e},0)),selectorChartRightAxisSize=createSelector([selectorChartRawYAxis],r=>(r??[]).reduce((e,t)=>{var n;return t.position==="right"?e+(t.width||0)+((n=t.zoom)!=null&&n.slider.enabled?t.zoom.slider.size:0):e},0)),selectorChartTopAxisSize=createSelector([selectorChartRawXAxis],r=>(r??[]).reduce((e,t)=>{var n;return t.position==="top"?e+(t.height||0)+((n=t.zoom)!=null&&n.slider.enabled?t.zoom.slider.size:0):e},0)),selectorChartBottomAxisSize=createSelector([selectorChartRawXAxis],r=>(r??[]).reduce((e,t)=>{var n;return t.position==="bottom"?e+(t.height||0)+((n=t.zoom)!=null&&n.slider.enabled?t.zoom.slider.size:0):e},0)),selectorChartDimensionsState=r=>r.dimensions,selectorChartWidth=r=>r.dimensions.width,selectorChartHeight=r=>r.dimensions.height,selectorChartTopMargin=r=>r.dimensions.margin.top,selectorChartRightMargin=r=>r.dimensions.margin.right,selectorChartBottomMargin=r=>r.dimensions.margin.bottom,selectorChartLeftMargin=r=>r.dimensions.margin.left,selectorChartDrawingArea=createSelector([selectorChartWidth,selectorChartHeight,selectorChartTopMargin,selectorChartRightMargin,selectorChartBottomMargin,selectorChartLeftMargin,selectorChartTopAxisSize,selectorChartRightAxisSize,selectorChartBottomAxisSize,selectorChartLeftAxisSize],(r,e,t,n,i,s,a,o,c,h)=>({width:r-s-n-h-o,left:s+h,right:n+o,height:e-t-i-a-c,top:t+a,bottom:i+c})),selectorChartPropsSize=createSelector([selectorChartDimensionsState],r=>({width:r.propsWidth,height:r.propsHeight})),selectorChartContainerSize=createSelector([selectorChartWidth,selectorChartHeight],(r,e)=>({width:r,height:e}));function defaultizeMargin(r,e){return typeof r=="number"?{top:r,bottom:r,left:r,right:r}:e?_extends({},e,r):r}const MAX_COMPUTE_RUN=10,useChartDimensions=({params:r,store:e,svgRef:t})=>{const n=r.width!==void 0&&r.height!==void 0,i=reactExports.useRef({displayError:!1,initialCompute:!0,computeRun:0}),[s,a]=reactExports.useState(0),[o,c]=reactExports.useState(0),h=reactExports.useCallback(()=>{const E=t==null?void 0:t.current;if(!E)return{};const C=ownerWindow(E).getComputedStyle(E),I=Math.floor(parseFloat(C.height))||0,b=Math.floor(parseFloat(C.width))||0;return e.update(R=>R.dimensions.width===b&&R.dimensions.height===I?R:_extends({},R,{dimensions:{margin:{top:r.margin.top,right:r.margin.right,bottom:r.margin.bottom,left:r.margin.left},width:r.width??b,height:r.height??I,propsWidth:r.width,propsHeight:r.height}})),{height:I,width:b}},[e,t,r.height,r.width,r.margin.left,r.margin.right,r.margin.top,r.margin.bottom]);reactExports.useEffect(()=>{e.update(E=>{const A=r.width??E.dimensions.width,C=r.height??E.dimensions.height;return _extends({},E,{dimensions:{margin:{top:r.margin.top,right:r.margin.right,bottom:r.margin.bottom,left:r.margin.left},width:A,height:C,propsHeight:r.height,propsWidth:r.width}})})},[e,r.height,r.width,r.margin.left,r.margin.right,r.margin.top,r.margin.bottom]),reactExports.useEffect(()=>{i.current.displayError=!0},[]),useEnhancedEffect(()=>{if(n||!i.current.initialCompute||i.current.computeRun>MAX_COMPUTE_RUN)return;const E=h();E.width!==s||E.height!==o?(i.current.computeRun+=1,E.width!==void 0&&a(E.width),E.height!==void 0&&c(E.height)):i.current.initialCompute&&(i.current.initialCompute=!1)},[o,s,h,n]),useEnhancedEffect(()=>{if(n)return()=>{};h();const E=t.current;if(typeof ResizeObserver>"u")return()=>{};let A;const C=new ResizeObserver(()=>{A=requestAnimationFrame(()=>{h()})});return E&&C.observe(E),()=>{A&&cancelAnimationFrame(A),E&&C.unobserve(E)}},[h,n,t]);const f=useSelector(e,selectorChartDrawingArea),m=reactExports.useCallback(E=>E>=f.left-1&&E<=f.left+f.width,[f.left,f.width]),g=reactExports.useCallback(E=>E>=f.top-1&&E<=f.top+f.height,[f.height,f.top]);return{instance:{isPointInside:reactExports.useCallback((E,A,C)=>C&&"closest"in C&&C.closest("[data-drawing-container]")?!0:m(E)&&g(A),[m,g]),isXInside:m,isYInside:g}}};useChartDimensions.params={width:!0,height:!0,margin:!0};useChartDimensions.getDefaultizedParams=({params:r})=>_extends({},r,{margin:defaultizeMargin(r.margin,DEFAULT_MARGINS)});useChartDimensions.getInitialState=({width:r,height:e,margin:t})=>({dimensions:{margin:t,width:r??0,height:e??0,propsWidth:r,propsHeight:e}});const useChartExperimentalFeatures=({params:r,store:e})=>(useEnhancedEffect(()=>{e.update(t=>_extends({},t,{experimentalFeatures:r.experimentalFeatures}))},[e,r.experimentalFeatures]),{});useChartExperimentalFeatures.params={experimentalFeatures:!0};useChartExperimentalFeatures.getInitialState=({experimentalFeatures:r})=>({experimentalFeatures:r});const selectorChartExperimentalFeaturesState=r=>r.experimentalFeatures,selectorPreferStrictDomainInLineCharts=createSelector([selectorChartExperimentalFeaturesState],r=>!!(r!=null&&r.preferStrictDomainInLineCharts));let globalChartDefaultId=0;const createChartDefaultId=()=>(globalChartDefaultId+=1,`mui-chart-${globalChartDefaultId}`),useChartId$1=({params:r,store:e})=>(reactExports.useEffect(()=>{e.update(t=>r.id===void 0||r.id===t.id.providedChartId&&t.id.chartId!==void 0?t:_extends({},t,{id:_extends({},t.id,{chartId:r.id??createChartDefaultId()})}))},[e,r.id]),{});useChartId$1.params={id:!0};useChartId$1.getInitialState=({id:r})=>({id:{chartId:r,providedChartId:r}});const selectorChartIdState=r=>r.id,selectorChartId=createSelector([selectorChartIdState],r=>r.chartId),rainbowSurgePaletteLight=["#4254FB","#FFB422","#FA4F58","#0DBEFF","#22BF75","#FA83B4","#FF7511"],rainbowSurgePaletteDark=["#495AFB","#FFC758","#F35865","#30C8FF","#44CE8D","#F286B3","#FF8C39"],rainbowSurgePalette=r=>r==="dark"?rainbowSurgePaletteDark:rainbowSurgePaletteLight,preprocessSeries=({series:r,colors:e,seriesConfig:t,dataset:n})=>{const i={};r.forEach((a,o)=>{var f;const c=t[a.type].getSeriesWithDefaultValues(a,o,e),h=c.id;if(i[a.type]===void 0&&(i[a.type]={series:{},seriesOrder:[]}),((f=i[a.type])==null?void 0:f.series[h])!==void 0)throw new Error(`MUI X Charts: series' id "${h}" is not unique.`);i[a.type].series[h]=c,i[a.type].seriesOrder.push(h)});const s={};return Object.keys(t).forEach(a=>{var c,h;const o=i[a];o!==void 0&&(s[a]=((h=(c=t[a])==null?void 0:c.seriesProcessor)==null?void 0:h.call(c,o,n))??i[a])}),s},useChartSeries=({params:r,store:e,seriesConfig:t})=>{const{series:n,dataset:i,theme:s,colors:a}=r,o=reactExports.useRef(!0);return reactExports.useEffect(()=>{if(o.current){o.current=!1;return}e.update(c=>_extends({},c,{series:_extends({},c.series,{processedSeries:preprocessSeries({series:n,colors:typeof a=="function"?a(s):a,seriesConfig:t,dataset:i})})}))},[a,i,n,s,t,e]),{}};useChartSeries.params={dataset:!0,series:!0,colors:!0,theme:!0};const EMPTY_ARRAY=[];useChartSeries.getDefaultizedParams=({params:r})=>{var e;return _extends({},r,{series:(e=r.series)!=null&&e.length?r.series:EMPTY_ARRAY,colors:r.colors??rainbowSurgePalette,theme:r.theme??"light"})};useChartSeries.getInitialState=({series:r=[],colors:e,theme:t,dataset:n},i,s)=>({series:{seriesConfig:s,processedSeries:preprocessSeries({series:r,colors:typeof e=="function"?e(t):e,seriesConfig:s,dataset:n})}});const selectorChartSeriesState=r=>r.series,selectorChartSeriesProcessed=createSelector([selectorChartSeriesState],r=>r.processedSeries),selectorChartSeriesConfig=createSelector([selectorChartSeriesState],r=>r.seriesConfig),eventList={abort:!0,animationcancel:!0,animationend:!0,animationiteration:!0,animationstart:!0,auxclick:!0,beforeinput:!0,beforetoggle:!0,blur:!0,cancel:!0,canplay:!0,canplaythrough:!0,change:!0,click:!0,close:!0,compositionend:!0,compositionstart:!0,compositionupdate:!0,contextlost:!0,contextmenu:!0,contextrestored:!0,copy:!0,cuechange:!0,cut:!0,dblclick:!0,drag:!0,dragend:!0,dragenter:!0,dragleave:!0,dragover:!0,dragstart:!0,drop:!0,durationchange:!0,emptied:!0,ended:!0,error:!0,focus:!0,focusin:!0,focusout:!0,formdata:!0,gotpointercapture:!0,input:!0,invalid:!0,keydown:!0,keypress:!0,keyup:!0,load:!0,loadeddata:!0,loadedmetadata:!0,loadstart:!0,lostpointercapture:!0,mousedown:!0,mouseenter:!0,mouseleave:!0,mousemove:!0,mouseout:!0,mouseover:!0,mouseup:!0,paste:!0,pause:!0,play:!0,playing:!0,pointercancel:!0,pointerdown:!0,pointerenter:!0,pointerleave:!0,pointermove:!0,pointerout:!0,pointerover:!0,pointerup:!0,progress:!0,ratechange:!0,reset:!0,resize:!0,scroll:!0,scrollend:!0,securitypolicyviolation:!0,seeked:!0,seeking:!0,select:!0,selectionchange:!0,selectstart:!0,slotchange:!0,stalled:!0,submit:!0,suspend:!0,timeupdate:!0,toggle:!0,touchcancel:!0,touchend:!0,touchmove:!0,touchstart:!0,transitioncancel:!0,transitionend:!0,transitionrun:!0,transitionstart:!0,volumechange:!0,waiting:!0,webkitanimationend:!0,webkitanimationiteration:!0,webkitanimationstart:!0,webkittransitionend:!0,wheel:!0,beforematch:!0,pointerrawupdate:!0};class Gesture{constructor(e){if(this.name=void 0,this.preventDefault=void 0,this.stopPropagation=void 0,this.preventIf=void 0,this.requiredKeys=void 0,this.keyboardManager=void 0,this.pointerMode=void 0,this.customData={},this.pointerManager=void 0,this.gesturesRegistry=void 0,this.element=void 0,this.state=void 0,this.isSinglePhase=void 0,this.eventType=void 0,this.optionsType=void 0,this.mutableOptionsType=void 0,this.mutableStateType=void 0,!e||!e.name)throw new Error("Gesture must be initialized with a valid name.");if(e.name in eventList)throw new Error(`Gesture can't be created with a native event name. Tried to use "${e.name}". Please use a custom name instead.`);this.name=e.name,this.preventDefault=e.preventDefault??!1,this.stopPropagation=e.stopPropagation??!1,this.preventIf=e.preventIf??[],this.requiredKeys=e.requiredKeys??[],this.pointerMode=e.pointerMode??[]}init(e,t,n,i){this.element=e,this.pointerManager=t,this.gesturesRegistry=n,this.keyboardManager=i;const s=`${this.name}ChangeOptions`;this.element.addEventListener(s,this.handleOptionsChange.bind(this));const a=`${this.name}ChangeState`;this.element.addEventListener(a,this.handleStateChange.bind(this))}handleOptionsChange(e){e&&e.detail&&this.updateOptions(e.detail)}updateOptions(e){this.preventDefault=e.preventDefault??this.preventDefault,this.stopPropagation=e.stopPropagation??this.stopPropagation,this.preventIf=e.preventIf??this.preventIf,this.requiredKeys=e.requiredKeys??this.requiredKeys,this.pointerMode=e.pointerMode??this.pointerMode}handleStateChange(e){e&&e.detail&&this.updateState(e.detail)}updateState(e){Object.assign(this.state,e)}getTargetElement(e){return this.isActive||this.element===e.target||"contains"in this.element&&this.element.contains(e.target)||"getRootNode"in this.element&&this.element.getRootNode()instanceof ShadowRoot&&e.composedPath().includes(this.element)?this.element:null}set isActive(e){e?this.gesturesRegistry.registerActiveGesture(this.element,this):this.gesturesRegistry.unregisterActiveGesture(this.element,this)}get isActive(){return this.gesturesRegistry.isGestureActive(this.element,this)??!1}shouldPreventGesture(e){if(!this.keyboardManager.areKeysPressed(this.requiredKeys))return!0;if(this.preventIf.length===0)return!1;const t=this.gesturesRegistry.getActiveGestures(e);return this.preventIf.some(n=>t[n])}isPointerTypeAllowed(e){return!this.pointerMode||this.pointerMode.length===0?!0:this.pointerMode.includes(e)}destroy(){const e=`${this.name}ChangeOptions`;this.element.removeEventListener(e,this.handleOptionsChange.bind(this));const t=`${this.name}ChangeState`;this.element.removeEventListener(t,this.handleStateChange.bind(this))}}class ActiveGesturesRegistry{constructor(){this.activeGestures=new Map}registerActiveGesture(e,t){this.activeGestures.has(e)||this.activeGestures.set(e,new Set);const n=this.activeGestures.get(e),i={gesture:t,element:e};n.add(i)}unregisterActiveGesture(e,t){const n=this.activeGestures.get(e);n&&(n.forEach(i=>{i.gesture===t&&n.delete(i)}),n.size===0&&this.activeGestures.delete(e))}getActiveGestures(e){const t=this.activeGestures.get(e);return t?Array.from(t).reduce((n,i)=>(n[i.gesture.name]=!0,n),{}):{}}isGestureActive(e,t){const n=this.activeGestures.get(e);return n?Array.from(n).some(i=>i.gesture===t):!1}destroy(){this.activeGestures.clear()}unregisterElement(e){this.activeGestures.delete(e)}}class KeyboardManager{constructor(){this.pressedKeys=new Set,this.handleKeyDown=e=>{this.pressedKeys.add(e.key)},this.handleKeyUp=e=>{this.pressedKeys.delete(e.key)},this.clearKeys=()=>{this.pressedKeys.clear()},this.initialize()}initialize(){typeof window>"u"||(window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("blur",this.clearKeys))}areKeysPressed(e){return!e||e.length===0?!0:e.every(t=>t==="ControlOrMeta"?this.pressedKeys.has("Control")||this.pressedKeys.has("Meta"):this.pressedKeys.has(t))}destroy(){typeof window<"u"&&(window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("blur",this.clearKeys)),this.clearKeys()}}class PointerManager{constructor(e){this.root=void 0,this.touchAction=void 0,this.passive=void 0,this.preventEventInterruption=!0,this.pointers=new Map,this.gestureHandlers=new Set,this.handleInterruptEvents=t=>{if(this.preventEventInterruption&&"pointerType"in t&&t.pointerType==="touch"){t.preventDefault();return}const n=new PointerEvent("forceCancel",{bubbles:!1,cancelable:!1}),i=this.pointers.values().next().value;if(this.pointers.size>0&&i){Object.defineProperties(n,{clientX:{value:i.clientX},clientY:{value:i.clientY},pointerId:{value:i.pointerId},pointerType:{value:i.pointerType}});for(const[s,a]of this.pointers.entries()){const o=_extends({},a,{type:"forceCancel"});this.pointers.set(s,o)}}this.notifyHandlers(n),this.pointers.clear()},this.handlePointerEvent=t=>{const{type:n,pointerId:i}=t;if(n==="pointerdown"||n==="pointermove")this.pointers.set(i,this.createPointerData(t));else if(n==="pointerup"||n==="pointercancel"||n==="forceCancel"){this.pointers.set(i,this.createPointerData(t)),this.notifyHandlers(t),this.pointers.delete(i);return}this.notifyHandlers(t)},this.root=e.root??document.getRootNode({composed:!0}),this.touchAction=e.touchAction||"auto",this.passive=e.passive??!1,this.preventEventInterruption=e.preventEventInterruption??!1,this.setupEventListeners()}registerGestureHandler(e){return this.gestureHandlers.add(e),()=>{this.gestureHandlers.delete(e)}}getPointers(){return new Map(this.pointers)}setupEventListeners(){this.touchAction!=="auto"&&(this.root.style.touchAction=this.touchAction),this.root.addEventListener("pointerdown",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("pointermove",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("pointerup",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("pointercancel",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("forceCancel",this.handlePointerEvent,{passive:this.passive}),this.root.addEventListener("blur",this.handleInterruptEvents),this.root.addEventListener("contextmenu",this.handleInterruptEvents)}notifyHandlers(e){this.gestureHandlers.forEach(t=>t(this.pointers,e))}createPointerData(e){return{pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,target:e.target,timeStamp:e.timeStamp,type:e.type,isPrimary:e.isPrimary,pressure:e.pressure,width:e.width,height:e.height,pointerType:e.pointerType,srcEvent:e}}destroy(){this.root.removeEventListener("pointerdown",this.handlePointerEvent),this.root.removeEventListener("pointermove",this.handlePointerEvent),this.root.removeEventListener("pointerup",this.handlePointerEvent),this.root.removeEventListener("pointercancel",this.handlePointerEvent),this.root.removeEventListener("forceCancel",this.handlePointerEvent),this.root.removeEventListener("blur",this.handleInterruptEvents),this.root.removeEventListener("contextmenu",this.handleInterruptEvents),this.pointers.clear(),this.gestureHandlers.clear()}}class GestureManager{constructor(e){this.gestureTemplates=new Map,this.elementGestureMap=new Map,this.activeGesturesRegistry=new ActiveGesturesRegistry,this.pointerManager=void 0,this.keyboardManager=new KeyboardManager,this.pointerManager=new PointerManager({root:e.root,touchAction:e.touchAction,passive:e.passive}),e.gestures&&e.gestures.length>0&&e.gestures.forEach(t=>{this.addGestureTemplate(t)})}addGestureTemplate(e){this.gestureTemplates.has(e.name)&&console.warn(`Gesture template with name "${e.name}" already exists. It will be overwritten.`),this.gestureTemplates.set(e.name,e)}setGestureOptions(e,t,n){const i=this.elementGestureMap.get(t);if(!i||!i.has(e)){console.error(`Gesture "${e}" not found on the provided element.`);return}const s=new CustomEvent(`${e}ChangeOptions`,{detail:n,bubbles:!1,cancelable:!1,composed:!1});t.dispatchEvent(s)}setGestureState(e,t,n){const i=this.elementGestureMap.get(t);if(!i||!i.has(e)){console.error(`Gesture "${e}" not found on the provided element.`);return}const s=new CustomEvent(`${e}ChangeState`,{detail:n,bubbles:!1,cancelable:!1,composed:!1});t.dispatchEvent(s)}registerElement(e,t,n){return Array.isArray(e)||(e=[e]),e.forEach(i=>{const s=n==null?void 0:n[i];this.registerSingleGesture(i,t,s)}),t}registerSingleGesture(e,t,n){const i=this.gestureTemplates.get(e);if(!i)return console.error(`Gesture template "${e}" not found.`),!1;this.elementGestureMap.has(t)||this.elementGestureMap.set(t,new Map);const s=this.elementGestureMap.get(t);s.has(e)&&(console.warn(`Element already has gesture "${e}" registered. It will be replaced.`),this.unregisterElement(e,t));const a=i.clone(n);return a.init(t,this.pointerManager,this.activeGesturesRegistry,this.keyboardManager),s.set(e,a),!0}unregisterElement(e,t){const n=this.elementGestureMap.get(t);return!n||!n.has(e)?!1:(n.get(e).destroy(),n.delete(e),this.activeGesturesRegistry.unregisterElement(t),n.size===0&&this.elementGestureMap.delete(t),!0)}unregisterAllGestures(e){const t=this.elementGestureMap.get(e);if(t){for(const[,n]of t)n.destroy(),this.activeGesturesRegistry.unregisterElement(e);this.elementGestureMap.delete(e)}}destroy(){for(const[e]of this.elementGestureMap)this.unregisterAllGestures(e);this.gestureTemplates.clear(),this.elementGestureMap.clear(),this.activeGesturesRegistry.destroy(),this.keyboardManager.destroy(),this.pointerManager.destroy()}}class PointerGesture extends Gesture{constructor(e){super(e),this.unregisterHandler=null,this.originalTarget=null,this.optionsType=void 0,this.mutableOptionsType=void 0,this.minPointers=void 0,this.maxPointers=void 0,this.minPointers=e.minPointers??1,this.maxPointers=e.maxPointers??1/0}init(e,t,n,i){super.init(e,t,n,i),this.unregisterHandler=this.pointerManager.registerGestureHandler(this.handlePointerEvent.bind(this))}updateOptions(e){super.updateOptions(e),this.minPointers=e.minPointers??this.minPointers,this.maxPointers=e.maxPointers??this.maxPointers}getRelevantPointers(e,t){return e.filter(n=>this.isPointerTypeAllowed(n.pointerType)&&(t===n.target||n.target===this.originalTarget||t===this.originalTarget||"contains"in t&&t.contains(n.target))||"getRootNode"in t&&t.getRootNode()instanceof ShadowRoot&&n.srcEvent.composedPath().includes(t))}destroy(){this.unregisterHandler&&(this.unregisterHandler(),this.unregisterHandler=null),super.destroy()}}function getDistance(r,e){const t=e.x-r.x,n=e.y-r.y;return Math.sqrt(t*t+n*n)}function calculateAverageDistance(r){if(r.length<2)return 0;let e=0,t=0;for(let n=0;n<r.length;n+=1)for(let i=n+1;i<r.length;i+=1)e+=getDistance({x:r[n].clientX,y:r[n].clientY},{x:r[i].clientX,y:r[i].clientY}),t+=1;return t>0?e/t:0}function calculateCentroid(r){if(r.length===0)return{x:0,y:0};const e=r.reduce((t,n)=>(t.x+=n.clientX,t.y+=n.clientY,t),{x:0,y:0});return{x:e.x/r.length,y:e.y/r.length}}function createEventName(r,e){return`${r}${e==="ongoing"?"":e.charAt(0).toUpperCase()+e.slice(1)}`}const MAIN_THRESHOLD=1e-5,ANGLE_THRESHOLD=1e-5,SECONDARY_THRESHOLD=.15;function getDirection$2(r,e){const t=e.x-r.x,n=e.y-r.y,i={vertical:null,horizontal:null,mainAxis:null},s=isDiagonalMovement(e,r),a=Math.abs(t)>Math.abs(n)?"horizontal":"vertical",o=s||a==="horizontal"?MAIN_THRESHOLD:SECONDARY_THRESHOLD,c=s?MAIN_THRESHOLD:a==="horizontal"?SECONDARY_THRESHOLD:MAIN_THRESHOLD;return Math.abs(t)>o&&(i.horizontal=t>0?"right":"left"),Math.abs(n)>c&&(i.vertical=n>0?"down":"up"),i.mainAxis=s?"diagonal":a,i}function isDiagonalMovement(r,e){const t=e.x-r.x,n=e.y-r.y,i=Math.atan2(n,t)*180/Math.PI;return i>=-45+ANGLE_THRESHOLD&&i<=-22.5+ANGLE_THRESHOLD||i>=22.5+ANGLE_THRESHOLD&&i<=45+ANGLE_THRESHOLD||i>=135+ANGLE_THRESHOLD&&i<=157.5+ANGLE_THRESHOLD||i>=-157.5+ANGLE_THRESHOLD&&i<=-135+ANGLE_THRESHOLD}function isDirectionAllowed(r,e){if(!r.vertical&&!r.horizontal)return!1;if(e.length===0)return!0;const t=r.vertical===null||e.includes(r.vertical),n=r.horizontal===null||e.includes(r.horizontal);return t&&n}const DIRECTION_THRESHOLD=0,getPinchDirection=r=>r>DIRECTION_THRESHOLD?1:r<-DIRECTION_THRESHOLD?-1:0;class MoveGesture extends PointerGesture{constructor(e){super(e),this.state={lastPosition:null},this.isSinglePhase=void 0,this.eventType=void 0,this.optionsType=void 0,this.mutableOptionsType=void 0,this.mutableStateType=void 0,this.threshold=void 0,this.handleElementEnterBound=void 0,this.handleElementLeaveBound=void 0,this.handleElementEnterBound=this.handleElementEnter.bind(this),this.handleElementLeaveBound=this.handleElementLeave.bind(this),this.threshold=e.threshold||0}clone(e){return new MoveGesture(_extends({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,threshold:this.threshold,minPointers:this.minPointers,maxPointers:this.maxPointers,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf]},e))}init(e,t,n,i){super.init(e,t,n,i),this.element.addEventListener("pointerenter",this.handleElementEnterBound),this.element.addEventListener("pointerleave",this.handleElementLeaveBound)}destroy(){this.element.removeEventListener("pointerenter",this.handleElementEnterBound),this.element.removeEventListener("pointerleave",this.handleElementLeaveBound),this.resetState(),super.destroy()}updateOptions(e){super.updateOptions(e)}resetState(){this.isActive=!1,this.state={lastPosition:null}}handleElementEnter(e){if(e.pointerType!=="mouse"&&e.pointerType!=="pen")return;const t=this.pointerManager.getPointers()||new Map,n=Array.from(t.values());if(n.length>=this.minPointers&&n.length<=this.maxPointers){this.isActive=!0;const i={x:e.clientX,y:e.clientY};this.state.lastPosition=i,this.emitMoveEvent(this.element,"start",n,e),this.emitMoveEvent(this.element,"ongoing",n,e)}}handleElementLeave(e){if(e.pointerType!=="mouse"&&e.pointerType!=="pen"||!this.isActive)return;const t=this.pointerManager.getPointers()||new Map,n=Array.from(t.values());this.emitMoveEvent(this.element,"end",n,e),this.resetState()}handlePointerEvent(e,t){if(t.type!=="pointermove"||t.pointerType!=="mouse"&&t.pointerType!=="pen")return;this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation();const n=Array.from(e.values()),i=this.getTargetElement(t);if(!i||n.length<this.minPointers||n.length>this.maxPointers)return;if(this.shouldPreventGesture(i)){if(!this.isActive)return;this.resetState(),this.emitMoveEvent(i,"end",n,t);return}const s={x:t.clientX,y:t.clientY};this.state.lastPosition=s,this.isActive||(this.isActive=!0,this.emitMoveEvent(i,"start",n,t)),this.emitMoveEvent(i,"ongoing",n,t)}emitMoveEvent(e,t,n,i){const s=this.state.lastPosition||calculateCentroid(n),a=this.gesturesRegistry.getActiveGestures(e),o={gestureName:this.name,centroid:s,target:i.target,srcEvent:i,phase:t,pointers:n,timeStamp:i.timeStamp,activeGestures:a,customData:this.customData},c=createEventName(this.name,t),h=new CustomEvent(c,{bubbles:!0,cancelable:!0,composed:!0,detail:o});e.dispatchEvent(h)}}class PanGesture extends PointerGesture{constructor(e){super(e),this.state={startPointers:new Map,startCentroid:null,lastCentroid:null,movementThresholdReached:!1,totalDeltaX:0,totalDeltaY:0,activeDeltaX:0,activeDeltaY:0,lastDirection:{vertical:null,horizontal:null,mainAxis:null},lastDeltas:null},this.isSinglePhase=void 0,this.eventType=void 0,this.optionsType=void 0,this.mutableOptionsType=void 0,this.mutableStateType=void 0,this.threshold=void 0,this.direction=void 0,this.direction=e.direction||["up","down","left","right"],this.threshold=e.threshold||0}clone(e){return new PanGesture(_extends({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,threshold:this.threshold,minPointers:this.minPointers,maxPointers:this.maxPointers,direction:[...this.direction],requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf]},e))}destroy(){this.resetState(),super.destroy()}updateOptions(e){super.updateOptions(e),this.direction=e.direction||this.direction}resetState(){this.isActive=!1,this.state=_extends({},this.state,{startPointers:new Map,startCentroid:null,lastCentroid:null,lastDeltas:null,activeDeltaX:0,activeDeltaY:0,movementThresholdReached:!1,lastDirection:{vertical:null,horizontal:null,mainAxis:null}})}handlePointerEvent(e,t){const n=Array.from(e.values());if(t.type==="forceCancel"){this.cancel(t.target,n,t);return}const i=this.getTargetElement(t);if(!i)return;if(this.shouldPreventGesture(i)){this.cancel(i,n,t);return}const s=this.getRelevantPointers(n,i);if(s.length<this.minPointers||s.length>this.maxPointers){this.cancel(i,s,t);return}switch(t.type){case"pointerdown":!this.isActive&&!this.state.startCentroid&&(s.forEach(a=>{this.state.startPointers.set(a.pointerId,a)}),this.originalTarget=i,this.state.startCentroid=calculateCentroid(s),this.state.lastCentroid=_extends({},this.state.startCentroid));break;case"pointermove":if(this.state.startCentroid&&s.length>=this.minPointers){const a=calculateCentroid(s),o=a.x-this.state.startCentroid.x,c=a.y-this.state.startCentroid.y,h=Math.sqrt(o*o+c*c),f=getDirection$2(this.state.lastCentroid??this.state.startCentroid,a),m=this.state.lastCentroid?a.x-this.state.lastCentroid.x:0,g=this.state.lastCentroid?a.y-this.state.lastCentroid.y:0;!this.state.movementThresholdReached&&h>=this.threshold&&isDirectionAllowed(f,this.direction)?(this.state.movementThresholdReached=!0,this.isActive=!0,this.state.lastDeltas={x:m,y:g},this.state.totalDeltaX+=m,this.state.totalDeltaY+=g,this.state.activeDeltaX+=m,this.state.activeDeltaY+=g,this.emitPanEvent(i,"start",s,t,a),this.emitPanEvent(i,"ongoing",s,t,a)):this.state.movementThresholdReached&&this.isActive&&(this.state.lastDeltas={x:m,y:g},this.state.totalDeltaX+=m,this.state.totalDeltaY+=g,this.state.activeDeltaX+=m,this.state.activeDeltaY+=g,this.emitPanEvent(i,"ongoing",s,t,a)),this.state.lastCentroid=a,this.state.lastDirection=f}break;case"pointerup":case"pointercancel":case"forceCancel":if(this.isActive&&this.state.movementThresholdReached){if(s.filter(a=>a.type!=="pointerup"&&a.type!=="pointercancel").length<this.minPointers){const a=this.state.lastCentroid||this.state.startCentroid;t.type==="pointercancel"&&this.emitPanEvent(i,"cancel",s,t,a),this.emitPanEvent(i,"end",s,t,a),this.resetState()}}else this.resetState();break}}emitPanEvent(e,t,n,i,s){var I,b;if(!this.state.startCentroid)return;const a=((I=this.state.lastDeltas)==null?void 0:I.x)??0,o=((b=this.state.lastDeltas)==null?void 0:b.y)??0,c=this.state.startPointers.values().next().value,h=c?(i.timeStamp-c.timeStamp)/1e3:0,f=h>0?a/h:0,m=h>0?o/h:0,g=Math.sqrt(f*f+m*m),_=this.gesturesRegistry.getActiveGestures(e),E={gestureName:this.name,initialCentroid:this.state.startCentroid,centroid:s,target:i.target,srcEvent:i,phase:t,pointers:n,timeStamp:i.timeStamp,deltaX:a,deltaY:o,direction:this.state.lastDirection,velocityX:f,velocityY:m,velocity:g,totalDeltaX:this.state.totalDeltaX,totalDeltaY:this.state.totalDeltaY,activeDeltaX:this.state.activeDeltaX,activeDeltaY:this.state.activeDeltaY,activeGestures:_,customData:this.customData},A=createEventName(this.name,t),C=new CustomEvent(A,{bubbles:!0,cancelable:!0,composed:!0,detail:E});e.dispatchEvent(C),this.preventDefault&&i.preventDefault(),this.stopPropagation&&i.stopPropagation()}cancel(e,t,n){if(this.isActive){const i=e??this.element;this.emitPanEvent(i,"cancel",t,n,this.state.lastCentroid),this.emitPanEvent(i,"end",t,n,this.state.lastCentroid)}this.resetState()}}class PinchGesture extends PointerGesture{constructor(e){super(_extends({},e,{minPointers:e.minPointers??2})),this.state={startDistance:0,lastDistance:0,lastScale:1,lastTime:0,velocity:0,totalScale:1,deltaScale:0},this.isSinglePhase=void 0,this.eventType=void 0,this.optionsType=void 0,this.mutableOptionsType=void 0,this.mutableStateType=void 0,this.threshold=void 0,this.threshold=e.threshold??0}clone(e){return new PinchGesture(_extends({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,threshold:this.threshold,minPointers:this.minPointers,maxPointers:this.maxPointers,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf]},e))}destroy(){this.resetState(),super.destroy()}updateOptions(e){super.updateOptions(e)}resetState(){this.isActive=!1,this.state=_extends({},this.state,{startDistance:0,lastDistance:0,lastScale:1,lastTime:0,velocity:0,deltaScale:0})}handlePointerEvent(e,t){const n=Array.from(e.values()),i=this.getTargetElement(t);if(!i)return;if(this.shouldPreventGesture(i)){this.isActive&&(this.emitPinchEvent(i,"cancel",n,t),this.resetState());return}const s=this.getRelevantPointers(n,i);switch(t.type){case"pointerdown":if(s.length>=2&&!this.isActive){const a=calculateAverageDistance(s);this.state.startDistance=a,this.state.lastDistance=a,this.state.lastTime=t.timeStamp,this.originalTarget=i}break;case"pointermove":if(this.state.startDistance&&s.length>=this.minPointers){const a=calculateAverageDistance(s),o=Math.abs(a-this.state.lastDistance);if(o!==0&&o>=this.threshold){const c=this.state.startDistance?a/this.state.startDistance:1,h=c/this.state.lastScale;this.state.totalScale*=h;const f=(t.timeStamp-this.state.lastTime)/1e3;if(this.state.lastDistance){const g=(a-this.state.lastDistance)/f;this.state.velocity=Number.isNaN(g)?0:g}this.state.lastDistance=a,this.state.deltaScale=c-this.state.lastScale,this.state.lastScale=c,this.state.lastTime=t.timeStamp,this.isActive?this.emitPinchEvent(i,"ongoing",s,t):(this.isActive=!0,this.emitPinchEvent(i,"start",s,t),this.emitPinchEvent(i,"ongoing",s,t))}}break;case"pointerup":case"pointercancel":case"forceCancel":if(this.isActive){const a=s.filter(o=>o.type!=="pointerup"&&o.type!=="pointercancel");if(a.length<this.minPointers)t.type==="pointercancel"&&this.emitPinchEvent(i,"cancel",s,t),this.emitPinchEvent(i,"end",s,t),this.resetState();else if(a.length>=2){const o=calculateAverageDistance(a);this.state.startDistance=o/this.state.lastScale}}break}}emitPinchEvent(e,t,n,i){const s=calculateCentroid(n),a=this.state.lastDistance,o=this.state.lastScale,c=this.gesturesRegistry.getActiveGestures(e),h={gestureName:this.name,centroid:s,target:i.target,srcEvent:i,phase:t,pointers:n,timeStamp:i.timeStamp,scale:o,deltaScale:this.state.deltaScale,totalScale:this.state.totalScale,distance:a,velocity:this.state.velocity,activeGestures:c,direction:getPinchDirection(this.state.velocity),customData:this.customData};this.preventDefault&&i.preventDefault(),this.stopPropagation&&i.stopPropagation();const f=createEventName(this.name,t),m=new CustomEvent(f,{bubbles:!0,cancelable:!0,composed:!0,detail:h});e.dispatchEvent(m)}}class PressGesture extends PointerGesture{constructor(e){super(e),this.state={startCentroid:null,lastPosition:null,timerId:null,startTime:0,pressThresholdReached:!1},this.isSinglePhase=void 0,this.eventType=void 0,this.optionsType=void 0,this.mutableOptionsType=void 0,this.mutableStateType=void 0,this.duration=void 0,this.maxDistance=void 0,this.duration=e.duration??500,this.maxDistance=e.maxDistance??10}clone(e){return new PressGesture(_extends({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,minPointers:this.minPointers,maxPointers:this.maxPointers,duration:this.duration,maxDistance:this.maxDistance,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf]},e))}destroy(){this.clearPressTimer(),this.resetState(),super.destroy()}updateOptions(e){super.updateOptions(e),this.duration=e.duration??this.duration,this.maxDistance=e.maxDistance??this.maxDistance}resetState(){this.clearPressTimer(),this.isActive=!1,this.state=_extends({},this.state,{startCentroid:null,lastPosition:null,timerId:null,startTime:0,pressThresholdReached:!1})}clearPressTimer(){this.state.timerId!==null&&(clearTimeout(this.state.timerId),this.state.timerId=null)}handlePointerEvent(e,t){const n=Array.from(e.values());if(t.type==="forceCancel"){this.cancelPress(t.target,n,t);return}const i=this.getTargetElement(t);if(!i)return;if(this.shouldPreventGesture(i)){this.isActive&&this.cancelPress(i,n,t);return}const s=this.getRelevantPointers(n,i);if(s.length<this.minPointers||s.length>this.maxPointers){this.isActive&&this.cancelPress(i,s,t);return}switch(t.type){case"pointerdown":!this.isActive&&!this.state.startCentroid&&(this.state.startCentroid=calculateCentroid(s),this.state.lastPosition=_extends({},this.state.startCentroid),this.state.startTime=t.timeStamp,this.isActive=!0,this.originalTarget=i,this.clearPressTimer(),this.state.timerId=setTimeout(()=>{if(this.isActive&&this.state.startCentroid){this.state.pressThresholdReached=!0;const a=this.state.lastPosition;this.emitPressEvent(i,"start",s,t,a),this.emitPressEvent(i,"ongoing",s,t,a)}},this.duration));break;case"pointermove":if(this.isActive&&this.state.startCentroid){const a=calculateCentroid(s);this.state.lastPosition=a;const o=a.x-this.state.startCentroid.x,c=a.y-this.state.startCentroid.y;Math.sqrt(o*o+c*c)>this.maxDistance&&this.cancelPress(i,s,t)}break;case"pointerup":if(this.isActive){if(this.state.pressThresholdReached){const a=this.state.lastPosition||this.state.startCentroid;this.emitPressEvent(i,"end",s,t,a)}this.resetState()}break;case"pointercancel":case"forceCancel":this.cancelPress(i,s,t);break}}emitPressEvent(e,t,n,i,s){const a=this.gesturesRegistry.getActiveGestures(e),o=i.timeStamp-this.state.startTime,c={gestureName:this.name,centroid:s,target:i.target,srcEvent:i,phase:t,pointers:n,timeStamp:i.timeStamp,x:s.x,y:s.y,duration:o,activeGestures:a,customData:this.customData},h=createEventName(this.name,t),f=new CustomEvent(h,{bubbles:!0,cancelable:!0,composed:!0,detail:c});e.dispatchEvent(f),this.preventDefault&&i.preventDefault(),this.stopPropagation&&i.stopPropagation()}cancelPress(e,t,n){if(this.isActive&&this.state.pressThresholdReached){const i=this.state.lastPosition||this.state.startCentroid;this.emitPressEvent(e??this.element,"cancel",t,n,i),this.emitPressEvent(e??this.element,"end",t,n,i)}this.resetState()}}class TapGesture extends PointerGesture{constructor(e){super(e),this.state={startCentroid:null,currentTapCount:0,lastTapTime:0,lastPosition:null},this.isSinglePhase=void 0,this.eventType=void 0,this.optionsType=void 0,this.mutableOptionsType=void 0,this.mutableStateType=void 0,this.maxDistance=void 0,this.taps=void 0,this.maxDistance=e.maxDistance??10,this.taps=e.taps??1}clone(e){return new TapGesture(_extends({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,minPointers:this.minPointers,maxPointers:this.maxPointers,maxDistance:this.maxDistance,taps:this.taps,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf]},e))}destroy(){this.resetState(),super.destroy()}updateOptions(e){super.updateOptions(e),this.maxDistance=e.maxDistance??this.maxDistance,this.taps=e.taps??this.taps}resetState(){this.isActive=!1,this.state={startCentroid:null,currentTapCount:0,lastTapTime:0,lastPosition:null}}handlePointerEvent(e,t){const n=Array.from(e.values()),i=this.getTargetElement(t);if(!i)return;const s=this.getRelevantPointers(n,i);if(this.shouldPreventGesture(i)||s.length<this.minPointers||s.length>this.maxPointers){this.isActive&&this.cancelTap(i,s,t);return}switch(t.type){case"pointerdown":this.isActive||(this.state.startCentroid=calculateCentroid(s),this.state.lastPosition=_extends({},this.state.startCentroid),this.isActive=!0,this.originalTarget=i);break;case"pointermove":if(this.isActive&&this.state.startCentroid){const a=calculateCentroid(s);this.state.lastPosition=a;const o=a.x-this.state.startCentroid.x,c=a.y-this.state.startCentroid.y;Math.sqrt(o*o+c*c)>this.maxDistance&&this.cancelTap(i,s,t)}break;case"pointerup":if(this.isActive){this.state.currentTapCount+=1;const a=this.state.lastPosition||this.state.startCentroid;if(!a){this.cancelTap(i,s,t);return}this.state.currentTapCount>=this.taps?(this.fireTapEvent(i,s,t,a),this.resetState()):(this.state.lastTapTime=t.timeStamp,this.isActive=!1,this.state.startCentroid=null,setTimeout(()=>{this.state&&this.state.currentTapCount>0&&this.state.currentTapCount<this.taps&&(this.state.currentTapCount=0)},300))}break;case"pointercancel":case"forceCancel":this.cancelTap(i,s,t);break}}fireTapEvent(e,t,n,i){const s=this.gesturesRegistry.getActiveGestures(e),a={gestureName:this.name,centroid:i,target:n.target,srcEvent:n,phase:"end",pointers:t,timeStamp:n.timeStamp,x:i.x,y:i.y,tapCount:this.state.currentTapCount,activeGestures:s,customData:this.customData},o=new CustomEvent(this.name,{bubbles:!0,cancelable:!0,composed:!0,detail:a});e.dispatchEvent(o),this.preventDefault&&n.preventDefault(),this.stopPropagation&&n.stopPropagation()}cancelTap(e,t,n){if(this.state.startCentroid||this.state.lastPosition){const i=this.state.lastPosition||this.state.startCentroid,s=this.gesturesRegistry.getActiveGestures(e),a={gestureName:this.name,centroid:i,target:n.target,srcEvent:n,phase:"cancel",pointers:t,timeStamp:n.timeStamp,x:i.x,y:i.y,tapCount:this.state.currentTapCount,activeGestures:s,customData:this.customData},o=createEventName(this.name,"cancel"),c=new CustomEvent(o,{bubbles:!0,cancelable:!0,composed:!0,detail:a});e.dispatchEvent(c)}this.resetState()}}class TurnWheelGesture extends Gesture{constructor(e){super(e),this.state={totalDeltaX:0,totalDeltaY:0,totalDeltaZ:0},this.isSinglePhase=void 0,this.eventType=void 0,this.optionsType=void 0,this.mutableOptionsType=void 0,this.mutableStateType=void 0,this.sensitivity=void 0,this.max=void 0,this.min=void 0,this.initialDelta=void 0,this.invert=void 0,this.handleWheelEventBound=void 0,this.sensitivity=e.sensitivity??1,this.max=e.max??Number.MAX_SAFE_INTEGER,this.min=e.min??Number.MIN_SAFE_INTEGER,this.initialDelta=e.initialDelta??0,this.invert=e.invert??!1,this.state.totalDeltaX=this.initialDelta,this.state.totalDeltaY=this.initialDelta,this.state.totalDeltaZ=this.initialDelta,this.handleWheelEventBound=this.handleWheelEvent.bind(this)}clone(e){return new TurnWheelGesture(_extends({name:this.name,preventDefault:this.preventDefault,stopPropagation:this.stopPropagation,sensitivity:this.sensitivity,max:this.max,min:this.min,initialDelta:this.initialDelta,invert:this.invert,requiredKeys:[...this.requiredKeys],pointerMode:[...this.pointerMode],preventIf:[...this.preventIf]},e))}init(e,t,n,i){super.init(e,t,n,i),this.element.addEventListener("wheel",this.handleWheelEventBound)}destroy(){this.element.removeEventListener("wheel",this.handleWheelEventBound),this.resetState(),super.destroy()}resetState(){this.isActive=!1,this.state={totalDeltaX:0,totalDeltaY:0,totalDeltaZ:0}}updateOptions(e){super.updateOptions(e),this.sensitivity=e.sensitivity??this.sensitivity,this.max=e.max??this.max,this.min=e.min??this.min,this.initialDelta=e.initialDelta??this.initialDelta,this.invert=e.invert??this.invert}handleWheelEvent(e){if(this.shouldPreventGesture(this.element))return;const t=this.pointerManager.getPointers()||new Map,n=Array.from(t.values());this.state.totalDeltaX+=e.deltaX*this.sensitivity*(this.invert?-1:1),this.state.totalDeltaY+=e.deltaY*this.sensitivity*(this.invert?-1:1),this.state.totalDeltaZ+=e.deltaZ*this.sensitivity*(this.invert?-1:1),["totalDeltaX","totalDeltaY","totalDeltaZ"].forEach(i=>{this.state[i]<this.min&&(this.state[i]=this.min),this.state[i]>this.max&&(this.state[i]=this.max)}),this.emitWheelEvent(n,e)}emitWheelEvent(e,t){const n=e.length>0?calculateCentroid(e):{x:t.clientX,y:t.clientY},i=this.gesturesRegistry.getActiveGestures(this.element),s={gestureName:this.name,centroid:n,target:t.target,srcEvent:t,phase:"ongoing",pointers:e,timeStamp:t.timeStamp,deltaX:t.deltaX*this.sensitivity*(this.invert?-1:1),deltaY:t.deltaY*this.sensitivity*(this.invert?-1:1),deltaZ:t.deltaZ*this.sensitivity*(this.invert?-1:1),deltaMode:t.deltaMode,totalDeltaX:this.state.totalDeltaX,totalDeltaY:this.state.totalDeltaY,totalDeltaZ:this.state.totalDeltaZ,activeGestures:i,customData:this.customData};this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation();const a=createEventName(this.name,"ongoing"),o=new CustomEvent(a,{bubbles:!0,cancelable:!0,composed:!0,detail:s});this.element.dispatchEvent(o)}}const preventDefault=r=>r.preventDefault(),useChartInteractionListener=({svgRef:r})=>{reactExports.useEffect(()=>{const t=r.current;if(!t)return;const n=new GestureManager({gestures:[new PanGesture({name:"pan",threshold:0,maxPointers:1}),new MoveGesture({name:"move",preventIf:["pan","pinch"]}),new PinchGesture({name:"pinch",threshold:5,preventIf:["pan"]}),new TurnWheelGesture({name:"turnWheel",sensitivity:.01,initialDelta:1}),new TapGesture({name:"tap",maxDistance:10,preventIf:["pan","pinch"]}),new PressGesture({name:"quickPress",duration:50,maxDistance:10})]});return n.registerElement(["pan","move","pinch","turnWheel","tap","quickPress"],t),()=>{n.destroy()}},[r]);const e=reactExports.useCallback((t,n,i)=>{const s=r.current;return s==null||s.addEventListener(t,n,i),{cleanup:()=>s==null?void 0:s.removeEventListener(t,n)}},[r]);return reactExports.useEffect(()=>{const t=r.current;return t==null||t.addEventListener("gesturestart",preventDefault),t==null||t.addEventListener("gesturechange",preventDefault),t==null||t.addEventListener("gestureend",preventDefault),()=>{t==null||t.removeEventListener("gesturestart",preventDefault),t==null||t.removeEventListener("gesturechange",preventDefault),t==null||t.removeEventListener("gestureend",preventDefault)}},[r]),{instance:{addInteractionListener:e}}};useChartInteractionListener.params={};useChartInteractionListener.getInitialState=()=>({});const CHART_CORE_PLUGINS=[useChartId$1,useChartExperimentalFeatures,useChartDimensions,useChartSeries,useChartInteractionListener,useChartAnimation],_excluded$r=["apiRef"],extractPluginParamsFromProps=r=>{let{plugins:e}=r,t=_objectWithoutPropertiesLoose(r.props,_excluded$r);const n={};e.forEach(a=>{Object.assign(n,a.params)});const i={};return Object.keys(t).forEach(a=>{const o=t[a];n[a]&&(i[a]=o)}),e.reduce((a,o)=>o.getDefaultizedParams?o.getDefaultizedParams({params:a}):a,i)};let globalId=0;function useCharts(r,e,t){const n=useId(),i=reactExports.useMemo(()=>[...CHART_CORE_PLUGINS,...r],[r]),s=extractPluginParamsFromProps({plugins:i,props:e});s.id=s.id??n;const o=reactExports.useRef({}).current,c=useChartApiInitialization(e.apiRef),h=reactExports.useRef(null),f=reactExports.useRef(null),m=reactExports.useRef(null);if(m.current==null){globalId+=1;const E={cacheKey:{id:globalId}};i.forEach(A=>{A.getInitialState&&Object.assign(E,A.getInitialState(s,E,t))}),m.current=new ChartStore(E)}const g=E=>{const A=E({instance:o,params:s,plugins:i,store:m.current,svgRef:f,chartRootRef:h,seriesConfig:t});A.publicAPI&&Object.assign(c.current,A.publicAPI),A.instance&&Object.assign(o,A.instance)};return i.forEach(g),{contextValue:reactExports.useMemo(()=>({store:m.current,publicAPI:c.current,instance:o,svgRef:f,chartRootRef:h}),[o,c])}}function initializeInputApiRef(r){return r.current==null&&(r.current={}),r}function useChartApiInitialization(r){const e=reactExports.useRef({});return r?initializeInputApiRef(r):e}const ChartContext=reactExports.createContext(null),useAssertModelConsistency=()=>{},ZOOM_SLIDER_MARGIN=4,DEFAULT_ZOOM_SLIDER_SIZE=20+2*ZOOM_SLIDER_MARGIN,DEFAULT_ZOOM_SLIDER_PREVIEW_SIZE=40+2*ZOOM_SLIDER_MARGIN,DEFAULT_ZOOM_SLIDER_SHOW_TOOLTIP="hover",DEFAULT_PIE_CHART_MARGIN={top:5,bottom:5,left:5,right:5},defaultZoomOptions={minStart:0,maxEnd:100,step:5,minSpan:10,maxSpan:100,panning:!0,filterMode:"keep",slider:{enabled:!1,preview:!1,size:DEFAULT_ZOOM_SLIDER_SIZE,showTooltip:DEFAULT_ZOOM_SLIDER_SHOW_TOOLTIP}},defaultizeZoom=(r,e,t)=>{var n;if(r)return r===!0?_extends({axisId:e,axisDirection:t},defaultZoomOptions):_extends({axisId:e,axisDirection:t},defaultZoomOptions,r,{slider:_extends({},defaultZoomOptions.slider,{size:((n=r.slider)==null?void 0:n.preview)??defaultZoomOptions.slider.preview?DEFAULT_ZOOM_SLIDER_PREVIEW_SIZE:DEFAULT_ZOOM_SLIDER_SIZE},r.slider)})};function defaultizeXAxis(r,e){const t={top:0,bottom:0,none:0};return(r&&r.length>0?r:[{id:DEFAULT_X_AXIS_KEY,scaleType:"linear"}]).map((s,a)=>{var _;const o=s.dataKey,c=a===0?"bottom":"none",h=s.position??c,f=DEFAULT_AXIS_SIZE_HEIGHT+(s.label?AXIS_LABEL_DEFAULT_HEIGHT:0),m=s.id??`defaultized-x-axis-${a}`,g=_extends({offset:t[h]},s,{id:m,position:h,height:s.height??f,zoom:defaultizeZoom(s.zoom,m,"x")});if(h!=="none"&&(t[h]+=g.height,(_=g.zoom)!=null&&_.slider.enabled&&(t[h]+=g.zoom.slider.size)),o===void 0||s.data!==void 0)return g;if(e===void 0)throw new Error("MUI X Charts: x-axis uses `dataKey` but no `dataset` is provided.");return _extends({},g,{data:e.map(E=>E[o])})})}function defaultizeYAxis(r,e){const t={right:0,left:0,none:0};return(r&&r.length>0?r:[{id:DEFAULT_Y_AXIS_KEY,scaleType:"linear"}]).map((s,a)=>{var _;const o=s.dataKey,c=a===0?"left":"none",h=s.position??c,f=DEFAULT_AXIS_SIZE_WIDTH+(s.label?AXIS_LABEL_DEFAULT_HEIGHT:0),m=s.id??`defaultized-y-axis-${a}`,g=_extends({offset:t[h]},s,{id:m,position:h,width:s.width??f,zoom:defaultizeZoom(s.zoom,m,"y")});if(h!=="none"&&(t[h]+=g.width,(_=g.zoom)!=null&&_.slider.enabled&&(t[h]+=g.zoom.slider.size)),o===void 0||s.data!==void 0)return g;if(e===void 0)throw new Error("MUI X Charts: y-axis uses `dataKey` but no `dataset` is provided.");return _extends({},g,{data:e.map(E=>E[o])})})}function ascending(r,e){return r==null||e==null?NaN:r<e?-1:r>e?1:r>=e?0:NaN}function descending$1(r,e){return r==null||e==null?NaN:e<r?-1:e>r?1:e>=r?0:NaN}function bisector(r){let e,t,n;r.length!==2?(e=ascending,t=(o,c)=>ascending(r(o),c),n=(o,c)=>r(o)-c):(e=r===ascending||r===descending$1?r:zero$1,t=r,n=r);function i(o,c,h=0,f=o.length){if(h<f){if(e(c,c)!==0)return f;do{const m=h+f>>>1;t(o[m],c)<0?h=m+1:f=m}while(h<f)}return h}function s(o,c,h=0,f=o.length){if(h<f){if(e(c,c)!==0)return f;do{const m=h+f>>>1;t(o[m],c)<=0?h=m+1:f=m}while(h<f)}return h}function a(o,c,h=0,f=o.length){const m=i(o,c,h,f-1);return m>h&&n(o[m-1],c)>-n(o[m],c)?m-1:m}return{left:i,center:a,right:s}}function zero$1(){return 0}function number$2(r){return r===null?NaN:+r}const ascendingBisect=bisector(ascending),bisectRight=ascendingBisect.right;bisector(number$2).center;class InternMap extends Map{constructor(e,t=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),e!=null)for(const[n,i]of e)this.set(n,i)}get(e){return super.get(intern_get(this,e))}has(e){return super.has(intern_get(this,e))}set(e,t){return super.set(intern_set(this,e),t)}delete(e){return super.delete(intern_delete(this,e))}}function intern_get({_intern:r,_key:e},t){const n=e(t);return r.has(n)?r.get(n):t}function intern_set({_intern:r,_key:e},t){const n=e(t);return r.has(n)?r.get(n):(r.set(n,t),t)}function intern_delete({_intern:r,_key:e},t){const n=e(t);return r.has(n)&&(t=r.get(n),r.delete(n)),t}function keyof(r){return r!==null&&typeof r=="object"?r.valueOf():r}const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(r,e,t){const n=(e-r)/Math.max(0,t),i=Math.floor(Math.log10(n)),s=n/Math.pow(10,i),a=s>=e10?10:s>=e5?5:s>=e2?2:1;let o,c,h;return i<0?(h=Math.pow(10,-i)/a,o=Math.round(r*h),c=Math.round(e*h),o/h<r&&++o,c/h>e&&--c,h=-h):(h=Math.pow(10,i)*a,o=Math.round(r/h),c=Math.round(e/h),o*h<r&&++o,c*h>e&&--c),c<o&&.5<=t&&t<2?tickSpec(r,e,t*2):[o,c,h]}function ticks(r,e,t){if(e=+e,r=+r,t=+t,!(t>0))return[];if(r===e)return[r];const n=e<r,[i,s,a]=n?tickSpec(e,r,t):tickSpec(r,e,t);if(!(s>=i))return[];const o=s-i+1,c=new Array(o);if(n)if(a<0)for(let h=0;h<o;++h)c[h]=(s-h)/-a;else for(let h=0;h<o;++h)c[h]=(s-h)*a;else if(a<0)for(let h=0;h<o;++h)c[h]=(i+h)/-a;else for(let h=0;h<o;++h)c[h]=(i+h)*a;return c}function tickIncrement(r,e,t){return e=+e,r=+r,t=+t,tickSpec(r,e,t)[2]}function tickStep(r,e,t){e=+e,r=+r,t=+t;const n=e<r,i=n?tickIncrement(e,r,t):tickIncrement(r,e,t);return(n?-1:1)*(i<0?1/-i:i)}function range(r,e,t){r=+r,e=+e,t=(i=arguments.length)<2?(e=r,r=0,1):i<3?1:+t;for(var n=-1,i=Math.max(0,Math.ceil((e-r)/t))|0,s=new Array(i);++n<i;)s[n]=r+n*t;return s}function initRange(r,e){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(e).domain(r);break}return this}function initInterpolator(r,e){switch(arguments.length){case 0:break;case 1:{typeof r=="function"?this.interpolator(r):this.range(r);break}default:{this.domain(r),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const implicit=Symbol("implicit");function ordinal(){var r=new InternMap,e=[],t=[],n=implicit;function i(s){let a=r.get(s);if(a===void 0){if(n!==implicit)return n;r.set(s,a=e.push(s)-1)}return t[a%t.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],r=new InternMap;for(const a of s)r.has(a)||r.set(a,e.push(a)-1);return i},i.range=function(s){return arguments.length?(t=Array.from(s),i):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return ordinal(e,t).unknown(n)},initRange.apply(i,arguments),i}function band(){var r=ordinal().unknown(void 0),e=r.domain,t=r.range,n=0,i=1,s,a,o=!1,c=0,h=0,f=.5;delete r.unknown;function m(){var g=e().length,_=i<n,E=_?i:n,A=_?n:i;s=(A-E)/Math.max(1,g-c+h*2),o&&(s=Math.floor(s)),E+=(A-E-s*(g-c))*f,a=s*(1-c),o&&(E=Math.round(E),a=Math.round(a));var C=range(g).map(function(I){return E+s*I});return t(_?C.reverse():C)}return r.domain=function(g){return arguments.length?(e(g),m()):e()},r.range=function(g){return arguments.length?([n,i]=g,n=+n,i=+i,m()):[n,i]},r.rangeRound=function(g){return[n,i]=g,n=+n,i=+i,o=!0,m()},r.bandwidth=function(){return a},r.step=function(){return s},r.round=function(g){return arguments.length?(o=!!g,m()):o},r.padding=function(g){return arguments.length?(c=Math.min(1,h=+g),m()):c},r.paddingInner=function(g){return arguments.length?(c=Math.min(1,g),m()):c},r.paddingOuter=function(g){return arguments.length?(h=+g,m()):h},r.align=function(g){return arguments.length?(f=Math.max(0,Math.min(1,g)),m()):f},r.copy=function(){return band(e(),[n,i]).round(o).paddingInner(c).paddingOuter(h).align(f)},initRange.apply(m(),arguments)}function pointish(r){var e=r.copy;return r.padding=r.paddingOuter,delete r.paddingInner,delete r.paddingOuter,r.copy=function(){return pointish(e())},r}function point(){return pointish(band.apply(null,arguments).paddingInner(1))}function define(r,e,t){r.prototype=e.prototype=t,t.constructor=r}function extend(r,e){var t=Object.create(r.prototype);for(var n in e)t[n]=e[n];return t}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(r){var e,t;return r=(r+"").trim().toLowerCase(),(e=reHex.exec(r))?(t=e[1].length,e=parseInt(e[1],16),t===6?rgbn(e):t===3?new Rgb(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?rgba(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?rgba(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=reRgbInteger.exec(r))?new Rgb(e[1],e[2],e[3],1):(e=reRgbPercent.exec(r))?new Rgb(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=reRgbaInteger.exec(r))?rgba(e[1],e[2],e[3],e[4]):(e=reRgbaPercent.exec(r))?rgba(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=reHslPercent.exec(r))?hsla(e[1],e[2]/100,e[3]/100,1):(e=reHslaPercent.exec(r))?hsla(e[1],e[2]/100,e[3]/100,e[4]):named.hasOwnProperty(r)?rgbn(named[r]):r==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(r){return new Rgb(r>>16&255,r>>8&255,r&255,1)}function rgba(r,e,t,n){return n<=0&&(r=e=t=NaN),new Rgb(r,e,t,n)}function rgbConvert(r){return r instanceof Color||(r=color(r)),r?(r=r.rgb(),new Rgb(r.r,r.g,r.b,r.opacity)):new Rgb}function rgb$1(r,e,t,n){return arguments.length===1?rgbConvert(r):new Rgb(r,e,t,n??1)}function Rgb(r,e,t,n){this.r=+r,this.g=+e,this.b=+t,this.opacity=+n}define(Rgb,rgb$1,extend(Color,{brighter(r){return r=r==null?brighter:Math.pow(brighter,r),new Rgb(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?darker:Math.pow(darker,r),new Rgb(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const r=clampa(this.opacity);return`${r===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${r===1?")":`, ${r})`}`}function clampa(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function clampi(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function hex(r){return r=clampi(r),(r<16?"0":"")+r.toString(16)}function hsla(r,e,t,n){return n<=0?r=e=t=NaN:t<=0||t>=1?r=e=NaN:e<=0&&(r=NaN),new Hsl(r,e,t,n)}function hslConvert(r){if(r instanceof Hsl)return new Hsl(r.h,r.s,r.l,r.opacity);if(r instanceof Color||(r=color(r)),!r)return new Hsl;if(r instanceof Hsl)return r;r=r.rgb();var e=r.r/255,t=r.g/255,n=r.b/255,i=Math.min(e,t,n),s=Math.max(e,t,n),a=NaN,o=s-i,c=(s+i)/2;return o?(e===s?a=(t-n)/o+(t<n)*6:t===s?a=(n-e)/o+2:a=(e-t)/o+4,o/=c<.5?s+i:2-s-i,a*=60):o=c>0&&c<1?0:a,new Hsl(a,o,c,r.opacity)}function hsl(r,e,t,n){return arguments.length===1?hslConvert(r):new Hsl(r,e,t,n??1)}function Hsl(r,e,t,n){this.h=+r,this.s=+e,this.l=+t,this.opacity=+n}define(Hsl,hsl,extend(Color,{brighter(r){return r=r==null?brighter:Math.pow(brighter,r),new Hsl(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?darker:Math.pow(darker,r),new Hsl(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,e=isNaN(r)||isNaN(this.s)?0:this.s,t=this.l,n=t+(t<.5?t:1-t)*e,i=2*t-n;return new Rgb(hsl2rgb(r>=240?r-240:r+120,i,n),hsl2rgb(r,i,n),hsl2rgb(r<120?r+240:r-120,i,n),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=clampa(this.opacity);return`${r===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${r===1?")":`, ${r})`}`}}));function clamph(r){return r=(r||0)%360,r<0?r+360:r}function clampt(r){return Math.max(0,Math.min(1,r||0))}function hsl2rgb(r,e,t){return(r<60?e+(t-e)*r/60:r<180?t:r<240?e+(t-e)*(240-r)/60:e)*255}const constant$1=r=>()=>r;function linear$1(r,e){return function(t){return r+t*e}}function exponential(r,e,t){return r=Math.pow(r,t),e=Math.pow(e,t)-r,t=1/t,function(n){return Math.pow(r+n*e,t)}}function gamma(r){return(r=+r)==1?nogamma:function(e,t){return t-e?exponential(e,t,r):constant$1(isNaN(e)?t:e)}}function nogamma(r,e){var t=e-r;return t?linear$1(r,t):constant$1(isNaN(r)?e:r)}const rgb=function r(e){var t=gamma(e);function n(i,s){var a=t((i=rgb$1(i)).r,(s=rgb$1(s)).r),o=t(i.g,s.g),c=t(i.b,s.b),h=nogamma(i.opacity,s.opacity);return function(f){return i.r=a(f),i.g=o(f),i.b=c(f),i.opacity=h(f),i+""}}return n.gamma=r,n}(1);function numberArray(r,e){e||(e=[]);var t=r?Math.min(e.length,r.length):0,n=e.slice(),i;return function(s){for(i=0;i<t;++i)n[i]=r[i]*(1-s)+e[i]*s;return n}}function isNumberArray(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function genericArray(r,e){var t=e?e.length:0,n=r?Math.min(t,r.length):0,i=new Array(n),s=new Array(t),a;for(a=0;a<n;++a)i[a]=interpolate(r[a],e[a]);for(;a<t;++a)s[a]=e[a];return function(o){for(a=0;a<n;++a)s[a]=i[a](o);return s}}function interpolateDate(r,e){var t=new Date;return r=+r,e=+e,function(n){return t.setTime(r*(1-n)+e*n),t}}function interpolateNumber(r,e){return r=+r,e=+e,function(t){return r*(1-t)+e*t}}function object(r,e){var t={},n={},i;(r===null||typeof r!="object")&&(r={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in r?t[i]=interpolate(r[i],e[i]):n[i]=e[i];return function(s){for(i in t)n[i]=t[i](s);return n}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(r){return function(){return r}}function one(r){return function(e){return r(e)+""}}function interpolateString(r,e){var t=reA.lastIndex=reB.lastIndex=0,n,i,s,a=-1,o=[],c=[];for(r=r+"",e=e+"";(n=reA.exec(r))&&(i=reB.exec(e));)(s=i.index)>t&&(s=e.slice(t,s),o[a]?o[a]+=s:o[++a]=s),(n=n[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,c.push({i:a,x:interpolateNumber(n,i)})),t=reB.lastIndex;return t<e.length&&(s=e.slice(t),o[a]?o[a]+=s:o[++a]=s),o.length<2?c[0]?one(c[0].x):zero(e):(e=c.length,function(h){for(var f=0,m;f<e;++f)o[(m=c[f]).i]=m.x(h);return o.join("")})}function interpolate(r,e){var t=typeof e,n;return e==null||t==="boolean"?constant$1(e):(t==="number"?interpolateNumber:t==="string"?(n=color(e))?(e=n,rgb):interpolateString:e instanceof color?rgb:e instanceof Date?interpolateDate:isNumberArray(e)?numberArray:Array.isArray(e)?genericArray:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?object:interpolateNumber)(r,e)}function interpolateRound(r,e){return r=+r,e=+e,function(t){return Math.round(r*(1-t)+e*t)}}function constants(r){return function(){return r}}function number$1(r){return+r}var unit=[0,1];function identity$2(r){return r}function normalize(r,e){return(e-=r=+r)?function(t){return(t-r)/e}:constants(isNaN(e)?NaN:.5)}function clamper(r,e){var t;return r>e&&(t=r,r=e,e=t),function(n){return Math.max(r,Math.min(e,n))}}function bimap(r,e,t){var n=r[0],i=r[1],s=e[0],a=e[1];return i<n?(n=normalize(i,n),s=t(a,s)):(n=normalize(n,i),s=t(s,a)),function(o){return s(n(o))}}function polymap(r,e,t){var n=Math.min(r.length,e.length)-1,i=new Array(n),s=new Array(n),a=-1;for(r[n]<r[0]&&(r=r.slice().reverse(),e=e.slice().reverse());++a<n;)i[a]=normalize(r[a],r[a+1]),s[a]=t(e[a],e[a+1]);return function(o){var c=bisectRight(r,o,1,n)-1;return s[c](i[c](o))}}function copy$1(r,e){return e.domain(r.domain()).range(r.range()).interpolate(r.interpolate()).clamp(r.clamp()).unknown(r.unknown())}function transformer$1(){var r=unit,e=unit,t=interpolate,n,i,s,a=identity$2,o,c,h;function f(){var g=Math.min(r.length,e.length);return a!==identity$2&&(a=clamper(r[0],r[g-1])),o=g>2?polymap:bimap,c=h=null,m}function m(g){return g==null||isNaN(g=+g)?s:(c||(c=o(r.map(n),e,t)))(n(a(g)))}return m.invert=function(g){return a(i((h||(h=o(e,r.map(n),interpolateNumber)))(g)))},m.domain=function(g){return arguments.length?(r=Array.from(g,number$1),f()):r.slice()},m.range=function(g){return arguments.length?(e=Array.from(g),f()):e.slice()},m.rangeRound=function(g){return e=Array.from(g),t=interpolateRound,f()},m.clamp=function(g){return arguments.length?(a=g?!0:identity$2,f()):a!==identity$2},m.interpolate=function(g){return arguments.length?(t=g,f()):t},m.unknown=function(g){return arguments.length?(s=g,m):s},function(g,_){return n=g,i=_,f()}}function continuous(){return transformer$1()(identity$2,identity$2)}function formatDecimal(r){return Math.abs(r=Math.round(r))>=1e21?r.toLocaleString("en").replace(/,/g,""):r.toString(10)}function formatDecimalParts(r,e){if((t=(r=e?r.toExponential(e-1):r.toExponential()).indexOf("e"))<0)return null;var t,n=r.slice(0,t);return[n.length>1?n[0]+n.slice(2):n,+r.slice(t+1)]}function exponent(r){return r=formatDecimalParts(Math.abs(r)),r?r[1]:NaN}function formatGroup(r,e){return function(t,n){for(var i=t.length,s=[],a=0,o=r[0],c=0;i>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),s.push(t.substring(i-=o,i+o)),!((c+=o+1)>n));)o=r[a=(a+1)%r.length];return s.reverse().join(e)}}function formatNumerals(r){return function(e){return e.replace(/[0-9]/g,function(t){return r[+t]})}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(r){if(!(e=re.exec(r)))throw new Error("invalid format: "+r);var e;return new FormatSpecifier({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(r){this.fill=r.fill===void 0?" ":r.fill+"",this.align=r.align===void 0?">":r.align+"",this.sign=r.sign===void 0?"-":r.sign+"",this.symbol=r.symbol===void 0?"":r.symbol+"",this.zero=!!r.zero,this.width=r.width===void 0?void 0:+r.width,this.comma=!!r.comma,this.precision=r.precision===void 0?void 0:+r.precision,this.trim=!!r.trim,this.type=r.type===void 0?"":r.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim(r){e:for(var e=r.length,t=1,n=-1,i;t<e;++t)switch(r[t]){case".":n=i=t;break;case"0":n===0&&(n=t),i=t;break;default:if(!+r[t])break e;n>0&&(n=0);break}return n>0?r.slice(0,n)+r.slice(i+1):r}var prefixExponent;function formatPrefixAuto(r,e){var t=formatDecimalParts(r,e);if(!t)return r+"";var n=t[0],i=t[1],s=i-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=n.length;return s===a?n:s>a?n+new Array(s-a+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+formatDecimalParts(r,Math.max(0,e+s-1))[0]}function formatRounded(r,e){var t=formatDecimalParts(r,e);if(!t)return r+"";var n=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const formatTypes={"%":(r,e)=>(r*100).toFixed(e),b:r=>Math.round(r).toString(2),c:r=>r+"",d:formatDecimal,e:(r,e)=>r.toExponential(e),f:(r,e)=>r.toFixed(e),g:(r,e)=>r.toPrecision(e),o:r=>Math.round(r).toString(8),p:(r,e)=>formatRounded(r*100,e),r:formatRounded,s:formatPrefixAuto,X:r=>Math.round(r).toString(16).toUpperCase(),x:r=>Math.round(r).toString(16)};function identity$1(r){return r}var map=Array.prototype.map,prefixes=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function formatLocale$1(r){var e=r.grouping===void 0||r.thousands===void 0?identity$1:formatGroup(map.call(r.grouping,Number),r.thousands+""),t=r.currency===void 0?"":r.currency[0]+"",n=r.currency===void 0?"":r.currency[1]+"",i=r.decimal===void 0?".":r.decimal+"",s=r.numerals===void 0?identity$1:formatNumerals(map.call(r.numerals,String)),a=r.percent===void 0?"%":r.percent+"",o=r.minus===void 0?"−":r.minus+"",c=r.nan===void 0?"NaN":r.nan+"";function h(m){m=formatSpecifier(m);var g=m.fill,_=m.align,E=m.sign,A=m.symbol,C=m.zero,I=m.width,b=m.comma,R=m.precision,V=m.trim,U=m.type;U==="n"?(b=!0,U="g"):formatTypes[U]||(R===void 0&&(R=12),V=!0,U="g"),(C||g==="0"&&_==="=")&&(C=!0,g="0",_="=");var W=A==="$"?t:A==="#"&&/[boxX]/.test(U)?"0"+U.toLowerCase():"",j=A==="$"?n:/[%p]/.test(U)?a:"",w=formatTypes[U],P=/[defgprs%]/.test(U);R=R===void 0?6:/[gprs]/.test(U)?Math.max(1,Math.min(21,R)):Math.max(0,Math.min(20,R));function K(X){var Y=W,Z=j,ae,le,ie;if(U==="c")Z=w(X)+Z,X="";else{X=+X;var se=X<0||1/X<0;if(X=isNaN(X)?c:w(Math.abs(X),R),V&&(X=formatTrim(X)),se&&+X==0&&E!=="+"&&(se=!1),Y=(se?E==="("?E:o:E==="-"||E==="("?"":E)+Y,Z=(U==="s"?prefixes[8+prefixExponent/3]:"")+Z+(se&&E==="("?")":""),P){for(ae=-1,le=X.length;++ae<le;)if(ie=X.charCodeAt(ae),48>ie||ie>57){Z=(ie===46?i+X.slice(ae+1):X.slice(ae))+Z,X=X.slice(0,ae);break}}}b&&!C&&(X=e(X,1/0));var ce=Y.length+X.length+Z.length,ue=ce<I?new Array(I-ce+1).join(g):"";switch(b&&C&&(X=e(ue+X,ue.length?I-Z.length:1/0),ue=""),_){case"<":X=Y+X+Z+ue;break;case"=":X=Y+ue+X+Z;break;case"^":X=ue.slice(0,ce=ue.length>>1)+Y+X+Z+ue.slice(ce);break;default:X=ue+Y+X+Z;break}return s(X)}return K.toString=function(){return m+""},K}function f(m,g){var _=h((m=formatSpecifier(m),m.type="f",m)),E=Math.max(-8,Math.min(8,Math.floor(exponent(g)/3)))*3,A=Math.pow(10,-E),C=prefixes[8+E/3];return function(I){return _(A*I)+C}}return{format:h,formatPrefix:f}}var locale$1,format,formatPrefix;defaultLocale$1({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale$1(r){return locale$1=formatLocale$1(r),format=locale$1.format,formatPrefix=locale$1.formatPrefix,locale$1}function precisionFixed(r){return Math.max(0,-exponent(Math.abs(r)))}function precisionPrefix(r,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent(e)/3)))*3-exponent(Math.abs(r)))}function precisionRound(r,e){return r=Math.abs(r),e=Math.abs(e)-r,Math.max(0,exponent(e)-exponent(r))+1}function tickFormat(r,e,t,n){var i=tickStep(r,e,t),s;switch(n=formatSpecifier(n??",f"),n.type){case"s":{var a=Math.max(Math.abs(r),Math.abs(e));return n.precision==null&&!isNaN(s=precisionPrefix(i,a))&&(n.precision=s),formatPrefix(n,a)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=precisionRound(i,Math.max(Math.abs(r),Math.abs(e))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=precisionFixed(i))&&(n.precision=s-(n.type==="%")*2);break}}return format(n)}function linearish(r){var e=r.domain;return r.ticks=function(t){var n=e();return ticks(n[0],n[n.length-1],t??10)},r.tickFormat=function(t,n){var i=e();return tickFormat(i[0],i[i.length-1],t??10,n)},r.nice=function(t){t==null&&(t=10);var n=e(),i=0,s=n.length-1,a=n[i],o=n[s],c,h,f=10;for(o<a&&(h=a,a=o,o=h,h=i,i=s,s=h);f-- >0;){if(h=tickIncrement(a,o,t),h===c)return n[i]=a,n[s]=o,e(n);if(h>0)a=Math.floor(a/h)*h,o=Math.ceil(o/h)*h;else if(h<0)a=Math.ceil(a*h)/h,o=Math.floor(o*h)/h;else break;c=h}return r},r}function linear(){var r=continuous();return r.copy=function(){return copy$1(r,linear())},initRange.apply(r,arguments),linearish(r)}function nice(r,e){r=r.slice();var t=0,n=r.length-1,i=r[t],s=r[n],a;return s<i&&(a=t,t=n,n=a,a=i,i=s,s=a),r[t]=e.floor(i),r[n]=e.ceil(s),r}function transformLog(r){return Math.log(r)}function transformExp(r){return Math.exp(r)}function transformLogn(r){return-Math.log(-r)}function transformExpn(r){return-Math.exp(-r)}function pow10(r){return isFinite(r)?+("1e"+r):r<0?0:r}function powp(r){return r===10?pow10:r===Math.E?Math.exp:e=>Math.pow(r,e)}function logp(r){return r===Math.E?Math.log:r===10&&Math.log10||r===2&&Math.log2||(r=Math.log(r),e=>Math.log(e)/r)}function reflect(r){return(e,t)=>-r(-e,t)}function loggish(r){const e=r(transformLog,transformExp),t=e.domain;let n=10,i,s;function a(){return i=logp(n),s=powp(n),t()[0]<0?(i=reflect(i),s=reflect(s),r(transformLogn,transformExpn)):r(transformLog,transformExp),e}return e.base=function(o){return arguments.length?(n=+o,a()):n},e.domain=function(o){return arguments.length?(t(o),a()):t()},e.ticks=o=>{const c=t();let h=c[0],f=c[c.length-1];const m=f<h;m&&([h,f]=[f,h]);let g=i(h),_=i(f),E,A;const C=o==null?10:+o;let I=[];if(!(n%1)&&_-g<C){if(g=Math.floor(g),_=Math.ceil(_),h>0){for(;g<=_;++g)for(E=1;E<n;++E)if(A=g<0?E/s(-g):E*s(g),!(A<h)){if(A>f)break;I.push(A)}}else for(;g<=_;++g)for(E=n-1;E>=1;--E)if(A=g>0?E/s(-g):E*s(g),!(A<h)){if(A>f)break;I.push(A)}I.length*2<C&&(I=ticks(h,f,C))}else I=ticks(g,_,Math.min(_-g,C)).map(s);return m?I.reverse():I},e.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=formatSpecifier(c)).precision==null&&(c.trim=!0),c=format(c)),o===1/0)return c;const h=Math.max(1,n*o/e.ticks().length);return f=>{let m=f/s(Math.round(i(f)));return m*n<n-.5&&(m*=n),m<=h?c(f):""}},e.nice=()=>t(nice(t(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),e}function log(){const r=loggish(transformer$1()).domain([1,10]);return r.copy=()=>copy$1(r,log()).base(r.base()),initRange.apply(r,arguments),r}function transformSymlog(r){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/r))}}function transformSymexp(r){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*r}}function symlogish(r){var e=1,t=r(transformSymlog(e),transformSymexp(e));return t.constant=function(n){return arguments.length?r(transformSymlog(e=+n),transformSymexp(e)):e},linearish(t)}function symlog(){var r=symlogish(transformer$1());return r.copy=function(){return copy$1(r,symlog()).constant(r.constant())},initRange.apply(r,arguments)}function transformPow(r){return function(e){return e<0?-Math.pow(-e,r):Math.pow(e,r)}}function transformSqrt(r){return r<0?-Math.sqrt(-r):Math.sqrt(r)}function transformSquare(r){return r<0?-r*r:r*r}function powish(r){var e=r(identity$2,identity$2),t=1;function n(){return t===1?r(identity$2,identity$2):t===.5?r(transformSqrt,transformSquare):r(transformPow(t),transformPow(1/t))}return e.exponent=function(i){return arguments.length?(t=+i,n()):t},linearish(e)}function pow$1(){var r=powish(transformer$1());return r.copy=function(){return copy$1(r,pow$1()).exponent(r.exponent())},initRange.apply(r,arguments),r}function sqrt$1(){return pow$1.apply(null,arguments).exponent(.5)}function threshold(){var r=[.5],e=[0,1],t,n=1;function i(s){return s!=null&&s<=s?e[bisectRight(r,s,0,n)]:t}return i.domain=function(s){return arguments.length?(r=Array.from(s),n=Math.min(r.length,e.length-1),i):r.slice()},i.range=function(s){return arguments.length?(e=Array.from(s),n=Math.min(r.length,e.length-1),i):e.slice()},i.invertExtent=function(s){var a=e.indexOf(s);return[r[a-1],r[a]]},i.unknown=function(s){return arguments.length?(t=s,i):t},i.copy=function(){return threshold().domain(r).range(e).unknown(t)},initRange.apply(i,arguments)}const t0=new Date,t1=new Date;function timeInterval(r,e,t,n){function i(s){return r(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(r(s=new Date(+s)),s),i.ceil=s=>(r(s=new Date(s-1)),e(s,1),r(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(e(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const c=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return c;let h;do c.push(h=new Date(+s)),e(s,o),r(s);while(h<s&&s<a);return c},i.filter=s=>timeInterval(a=>{if(a>=a)for(;r(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;e(a,-1),!s(a););else for(;--o>=0;)for(;e(a,1),!s(a););}),t&&(i.count=(s,a)=>(t0.setTime(+s),t1.setTime(+a),r(t0),r(t1),Math.floor(t(t0,t1))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(n?a=>n(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const millisecond=timeInterval(()=>{},(r,e)=>{r.setTime(+r+e)},(r,e)=>e-r);millisecond.every=r=>(r=Math.floor(r),!isFinite(r)||!(r>0)?null:r>1?timeInterval(e=>{e.setTime(Math.floor(e/r)*r)},(e,t)=>{e.setTime(+e+t*r)},(e,t)=>(t-e)/r):millisecond);millisecond.range;const durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,second=timeInterval(r=>{r.setTime(r-r.getMilliseconds())},(r,e)=>{r.setTime(+r+e*durationSecond)},(r,e)=>(e-r)/durationSecond,r=>r.getUTCSeconds());second.range;const timeMinute=timeInterval(r=>{r.setTime(r-r.getMilliseconds()-r.getSeconds()*durationSecond)},(r,e)=>{r.setTime(+r+e*durationMinute)},(r,e)=>(e-r)/durationMinute,r=>r.getMinutes());timeMinute.range;const utcMinute=timeInterval(r=>{r.setUTCSeconds(0,0)},(r,e)=>{r.setTime(+r+e*durationMinute)},(r,e)=>(e-r)/durationMinute,r=>r.getUTCMinutes());utcMinute.range;const timeHour=timeInterval(r=>{r.setTime(r-r.getMilliseconds()-r.getSeconds()*durationSecond-r.getMinutes()*durationMinute)},(r,e)=>{r.setTime(+r+e*durationHour)},(r,e)=>(e-r)/durationHour,r=>r.getHours());timeHour.range;const utcHour=timeInterval(r=>{r.setUTCMinutes(0,0,0)},(r,e)=>{r.setTime(+r+e*durationHour)},(r,e)=>(e-r)/durationHour,r=>r.getUTCHours());utcHour.range;const timeDay=timeInterval(r=>r.setHours(0,0,0,0),(r,e)=>r.setDate(r.getDate()+e),(r,e)=>(e-r-(e.getTimezoneOffset()-r.getTimezoneOffset())*durationMinute)/durationDay,r=>r.getDate()-1);timeDay.range;const utcDay=timeInterval(r=>{r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCDate(r.getUTCDate()+e)},(r,e)=>(e-r)/durationDay,r=>r.getUTCDate()-1);utcDay.range;const unixDay=timeInterval(r=>{r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCDate(r.getUTCDate()+e)},(r,e)=>(e-r)/durationDay,r=>Math.floor(r/durationDay));unixDay.range;function timeWeekday(r){return timeInterval(e=>{e.setDate(e.getDate()-(e.getDay()+7-r)%7),e.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+t*7)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*durationMinute)/durationWeek)}const timeSunday=timeWeekday(0),timeMonday=timeWeekday(1),timeTuesday=timeWeekday(2),timeWednesday=timeWeekday(3),timeThursday=timeWeekday(4),timeFriday=timeWeekday(5),timeSaturday=timeWeekday(6);timeSunday.range;timeMonday.range;timeTuesday.range;timeWednesday.range;timeThursday.range;timeFriday.range;timeSaturday.range;function utcWeekday(r){return timeInterval(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-r)%7),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t*7)},(e,t)=>(t-e)/durationWeek)}const utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6);utcSunday.range;utcMonday.range;utcTuesday.range;utcWednesday.range;utcThursday.range;utcFriday.range;utcSaturday.range;const timeMonth=timeInterval(r=>{r.setDate(1),r.setHours(0,0,0,0)},(r,e)=>{r.setMonth(r.getMonth()+e)},(r,e)=>e.getMonth()-r.getMonth()+(e.getFullYear()-r.getFullYear())*12,r=>r.getMonth());timeMonth.range;const utcMonth=timeInterval(r=>{r.setUTCDate(1),r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCMonth(r.getUTCMonth()+e)},(r,e)=>e.getUTCMonth()-r.getUTCMonth()+(e.getUTCFullYear()-r.getUTCFullYear())*12,r=>r.getUTCMonth());utcMonth.range;const timeYear=timeInterval(r=>{r.setMonth(0,1),r.setHours(0,0,0,0)},(r,e)=>{r.setFullYear(r.getFullYear()+e)},(r,e)=>e.getFullYear()-r.getFullYear(),r=>r.getFullYear());timeYear.every=r=>!isFinite(r=Math.floor(r))||!(r>0)?null:timeInterval(e=>{e.setFullYear(Math.floor(e.getFullYear()/r)*r),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t*r)});timeYear.range;const utcYear=timeInterval(r=>{r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,e)=>{r.setUTCFullYear(r.getUTCFullYear()+e)},(r,e)=>e.getUTCFullYear()-r.getUTCFullYear(),r=>r.getUTCFullYear());utcYear.every=r=>!isFinite(r=Math.floor(r))||!(r>0)?null:timeInterval(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/r)*r),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t*r)});utcYear.range;function ticker(r,e,t,n,i,s){const a=[[second,1,durationSecond],[second,5,5*durationSecond],[second,15,15*durationSecond],[second,30,30*durationSecond],[s,1,durationMinute],[s,5,5*durationMinute],[s,15,15*durationMinute],[s,30,30*durationMinute],[i,1,durationHour],[i,3,3*durationHour],[i,6,6*durationHour],[i,12,12*durationHour],[n,1,durationDay],[n,2,2*durationDay],[t,1,durationWeek],[e,1,durationMonth],[e,3,3*durationMonth],[r,1,durationYear]];function o(h,f,m){const g=f<h;g&&([h,f]=[f,h]);const _=m&&typeof m.range=="function"?m:c(h,f,m),E=_?_.range(h,+f+1):[];return g?E.reverse():E}function c(h,f,m){const g=Math.abs(f-h)/m,_=bisector(([,,C])=>C).right(a,g);if(_===a.length)return r.every(tickStep(h/durationYear,f/durationYear,m));if(_===0)return millisecond.every(Math.max(tickStep(h,f,m),1));const[E,A]=a[g/a[_-1][2]<a[_][2]/g?_-1:_];return E.every(A)}return[o,c]}const[utcTicks,utcTickInterval]=ticker(utcYear,utcMonth,utcSunday,unixDay,utcHour,utcMinute),[timeTicks,timeTickInterval]=ticker(timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute);function localDate(r){if(0<=r.y&&r.y<100){var e=new Date(-1,r.m,r.d,r.H,r.M,r.S,r.L);return e.setFullYear(r.y),e}return new Date(r.y,r.m,r.d,r.H,r.M,r.S,r.L)}function utcDate(r){if(0<=r.y&&r.y<100){var e=new Date(Date.UTC(-1,r.m,r.d,r.H,r.M,r.S,r.L));return e.setUTCFullYear(r.y),e}return new Date(Date.UTC(r.y,r.m,r.d,r.H,r.M,r.S,r.L))}function newDate(r,e,t){return{y:r,m:e,d:t,H:0,M:0,S:0,L:0}}function formatLocale(r){var e=r.dateTime,t=r.date,n=r.time,i=r.periods,s=r.days,a=r.shortDays,o=r.months,c=r.shortMonths,h=formatRe(i),f=formatLookup(i),m=formatRe(s),g=formatLookup(s),_=formatRe(a),E=formatLookup(a),A=formatRe(o),C=formatLookup(o),I=formatRe(c),b=formatLookup(c),R={a:se,A:ce,b:ue,B:Ae,c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:Se,q:ye,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},V={a:he,A:ke,b:Pe,B:Le,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:$e,q:qe,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},U={a:K,A:X,b:Y,B:Z,c:ae,d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:P,q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:le,X:ie,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};R.x=W(t,R),R.X=W(n,R),R.c=W(e,R),V.x=W(t,V),V.X=W(n,V),V.c=W(e,V);function W(xe,Ie){return function(Te){var pe=[],Fe=-1,Re=0,Ue=xe.length,Ve,Me,ze;for(Te instanceof Date||(Te=new Date(+Te));++Fe<Ue;)xe.charCodeAt(Fe)===37&&(pe.push(xe.slice(Re,Fe)),(Me=pads[Ve=xe.charAt(++Fe)])!=null?Ve=xe.charAt(++Fe):Me=Ve==="e"?" ":"0",(ze=Ie[Ve])&&(Ve=ze(Te,Me)),pe.push(Ve),Re=Fe+1);return pe.push(xe.slice(Re,Fe)),pe.join("")}}function j(xe,Ie){return function(Te){var pe=newDate(1900,void 0,1),Fe=w(pe,xe,Te+="",0),Re,Ue;if(Fe!=Te.length)return null;if("Q"in pe)return new Date(pe.Q);if("s"in pe)return new Date(pe.s*1e3+("L"in pe?pe.L:0));if(Ie&&!("Z"in pe)&&(pe.Z=0),"p"in pe&&(pe.H=pe.H%12+pe.p*12),pe.m===void 0&&(pe.m="q"in pe?pe.q:0),"V"in pe){if(pe.V<1||pe.V>53)return null;"w"in pe||(pe.w=1),"Z"in pe?(Re=utcDate(newDate(pe.y,0,1)),Ue=Re.getUTCDay(),Re=Ue>4||Ue===0?utcMonday.ceil(Re):utcMonday(Re),Re=utcDay.offset(Re,(pe.V-1)*7),pe.y=Re.getUTCFullYear(),pe.m=Re.getUTCMonth(),pe.d=Re.getUTCDate()+(pe.w+6)%7):(Re=localDate(newDate(pe.y,0,1)),Ue=Re.getDay(),Re=Ue>4||Ue===0?timeMonday.ceil(Re):timeMonday(Re),Re=timeDay.offset(Re,(pe.V-1)*7),pe.y=Re.getFullYear(),pe.m=Re.getMonth(),pe.d=Re.getDate()+(pe.w+6)%7)}else("W"in pe||"U"in pe)&&("w"in pe||(pe.w="u"in pe?pe.u%7:"W"in pe?1:0),Ue="Z"in pe?utcDate(newDate(pe.y,0,1)).getUTCDay():localDate(newDate(pe.y,0,1)).getDay(),pe.m=0,pe.d="W"in pe?(pe.w+6)%7+pe.W*7-(Ue+5)%7:pe.w+pe.U*7-(Ue+6)%7);return"Z"in pe?(pe.H+=pe.Z/100|0,pe.M+=pe.Z%100,utcDate(pe)):localDate(pe)}}function w(xe,Ie,Te,pe){for(var Fe=0,Re=Ie.length,Ue=Te.length,Ve,Me;Fe<Re;){if(pe>=Ue)return-1;if(Ve=Ie.charCodeAt(Fe++),Ve===37){if(Ve=Ie.charAt(Fe++),Me=U[Ve in pads?Ie.charAt(Fe++):Ve],!Me||(pe=Me(xe,Te,pe))<0)return-1}else if(Ve!=Te.charCodeAt(pe++))return-1}return pe}function P(xe,Ie,Te){var pe=h.exec(Ie.slice(Te));return pe?(xe.p=f.get(pe[0].toLowerCase()),Te+pe[0].length):-1}function K(xe,Ie,Te){var pe=_.exec(Ie.slice(Te));return pe?(xe.w=E.get(pe[0].toLowerCase()),Te+pe[0].length):-1}function X(xe,Ie,Te){var pe=m.exec(Ie.slice(Te));return pe?(xe.w=g.get(pe[0].toLowerCase()),Te+pe[0].length):-1}function Y(xe,Ie,Te){var pe=I.exec(Ie.slice(Te));return pe?(xe.m=b.get(pe[0].toLowerCase()),Te+pe[0].length):-1}function Z(xe,Ie,Te){var pe=A.exec(Ie.slice(Te));return pe?(xe.m=C.get(pe[0].toLowerCase()),Te+pe[0].length):-1}function ae(xe,Ie,Te){return w(xe,e,Ie,Te)}function le(xe,Ie,Te){return w(xe,t,Ie,Te)}function ie(xe,Ie,Te){return w(xe,n,Ie,Te)}function se(xe){return a[xe.getDay()]}function ce(xe){return s[xe.getDay()]}function ue(xe){return c[xe.getMonth()]}function Ae(xe){return o[xe.getMonth()]}function Se(xe){return i[+(xe.getHours()>=12)]}function ye(xe){return 1+~~(xe.getMonth()/3)}function he(xe){return a[xe.getUTCDay()]}function ke(xe){return s[xe.getUTCDay()]}function Pe(xe){return c[xe.getUTCMonth()]}function Le(xe){return o[xe.getUTCMonth()]}function $e(xe){return i[+(xe.getUTCHours()>=12)]}function qe(xe){return 1+~~(xe.getUTCMonth()/3)}return{format:function(xe){var Ie=W(xe+="",R);return Ie.toString=function(){return xe},Ie},parse:function(xe){var Ie=j(xe+="",!1);return Ie.toString=function(){return xe},Ie},utcFormat:function(xe){var Ie=W(xe+="",V);return Ie.toString=function(){return xe},Ie},utcParse:function(xe){var Ie=j(xe+="",!0);return Ie.toString=function(){return xe},Ie}}}var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function pad(r,e,t){var n=r<0?"-":"",i=(n?-r:r)+"",s=i.length;return n+(s<t?new Array(t-s+1).join(e)+i:i)}function requote(r){return r.replace(requoteRe,"\\$&")}function formatRe(r){return new RegExp("^(?:"+r.map(requote).join("|")+")","i")}function formatLookup(r){return new Map(r.map((e,t)=>[e.toLowerCase(),t]))}function parseWeekdayNumberSunday(r,e,t){var n=numberRe.exec(e.slice(t,t+1));return n?(r.w=+n[0],t+n[0].length):-1}function parseWeekdayNumberMonday(r,e,t){var n=numberRe.exec(e.slice(t,t+1));return n?(r.u=+n[0],t+n[0].length):-1}function parseWeekNumberSunday(r,e,t){var n=numberRe.exec(e.slice(t,t+2));return n?(r.U=+n[0],t+n[0].length):-1}function parseWeekNumberISO(r,e,t){var n=numberRe.exec(e.slice(t,t+2));return n?(r.V=+n[0],t+n[0].length):-1}function parseWeekNumberMonday(r,e,t){var n=numberRe.exec(e.slice(t,t+2));return n?(r.W=+n[0],t+n[0].length):-1}function parseFullYear(r,e,t){var n=numberRe.exec(e.slice(t,t+4));return n?(r.y=+n[0],t+n[0].length):-1}function parseYear(r,e,t){var n=numberRe.exec(e.slice(t,t+2));return n?(r.y=+n[0]+(+n[0]>68?1900:2e3),t+n[0].length):-1}function parseZone(r,e,t){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(t,t+6));return n?(r.Z=n[1]?0:-(n[2]+(n[3]||"00")),t+n[0].length):-1}function parseQuarter(r,e,t){var n=numberRe.exec(e.slice(t,t+1));return n?(r.q=n[0]*3-3,t+n[0].length):-1}function parseMonthNumber(r,e,t){var n=numberRe.exec(e.slice(t,t+2));return n?(r.m=n[0]-1,t+n[0].length):-1}function parseDayOfMonth(r,e,t){var n=numberRe.exec(e.slice(t,t+2));return n?(r.d=+n[0],t+n[0].length):-1}function parseDayOfYear(r,e,t){var n=numberRe.exec(e.slice(t,t+3));return n?(r.m=0,r.d=+n[0],t+n[0].length):-1}function parseHour24(r,e,t){var n=numberRe.exec(e.slice(t,t+2));return n?(r.H=+n[0],t+n[0].length):-1}function parseMinutes(r,e,t){var n=numberRe.exec(e.slice(t,t+2));return n?(r.M=+n[0],t+n[0].length):-1}function parseSeconds(r,e,t){var n=numberRe.exec(e.slice(t,t+2));return n?(r.S=+n[0],t+n[0].length):-1}function parseMilliseconds(r,e,t){var n=numberRe.exec(e.slice(t,t+3));return n?(r.L=+n[0],t+n[0].length):-1}function parseMicroseconds(r,e,t){var n=numberRe.exec(e.slice(t,t+6));return n?(r.L=Math.floor(n[0]/1e3),t+n[0].length):-1}function parseLiteralPercent(r,e,t){var n=percentRe.exec(e.slice(t,t+1));return n?t+n[0].length:-1}function parseUnixTimestamp(r,e,t){var n=numberRe.exec(e.slice(t));return n?(r.Q=+n[0],t+n[0].length):-1}function parseUnixTimestampSeconds(r,e,t){var n=numberRe.exec(e.slice(t));return n?(r.s=+n[0],t+n[0].length):-1}function formatDayOfMonth(r,e){return pad(r.getDate(),e,2)}function formatHour24(r,e){return pad(r.getHours(),e,2)}function formatHour12(r,e){return pad(r.getHours()%12||12,e,2)}function formatDayOfYear(r,e){return pad(1+timeDay.count(timeYear(r),r),e,3)}function formatMilliseconds(r,e){return pad(r.getMilliseconds(),e,3)}function formatMicroseconds(r,e){return formatMilliseconds(r,e)+"000"}function formatMonthNumber(r,e){return pad(r.getMonth()+1,e,2)}function formatMinutes(r,e){return pad(r.getMinutes(),e,2)}function formatSeconds(r,e){return pad(r.getSeconds(),e,2)}function formatWeekdayNumberMonday(r){var e=r.getDay();return e===0?7:e}function formatWeekNumberSunday(r,e){return pad(timeSunday.count(timeYear(r)-1,r),e,2)}function dISO(r){var e=r.getDay();return e>=4||e===0?timeThursday(r):timeThursday.ceil(r)}function formatWeekNumberISO(r,e){return r=dISO(r),pad(timeThursday.count(timeYear(r),r)+(timeYear(r).getDay()===4),e,2)}function formatWeekdayNumberSunday(r){return r.getDay()}function formatWeekNumberMonday(r,e){return pad(timeMonday.count(timeYear(r)-1,r),e,2)}function formatYear(r,e){return pad(r.getFullYear()%100,e,2)}function formatYearISO(r,e){return r=dISO(r),pad(r.getFullYear()%100,e,2)}function formatFullYear(r,e){return pad(r.getFullYear()%1e4,e,4)}function formatFullYearISO(r,e){var t=r.getDay();return r=t>=4||t===0?timeThursday(r):timeThursday.ceil(r),pad(r.getFullYear()%1e4,e,4)}function formatZone(r){var e=r.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+pad(e/60|0,"0",2)+pad(e%60,"0",2)}function formatUTCDayOfMonth(r,e){return pad(r.getUTCDate(),e,2)}function formatUTCHour24(r,e){return pad(r.getUTCHours(),e,2)}function formatUTCHour12(r,e){return pad(r.getUTCHours()%12||12,e,2)}function formatUTCDayOfYear(r,e){return pad(1+utcDay.count(utcYear(r),r),e,3)}function formatUTCMilliseconds(r,e){return pad(r.getUTCMilliseconds(),e,3)}function formatUTCMicroseconds(r,e){return formatUTCMilliseconds(r,e)+"000"}function formatUTCMonthNumber(r,e){return pad(r.getUTCMonth()+1,e,2)}function formatUTCMinutes(r,e){return pad(r.getUTCMinutes(),e,2)}function formatUTCSeconds(r,e){return pad(r.getUTCSeconds(),e,2)}function formatUTCWeekdayNumberMonday(r){var e=r.getUTCDay();return e===0?7:e}function formatUTCWeekNumberSunday(r,e){return pad(utcSunday.count(utcYear(r)-1,r),e,2)}function UTCdISO(r){var e=r.getUTCDay();return e>=4||e===0?utcThursday(r):utcThursday.ceil(r)}function formatUTCWeekNumberISO(r,e){return r=UTCdISO(r),pad(utcThursday.count(utcYear(r),r)+(utcYear(r).getUTCDay()===4),e,2)}function formatUTCWeekdayNumberSunday(r){return r.getUTCDay()}function formatUTCWeekNumberMonday(r,e){return pad(utcMonday.count(utcYear(r)-1,r),e,2)}function formatUTCYear(r,e){return pad(r.getUTCFullYear()%100,e,2)}function formatUTCYearISO(r,e){return r=UTCdISO(r),pad(r.getUTCFullYear()%100,e,2)}function formatUTCFullYear(r,e){return pad(r.getUTCFullYear()%1e4,e,4)}function formatUTCFullYearISO(r,e){var t=r.getUTCDay();return r=t>=4||t===0?utcThursday(r):utcThursday.ceil(r),pad(r.getUTCFullYear()%1e4,e,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(r){return+r}function formatUnixTimestampSeconds(r){return Math.floor(+r/1e3)}var locale,timeFormat,utcFormat;defaultLocale({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function defaultLocale(r){return locale=formatLocale(r),timeFormat=locale.format,locale.parse,utcFormat=locale.utcFormat,locale.utcParse,locale}function date(r){return new Date(r)}function number(r){return r instanceof Date?+r:+new Date(+r)}function calendar(r,e,t,n,i,s,a,o,c,h){var f=continuous(),m=f.invert,g=f.domain,_=h(".%L"),E=h(":%S"),A=h("%I:%M"),C=h("%I %p"),I=h("%a %d"),b=h("%b %d"),R=h("%B"),V=h("%Y");function U(W){return(c(W)<W?_:o(W)<W?E:a(W)<W?A:s(W)<W?C:n(W)<W?i(W)<W?I:b:t(W)<W?R:V)(W)}return f.invert=function(W){return new Date(m(W))},f.domain=function(W){return arguments.length?g(Array.from(W,number)):g().map(date)},f.ticks=function(W){var j=g();return r(j[0],j[j.length-1],W??10)},f.tickFormat=function(W,j){return j==null?U:h(j)},f.nice=function(W){var j=g();return(!W||typeof W.range!="function")&&(W=e(j[0],j[j.length-1],W??10)),W?g(nice(j,W)):f},f.copy=function(){return copy$1(f,calendar(r,e,t,n,i,s,a,o,c,h))},f}function time(){return initRange.apply(calendar(timeTicks,timeTickInterval,timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute,second,timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function utcTime(){return initRange.apply(calendar(utcTicks,utcTickInterval,utcYear,utcMonth,utcSunday,utcDay,utcHour,utcMinute,second,utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function transformer(){var r=0,e=1,t,n,i,s,a=identity$2,o=!1,c;function h(m){return m==null||isNaN(m=+m)?c:a(i===0?.5:(m=(s(m)-t)*i,o?Math.max(0,Math.min(1,m)):m))}h.domain=function(m){return arguments.length?([r,e]=m,t=s(r=+r),n=s(e=+e),i=t===n?0:1/(n-t),h):[r,e]},h.clamp=function(m){return arguments.length?(o=!!m,h):o},h.interpolator=function(m){return arguments.length?(a=m,h):a};function f(m){return function(g){var _,E;return arguments.length?([_,E]=g,a=m(_,E),h):[a(0),a(1)]}}return h.range=f(interpolate),h.rangeRound=f(interpolateRound),h.unknown=function(m){return arguments.length?(c=m,h):c},function(m){return s=m,t=m(r),n=m(e),i=t===n?0:1/(n-t),h}}function copy(r,e){return e.domain(r.domain()).interpolator(r.interpolator()).clamp(r.clamp()).unknown(r.unknown())}function sequential(){var r=linearish(transformer()(identity$2));return r.copy=function(){return copy(r,sequential())},initInterpolator.apply(r,arguments)}function createScalarFormatter(r,e){return function(n,i){return i.location==="tick"?i.scale.tickFormat(r)(n):i.location==="zoom-slider-tooltip"?e.tickFormat(2)(n):`${n}`}}function isBandScaleConfig(r){return r.scaleType==="band"}function isPointScaleConfig(r){return r.scaleType==="point"}function isSymlogScaleConfig(r){return r.scaleType==="symlog"}function getSequentialColorScale(r){return r.type==="piecewise"?threshold(r.thresholds,r.colors):sequential([r.min??0,r.max??100],r.color)}function getOrdinalColorScale(r){return r.values?ordinal(r.values,r.colors).unknown(r.unknownColor??null):ordinal(r.colors.map((e,t)=>t),r.colors).unknown(r.unknownColor??null)}function getColorScale(r){return r.type==="ordinal"?getOrdinalColorScale(r):getSequentialColorScale(r)}function getTickNumber(r){const{tickMaxStep:e,tickMinStep:t,tickNumber:n,range:i,domain:s}=r,a=t===void 0?999:Math.floor(Math.abs(s[1]-s[0])/t),o=e===void 0?2:Math.ceil(Math.abs(s[1]-s[0])/e),c=n??Math.floor(Math.abs(i[1]-i[0])/50);return Math.min(a,Math.max(o,c))}function scaleTickNumberByRange(r,e){return e[1]-e[0]===0?1:r/((e[1]-e[0])/100)}function scaleSymlog(r,e){const t=symlog(r,e),n=t.ticks,{negativeScale:i,linearScale:s,positiveScale:a}=generateScales(t);return t.ticks=o=>{const c=n(o),h=t.constant();let f=0,m=0,g=0;c.forEach(E=>{E>-h&&E<h&&(m+=1),E<=-h&&(f+=1),E>=h&&(g+=1)});const _=[];if(f>0&&_.push(...i.ticks(f)),m>0){const E=s.ticks(m);_.at(-1)===E[0]?_.push(...E.slice(1)):_.push(...E)}if(g>0){const E=a.ticks(g);_.at(-1)===E[0]?_.push(...E.slice(1)):_.push(...E)}return _},t.tickFormat=(o=10,c)=>{const h=t.constant(),[f,m]=t.domain(),g=m-f,_=i.domain(),E=_[1]-_[0],C=(g===0?0:E/g)*o,I=s.domain(),b=I[1]-I[0],V=(g===0?0:b/g)*o,U=a.domain(),W=U[1]-U[0],w=(g===0?0:W/g)*o,P=i.tickFormat(C,c),K=s.tickFormat(V,c),X=a.tickFormat(w,c);return Y=>(Y.valueOf()<=-h?P:Y.valueOf()>=h?X:K)(Y)},t}function generateScales(r){const e=r.constant(),t=r.domain(),n=[t[0],Math.min(t[1],-e)],i=log(n,r.range()),s=[Math.max(t[0],-e),Math.min(t[1],e)],a=linear(s,r.range()),o=[Math.max(t[0],e),t[1]],c=log(o,r.range());return{negativeScale:i,linearScale:a,positiveScale:c}}function getScale(r,e,t){switch(r){case"log":return log(e,t);case"pow":return pow$1(e,t);case"sqrt":return sqrt$1(e,t);case"time":return time(e,t);case"utc":return utcTime(e,t);case"symlog":return scaleSymlog(e,t);default:return linear(e,t)}}const isDateData=r=>(r==null?void 0:r[0])instanceof Date;function createDateFormatter(r,e){const t=time(r.data,e);return(n,{location:i})=>i==="tick"?t.tickFormat(r.tickNumber)(n):`${n.toLocaleString()}`}const zoomScaleRange=(r,e)=>{const t=r[1]-r[0],n=e[1]-e[0],i=r[0]-e[0]*t/n,s=r[1]+(100-e[1])*t/n;return[i,s]};let cartesianInstance,polarInstance;class CartesianSeriesTypes{constructor(){if(this.types=new Set,cartesianInstance)throw new Error("You can only create one instance!");cartesianInstance=this.types}addType(e){this.types.add(e)}getTypes(){return this.types}}class PolarSeriesTypes{constructor(){if(this.types=new Set,polarInstance)throw new Error("You can only create one instance!");polarInstance=this.types}addType(e){this.types.add(e)}getTypes(){return this.types}}const cartesianSeriesTypes=new CartesianSeriesTypes;cartesianSeriesTypes.addType("bar");cartesianSeriesTypes.addType("line");cartesianSeriesTypes.addType("scatter");const polarSeriesTypes=new PolarSeriesTypes;polarSeriesTypes.addType("radar");function isCartesianSeriesType(r){return cartesianSeriesTypes.getTypes().has(r)}const axisExtremumCallback$1=(r,e,t,n,i,s,a,o)=>{var E;const c=n==="x"?i[e].xExtremumGetter:i[e].yExtremumGetter,h=((E=a[e])==null?void 0:E.series)??{},[f,m]=(c==null?void 0:c({series:h,axis:t,axisIndex:s,isDefaultAxis:s===0,getFilters:o}))??[1/0,-1/0],[g,_]=r;return[Math.min(f,g),Math.max(m,_)]},getAxisExtremum$1=(r,e,t,n,i,s)=>{const o=Object.keys(t).filter(isCartesianSeriesType).reduce((c,h)=>axisExtremumCallback$1(c,h,r,e,t,n,i,s),[1/0,-1/0]);return Number.isNaN(o[0])||Number.isNaN(o[1])?[1/0,-1/0]:o},getAxisTriggerTooltip$1=(r,e,t,n)=>{const i=new Set;return Object.keys(e).filter(isCartesianSeriesType).forEach(a=>{var h,f,m;const o=((h=t[a])==null?void 0:h.series)??{},c=(m=(f=e[a]).axisTooltipGetter)==null?void 0:m.call(f,o);c!==void 0&&c.forEach(({axisId:g,direction:_})=>{_===r&&i.add(g??n)})}),i},getAxisDomainLimit=(r,e,t,n)=>{var i;if(r.domainLimit!==void 0)return r.domainLimit;if(e==="x")for(const s of((i=n.line)==null?void 0:i.seriesOrder)??[]){const a=n.line.series[s];if(a.xAxisId===r.id||a.xAxisId===void 0&&t===0)return"strict"}return"nice"};function getRange$1(r,e,t){const n=e==="x"?[r.left,r.left+r.width]:[r.top+r.height,r.top];return t.reverse?[n[1],n[0]]:n}const DEFAULT_CATEGORY_GAP_RATIO$1=.2,DEFAULT_BAR_GAP_RATIO$1=.1;function computeAxisValue$1({drawingArea:r,formattedSeries:e,axis:t,seriesConfig:n,axisDirection:i,zoomMap:s,zoomOptions:a,getFilters:o,preferStrictDomainInLineCharts:c}){if(t===void 0)return{axis:{},axisIds:[]};const h=getAxisTriggerTooltip$1(i,n,e,t[0].id),f={};return t.forEach((m,g)=>{const _=m,E=a==null?void 0:a[_.id],A=s==null?void 0:s.get(_.id),C=A?[A.start,A.end]:[0,100],I=getRange$1(r,i,_),[b,R]=getAxisExtremum$1(_,i,n,g,e,A===void 0&&!E?o:void 0),V=!_.ignoreTooltip&&h.has(_.id),U=_.data??[];if(isBandScaleConfig(_)){const se=_.categoryGapRatio??DEFAULT_CATEGORY_GAP_RATIO$1,ce=_.barGapRatio??DEFAULT_BAR_GAP_RATIO$1,ue=i==="y"?[I[1],I[0]]:I,Ae=zoomScaleRange(ue,C);if(f[_.id]=_extends({offset:0,height:0,categoryGapRatio:se,barGapRatio:ce,triggerTooltip:V},_,{data:U,scale:band(_.data,Ae).paddingInner(se).paddingOuter(se/2),tickNumber:_.data.length,colorScale:_.colorMap&&(_.colorMap.type==="ordinal"?getOrdinalColorScale(_extends({values:_.data},_.colorMap)):getColorScale(_.colorMap))}),isDateData(_.data)){const Se=createDateFormatter(_,ue);f[_.id].valueFormatter=_.valueFormatter??Se}}if(isPointScaleConfig(_)){const se=i==="y"?[...I].reverse():I,ce=zoomScaleRange(se,C);if(f[_.id]=_extends({offset:0,height:0,triggerTooltip:V},_,{data:U,scale:point(_.data,ce),tickNumber:_.data.length,colorScale:_.colorMap&&(_.colorMap.type==="ordinal"?getOrdinalColorScale(_extends({values:_.data},_.colorMap)):getColorScale(_.colorMap))}),isDateData(_.data)){const ue=createDateFormatter(_,se);f[_.id].valueFormatter=_.valueFormatter??ue}}if(_.scaleType==="band"||_.scaleType==="point")return;const W=_.scaleType??"linear",j=c?getAxisDomainLimit(_,i,g,e):_.domainLimit??"nice",w=[_.min??b,_.max??R];if(typeof j=="function"){const{min:se,max:ce}=j(b,R);w[0]=se,w[1]=ce}const P=getTickNumber(_extends({},_,{range:I,domain:w})),K=scaleTickNumberByRange(P,C),X=zoomScaleRange(I,C),Y=getScale(W,w,X);isSymlogScaleConfig(_)&&_.constant!=null&&Y.constant(_.constant);const Z=j==="nice"?Y.nice(P):Y,[ae,le]=Z.domain(),ie=[_.min??ae,_.max??le];f[_.id]=_extends({offset:0,height:0,triggerTooltip:V},_,{data:U,scaleType:W,scale:Z.domain(ie),tickNumber:K,colorScale:_.colorMap&&getColorScale(_.colorMap),valueFormatter:_.valueFormatter??createScalarFormatter(K,getScale(W,I.map(se=>Y.invert(se)),I))})}),{axis:f,axisIds:t.map(({id:m})=>m)}}function isDefined(r){return r!=null}function createAxisFilterMapper({zoomMap:r,zoomOptions:e,seriesConfig:t,formattedSeries:n,direction:i}){return(s,a)=>{const o=e[s.id];if(!o||o.filterMode!=="discard")return null;const c=r==null?void 0:r.get(s.id);if(c===void 0||c.start<=0&&c.end>=100)return null;const h=s.scaleType;return h==="point"||h==="band"?createDiscreteScaleGetAxisFilter(s.data,c.start,c.end,i):createContinuousScaleGetAxisFilter(h,getAxisExtremum$1(s,i,t,a,n),c.start,c.end,i,s.data)}}function createDiscreteScaleGetAxisFilter(r,e,t,n){const i=(r==null?void 0:r.length)??0,s=Math.floor(e*i/100),a=Math.ceil(t*i/100);return function(c,h){return(c[n]??(r==null?void 0:r[h]))==null?!0:h>=s&&h<a}}function createContinuousScaleGetAxisFilter(r,e,t,n,i,s){let a,o;[a,o]=getScale(r??"linear",e,[0,100]).nice().domain(),a=a instanceof Date?a.getTime():a,o=o instanceof Date?o.getTime():o;const c=a+t*(o-a)/100,h=a+n*(o-a)/100;return function(m,g){const _=m[i]??(s==null?void 0:s[g]);return _==null?!0:_>=c&&_<=h}}const createGetAxisFilters=r=>({currentAxisId:e,seriesXAxisId:t,seriesYAxisId:n,isDefaultAxis:i})=>(s,a)=>{var h,f;return!(e===t?n:t)||i?((f=(h=Object.values(r??{}))[0])==null?void 0:f.call(h,s,a))??!0:[n,t].filter(m=>m!==e).map(m=>r[m??""]).filter(isDefined).every(m=>m(s,a))},createZoomLookup=r=>(e=[])=>e.reduce((t,n)=>{const{zoom:i,id:s}=n,a=defaultizeZoom(i,s,r);return a&&(t[s]=a),t},{}),createZoomMap=r=>{const e=new Map;return r.forEach(t=>{e.set(t.axisId,t)}),e},selectorChartZoomState=r=>r.zoom,selectorChartZoomIsInteracting=createSelector([selectorChartZoomState],r=>r==null?void 0:r.isInteracting),selectorChartZoomMap=createSelector([selectorChartZoomState],r=>(r==null?void 0:r.zoomData)&&createZoomMap(r==null?void 0:r.zoomData)),selectorChartZoomOptionsLookup=createSelector([selectorChartRawXAxis,selectorChartRawYAxis],(r,e)=>_extends({},createZoomLookup("x")(r),createZoomLookup("y")(e)));createSelector([selectorChartZoomOptionsLookup,(r,e)=>e],(r,e)=>r[e]);const selectorChartXFilter=createSelector([selectorChartZoomMap,selectorChartZoomOptionsLookup,selectorChartSeriesConfig,selectorChartSeriesProcessed],(r,e,t,n)=>r&&e&&createAxisFilterMapper({zoomMap:r,zoomOptions:e,seriesConfig:t,formattedSeries:n,direction:"x"})),selectorChartYFilter=createSelector([selectorChartZoomMap,selectorChartZoomOptionsLookup,selectorChartSeriesConfig,selectorChartSeriesProcessed],(r,e,t,n)=>r&&e&&createAxisFilterMapper({zoomMap:r,zoomOptions:e,seriesConfig:t,formattedSeries:n,direction:"y"})),selectorChartZoomAxisFilters=createSelector([selectorChartXFilter,selectorChartYFilter,selectorChartRawXAxis,selectorChartRawYAxis],(r,e,t,n)=>{if(r===void 0||e===void 0)return;const i=t==null?void 0:t.reduce((a,o,c)=>{const h=r(o,c);return h!==null&&(a[o.id]=h),a},{}),s=n==null?void 0:n.reduce((a,o,c)=>{const h=e(o,c);return h!==null&&(a[o.id]=h),a},{});if(!(Object.keys(i??{}).length===0&&Object.keys(s??{}).length===0))return createGetAxisFilters(_extends({},i,s))}),selectorChartXAxis=createSelector([selectorChartRawXAxis,selectorChartDrawingArea,selectorChartSeriesProcessed,selectorChartSeriesConfig,selectorChartZoomMap,selectorChartZoomOptionsLookup,selectorChartZoomAxisFilters,selectorPreferStrictDomainInLineCharts],(r,e,t,n,i,s,a,o)=>computeAxisValue$1({drawingArea:e,formattedSeries:t,axis:r,seriesConfig:n,axisDirection:"x",zoomMap:i,zoomOptions:s,getFilters:a,preferStrictDomainInLineCharts:o})),selectorChartYAxis=createSelector([selectorChartRawYAxis,selectorChartDrawingArea,selectorChartSeriesProcessed,selectorChartSeriesConfig,selectorChartZoomMap,selectorChartZoomOptionsLookup,selectorChartZoomAxisFilters,selectorPreferStrictDomainInLineCharts],(r,e,t,n,i,s,a,o)=>computeAxisValue$1({drawingArea:e,formattedSeries:t,axis:r,seriesConfig:n,axisDirection:"y",zoomMap:i,zoomOptions:s,getFilters:a,preferStrictDomainInLineCharts:o}));createSelector([selectorChartXAxis,selectorChartYAxis,(r,e)=>e],(r,e,t)=>(r==null?void 0:r.axis[t])??(e==null?void 0:e.axis[t]));createSelector([selectorChartRawXAxis,selectorChartRawYAxis,(r,e)=>e],(r,e,t)=>{const n=(r==null?void 0:r.find(i=>i.id===t))??(e==null?void 0:e.find(i=>i.id===t))??null;if(n)return n});function isBandScale(r){return r.bandwidth!==void 0}function getAsANumber(r){return r instanceof Date?r.getTime():r}function getAxisIndex$1(r,e){const{scale:t,data:n,reverse:i}=r;if(!isBandScale(t)){const a=t.invert(e);if(n===void 0)return-1;const o=getAsANumber(a);return n==null?void 0:n.findIndex((h,f)=>{const m=getAsANumber(h);return m>o&&(f===0||Math.abs(o-m)<=Math.abs(o-getAsANumber(n[f-1])))||m<=o&&(f===n.length-1||Math.abs(getAsANumber(a)-m)<Math.abs(getAsANumber(a)-getAsANumber(n[f+1])))})}const s=t.bandwidth()===0?Math.floor((e-Math.min(...t.range())+t.step()/2)/t.step()):Math.floor((e-Math.min(...t.range()))/t.step());return s<0||s>=n.length?-1:i?n.length-1-s:s}function getAxisValue(r,e,t){const{scale:n,data:i}=r;if(!isBandScale(n)){const s=n.invert(e);return t<0?s:i[t]}return t<0||t>=i.length?null:i[t]}function getSVGPoint(r,e){const t=r.createSVGPoint();return t.x=e.clientX,t.y=e.clientY,t.matrixTransform(r.getScreenCTM().inverse())}const is=Object.is;function fastObjectShallowCompare(r,e){if(r===e)return!0;if(!(r instanceof Object)||!(e instanceof Object))return!1;let t=0,n=0;for(const i in r)if(t+=1,!is(r[i],e[i])||!(i in e))return!1;for(const i in e)n+=1;return t===n}const useChartInteraction=({store:r})=>{const e=useEventCallback(function(){r.update(a=>_extends({},a,{interaction:{pointer:null,item:null}}))}),t=useEventCallback(function(a){r.update(o=>{const c=o.interaction.item;return a?c===null||Object.keys(a).some(h=>a[h]!==c[h])?o:_extends({},o,{interaction:_extends({},o.interaction,{item:null})}):c===null?o:_extends({},o,{interaction:_extends({},o.interaction,{item:null})})})}),n=useEventCallback(function(a){r.update(o=>fastObjectShallowCompare(o.interaction.item,a)?o:_extends({},o,{interaction:_extends({},o.interaction,{item:a})}))}),i=useEventCallback(function(a){r.update(o=>_extends({},o,{interaction:_extends({},o.interaction,{pointer:a})}))});return{instance:{cleanInteraction:e,setItemInteraction:n,removeItemInteraction:t,setPointerCoordinate:i}}};useChartInteraction.getInitialState=()=>({interaction:{item:null,pointer:null}});useChartInteraction.params={};const selectInteraction=r=>r.interaction,selectorChartsInteractionIsInitialized=createSelector([selectInteraction],r=>r!==void 0),selectorChartsInteractionItem=createSelector([selectInteraction],r=>(r==null?void 0:r.item)??null),selectorChartsInteractionPointer=createSelector([selectInteraction],r=>(r==null?void 0:r.pointer)??null),selectorChartsInteractionPointerX=createSelector([selectorChartsInteractionPointer],r=>r&&r.x),selectorChartsInteractionPointerY=createSelector([selectorChartsInteractionPointer],r=>r&&r.y),selectorChartsInteractionItemIsDefined=createSelector([selectorChartsInteractionItem],r=>r!==null);function isDeepEqual(r,e){if(r===e)return!0;if(r&&e&&typeof r=="object"&&typeof e=="object"){if(r.constructor!==e.constructor)return!1;if(Array.isArray(r)){const i=r.length;if(i!==e.length)return!1;for(let s=0;s<i;s+=1)if(!isDeepEqual(r[s],e[s]))return!1;return!0}if(r instanceof Map&&e instanceof Map){if(r.size!==e.size)return!1;const i=Array.from(r.entries());for(let s=0;s<i.length;s+=1)if(!e.has(i[s][0]))return!1;for(let s=0;s<i.length;s+=1){const a=i[s];if(!isDeepEqual(a[1],e.get(a[0])))return!1}return!0}if(r instanceof Set&&e instanceof Set){if(r.size!==e.size)return!1;const i=Array.from(r.entries());for(let s=0;s<i.length;s+=1)if(!e.has(i[s][0]))return!1;return!0}if(ArrayBuffer.isView(r)&&ArrayBuffer.isView(e)){const i=r.length;if(i!==e.length)return!1;for(let s=0;s<i;s+=1)if(r[s]!==e[s])return!1;return!0}if(r.constructor===RegExp)return r.source===e.source&&r.flags===e.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===e.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===e.toString();const t=Object.keys(r),n=t.length;if(n!==Object.keys(e).length)return!1;for(let i=0;i<n;i+=1)if(!Object.prototype.hasOwnProperty.call(e,t[i]))return!1;for(let i=0;i<n;i+=1){const s=t[i];if(!isDeepEqual(r[s],e[s]))return!1}return!0}return r!==r&&e!==e}const optionalGetAxisId$1=(r,e)=>e;function indexGetter$1(r,e,t=e.axisIds[0]){return Array.isArray(t)?t.map(n=>getAxisIndex$1(e.axis[n],r)):getAxisIndex$1(e.axis[t],r)}const selectChartsInteractionAxisIndex=(r,e,t)=>{if(r===null)return null;const n=indexGetter$1(r,e,t);return n===-1?null:n},selectorChartsInteractionXAxisIndex=createSelector([selectorChartsInteractionPointerX,selectorChartXAxis,optionalGetAxisId$1],selectChartsInteractionAxisIndex),selectorChartsInteractionYAxisIndex=createSelector([selectorChartsInteractionPointerY,selectorChartYAxis,optionalGetAxisId$1],selectChartsInteractionAxisIndex),selectorChartAxisInteraction=createSelector([selectorChartsInteractionPointerX,selectorChartsInteractionPointerY,selectorChartXAxis,selectorChartYAxis],(r,e,t,n)=>[...r===null?[]:t.axisIds.map(i=>({axisId:i,dataIndex:indexGetter$1(r,t,i)})),...e===null?[]:n.axisIds.map(i=>({axisId:i,dataIndex:indexGetter$1(e,n,i)}))].filter(i=>i.dataIndex!==null&&i.dataIndex>=0));function valueGetter(r,e,t,n=e.axisIds[0]){return Array.isArray(n)?n.map((i,s)=>getAxisValue(e.axis[i],r,t[s])):getAxisValue(e.axis[n],r,t)}const selectorChartsInteractionXAxisValue=createSelector([selectorChartsInteractionPointerX,selectorChartXAxis,selectorChartsInteractionXAxisIndex,optionalGetAxisId$1],(r,e,t,n)=>r===null||t===null||e.axisIds.length===0?null:valueGetter(r,e,t,n)),selectorChartsInteractionYAxisValue=createSelector([selectorChartsInteractionPointerY,selectorChartYAxis,selectorChartsInteractionYAxisIndex,optionalGetAxisId$1],(r,e,t,n)=>r===null||t===null||e.axisIds.length===0?null:valueGetter(r,e,t,n)),selectorChartsInteractionTooltipXAxes=createSelector([selectorChartsInteractionPointerX,selectorChartXAxis],(r,e)=>r===null?[]:e.axisIds.filter(t=>e.axis[t].triggerTooltip).map(t=>({axisId:t,dataIndex:getAxisIndex$1(e.axis[t],r)})).filter(({dataIndex:t})=>t>=0),{memoizeOptions:{resultEqualityCheck:isDeepEqual}}),selectorChartsInteractionTooltipYAxes=createSelector([selectorChartsInteractionPointerY,selectorChartYAxis],(r,e)=>r===null?[]:e.axisIds.filter(t=>e.axis[t].triggerTooltip).map(t=>({axisId:t,dataIndex:getAxisIndex$1(e.axis[t],r)})).filter(({dataIndex:t})=>t>=0),{memoizeOptions:{resultEqualityCheck:isDeepEqual}}),selectorChartsInteractionAxisTooltip=createSelector([selectorChartsInteractionTooltipXAxes,selectorChartsInteractionTooltipYAxes],(r,e)=>r.length>0||e.length>0),noop=()=>{};function useLazySelectorEffect(r,e,t,n){const i=useLazyRef(initialize,{store:r,selector:e,skip:n}).current;i.effect=t,reactExports.useEffect(i.onMount(n),[n])}function initialize(r){const{store:e,selector:t,skip:n}=r;let i=!1,s;const a=()=>{o.dispose??(o.dispose=e.subscribe(c=>{const h=t(c);o.effect(s,h),s=h}))},o={effect:noop,dispose:null,onMount:c=>()=>{if(!c)return i||(i=!0,s=t(e.value)),a(),()=>{var h;(h=o.dispose)==null||h.call(o),o.dispose=null}}};return n||(i=!0,s=t(e.value),a()),o}const useChartCartesianAxis=({params:r,store:e,seriesConfig:t,svgRef:n,instance:i})=>{const{xAxis:s,yAxis:a,dataset:o,onHighlightedAxisChange:c}=r,h=useSelector(e,selectorChartDrawingArea),f=useSelector(e,selectorChartSeriesProcessed),m=useSelector(e,selectorChartsInteractionIsInitialized),{axis:g,axisIds:_}=useSelector(e,selectorChartXAxis),{axis:E,axisIds:A}=useSelector(e,selectorChartYAxis);useAssertModelConsistency({controlled:r.highlightedAxis}),useEnhancedEffect(()=>{r.highlightedAxis!==void 0&&e.update(R=>R.controlledCartesianAxisHighlight===r.highlightedAxis?R:_extends({},R,{controlledCartesianAxisHighlight:r.highlightedAxis}))},[e,r.highlightedAxis]);const C=reactExports.useRef(!0);reactExports.useEffect(()=>{if(C.current){C.current=!1;return}e.update(R=>_extends({},R,{cartesianAxis:_extends({},R.cartesianAxis,{x:defaultizeXAxis(s,o),y:defaultizeYAxis(a,o)})}))},[t,h,s,a,o,e]);const I=_[0],b=A[0];return useLazySelectorEffect(e,selectorChartAxisInteraction,(R,V)=>{if(!Object.is(R,V)){if(R.length!==V.length){c(V);return}R!=null&&R.some(({axisId:U,dataIndex:W},j)=>V[j].axisId!==U||V[j].dataIndex!==W)&&c(V)}},!c),reactExports.useEffect(()=>{const R=n.current;if(!m||!R||r.disableAxisListener)return()=>{};const V=i.addInteractionListener("moveEnd",X=>{var Y;X.detail.activeGestures.pan||(Y=i.cleanInteraction)==null||Y.call(i)}),U=i.addInteractionListener("panEnd",X=>{var Y;X.detail.activeGestures.move||(Y=i.cleanInteraction)==null||Y.call(i)}),W=i.addInteractionListener("quickPressEnd",X=>{var Y;!X.detail.activeGestures.move&&!X.detail.activeGestures.pan&&((Y=i.cleanInteraction)==null||Y.call(i))}),j=X=>{var le,ie;const Y=X.detail.srcEvent,Z=X.detail.target,ae=getSVGPoint(R,Y);if(X.detail.srcEvent.buttons>=1&&(Z!=null&&Z.hasPointerCapture(X.detail.srcEvent.pointerId))&&!(Z!=null&&Z.closest("[data-charts-zoom-slider]"))&&(Z==null||Z.releasePointerCapture(X.detail.srcEvent.pointerId)),!i.isPointInside(ae.x,ae.y,Z)){(le=i.cleanInteraction)==null||le.call(i);return}(ie=i.setPointerCoordinate)==null||ie.call(i,ae)},w=i.addInteractionListener("move",j),P=i.addInteractionListener("pan",j),K=i.addInteractionListener("quickPress",j);return()=>{w.cleanup(),V.cleanup(),P.cleanup(),U.cleanup(),K.cleanup(),W.cleanup()}},[n,e,g,I,E,b,i,r.disableAxisListener,m]),reactExports.useEffect(()=>{const R=n.current,V=r.onAxisClick;if(R===null||!V)return()=>{};const U=i.addInteractionListener("tap",W=>{let j=null,w=!1;const P=getSVGPoint(R,W.detail.srcEvent),K=getAxisIndex$1(g[I],P.x);w=K!==-1,j=w?K:getAxisIndex$1(E[b],P.y);const X=w?_[0]:A[0];if(j==null||j===-1)return;const Y=(w?g:E)[X].data[j],Z={};Object.keys(f).filter(ae=>["bar","line"].includes(ae)).forEach(ae=>{var le;(le=f[ae])==null||le.seriesOrder.forEach(ie=>{const se=f[ae].series[ie],ce=se.xAxisId,ue=se.yAxisId,Ae=w?ce:ue;(Ae===void 0||Ae===X)&&(Z[ie]=se.data[j])})}),V(W.detail.srcEvent,{dataIndex:j,axisValue:Y,seriesValues:Z})});return()=>{U.cleanup()}},[r.onAxisClick,f,n,g,_,E,A,I,b,i]),{}};useChartCartesianAxis.params={xAxis:!0,yAxis:!0,dataset:!0,onAxisClick:!0,disableAxisListener:!0,onHighlightedAxisChange:!0,highlightedAxis:!0};useChartCartesianAxis.getDefaultizedParams=({params:r})=>_extends({},r,{colors:r.colors??rainbowSurgePalette,theme:r.theme??"light",defaultizedXAxis:defaultizeXAxis(r.xAxis,r.dataset),defaultizedYAxis:defaultizeYAxis(r.yAxis,r.dataset)});useChartCartesianAxis.getInitialState=r=>_extends({cartesianAxis:{x:r.defaultizedXAxis,y:r.defaultizedYAxis}},r.highlightedAxis===void 0?{}:{controlledCartesianAxisHighlight:r.highlightedAxis});const selectorChartControlledCartesianAxisHighlight=r=>r.controlledCartesianAxisHighlight,selectAxisHighlight=(r,e,t)=>t!==void 0?t.filter(n=>e.axis[n.axisId]!==void 0).map(n=>n):r===null?[]:[{axisId:e.axisIds[0],dataIndex:r}];createSelector([selectorChartsInteractionXAxisIndex,selectorChartXAxis,selectorChartControlledCartesianAxisHighlight],selectAxisHighlight);createSelector([selectorChartsInteractionYAxisIndex,selectorChartYAxis,selectorChartControlledCartesianAxisHighlight],selectAxisHighlight);const selectAxisHighlightWithValue=(r,e,t,n)=>n!==void 0?n.map(i=>{var s,a;return _extends({},i,{value:(a=(s=t.axis[i.axisId])==null?void 0:s.data)==null?void 0:a[i.dataIndex]})}).filter(({value:i})=>i!==void 0):e===null?[]:[{axisId:t.axisIds[0],dataIndex:r,value:e}],selectorChartsHighlightXAxisValue=createSelector([selectorChartsInteractionXAxisIndex,selectorChartsInteractionXAxisValue,selectorChartXAxis,selectorChartControlledCartesianAxisHighlight],selectAxisHighlightWithValue),selectorChartsHighlightYAxisValue=createSelector([selectorChartsInteractionYAxisIndex,selectorChartsInteractionYAxisValue,selectorChartYAxis,selectorChartControlledCartesianAxisHighlight],selectAxisHighlightWithValue),selectAxis=(r,e)=>r===void 0?[e.axis[e.axisIds[0]]]:r.map(n=>e.axis[n.axisId]??null).filter(n=>n!==null);createSelector([selectorChartControlledCartesianAxisHighlight,selectorChartXAxis],selectAxis);createSelector([selectorChartControlledCartesianAxisHighlight,selectorChartYAxis],selectAxis);function addDefaultId(r,e){return r.id!==void 0?r:_extends({id:e},r)}function processColorMap(r){return r.colorMap?_extends({},r,{colorScale:r.colorMap.type==="ordinal"&&r.data?getOrdinalColorScale(_extends({values:r.data},r.colorMap)):getColorScale(r.colorMap.type==="continuous"?_extends({min:r.min,max:r.max},r.colorMap):r.colorMap)}):r}function getZAxisState(r,e){if(!r||r.length===0)return{axis:{},axisIds:[]};const t={},n=[];return r.forEach((i,s)=>{const a=i.dataKey,o=i.id??`defaultized-z-axis-${s}`;if(a===void 0||i.data!==void 0){t[o]=processColorMap(addDefaultId(i,o)),n.push(o);return}if(e===void 0)throw new Error("MUI X Charts: z-axis uses `dataKey` but no `dataset` is provided.");t[o]=processColorMap(addDefaultId(_extends({},i,{data:e.map(c=>c[a])}),o)),n.push(o)}),{axis:t,axisIds:n}}const useChartZAxis=({params:r,store:e})=>{const{zAxis:t,dataset:n}=r,i=reactExports.useRef(!0);return reactExports.useEffect(()=>{if(i.current){i.current=!1;return}e.update(s=>_extends({},s,{zAxis:getZAxisState(t,n)}))},[t,n,e]),{}};useChartZAxis.params={zAxis:!0,dataset:!0};useChartZAxis.getInitialState=r=>({zAxis:getZAxisState(r.zAxis,r.dataset)});const selectRootState=r=>r,selectorChartZAxis=createSelector([selectRootState],r=>r.zAxis),useChartHighlight=({store:r,params:e})=>{useAssertModelConsistency({controlled:e.highlightedItem}),useEnhancedEffect(()=>{r.update(i=>i.highlight.item===e.highlightedItem?i:_extends({},i,{highlight:_extends({},i.highlight,{item:e.highlightedItem})}))},[r,e.highlightedItem]);const t=useEventCallback(()=>{var i;(i=e.onHighlightChange)==null||i.call(e,null),r.update(s=>_extends({},s,{highlight:{item:null}}))}),n=useEventCallback(i=>{var a;const s=r.getSnapshot().highlight.item;fastObjectShallowCompare(s,i)||((a=e.onHighlightChange)==null||a.call(e,i),r.update(o=>_extends({},o,{highlight:{item:i}})))});return{instance:{clearHighlight:t,setHighlight:n}}};useChartHighlight.getDefaultizedParams=({params:r})=>_extends({},r,{highlightedItem:r.highlightedItem??null});useChartHighlight.getInitialState=r=>({highlight:{item:r.highlightedItem}});useChartHighlight.params={highlightedItem:!0,onHighlightChange:!0};function findMinMax(r){let e=1/0,t=-1/0;for(const n of r??[])n<e&&(e=n),n>t&&(t=n);return[e,t]}const createResult=(r,e)=>e==="x"?{x:r,y:null}:{x:null,y:r},getBaseExtremum=r=>{var a;const{axis:e,getFilters:t,isDefaultAxis:n}=r,i=t==null?void 0:t({currentAxisId:e.id,isDefaultAxis:n}),s=i?(a=e.data)==null?void 0:a.filter((o,c)=>i({x:null,y:null},c)):e.data;return findMinMax(s??[])},getValueExtremum=r=>e=>{const{series:t,axis:n,getFilters:i,isDefaultAxis:s}=e;return Object.keys(t).filter(a=>{const o=r==="x"?t[a].xAxisId:t[a].yAxisId;return o===n.id||s&&o===void 0}).reduce((a,o)=>{const{stackedData:c}=t[o],h=i==null?void 0:i({currentAxisId:n.id,isDefaultAxis:s,seriesXAxisId:t[o].xAxisId,seriesYAxisId:t[o].yAxisId}),[f,m]=(c==null?void 0:c.reduce((g,_,E)=>h&&(!h(createResult(_[0],r),E)||!h(createResult(_[1],r),E))?g:[Math.min(..._,g[0]),Math.max(..._,g[1])],[1/0,-1/0]))??[1/0,-1/0];return[Math.min(f,a[0]),Math.max(m,a[1])]},[1/0,-1/0])},getExtremumX$2=r=>Object.keys(r.series).some(t=>r.series[t].layout==="horizontal")?getValueExtremum("x")(r):getBaseExtremum(r),getExtremumY$2=r=>Object.keys(r.series).some(t=>r.series[t].layout==="horizontal")?getBaseExtremum(r):getValueExtremum("y")(r);function constant(r){return function(){return r}}const abs=Math.abs,atan2=Math.atan2,cos=Math.cos,max=Math.max,min=Math.min,sin=Math.sin,sqrt=Math.sqrt,epsilon$3=1e-12,pi$1=Math.PI,halfPi=pi$1/2,tau$2=2*pi$1;function acos(r){return r>1?0:r<-1?pi$1:Math.acos(r)}function asin(r){return r>=1?halfPi:r<=-1?-halfPi:Math.asin(r)}const pi=Math.PI,tau$1=2*pi,epsilon$2=1e-6,tauEpsilon=tau$1-epsilon$2;function append(r){this._+=r[0];for(let e=1,t=r.length;e<t;++e)this._+=arguments[e]+r[e]}function appendRound(r){let e=Math.floor(r);if(!(e>=0))throw new Error(`invalid digits: ${r}`);if(e>15)return append;const t=10**e;return function(n){this._+=n[0];for(let i=1,s=n.length;i<s;++i)this._+=Math.round(arguments[i]*t)/t+n[i]}}let Path$1=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?append:appendRound(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,i){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(e,t,n,i,s,a){this._append`C${+e},${+t},${+n},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(e,t,n,i,s){if(e=+e,t=+t,n=+n,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,c=n-e,h=i-t,f=a-e,m=o-t,g=f*f+m*m;if(this._x1===null)this._append`M${this._x1=e},${this._y1=t}`;else if(g>epsilon$2)if(!(Math.abs(m*c-h*f)>epsilon$2)||!s)this._append`L${this._x1=e},${this._y1=t}`;else{let _=n-a,E=i-o,A=c*c+h*h,C=_*_+E*E,I=Math.sqrt(A),b=Math.sqrt(g),R=s*Math.tan((pi-Math.acos((A+g-C)/(2*I*b)))/2),V=R/b,U=R/I;Math.abs(V-1)>epsilon$2&&this._append`L${e+V*f},${t+V*m}`,this._append`A${s},${s},0,0,${+(m*_>f*E)},${this._x1=e+U*c},${this._y1=t+U*h}`}}arc(e,t,n,i,s,a){if(e=+e,t=+t,n=+n,a=!!a,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),c=n*Math.sin(i),h=e+o,f=t+c,m=1^a,g=a?i-s:s-i;this._x1===null?this._append`M${h},${f}`:(Math.abs(this._x1-h)>epsilon$2||Math.abs(this._y1-f)>epsilon$2)&&this._append`L${h},${f}`,n&&(g<0&&(g=g%tau$1+tau$1),g>tauEpsilon?this._append`A${n},${n},0,1,${m},${e-o},${t-c}A${n},${n},0,1,${m},${this._x1=h},${this._y1=f}`:g>epsilon$2&&this._append`A${n},${n},0,${+(g>=pi)},${m},${this._x1=e+n*Math.cos(s)},${this._y1=t+n*Math.sin(s)}`)}rect(e,t,n,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}};function withPath(r){let e=3;return r.digits=function(t){if(!arguments.length)return e;if(t==null)e=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);e=n}return r},()=>new Path$1(e)}function arcInnerRadius(r){return r.innerRadius}function arcOuterRadius(r){return r.outerRadius}function arcStartAngle(r){return r.startAngle}function arcEndAngle(r){return r.endAngle}function arcPadAngle(r){return r&&r.padAngle}function intersect(r,e,t,n,i,s,a,o){var c=t-r,h=n-e,f=a-i,m=o-s,g=m*c-f*h;if(!(g*g<epsilon$3))return g=(f*(e-s)-m*(r-i))/g,[r+g*c,e+g*h]}function cornerTangents(r,e,t,n,i,s,a){var o=r-t,c=e-n,h=(a?s:-s)/sqrt(o*o+c*c),f=h*c,m=-h*o,g=r+f,_=e+m,E=t+f,A=n+m,C=(g+E)/2,I=(_+A)/2,b=E-g,R=A-_,V=b*b+R*R,U=i-s,W=g*A-E*_,j=(R<0?-1:1)*sqrt(max(0,U*U*V-W*W)),w=(W*R-b*j)/V,P=(-W*b-R*j)/V,K=(W*R+b*j)/V,X=(-W*b+R*j)/V,Y=w-C,Z=P-I,ae=K-C,le=X-I;return Y*Y+Z*Z>ae*ae+le*le&&(w=K,P=X),{cx:w,cy:P,x01:-f,y01:-m,x11:w*(i/U-1),y11:P*(i/U-1)}}function d3Arc(){var r=arcInnerRadius,e=arcOuterRadius,t=constant(0),n=null,i=arcStartAngle,s=arcEndAngle,a=arcPadAngle,o=null,c=withPath(h);function h(){var f,m,g=+r.apply(this,arguments),_=+e.apply(this,arguments),E=i.apply(this,arguments)-halfPi,A=s.apply(this,arguments)-halfPi,C=abs(A-E),I=A>E;if(o||(o=f=c()),_<g&&(m=_,_=g,g=m),!(_>epsilon$3))o.moveTo(0,0);else if(C>tau$2-epsilon$3)o.moveTo(_*cos(E),_*sin(E)),o.arc(0,0,_,E,A,!I),g>epsilon$3&&(o.moveTo(g*cos(A),g*sin(A)),o.arc(0,0,g,A,E,I));else{var b=E,R=A,V=E,U=A,W=C,j=C,w=a.apply(this,arguments)/2,P=w>epsilon$3&&(n?+n.apply(this,arguments):sqrt(g*g+_*_)),K=min(abs(_-g)/2,+t.apply(this,arguments)),X=K,Y=K,Z,ae;if(P>epsilon$3){var le=asin(P/g*sin(w)),ie=asin(P/_*sin(w));(W-=le*2)>epsilon$3?(le*=I?1:-1,V+=le,U-=le):(W=0,V=U=(E+A)/2),(j-=ie*2)>epsilon$3?(ie*=I?1:-1,b+=ie,R-=ie):(j=0,b=R=(E+A)/2)}var se=_*cos(b),ce=_*sin(b),ue=g*cos(U),Ae=g*sin(U);if(K>epsilon$3){var Se=_*cos(R),ye=_*sin(R),he=g*cos(V),ke=g*sin(V),Pe;if(C<pi$1)if(Pe=intersect(se,ce,he,ke,Se,ye,ue,Ae)){var Le=se-Pe[0],$e=ce-Pe[1],qe=Se-Pe[0],xe=ye-Pe[1],Ie=1/sin(acos((Le*qe+$e*xe)/(sqrt(Le*Le+$e*$e)*sqrt(qe*qe+xe*xe)))/2),Te=sqrt(Pe[0]*Pe[0]+Pe[1]*Pe[1]);X=min(K,(g-Te)/(Ie-1)),Y=min(K,(_-Te)/(Ie+1))}else X=Y=0}j>epsilon$3?Y>epsilon$3?(Z=cornerTangents(he,ke,se,ce,_,Y,I),ae=cornerTangents(Se,ye,ue,Ae,_,Y,I),o.moveTo(Z.cx+Z.x01,Z.cy+Z.y01),Y<K?o.arc(Z.cx,Z.cy,Y,atan2(Z.y01,Z.x01),atan2(ae.y01,ae.x01),!I):(o.arc(Z.cx,Z.cy,Y,atan2(Z.y01,Z.x01),atan2(Z.y11,Z.x11),!I),o.arc(0,0,_,atan2(Z.cy+Z.y11,Z.cx+Z.x11),atan2(ae.cy+ae.y11,ae.cx+ae.x11),!I),o.arc(ae.cx,ae.cy,Y,atan2(ae.y11,ae.x11),atan2(ae.y01,ae.x01),!I))):(o.moveTo(se,ce),o.arc(0,0,_,b,R,!I)):o.moveTo(se,ce),!(g>epsilon$3)||!(W>epsilon$3)?o.lineTo(ue,Ae):X>epsilon$3?(Z=cornerTangents(ue,Ae,Se,ye,g,-X,I),ae=cornerTangents(se,ce,he,ke,g,-X,I),o.lineTo(Z.cx+Z.x01,Z.cy+Z.y01),X<K?o.arc(Z.cx,Z.cy,X,atan2(Z.y01,Z.x01),atan2(ae.y01,ae.x01),!I):(o.arc(Z.cx,Z.cy,X,atan2(Z.y01,Z.x01),atan2(Z.y11,Z.x11),!I),o.arc(0,0,g,atan2(Z.cy+Z.y11,Z.cx+Z.x11),atan2(ae.cy+ae.y11,ae.cx+ae.x11),I),o.arc(ae.cx,ae.cy,X,atan2(ae.y11,ae.x11),atan2(ae.y01,ae.x01),!I))):o.arc(0,0,g,U,V,I)}if(o.closePath(),f)return o=null,f+""||null}return h.centroid=function(){var f=(+r.apply(this,arguments)+ +e.apply(this,arguments))/2,m=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-pi$1/2;return[cos(m)*f,sin(m)*f]},h.innerRadius=function(f){return arguments.length?(r=typeof f=="function"?f:constant(+f),h):r},h.outerRadius=function(f){return arguments.length?(e=typeof f=="function"?f:constant(+f),h):e},h.cornerRadius=function(f){return arguments.length?(t=typeof f=="function"?f:constant(+f),h):t},h.padRadius=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:constant(+f),h):n},h.startAngle=function(f){return arguments.length?(i=typeof f=="function"?f:constant(+f),h):i},h.endAngle=function(f){return arguments.length?(s=typeof f=="function"?f:constant(+f),h):s},h.padAngle=function(f){return arguments.length?(a=typeof f=="function"?f:constant(+f),h):a},h.context=function(f){return arguments.length?(o=f??null,h):o},h}function array(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function descending(r,e){return e<r?-1:e>r?1:e>=r?0:NaN}function identity(r){return r}function d3Pie(){var r=identity,e=descending,t=null,n=constant(0),i=constant(tau$2),s=constant(0);function a(o){var c,h=(o=array(o)).length,f,m,g=0,_=new Array(h),E=new Array(h),A=+n.apply(this,arguments),C=Math.min(tau$2,Math.max(-tau$2,i.apply(this,arguments)-A)),I,b=Math.min(Math.abs(C)/h,s.apply(this,arguments)),R=b*(C<0?-1:1),V;for(c=0;c<h;++c)(V=E[_[c]=c]=+r(o[c],c,o))>0&&(g+=V);for(e!=null?_.sort(function(U,W){return e(E[U],E[W])}):t!=null&&_.sort(function(U,W){return t(o[U],o[W])}),c=0,m=g?(C-h*R)/g:0;c<h;++c,A=I)f=_[c],V=E[f],I=A+(V>0?V*m:0)+R,E[f]={data:o[f],index:c,value:V,startAngle:A,endAngle:I,padAngle:b};return E}return a.value=function(o){return arguments.length?(r=typeof o=="function"?o:constant(+o),a):r},a.sortValues=function(o){return arguments.length?(e=o,t=null,a):e},a.sort=function(o){return arguments.length?(t=o,e=null,a):t},a.startAngle=function(o){return arguments.length?(n=typeof o=="function"?o:constant(+o),a):n},a.endAngle=function(o){return arguments.length?(i=typeof o=="function"?o:constant(+o),a):i},a.padAngle=function(o){return arguments.length?(s=typeof o=="function"?o:constant(+o),a):s},a}function d3StackOffsetNone(r,e){if((a=r.length)>1)for(var t=1,n,i,s=r[e[0]],a,o=s.length;t<a;++t)for(i=s,s=r[e[t]],n=0;n<o;++n)s[n][1]+=s[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function d3StackOrderNone(r){for(var e=r.length,t=new Array(e);--e>=0;)t[e]=e;return t}function stackValue(r,e){return r[e]}function stackSeries(r){const e=[];return e.key=r,e}function d3Stack(){var r=constant([]),e=d3StackOrderNone,t=d3StackOffsetNone,n=stackValue;function i(s){var a=Array.from(r.apply(this,arguments),stackSeries),o,c=a.length,h=-1,f;for(const m of s)for(o=0,++h;o<c;++o)(a[o][h]=[0,+n(m,a[o].key,h,s)]).data=m;for(o=0,f=array(e(a));o<c;++o)a[f[o]].index=o;return t(a,f),a}return i.keys=function(s){return arguments.length?(r=typeof s=="function"?s:constant(Array.from(s)),i):r},i.value=function(s){return arguments.length?(n=typeof s=="function"?s:constant(+s),i):n},i.order=function(s){return arguments.length?(e=s==null?d3StackOrderNone:typeof s=="function"?s:constant(Array.from(s)),i):e},i.offset=function(s){return arguments.length?(t=s??d3StackOffsetNone,i):t},i}function d3StackOffsetExpand(r,e){if((n=r.length)>0){for(var t,n,i=0,s=r[0].length,a;i<s;++i){for(a=t=0;t<n;++t)a+=r[t][i][1]||0;if(a)for(t=0;t<n;++t)r[t][i][1]/=a}d3StackOffsetNone(r,e)}}function d3StackOffsetDiverging(r,e){if((c=r.length)>0)for(var t,n=0,i,s,a,o,c,h=r[e[0]].length;n<h;++n)for(a=o=0,t=0;t<c;++t)(s=(i=r[e[t]][n])[1]-i[0])>0?(i[0]=a,i[1]=a+=s):s<0?(i[1]=o,i[0]=o+=s):(i[0]=0,i[1]=s)}function d3StackOffsetSilhouette(r,e){if((i=r.length)>0){for(var t=0,n=r[e[0]],i,s=n.length;t<s;++t){for(var a=0,o=0;a<i;++a)o+=r[a][t][1]||0;n[t][1]+=n[t][0]=-o/2}d3StackOffsetNone(r,e)}}function d3StackOffsetWiggle(r,e){if(!(!((a=r.length)>0)||!((s=(i=r[e[0]]).length)>0))){for(var t=0,n=1,i,s,a;n<s;++n){for(var o=0,c=0,h=0;o<a;++o){for(var f=r[e[o]],m=f[n][1]||0,g=f[n-1][1]||0,_=(m-g)/2,E=0;E<o;++E){var A=r[e[E]],C=A[n][1]||0,I=A[n-1][1]||0;_+=C-I}c+=m,h+=_*m}i[n-1][1]+=i[n-1][0]=t,c&&(t-=h/c)}i[n-1][1]+=i[n-1][0]=t,d3StackOffsetNone(r,e)}}function d3StackOrderAppearance(r){var e=r.map(peak);return d3StackOrderNone(r).sort(function(t,n){return e[t]-e[n]})}function peak(r){for(var e=-1,t=0,n=r.length,i,s=-1/0;++e<n;)(i=+r[e][1])>s&&(s=i,t=e);return t}function d3StackOrderAscending(r){var e=r.map(sum$1);return d3StackOrderNone(r).sort(function(t,n){return e[t]-e[n]})}function sum$1(r){for(var e=0,t=-1,n=r.length,i;++t<n;)(i=+r[t][1])&&(e+=i);return e}function d3StackOrderDescending(r){return d3StackOrderAscending(r).reverse()}function d3StackOrderInsideOut(r){var e=r.length,t,n,i=r.map(sum$1),s=d3StackOrderAppearance(r),a=0,o=0,c=[],h=[];for(t=0;t<e;++t)n=s[t],a<o?(a+=i[n],c.push(n)):(o+=i[n],h.push(n));return h.reverse().concat(c)}function d3StackOrderReverse(r){return d3StackOrderNone(r).reverse()}const StackOrder={appearance:d3StackOrderAppearance,ascending:d3StackOrderAscending,descending:d3StackOrderDescending,insideOut:d3StackOrderInsideOut,none:d3StackOrderNone,reverse:d3StackOrderReverse},StackOffset={expand:d3StackOffsetExpand,diverging:d3StackOffsetDiverging,none:d3StackOffsetNone,silhouette:d3StackOffsetSilhouette,wiggle:d3StackOffsetWiggle},getStackingGroups=r=>{const{series:e,seriesOrder:t,defaultStrategy:n}=r,i=[],s={};return t.forEach(a=>{const{stack:o,stackOrder:c,stackOffset:h}=e[a];o===void 0?i.push({ids:[a],stackingOrder:StackOrder.none,stackingOffset:StackOffset.none}):s[o]===void 0?(s[o]=i.length,i.push({ids:[a],stackingOrder:StackOrder[c??(n==null?void 0:n.stackOrder)??"none"],stackingOffset:StackOffset[h??(n==null?void 0:n.stackOffset)??"diverging"]})):(i[s[o]].ids.push(a),c!==void 0&&(i[s[o]].stackingOrder=StackOrder[c]),h!==void 0&&(i[s[o]].stackingOffset=StackOffset[h]))}),i},barValueFormatter=r=>r==null?"":r.toLocaleString(),seriesProcessor$3=(r,e)=>{const{seriesOrder:t,series:n}=r,i=getStackingGroups(r),s=e??[];t.forEach(o=>{const c=n[o].data;if(c!==void 0)c.forEach((h,f)=>{s.length<=f?s.push({[o]:h}):s[f][o]=h});else if(e===void 0)throw new Error([`MUI X Charts: bar series with id='${o}' has no data.`,"Either provide a data property to the series or use the dataset prop."].join(`
`))});const a={};return i.forEach(o=>{const{ids:c,stackingOffset:h,stackingOrder:f}=o,m=d3Stack().keys(c.map(g=>{const _=n[g].dataKey;return n[g].data===void 0&&_!==void 0?_:g})).value((g,_)=>g[_]??0).order(f).offset(h)(s);c.forEach((g,_)=>{const E=n[g].dataKey;a[g]=_extends({layout:"vertical",labelMarkType:"square",minBarSize:0,valueFormatter:n[g].valueFormatter??barValueFormatter},n[g],{data:E?e.map(A=>{const C=A[E];return typeof C!="number"?null:C}):n[g].data,stackedData:m[_].map(([A,C])=>[A,C])})})}),{seriesOrder:t,stackingGroups:i,series:a}};function getLabel(r,e){return typeof r=="function"?r(e):r}const legendGetter$3=r=>{const{seriesOrder:e,series:t}=r;return e.reduce((n,i)=>{const s=getLabel(t[i].label,"legend");return s===void 0||n.push({markType:t[i].labelMarkType,id:i,seriesId:i,color:t[i].color,label:s}),n},[])},getColor$3=(r,e,t)=>{const n=r.layout==="vertical",i=n?e==null?void 0:e.colorScale:t==null?void 0:t.colorScale,s=n?t==null?void 0:t.colorScale:e==null?void 0:e.colorScale,a=n?e==null?void 0:e.data:t==null?void 0:t.data;return s?o=>{if(o===void 0)return r.color;const c=r.data[o],h=c===null?r.color:s(c);return h===null?r.color:h}:i&&a?o=>{if(o===void 0)return r.color;const c=a[o],h=c===null?r.color:i(c);return h===null?r.color:h}:()=>r.color},tooltipGetter$3=r=>{const{series:e,getColor:t,identifier:n}=r;if(!n||n.dataIndex===void 0)return null;const i=getLabel(e.label,"tooltip"),s=e.data[n.dataIndex];if(s==null)return null;const a=e.valueFormatter(s,{dataIndex:n.dataIndex});return{identifier:n,color:t(n.dataIndex),label:i,value:s,formattedValue:a,markType:e.labelMarkType}},axisTooltipGetter$1=r=>Object.values(r).map(e=>e.layout==="horizontal"?{direction:"y",axisId:e.yAxisId}:{direction:"x",axisId:e.xAxisId}),getSeriesWithDefaultValues$3=(r,e,t)=>_extends({id:r.id??`auto-generated-id-${e}`,color:t[e%t.length]},r),seriesConfig$3={seriesProcessor:seriesProcessor$3,colorProcessor:getColor$3,legendGetter:legendGetter$3,tooltipGetter:tooltipGetter$3,axisTooltipGetter:axisTooltipGetter$1,xExtremumGetter:getExtremumX$2,yExtremumGetter:getExtremumY$2,getSeriesWithDefaultValues:getSeriesWithDefaultValues$3},getExtremumX$1=r=>{const{series:e,axis:t,isDefaultAxis:n,getFilters:i}=r;let s=1/0,a=-1/0;for(const o in e){if(!Object.hasOwn(e,o))continue;const c=e[o].xAxisId;if(!(c===t.id||c===void 0&&n))continue;const h=i==null?void 0:i({currentAxisId:t.id,isDefaultAxis:n,seriesXAxisId:e[o].xAxisId,seriesYAxisId:e[o].yAxisId}),f=e[o].data??[];for(let m=0;m<f.length;m+=1){const g=f[m];h&&!h(g,m)||g.x!==null&&(g.x<s&&(s=g.x),g.x>a&&(a=g.x))}}return[s,a]},getExtremumY$1=r=>{const{series:e,axis:t,isDefaultAxis:n,getFilters:i}=r;let s=1/0,a=-1/0;for(const o in e){if(!Object.hasOwn(e,o))continue;const c=e[o].yAxisId;if(!(c===t.id||c===void 0&&n))continue;const h=i==null?void 0:i({currentAxisId:t.id,isDefaultAxis:n,seriesXAxisId:e[o].xAxisId,seriesYAxisId:e[o].yAxisId}),f=e[o].data??[];for(let m=0;m<f.length;m+=1){const g=f[m];h&&!h(g,m)||g.y!==null&&(g.y<s&&(s=g.y),g.y>a&&(a=g.y))}}return[s,a]},seriesProcessor$2=({series:r,seriesOrder:e},t)=>({series:Object.fromEntries(Object.entries(r).map(([i,s])=>{const a=s==null?void 0:s.datasetKeys,o=["x","y","id"].filter(h=>typeof(a==null?void 0:a[h])!="string");if(s!=null&&s.datasetKeys&&o.length>0)throw new Error([`MUI X Charts: scatter series with id='${i}' has incomplete datasetKeys.`,`Properties ${o.map(h=>`"${h}"`).join(", ")} are missing.`].join(`
`));const c=a?(t==null?void 0:t.map(h=>({x:h[a.x]??null,y:h[a.y]??null,z:a.z&&h[a.z],id:a.id&&h[a.id]})))??[]:s.data??[];return[i,_extends({labelMarkType:"circle",markerSize:4},s,{preview:_extends({markerSize:1},s==null?void 0:s.preview),data:c,valueFormatter:s.valueFormatter??(h=>h&&`(${h.x}, ${h.y})`)})]})),seriesOrder:e}),getColor$2=(r,e,t,n)=>{const i=n==null?void 0:n.colorScale,s=t==null?void 0:t.colorScale,a=e==null?void 0:e.colorScale;return i?o=>{var f,m;if(o===void 0)return r.color;if(((f=n==null?void 0:n.data)==null?void 0:f[o])!==void 0){const g=i((m=n==null?void 0:n.data)==null?void 0:m[o]);if(g!==null)return g}const c=r.data[o],h=c===null?r.color:i(c.z);return h===null?r.color:h}:s?o=>{if(o===void 0)return r.color;const c=r.data[o],h=c===null?r.color:s(c.y);return h===null?r.color:h}:a?o=>{if(o===void 0)return r.color;const c=r.data[o],h=c===null?r.color:a(c.x);return h===null?r.color:h}:()=>r.color},legendGetter$2=r=>{const{seriesOrder:e,series:t}=r;return e.reduce((n,i)=>{const s=getLabel(t[i].label,"legend");return s===void 0||n.push({markType:t[i].labelMarkType,id:i,seriesId:i,color:t[i].color,label:s}),n},[])},tooltipGetter$2=r=>{const{series:e,getColor:t,identifier:n}=r;if(!n||n.dataIndex===void 0)return null;const i=getLabel(e.label,"tooltip"),s=e.data[n.dataIndex],a=e.valueFormatter(s,{dataIndex:n.dataIndex});return{identifier:n,color:t(n.dataIndex),label:i,value:s,formattedValue:a,markType:e.labelMarkType}},getSeriesWithDefaultValues$2=(r,e,t)=>_extends({id:r.id??`auto-generated-id-${e}`,color:t[e%t.length]},r),seriesConfig$2={seriesProcessor:seriesProcessor$2,colorProcessor:getColor$2,legendGetter:legendGetter$2,tooltipGetter:tooltipGetter$2,xExtremumGetter:getExtremumX$1,yExtremumGetter:getExtremumY$1,getSeriesWithDefaultValues:getSeriesWithDefaultValues$2},getExtremumX=r=>{const{axis:e}=r;return findMinMax(e.data??[])};function getSeriesExtremums(r,e,t,n){return t.reduce((i,s,a)=>{if(e[a]===null)return i;const[o,c]=r(s);return n&&(!n({y:o,x:null},a)||!n({y:c,x:null},a))?i:[Math.min(o,c,i[0]),Math.max(o,c,i[1])]},[1/0,-1/0])}const getExtremumY=r=>{const{series:e,axis:t,isDefaultAxis:n,getFilters:i}=r;return Object.keys(e).filter(s=>{const a=e[s].yAxisId;return a===t.id||n&&a===void 0}).reduce((s,a)=>{const{area:o,stackedData:c,data:h}=e[a],f=o!==void 0,m=i==null?void 0:i({currentAxisId:t.id,isDefaultAxis:n,seriesXAxisId:e[a].xAxisId,seriesYAxisId:e[a].yAxisId}),g=f&&t.scaleType!=="log"&&typeof e[a].baseline!="string"?C=>C:C=>[C[1],C[1]],_=getSeriesExtremums(g,h,c,m),[E,A]=_;return[Math.min(E,s[0]),Math.max(A,s[1])]},[1/0,-1/0])};function defaultizeValueFormatter(r,e){const t={};return Object.keys(r).forEach(n=>{t[n]=_extends({},r[n],{valueFormatter:r[n].valueFormatter??e})}),t}const seriesProcessor$1=(r,e)=>{const{seriesOrder:t,series:n}=r,i=getStackingGroups(_extends({},r,{defaultStrategy:{stackOffset:"none"}})),s=e??[];t.forEach(o=>{const c=n[o].data;c!==void 0&&c.forEach((h,f)=>{s.length<=f?s.push({[o]:h}):s[f][o]=h})});const a={};return i.forEach(o=>{const{ids:c,stackingOrder:h,stackingOffset:f}=o,m=d3Stack().keys(c.map(g=>{const _=n[g].dataKey;return n[g].data===void 0&&_!==void 0?_:g})).value((g,_)=>g[_]??0).order(h).offset(f)(s);c.forEach((g,_)=>{const E=n[g].dataKey;a[g]=_extends({labelMarkType:"line"},n[g],{data:E?e.map(A=>{const C=A[E];return typeof C!="number"?null:C}):n[g].data,stackedData:m[_].map(([A,C])=>[A,C])})})}),{seriesOrder:t,stackingGroups:i,series:defaultizeValueFormatter(a,o=>o==null?"":o.toLocaleString())}},getColor$1=(r,e,t)=>{const n=t==null?void 0:t.colorScale,i=e==null?void 0:e.colorScale;return n?s=>{if(s===void 0)return r.color;const a=r.data[s],o=a===null?r.color:n(a);return o===null?r.color:o}:i?s=>{var c;if(s===void 0)return r.color;const a=(c=e.data)==null?void 0:c[s],o=a===null?r.color:i(a);return o===null?r.color:o}:()=>r.color},legendGetter$1=r=>{const{seriesOrder:e,series:t}=r;return e.reduce((n,i)=>{const s=getLabel(t[i].label,"legend");return s===void 0||n.push({markType:t[i].labelMarkType,id:i,seriesId:i,color:t[i].color,label:s}),n},[])},tooltipGetter$1=r=>{const{series:e,getColor:t,identifier:n}=r;if(!n||n.dataIndex===void 0)return null;const i=getLabel(e.label,"tooltip"),s=e.data[n.dataIndex],a=e.valueFormatter(s,{dataIndex:n.dataIndex});return{identifier:n,color:t(n.dataIndex),label:i,value:s,formattedValue:a,markType:e.labelMarkType}},axisTooltipGetter=r=>Object.values(r).map(e=>({direction:"x",axisId:e.xAxisId})),getSeriesWithDefaultValues$1=(r,e,t)=>_extends({id:r.id??`auto-generated-id-${e}`,color:t[e%t.length]},r),seriesConfig$1={colorProcessor:getColor$1,seriesProcessor:seriesProcessor$1,legendGetter:legendGetter$1,tooltipGetter:tooltipGetter$1,axisTooltipGetter,xExtremumGetter:getExtremumX,yExtremumGetter:getExtremumY,getSeriesWithDefaultValues:getSeriesWithDefaultValues$1},getSortingComparator=(r="none")=>{if(typeof r=="function")return r;switch(r){case"none":return null;case"desc":return(e,t)=>t-e;case"asc":return(e,t)=>e-t;default:return null}},seriesProcessor=r=>{const{seriesOrder:e,series:t}=r,n={};return e.forEach(i=>{const s=d3Pie().startAngle(2*Math.PI*(t[i].startAngle??0)/360).endAngle(2*Math.PI*(t[i].endAngle??360)/360).padAngle(2*Math.PI*(t[i].paddingAngle??0)/360).sortValues(getSortingComparator(t[i].sortingValues??"none"))(t[i].data.map(a=>a.value));n[i]=_extends({labelMarkType:"circle",valueFormatter:a=>a.value.toLocaleString()},t[i],{data:t[i].data.map((a,o)=>_extends({},a,{id:a.id??`auto-generated-pie-id-${i}-${o}`},s[o])).map((a,o)=>{var c,h;return _extends({labelMarkType:"circle"},a,{formattedValue:((h=(c=t[i]).valueFormatter)==null?void 0:h.call(c,_extends({},a,{label:getLabel(a.label,"arc")}),{dataIndex:o}))??a.value.toLocaleString()})})})}),{seriesOrder:e,series:n}},getColor=r=>e=>r.data[e].color,legendGetter=r=>{const{seriesOrder:e,series:t}=r;return e.reduce((n,i)=>(t[i].data.forEach((s,a)=>{const o=getLabel(s.label,"legend");o!==void 0&&n.push({markType:s.labelMarkType??t[i].labelMarkType,id:s.id??a,seriesId:i,color:s.color,label:o,itemId:s.id??a})}),n),[])},tooltipGetter=r=>{const{series:e,getColor:t,identifier:n}=r;if(!n||n.dataIndex===void 0)return null;const i=e.data[n.dataIndex];if(i==null)return null;const s=getLabel(i.label,"tooltip"),a=_extends({},i,{label:s}),o=e.valueFormatter(a,{dataIndex:n.dataIndex});return{identifier:n,color:t(n.dataIndex),label:s,value:a,formattedValue:o,markType:i.labelMarkType??e.labelMarkType}},getSeriesWithDefaultValues=(r,e,t)=>_extends({id:r.id??`auto-generated-id-${e}`},r,{data:r.data.map((n,i)=>_extends({color:t[i%t.length]},n))}),seriesConfig={colorProcessor:getColor,seriesProcessor,legendGetter,tooltipGetter,getSeriesWithDefaultValues},defaultSeriesConfig={bar:seriesConfig$3,scatter:seriesConfig$2,line:seriesConfig$1,pie:seriesConfig},defaultPlugins=[useChartZAxis,useChartCartesianAxis,useChartInteraction,useChartHighlight];function ChartProvider(r){const{children:e,plugins:t=defaultPlugins,pluginParams:n={},seriesConfig:i=defaultSeriesConfig}=r,{contextValue:s}=useCharts(t,n,i);return jsxRuntimeExports.jsx(ChartContext.Provider,{value:s,children:e})}const useChartContext=()=>{const r=reactExports.useContext(ChartContext);if(r==null)throw new Error(["MUI X Charts: Could not find the Chart context.","It looks like you rendered your component outside of a ChartDataProvider.","This can also happen if you are bundling multiple versions of the library."].join(`
`));return r};function useStore(){const r=useChartContext();if(!r)throw new Error(["MUI X Charts: Could not find the charts context.","It looks like you rendered your component outside of a ChartContainer parent component."].join(`
`));return r.store}function useDrawingArea(){const r=useStore();return useSelector(r,selectorChartDrawingArea)}function useChartId(){const r=useStore();return useSelector(r,selectorChartId)}function isPolarSeriesType(r){return polarSeriesTypes.getTypes().has(r)}const axisExtremumCallback=(r,e,t,n,i,s,a)=>{var _;const o=n==="rotation"?i[e].rotationExtremumGetter:i[e].radiusExtremumGetter,c=((_=a[e])==null?void 0:_.series)??{},[h,f]=(o==null?void 0:o({series:c,axis:t,axisIndex:s,isDefaultAxis:s===0}))??[1/0,-1/0],[m,g]=r;return[Math.min(h,m),Math.max(f,g)]},getAxisExtremum=(r,e,t,n,i)=>{const a=Object.keys(t).filter(isPolarSeriesType).reduce((o,c)=>axisExtremumCallback(o,c,r,e,t,n,i),[1/0,-1/0]);return Number.isNaN(a[0])||Number.isNaN(a[1])?[1/0,-1/0]:a},deg2rad=(r,e)=>r===void 0?e:Math.PI*r/180,getAxisTriggerTooltip=(r,e,t,n)=>{const i=new Set;return Object.keys(e).filter(isPolarSeriesType).forEach(a=>{var h,f,m;const o=((h=t[a])==null?void 0:h.series)??{},c=(m=(f=e[a]).axisTooltipGetter)==null?void 0:m.call(f,o);c!==void 0&&c.forEach(({axisId:g,direction:_})=>{_===r&&i.add(g??n)})}),i};function getRange(r,e,t){if(e==="rotation"){if(t.scaleType==="point"){const n=[deg2rad(t.startAngle,0),deg2rad(t.endAngle,2*Math.PI)],i=n[1]-n[0];return i>Math.PI*2-.1&&(n[1]-=i/t.data.length),n}return[deg2rad(t.startAngle,0),deg2rad(t.endAngle,2*Math.PI)]}return[0,Math.min(r.height,r.width)/2]}const DEFAULT_CATEGORY_GAP_RATIO=.2,DEFAULT_BAR_GAP_RATIO=.1;function computeAxisValue({drawingArea:r,formattedSeries:e,axis:t,seriesConfig:n,axisDirection:i}){if(t===void 0)return{axis:{},axisIds:[]};const s=getAxisTriggerTooltip(i,n,e,t[0].id),a={};return t.forEach((o,c)=>{const h=o,f=getRange(r,i,h),[m,g]=getAxisExtremum(h,i,n,c,e),_=!h.ignoreTooltip&&s.has(h.id),E=h.data??[];if(isBandScaleConfig(h)){const P=h.categoryGapRatio??DEFAULT_CATEGORY_GAP_RATIO,K=h.barGapRatio??DEFAULT_BAR_GAP_RATIO;if(a[h.id]=_extends({offset:0,categoryGapRatio:P,barGapRatio:K,triggerTooltip:_},h,{data:E,scale:band(h.data,f).paddingInner(P).paddingOuter(P/2),tickNumber:h.data.length,colorScale:h.colorMap&&(h.colorMap.type==="ordinal"?getOrdinalColorScale(_extends({values:h.data},h.colorMap)):getColorScale(h.colorMap))}),isDateData(h.data)){const X=createDateFormatter(h,f);a[h.id].valueFormatter=h.valueFormatter??X}}if(isPointScaleConfig(h)&&(a[h.id]=_extends({offset:0,triggerTooltip:_},h,{data:E,scale:point(h.data,f),tickNumber:h.data.length,colorScale:h.colorMap&&(h.colorMap.type==="ordinal"?getOrdinalColorScale(_extends({values:h.data},h.colorMap)):getColorScale(h.colorMap))}),isDateData(h.data))){const P=createDateFormatter(h,f);a[h.id].valueFormatter=h.valueFormatter??P}if(h.scaleType==="band"||h.scaleType==="point")return;const A=h.scaleType??"linear",C=h.domainLimit??"nice",I=[h.min??m,h.max??g];if(typeof C=="function"){const{min:P,max:K}=C(m,g);I[0]=P,I[1]=K}const b=getTickNumber(_extends({},h,{range:f,domain:I})),R=scaleTickNumberByRange(b,f),V=getScale(A,I,f),U=C==="nice"?V.nice(b):V,[W,j]=U.domain(),w=[h.min??W,h.max??j];a[h.id]=_extends({offset:0,triggerTooltip:_},h,{data:E,scaleType:A,scale:U.domain(w),tickNumber:R,colorScale:h.colorMap&&getColorScale(h.colorMap)})}),{axis:a,axisIds:t.map(({id:o})=>o)}}const selectorChartPolarAxisState=r=>r.polarAxis,selectorChartRawRotationAxis=createSelector([selectorChartPolarAxisState],r=>r==null?void 0:r.rotation),selectorChartRawRadiusAxis=createSelector([selectorChartPolarAxisState],r=>r==null?void 0:r.radius),selectorChartRotationAxis=createSelector([selectorChartRawRotationAxis,selectorChartDrawingArea,selectorChartSeriesProcessed,selectorChartSeriesConfig],(r,e,t,n)=>computeAxisValue({drawingArea:e,formattedSeries:t,axis:r,seriesConfig:n,axisDirection:"rotation"})),selectorChartRadiusAxis=createSelector([selectorChartRawRadiusAxis,selectorChartDrawingArea,selectorChartSeriesProcessed,selectorChartSeriesConfig],(r,e,t,n)=>computeAxisValue({drawingArea:e,formattedSeries:t,axis:r,seriesConfig:n,axisDirection:"radius"})),selectorChartPolarCenter=createSelector([selectorChartDrawingArea],r=>({cx:r.left+r.width/2,cy:r.top+r.height/2})),generateSvg2rotation=r=>(e,t)=>Math.atan2(e-r.cx,r.cy-t);function clampAngle(r){return(r%360+360)%360}const TWO_PI=2*Math.PI;function clampAngleRad(r){return(r%TWO_PI+TWO_PI)%TWO_PI}function getAxisIndex(r,e){const{scale:t,data:n,reverse:i}=r;if(!isBandScale(t))throw new Error("MUI X Charts: getAxisValue is not implemented for polare continuous axes.");if(!n)return-1;const s=clampAngleRad(e-Math.min(...t.range())),a=t.bandwidth()===0?Math.floor((s+t.step()/2)/t.step())%n.length:Math.floor(s/t.step());return a<0||a>=n.length?-1:i?n.length-1-a:a}function useXAxes(){const r=useStore(),{axis:e,axisIds:t}=useSelector(r,selectorChartXAxis);return{xAxis:e,xAxisIds:t}}function useYAxes(){const r=useStore(),{axis:e,axisIds:t}=useSelector(r,selectorChartYAxis);return{yAxis:e,yAxisIds:t}}function useXAxis(r){const e=useStore(),{axis:t,axisIds:n}=useSelector(e,selectorChartXAxis),i=n[0];return t[i]}function useYAxis(r){const e=useStore(),{axis:t,axisIds:n}=useSelector(e,selectorChartYAxis),i=n[0];return t[i]}function useRotationAxes(){const r=useStore(),{axis:e,axisIds:t}=useSelector(r,selectorChartRotationAxis);return{rotationAxis:e,rotationAxisIds:t}}function useRadiusAxes(){const r=useStore(),{axis:e,axisIds:t}=useSelector(r,selectorChartRadiusAxis);return{radiusAxis:e,radiusAxisIds:t}}function useRotationAxis(r){const e=useStore(),{axis:t,axisIds:n}=useSelector(e,selectorChartRotationAxis),i=n[0];return t[i]}function getValueToPositionMapper(r){return isBandScale(r)?e=>(r(e)??0)+r.bandwidth()/2:e=>r(e)}function useZAxes(){const r=useStore(),{axis:e,axisIds:t}=useSelector(r,selectorChartZAxis)??{axis:{},axisIds:[]};return{zAxis:e,zAxisIds:t}}function useSvgRef(){const r=useChartContext();if(!r)throw new Error(["MUI X Charts: Could not find the svg ref context.","It looks like you rendered your component outside of a ChartContainer parent component."].join(`
`));return r.svgRef}function useSeries(){const r=useStore();return useSelector(r,selectorChartSeriesProcessed)}function fastArrayCompare(r,e){if(r===e)return!0;if(!Array.isArray(r)||!Array.isArray(e))return!1;let t=r.length;if(t!==e.length)return!1;for(;t--;)if(r[t]!==e[t])return!1;return!0}function createSeriesSelectorsOfType(r){const e=createSelector([selectorChartSeriesProcessed,(t,n)=>n],(t,n)=>{var s,a,o,c,h,f;if(!n||Array.isArray(n)&&n.length===0)return((a=(s=t[r])==null?void 0:s.seriesOrder)==null?void 0:a.map(m=>{var g;return(g=t[r])==null?void 0:g.series[m]}))??[];if(!Array.isArray(n))return(c=(o=t[r])==null?void 0:o.series)==null?void 0:c[n];const i=[];for(const m of n){const g=(f=(h=t[r])==null?void 0:h.series)==null?void 0:f[m];g&&i.push(g)}return i});return t=>{const n=useStore();return useSelector(n,e,[t],fastArrayCompare)}}function createAllSeriesSelectorOfType(r){const e=createSelector([selectorChartSeriesProcessed],t=>t[r]);return()=>{const t=useStore();return useSelector(t,e)}}createSeriesSelectorsOfType("pie");const useSelectorSeriesContext$1=createAllSeriesSelectorOfType("pie");function usePieSeriesContext(){return useSelectorSeriesContext$1()}createSeriesSelectorsOfType("bar");const useSelectorSeriesContext=createAllSeriesSelectorOfType("bar");function useBarSeriesContext(){return useSelectorSeriesContext()}function alwaysFalse$1(){return!1}function createIsHighlighted(r,e){return!r||!e?alwaysFalse$1:function(n){return n?r.highlight==="series"?n.seriesId===e.seriesId:r.highlight==="item"?n.dataIndex===e.dataIndex&&n.seriesId===e.seriesId:!1:!1}}function alwaysFalse(){return!1}function createIsFaded(r,e){return!r||!e?alwaysFalse:function(n){return n?r.fade==="series"?n.seriesId===e.seriesId&&n.dataIndex!==e.dataIndex:r.fade==="global"?n.seriesId!==e.seriesId||n.dataIndex!==e.dataIndex:!1:!1}}const selectHighlight=r=>r.highlight,selectSeries=r=>r.series,selectorChartsHighlightScopePerSeriesId=createSelector([selectSeries],r=>{const e=new Map;return Object.keys(r.processedSeries).forEach(t=>{var i;const n=r.processedSeries[t];(i=n==null?void 0:n.seriesOrder)==null||i.forEach(s=>{const a=n==null?void 0:n.series[s];e.set(s,a==null?void 0:a.highlightScope)})}),e}),selectorChartsHighlightedItem=createSelector([selectHighlight],function r(e){return e.item}),selectorChartsHighlightScope=createSelector([selectorChartsHighlightScopePerSeriesId,selectorChartsHighlightedItem],function r(e,t){if(!t)return null;const n=e.get(t.seriesId);return n===void 0?null:n}),selectorChartsIsHighlightedCallback=createSelector([selectorChartsHighlightScope,selectorChartsHighlightedItem],createIsHighlighted),selectorChartsIsFadedCallback=createSelector([selectorChartsHighlightScope,selectorChartsHighlightedItem],createIsFaded),selectorChartsIsHighlighted=createSelector([selectorChartsHighlightScope,selectorChartsHighlightedItem,(r,e)=>e],function r(e,t,n){return createIsHighlighted(e,t)(n)}),selectorChartsIsFaded=createSelector([selectorChartsHighlightScope,selectorChartsHighlightedItem,(r,e)=>e],function r(e,t,n){return createIsFaded(e,t)(n)});function useItemHighlighted(r){const e=useStore(),t=useSelector(e,selectorChartsIsHighlighted,[r]),n=useSelector(e,selectorChartsIsFaded,[r]);return{isHighlighted:t,isFaded:!t&&n}}function useItemHighlightedGetter(){const r=useStore(),e=useSelector(r,selectorChartsIsHighlightedCallback),t=useSelector(r,selectorChartsIsFadedCallback);return{isHighlighted:e,isFaded:t}}function getSeriesToDisplay(r,e){return Object.keys(r).flatMap(t=>{const n=e[t].legendGetter;return n===void 0?[]:n(r[t])})}function useLegend(){const r=useSeries(),e=useStore(),t=useSelector(e,selectorChartSeriesConfig);return{items:getSeriesToDisplay(r,t)}}function useChartGradientIdBuilder(){const r=useChartId();return reactExports.useCallback(e=>`${r}-gradient-${e}`,[r])}function useChartGradientIdObjectBoundBuilder(){const r=useChartId();return reactExports.useCallback(e=>`${r}-gradient-${e}-object-bound`,[r])}var src,hasRequiredSrc;function requireSrc(){if(hasRequiredSrc)return src;hasRequiredSrc=1;var r=4,e=.001,t=1e-7,n=10,i=11,s=1/(i-1),a=typeof Float32Array=="function";function o(A,C){return 1-3*C+3*A}function c(A,C){return 3*C-6*A}function h(A){return 3*A}function f(A,C,I){return((o(C,I)*A+c(C,I))*A+h(C))*A}function m(A,C,I){return 3*o(C,I)*A*A+2*c(C,I)*A+h(C)}function g(A,C,I,b,R){var V,U,W=0;do U=C+(I-C)/2,V=f(U,b,R)-A,V>0?I=U:C=U;while(Math.abs(V)>t&&++W<n);return U}function _(A,C,I,b){for(var R=0;R<r;++R){var V=m(C,I,b);if(V===0)return C;var U=f(C,I,b)-A;C-=U/V}return C}function E(A){return A}return src=function(C,I,b,R){if(!(0<=C&&C<=1&&0<=b&&b<=1))throw new Error("bezier x values must be in [0, 1] range");if(C===I&&b===R)return E;for(var V=a?new Float32Array(i):new Array(i),U=0;U<i;++U)V[U]=f(U*s,C,b);function W(j){for(var w=0,P=1,K=i-1;P!==K&&V[P]<=j;++P)w+=s;--P;var X=(j-V[P])/(V[P+1]-V[P]),Y=w+X*s,Z=m(Y,C,b);return Z>=e?_(j,Y,C,b):Z===0?Y:g(j,w,w+s,C,b)}return function(w){return w===0?0:w===1?1:f(W(w),I,R)}},src}var srcExports=requireSrc();const BezierEasing=getDefaultExportFromCjs(srcExports),ANIMATION_DURATION_MS=300,ANIMATION_TIMING_FUNCTION="cubic-bezier(0.66, 0, 0.34, 1)",ANIMATION_TIMING_FUNCTION_JS=BezierEasing(.66,0,.34,1);var frame=0,timeout$1=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(r,e,t){if(typeof r!="function")throw new TypeError("callback is not a function");t=(t==null?now():+t)+(e==null?0:+e),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=r,this._time=t,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(r,e,t){var n=new Timer;return n.restart(r,e,t),n}function timerFlush(){now(),++frame;for(var r=taskHead,e;r;)(e=clockNow-r._time)>=0&&r._call.call(void 0,e),r=r._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var r=clock.now(),e=r-clockLast;e>pokeDelay&&(clockSkew-=e,clockLast=r)}function nap(){for(var r,e=taskHead,t,n=1/0;e;)e._call?(n>e._time&&(n=e._time),r=e,e=e._next):(t=e._next,e._next=null,e=r?r._next=t:taskHead=t);taskTail=r,sleep(n)}function sleep(r){if(!frame){timeout$1&&(timeout$1=clearTimeout(timeout$1));var e=r-clockNow;e>24?(r<1/0&&(timeout$1=setTimeout(wake,r-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout(r,e,t){var n=new Timer;return e=e==null?0:+e,n.restart(i=>{n.stop(),r(i+e)},e,t),n}class Transition{constructor(e,t,n){this.duration=void 0,this.elapsed=0,this.easingFn=void 0,this.timer=null,this.onTickCallback=void 0,this.duration=e,this.easingFn=t,this.onTickCallback=n,this.resume()}get running(){return this.timer!==null}timerCallback(e){this.elapsed=Math.min(e,this.duration);const t=this.duration===0?1:this.elapsed/this.duration,n=this.easingFn(t);this.onTickCallback(n),this.elapsed>=this.duration&&this.stop()}resume(){if(this.running||this.elapsed>=this.duration)return this;const e=now()-this.elapsed;return this.timer=timer(t=>this.timerCallback(t),0,e),timerFlush(),this}stop(){return this.running?(this.timer&&(this.timer.stop(),this.timer=null),this):this}finish(){return this.stop(),timeout(()=>this.timerCallback(this.duration)),timerFlush(),this}}function shallowEqual(r,e){if(Object.is(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;const t=Object.keys(r),n=Object.keys(e);if(t.length!==n.length)return!1;for(let i=0;i<t.length;i+=1){const s=t[i];if(!Object.prototype.hasOwnProperty.call(e,s)||!Object.is(r[s],e[s]))return!1}return!0}function useAnimateInternal(r,{createInterpolator:e,applyProps:t,skip:n,initialProps:i=r}){const s=reactExports.useRef(i),a=reactExports.useRef(null),o=reactExports.useRef(null),c=reactExports.useRef(r);useEnhancedEffect(()=>{c.current=r},[r]),useEnhancedEffect(()=>{var m;n&&((m=a.current)==null||m.finish(),a.current=null,o.current=null,s.current=r)},[r,n]);const h=reactExports.useCallback(m=>{const g=s.current,_=e(g,r);a.current=new Transition(ANIMATION_DURATION_MS,ANIMATION_TIMING_FUNCTION_JS,E=>{const A=_(E);s.current=A,t(m,A)})},[t,e,r]);return reactExports.useCallback(m=>{var _,E,A,C;if(m===null){(_=a.current)==null||_.stop();return}const g=o.current;if(g===m){if(shallowEqual(c.current,r)){(E=a.current)==null||E.resume();return}(A=a.current)==null||A.stop()}g&&((C=a.current)==null||C.stop()),o.current=m,(a.current||!n)&&h(m)},[h,r,n])}function useAnimate(r,{createInterpolator:e,transformProps:t,applyProps:n,skip:i,initialProps:s=r,ref:a}){const o=t??(f=>f),c=useAnimateInternal(r,{initialProps:s,createInterpolator:e,applyProps:(f,m)=>n(f,o(m)),skip:i});return _extends({},t(i?r:s),{ref:useForkRef(c,a)})}function barPropsInterpolator(r,e){const t=interpolateNumber(r.x,e.x),n=interpolateNumber(r.y,e.y),i=interpolateNumber(r.width,e.width),s=interpolateNumber(r.height,e.height);return a=>({x:t(a),y:n(a),width:i(a),height:s(a)})}function useAnimateBar(r){const e={x:r.layout==="vertical"?r.x:r.xOrigin,y:r.layout==="vertical"?r.yOrigin:r.y,width:r.layout==="vertical"?r.width:0,height:r.layout==="vertical"?0:r.height};return useAnimate({x:r.x,y:r.y,width:r.width,height:r.height},{createInterpolator:barPropsInterpolator,applyProps(t,n){t.setAttribute("x",n.x.toString()),t.setAttribute("y",n.y.toString()),t.setAttribute("width",n.width.toString()),t.setAttribute("height",n.height.toString())},transformProps:t=>t,initialProps:e,skip:r.skipAnimation,ref:r.ref})}function barLabelPropsInterpolator(r,e){const t=interpolateNumber(r.x,e.x),n=interpolateNumber(r.y,e.y),i=interpolateNumber(r.width,e.width),s=interpolateNumber(r.height,e.height);return a=>({x:t(a),y:n(a),width:i(a),height:s(a)})}function useAnimateBarLabel(r){const e={x:r.layout==="vertical"?r.x+r.width/2:r.xOrigin,y:r.layout==="vertical"?r.yOrigin:r.y+r.height/2,width:r.width,height:r.height},t={x:r.x+r.width/2,y:r.y+r.height/2,width:r.width,height:r.height};return useAnimate(t,{createInterpolator:barLabelPropsInterpolator,transformProps:n=>n,applyProps(n,i){n.setAttribute("x",i.x.toString()),n.setAttribute("y",i.y.toString()),n.setAttribute("width",i.width.toString()),n.setAttribute("height",i.height.toString())},initialProps:e,skip:r.skipAnimation,ref:r.ref})}function pieArcPropsInterpolator(r,e){const t=interpolateNumber(r.startAngle,e.startAngle),n=interpolateNumber(r.endAngle,e.endAngle),i=interpolateNumber(r.innerRadius,e.innerRadius),s=interpolateNumber(r.outerRadius,e.outerRadius),a=interpolateNumber(r.paddingAngle,e.paddingAngle),o=interpolateNumber(r.cornerRadius,e.cornerRadius);return c=>({startAngle:t(c),endAngle:n(c),innerRadius:i(c),outerRadius:s(c),paddingAngle:a(c),cornerRadius:o(c)})}function useAnimatePieArc(r){const e={startAngle:(r.startAngle+r.endAngle)/2,endAngle:(r.startAngle+r.endAngle)/2,innerRadius:r.innerRadius,outerRadius:r.outerRadius,paddingAngle:r.paddingAngle,cornerRadius:r.cornerRadius};return useAnimate({startAngle:r.startAngle,endAngle:r.endAngle,innerRadius:r.innerRadius,outerRadius:r.outerRadius,paddingAngle:r.paddingAngle,cornerRadius:r.cornerRadius},{createInterpolator:pieArcPropsInterpolator,transformProps:t=>({d:d3Arc().cornerRadius(t.cornerRadius)({padAngle:t.paddingAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius,startAngle:t.startAngle,endAngle:t.endAngle}),visibility:t.startAngle===t.endAngle?"hidden":"visible"}),applyProps(t,n){t.setAttribute("d",n.d),t.setAttribute("visibility",n.visibility)},initialProps:e,skip:r.skipAnimation,ref:r.ref})}function pieArcLabelPropsInterpolator(r,e){const t=interpolateNumber(r.startAngle,e.startAngle),n=interpolateNumber(r.endAngle,e.endAngle),i=interpolateNumber(r.innerRadius,e.innerRadius),s=interpolateNumber(r.outerRadius,e.outerRadius),a=interpolateNumber(r.paddingAngle,e.paddingAngle),o=interpolateNumber(r.cornerRadius,e.cornerRadius);return c=>({startAngle:t(c),endAngle:n(c),innerRadius:i(c),outerRadius:s(c),paddingAngle:a(c),cornerRadius:o(c)})}function useAnimatePieArcLabel(r){const e={startAngle:(r.startAngle+r.endAngle)/2,endAngle:(r.startAngle+r.endAngle)/2,innerRadius:r.arcLabelRadius??r.innerRadius,outerRadius:r.arcLabelRadius??r.outerRadius,paddingAngle:r.paddingAngle,cornerRadius:r.cornerRadius};return useAnimate({startAngle:r.startAngle,endAngle:r.endAngle,innerRadius:(r==null?void 0:r.arcLabelRadius)??r.innerRadius,outerRadius:(r==null?void 0:r.arcLabelRadius)??r.outerRadius,paddingAngle:r.paddingAngle,cornerRadius:r.cornerRadius},{createInterpolator:pieArcLabelPropsInterpolator,transformProps:t=>{const[n,i]=d3Arc().cornerRadius(t.cornerRadius).centroid({padAngle:t.paddingAngle,startAngle:t.startAngle,endAngle:t.endAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius});return{x:n,y:i}},applyProps(t,{x:n,y:i}){t.setAttribute("x",n.toString()),t.setAttribute("y",i.toString())},initialProps:e,skip:r.skipAnimation,ref:r.ref})}function useChartRootRef(){return useChartContext().chartRootRef}const imageMimeTypes={"image/png":"PNG","image/jpeg":"JPEG","image/webp":"WebP"},getChartsLocalization=r=>({components:{MuiChartsLocalizationProvider:{defaultProps:{localeText:_extends({},r)}}}}),enUSLocaleText={loading:"Loading data…",noData:"No data to display",zoomIn:"Zoom in",zoomOut:"Zoom out",toolbarExport:"Export",toolbarExportPrint:"Print",toolbarExportImage:r=>`Export as ${imageMimeTypes[r]??r}`},DEFAULT_LOCALE=enUSLocaleText;getChartsLocalization(enUSLocaleText);const _excluded$q=["localeText"],ChartsLocalizationContext=reactExports.createContext(null);function ChartsLocalizationProvider(r){const{localeText:e}=r,t=_objectWithoutPropertiesLoose(r,_excluded$q),{localeText:n}=reactExports.useContext(ChartsLocalizationContext)??{localeText:void 0},i=useThemeProps({props:t,name:"MuiChartsLocalizationProvider"}),{children:s,localeText:a}=i,o=reactExports.useMemo(()=>_extends({},DEFAULT_LOCALE,a,n,e),[a,n,e]),c=reactExports.useMemo(()=>({localeText:o}),[o]);return jsxRuntimeExports.jsx(ChartsLocalizationContext.Provider,{value:c,children:s})}const useChartsLocalization=()=>{const r=reactExports.useContext(ChartsLocalizationContext);if(r===null)throw new Error(["MUI X Charts: Can not find the charts localization context.","It looks like you forgot to wrap your component in ChartsLocalizationProvider.","This can also happen if you are bundling multiple versions of the `@mui/x-charts` package"].join(`
`));return r};function ChartsClipPath(r){const{id:e,offset:t}=r,{left:n,top:i,width:s,height:a}=useDrawingArea(),o=_extends({top:0,right:0,bottom:0,left:0},t);return jsxRuntimeExports.jsx("clipPath",{id:e,children:jsxRuntimeExports.jsx("rect",{x:n-o.left,y:i-o.top,width:s+o.left+o.right,height:a+o.top+o.bottom})})}function isSsr(){return typeof window>"u"}const stringCache=new Map,MAX_CACHE_NUM=2e3,SPAN_STYLE={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},STYLE_LIST=["minWidth","maxWidth","width","minHeight","maxHeight","height","top","left","fontSize","padding","margin","paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom"],MEASUREMENT_SPAN_ID="mui_measurement_span";function autoCompleteStyle(r,e){return STYLE_LIST.indexOf(r)>=0&&e===+e?`${e}px`:e}function camelToMiddleLine(r){return r.split("").reduce((n,i)=>i===i.toUpperCase()?[...n,"-",i.toLowerCase()]:[...n,i],[]).join("")}const getStyleString=r=>Object.keys(r).sort().reduce((e,t)=>`${e}${camelToMiddleLine(t)}:${autoCompleteStyle(t,r[t])};`,"");let domCleanTimeout;const getStringSize=(r,e={})=>{if(r==null||isSsr())return{width:0,height:0};const t=`${r}`,n=getStyleString(e),i=`${t}-${n}`,s=stringCache.get(i);if(s)return s;try{let a=document.getElementById(MEASUREMENT_SPAN_ID);a===null&&(a=document.createElement("span"),a.setAttribute("id",MEASUREMENT_SPAN_ID),a.setAttribute("aria-hidden","true"),document.body.appendChild(a));const o=_extends({},SPAN_STYLE,e);Object.keys(o).map(f=>(a.style[camelToMiddleLine(f)]=autoCompleteStyle(f,o[f]),f)),a.textContent=t;const c=a.getBoundingClientRect(),h={width:c.width,height:c.height};return stringCache.set(i,h),stringCache.size+1>MAX_CACHE_NUM&&stringCache.clear(),domCleanTimeout&&clearTimeout(domCleanTimeout),domCleanTimeout=setTimeout(()=>{a.textContent=""},0),h}catch{return{width:0,height:0}}};function getWordsByLines({style:r,needsComputation:e,text:t}){return t.split(`
`).map(n=>_extends({text:n},e?getStringSize(n,r):{width:0,height:0}))}function useIsHydrated(){const[r,e]=reactExports.useState(typeof window<"u"||!1);return reactExports.useEffect(()=>{e(!0)},[]),r}const _excluded$p=["x","y","style","text","ownerState"],_excluded2$2=["angle","textAnchor","dominantBaseline"];function ChartsText(r){const{x:e,y:t,style:n,text:i}=r,s=_objectWithoutPropertiesLoose(r,_excluded$p),a=n??{},{angle:o,textAnchor:c,dominantBaseline:h}=a,f=_objectWithoutPropertiesLoose(a,_excluded2$2),m=useIsHydrated(),g=reactExports.useMemo(()=>getWordsByLines({style:f,needsComputation:m&&i.includes(`
`),text:i}),[f,i,m]);let _;switch(h){case"hanging":case"text-before-edge":_=0;break;case"central":_=(g.length-1)/2*-g[0].height;break;default:_=(g.length-1)*-g[0].height;break}return jsxRuntimeExports.jsx("text",_extends({},s,{transform:o?`rotate(${o}, ${e}, ${t})`:void 0,x:e,y:t,textAnchor:c,dominantBaseline:h,style:f,children:g.map((E,A)=>jsxRuntimeExports.jsx("tspan",{x:e,dy:`${A===0?_:g[0].height}px`,dominantBaseline:h,children:E.text},A))}))}function isInfinity(r){return typeof r=="number"&&!Number.isFinite(r)}const offsetRatio$1={start:0,extremities:0,end:1,middle:.5};function getTicks(r){const{scale:e,tickNumber:t,valueFormatter:n,tickInterval:i,tickPlacement:s="extremities",tickLabelPlacement:a,isInside:o}=r;if(isBandScale(e)){const g=e.domain(),_=a??"middle";return e.bandwidth()>0?[...(typeof i=="function"&&g.filter(i)||typeof i=="object"&&i||g).map(C=>{const I=`${C}`;return{value:C,formattedValue:(n==null?void 0:n(C,{location:"tick",scale:e,tickNumber:t,defaultTickLabel:I}))??I,offset:e(C)-(e.step()-e.bandwidth())/2+offsetRatio$1[s]*e.step(),labelOffset:_==="tick"?0:e.step()*(offsetRatio$1[_]-offsetRatio$1[s])}}),...s==="extremities"?[{formattedValue:void 0,offset:e.range()[1],labelOffset:0}]:[]]:(typeof i=="function"&&g.filter(i)||typeof i=="object"&&i||g).map(A=>{const C=`${A}`;return{value:A,formattedValue:(n==null?void 0:n(A,{location:"tick",scale:e,tickNumber:t,defaultTickLabel:C}))??C,offset:e(A),labelOffset:0}})}if(e.domain().some(isInfinity))return[];const h=a,f=typeof i=="object"?i:e.ticks(t),m=[];for(let g=0;g<f.length;g+=1){const _=f[g],E=e(_);if(o(E)){const A=e.tickFormat(t)(_);m.push({value:_,formattedValue:(n==null?void 0:n(_,{location:"tick",scale:e,tickNumber:t,defaultTickLabel:A}))??A,offset:E,labelOffset:h==="middle"?e(f[g-1]??0)-(E+e(f[g-1]??0))/2:0})}}return m}function useTicks(r){const{scale:e,tickNumber:t,valueFormatter:n,tickInterval:i,tickPlacement:s="extremities",tickLabelPlacement:a,direction:o}=r,{instance:c}=useChartContext(),h=o==="x"?c.isXInside:c.isYInside;return reactExports.useMemo(()=>getTicks({scale:e,tickNumber:t,tickPlacement:s,tickInterval:i,tickLabelPlacement:a,valueFormatter:n,isInside:h}),[e,t,s,i,a,n,h])}function useMounted(r=!1){const[e,t]=reactExports.useState(!1);return useEnhancedEffect(()=>{r||t(!0)},[r]),reactExports.useEffect(()=>{r&&t(!0)},[r]),e}const segmenter$1=typeof window<"u"&&"Intl"in window&&"Segmenter"in Intl?new Intl.Segmenter(void 0,{granularity:"grapheme"}):null;function getGraphemeCountFallback(r){return r.length}function getGraphemeCountModern(r){const e=segmenter$1.segment(r);let t=0;for(const n of e)t+=1;return t}const getGraphemeCount=segmenter$1?getGraphemeCountModern:getGraphemeCountFallback;function degToRad(r){return r*(Math.PI/180)}const segmenter=typeof window<"u"&&"Intl"in window&&"Segmenter"in Intl?new Intl.Segmenter(void 0,{granularity:"grapheme"}):null;function sliceUntilFallback(r,e){return r.slice(0,e)}function sliceUntilModern(r,e){const t=segmenter.segment(r);let n="",i=0;for(const s of t)if(n+=s.segment,i+=1,i>=e)break;return n}const sliceUntil=segmenter?sliceUntilModern:sliceUntilFallback,ELLIPSIS="…";function doesTextFitInRect(r,e){const{width:t,height:n,measureText:i}=e,s=degToRad(e.angle),a=i(r),o=Math.abs(a.width*Math.cos(s))+Math.abs(a.height*Math.sin(s)),c=Math.abs(a.width*Math.sin(s))+Math.abs(a.height*Math.cos(s));return o<=t&&c<=n}function ellipsize(r,e){if(e(r))return r;let t=r,n=1,i=1/2;const s=getGraphemeCount(r);let a=s,o=s,c=null;do{if(o=a,a=Math.floor(s*i),a===0)break;t=sliceUntil(r,a).trim();const h=e(t+ELLIPSIS);n+=1,h?(c=t,i+=1/2**n):i-=1/2**n}while(Math.abs(a-o)!==1);return c?c+ELLIPSIS:""}function shortenLabels$1(r,e,t,n,i){const s=new Map,a=clampAngle((i==null?void 0:i.angle)??0);let o=1,c=1;(i==null?void 0:i.textAnchor)==="start"?(o=1/0,c=1):(i==null?void 0:i.textAnchor)==="end"?(o=1,c=1/0):(o=2,c=2),a>90&&a<270&&([o,c]=[c,o]),n&&([o,c]=[c,o]);for(const h of r)if(h.formattedValue){const f=Math.min((h.offset+h.labelOffset)*o,(e.left+e.width+e.right-h.offset-h.labelOffset)*c),m=g=>doesTextFitInRect(g,{width:f,height:t,angle:a,measureText:_=>getStringSize(_,i)});s.set(h,ellipsize(h.formattedValue.toString(),m))}return s}const ANGLE_APPROX=5;function getMinXTranslation(r,e,t=0){const n=Math.min(Math.abs(t)%180,Math.abs(Math.abs(t)%180-180)%180);if(n<ANGLE_APPROX)return r;if(n>90-ANGLE_APPROX)return e;const i=deg2rad(n),s=Math.atan2(e,r);return i<s?r/Math.cos(i):e/Math.sin(i)}function getVisibleLabels(r,{tickLabelStyle:e,tickLabelInterval:t,tickLabelMinGap:n,reverse:i,isMounted:s,isXInside:a}){const o=f=>{if(!s||f.formattedValue===void 0)return{width:0,height:0};const m=getWordsByLines({style:e,needsComputation:!0,text:f.formattedValue});return{width:Math.max(...m.map(g=>g.width)),height:Math.max(m.length*m[0].height)}};if(typeof t=="function")return new Set(r.filter((f,m)=>t(f.value,m)));let c=0;const h=i?-1:1;return new Set(r.filter((f,m)=>{const{offset:g,labelOffset:_}=f,E=g+_;if(m>0&&h*E<h*(c+n)||!a(E))return!1;const{width:A,height:C}=o(f),I=getMinXTranslation(A,C,e==null?void 0:e.angle),b=E-h*I/2;return m>0&&h*b<h*(c+n)?!1:(c=E+h*I/2,!0)}))}function getAxisUtilityClass(r){return generateUtilityClass("MuiChartsAxis",r)}const axisClasses=generateUtilityClasses("MuiChartsAxis",["root","line","tickContainer","tick","tickLabel","label","directionX","directionY","top","bottom","left","right","id"]),AxisRoot=styled("g",{name:"MuiChartsAxis",slot:"Root"})(({theme:r})=>({[`& .${axisClasses.tickLabel}`]:_extends({},r.typography.caption,{fill:(r.vars||r).palette.text.primary}),[`& .${axisClasses.label}`]:{fill:(r.vars||r).palette.text.primary},[`& .${axisClasses.line}`]:{stroke:(r.vars||r).palette.text.primary,shapeRendering:"crispEdges",strokeWidth:1},[`& .${axisClasses.tick}`]:{stroke:(r.vars||r).palette.text.primary,shapeRendering:"crispEdges"}})),useUtilityClasses$d=r=>{const{classes:e,position:t,id:n}=r,i={root:["root","directionX",t,`id-${n}`],line:["line"],tickContainer:["tickContainer"],tick:["tick"],tickLabel:["tickLabel"],label:["label"]};return composeClasses(i,getAxisUtilityClass,e)},TICK_LABEL_GAP$1=3,AXIS_LABEL_TICK_LABEL_GAP$1=4,XAxisRoot=styled(AxisRoot,{name:"MuiChartsXAxis",slot:"Root"})({}),defaultProps$1={disableLine:!1,disableTicks:!1,tickSize:6,tickLabelMinGap:4};function getDefaultTextAnchor(r){const e=clampAngle(r);return e<=30||e>=330||e<=210&&e>=150?"middle":e<=180?"end":"start"}function getDefaultBaseline(r){const e=clampAngle(r);return e<=30||e>=330?"hanging":e<=210&&e>=150?"auto":"central"}function invertTextAnchor(r){switch(r){case"start":return"end";case"end":return"start";default:return r}}const _excluded$o=["scale","tickNumber","reverse"],useAxisProps=r=>{const{xAxis:e,xAxisIds:t}=useXAxes(),n=e[r.axisId??t[0]],{scale:i,tickNumber:s,reverse:a}=n,o=_objectWithoutPropertiesLoose(n,_excluded$o),c=useThemeProps({props:_extends({},o,r),name:"MuiChartsXAxis"}),h=_extends({},defaultProps$1,c),{position:f,tickLabelStyle:m,labelStyle:g,slots:_,slotProps:E}=h,A=useTheme(),C=useRtl(),I=useUtilityClasses$d(h),b=f==="bottom"?1:-1,R=(_==null?void 0:_.axisLine)??"line",V=(_==null?void 0:_.axisTick)??"line",U=(_==null?void 0:_.axisTickLabel)??ChartsText,W=(_==null?void 0:_.axisLabel)??ChartsText,j=getDefaultTextAnchor((f==="bottom"?0:180)-((m==null?void 0:m.angle)??0)),w=getDefaultBaseline((f==="bottom"?0:180)-((m==null?void 0:m.angle)??0)),P=useSlotProps({elementType:U,externalSlotProps:E==null?void 0:E.axisTickLabel,additionalProps:{style:_extends({},A.typography.caption,{fontSize:12,lineHeight:1.25,textAnchor:C?invertTextAnchor(j):j,dominantBaseline:w},m)},className:I.tickLabel,ownerState:{}}),K=useSlotProps({elementType:W,externalSlotProps:E==null?void 0:E.axisLabel,additionalProps:{style:_extends({},A.typography.body1,{lineHeight:1,fontSize:14,textAnchor:"middle",dominantBaseline:f==="bottom"?"text-after-edge":"text-before-edge"},g)},ownerState:{}}),X=i.domain(),Y=isBandScale(i),Z=Y&&X.length===0||!Y&&X.some(isInfinity)||f==="none";return{xScale:i,defaultizedProps:h,tickNumber:s,positionSign:b,skipAxisRendering:Z,classes:I,Line:R,Tick:V,TickLabel:U,Label:W,axisTickLabelProps:P,axisLabelProps:K,reverse:a,isRtl:C}};function ChartsSingleXAxis(r){const{xScale:e,defaultizedProps:t,tickNumber:n,positionSign:i,skipAxisRendering:s,classes:a,Line:o,Tick:c,TickLabel:h,Label:f,axisTickLabelProps:m,axisLabelProps:g,reverse:_,isRtl:E}=useAxisProps(r),A=useMounted(),{position:C,disableLine:I,disableTicks:b,label:R,tickSize:V,valueFormatter:U,slotProps:W,tickInterval:j,tickLabelInterval:w,tickPlacement:P,tickLabelPlacement:K,tickLabelMinGap:X,sx:Y,offset:Z,height:ae}=t,le=useDrawingArea(),{left:ie,top:se,width:ce,height:ue}=le,{instance:Ae}=useChartContext(),Se=useIsHydrated(),ye=b?4:V,he=useTicks({scale:e,tickNumber:n,valueFormatter:U,tickInterval:j,tickPlacement:P,tickLabelPlacement:K,direction:"x"}),ke=getVisibleLabels(he,{tickLabelStyle:m.style,tickLabelInterval:w,tickLabelMinGap:X,reverse:_,isMounted:A,isXInside:Ae.isXInside});if(s)return null;const Pe=R?getStringSize(R,g.style).height:0,Le={x:ie+ce/2,y:i*ae},$e=Math.max(0,ae-(R?Pe+AXIS_LABEL_TICK_LABEL_GAP$1:0)-ye-TICK_LABEL_GAP$1),qe=Se?shortenLabels$1(ke,le,$e,E,m.style):new Map(Array.from(ke).map(xe=>[xe,xe.formattedValue]));return jsxRuntimeExports.jsxs(XAxisRoot,{transform:`translate(0, ${C==="bottom"?se+ue+Z:se-Z})`,className:a.root,sx:Y,children:[!I&&jsxRuntimeExports.jsx(o,_extends({x1:ie,x2:ie+ce,className:a.line},W==null?void 0:W.axisLine)),he.map((xe,Ie)=>{const{offset:Te,labelOffset:pe}=xe,Fe=pe??0,Re=i*(ye+TICK_LABEL_GAP$1),Ue=Ae.isXInside(Te),Ve=qe.get(xe),Me=ke.has(xe);return jsxRuntimeExports.jsxs("g",{transform:`translate(${Te}, 0)`,className:a.tickContainer,children:[!b&&Ue&&jsxRuntimeExports.jsx(c,_extends({y2:i*ye,className:a.tick},W==null?void 0:W.axisTick)),Ve!==void 0&&Me&&jsxRuntimeExports.jsx(h,_extends({x:Fe,y:Re},m,{text:Ve}))]},Ie)}),R&&jsxRuntimeExports.jsx("g",{className:a.label,children:jsxRuntimeExports.jsx(f,_extends({},Le,g,{text:R}))})]})}const offsetRatio={start:0,extremities:0,end:1,middle:.5,tick:0};function useTicksGrouped(r){const{scale:e,tickInterval:t,tickLabelPlacement:n="middle",tickPlacement:i="extremities",groups:s}=r;return reactExports.useMemo(()=>{const a=e.domain(),o=typeof t=="function"&&a.filter(t)||typeof t=="object"&&t||a;if(e.bandwidth()>0){const c=mapToGrouping(o,s,i,n,e);return c[0]&&(c[0].ignoreTick=!0),[{formattedValue:void 0,offset:e.range()[0],labelOffset:0,groupIndex:s.length-1},...c,{formattedValue:void 0,offset:e.range()[1],labelOffset:0,groupIndex:s.length-1}]}return mapToGrouping(o,s,i,n,e)},[e,t,s,i,n])}function mapToGrouping(r,e,t,n,i){const s=[],a=new Map;let o=0;for(let c=0;c<e.length;c+=1)for(let h=0;h<r.length;h+=1){const f=r[h],m=e[c].getValue(f,h),g=s[s.length-1];if((g==null?void 0:g.value)!==m||(g==null?void 0:g.groupIndex)!==c){o=1;const E=isBandScale(i)?i(f)-(i.step()-i.bandwidth())/2+offsetRatio[t]*i.step():i(f),A=i.step()*o*(offsetRatio[n]-offsetRatio[t]);s.push({value:m,formattedValue:`${m}`,offset:E,groupIndex:c,dataIndex:h,ignoreTick:!1,labelOffset:A}),a.has(h)||a.set(h,new Set);const C=a.get(h);for(const I of C.values())s[I].ignoreTick=!0;C.add(s.length-1)}else{o+=1;const E=i.step()*o*(offsetRatio[n]-offsetRatio[t]);g.labelOffset=E}}return s}const DEFAULT_GROUPING_CONFIG={tickSize:6},getGroupingConfig=(r,e,t)=>{const n=r[e]??{},i=t??DEFAULT_GROUPING_CONFIG.tickSize,s=i*e*2+i;return _extends({},DEFAULT_GROUPING_CONFIG,n,{tickSize:n.tickSize??s})};function ChartsGroupedXAxis(r){const{xScale:e,defaultizedProps:t,positionSign:n,skipAxisRendering:i,classes:s,Line:a,Tick:o,TickLabel:c,Label:h,axisTickLabelProps:f,axisLabelProps:m}=useAxisProps(r);if(!isBandScale(e))throw new Error("MUI X Charts: ChartsGroupedXAxis only supports the `band` and `point` scale types.");const{position:g,disableLine:_,disableTicks:E,label:A,tickSize:C,valueFormatter:I,slotProps:b,tickInterval:R,tickPlacement:V,tickLabelPlacement:U,sx:W,offset:j,height:w}=t,P=t.groups,K=useDrawingArea(),{left:X,top:Y,width:Z,height:ae}=K,{instance:le}=useChartContext(),ie={x:X+Z/2,y:n*w},se=useTicksGrouped({scale:e,tickInterval:R,tickPlacement:V,tickLabelPlacement:U,groups:P});return i?null:jsxRuntimeExports.jsxs(XAxisRoot,{transform:`translate(0, ${g==="bottom"?Y+ae+j:Y-j})`,className:s.root,sx:W,children:[!_&&jsxRuntimeExports.jsx(a,_extends({x1:X,x2:X+Z,className:s.line},b==null?void 0:b.axisLine)),se.map((ce,ue)=>{const{offset:Ae,labelOffset:Se}=ce,ye=Se??0,he=le.isXInside(Ae),ke=ce.formattedValue,Pe=ce.ignoreTick??!1,Le=ce.groupIndex??0,$e=getGroupingConfig(P,Le,C),qe=n*$e.tickSize,xe=n*($e.tickSize+TICK_LABEL_GAP$1);return jsxRuntimeExports.jsxs("g",{transform:`translate(${Ae}, 0)`,className:s.tickContainer,"data-group-index":Le,children:[!E&&!Pe&&he&&jsxRuntimeExports.jsx(o,_extends({y2:qe,className:s.tick},b==null?void 0:b.axisTick)),ke!==void 0&&jsxRuntimeExports.jsx(c,_extends({x:ye,y:xe},f,{text:ke}))]},ue)}),A&&jsxRuntimeExports.jsx("g",{className:s.label,children:jsxRuntimeExports.jsx(h,_extends({},ie,m,{text:A}))})]})}function ChartsXAxis(r){const{xAxis:e,xAxisIds:t}=useXAxes(),n=e[r.axisId??t[0]];return"groups"in n&&Array.isArray(n.groups)?jsxRuntimeExports.jsx(ChartsGroupedXAxis,_extends({},r)):jsxRuntimeExports.jsx(ChartsSingleXAxis,_extends({},r))}function shortenLabels(r,e,t,n,i){const s=new Map,a=clampAngle((i==null?void 0:i.angle)??0);let o=1,c=1;(i==null?void 0:i.textAnchor)==="start"?(o=1/0,c=1):(i==null?void 0:i.textAnchor)==="end"?(o=1,c=1/0):(o=2,c=2),a>180&&([o,c]=[c,o]),n&&([o,c]=[c,o]);for(const h of r)if(h.formattedValue){const f=Math.min((h.offset+h.labelOffset)*o,(e.top+e.height+e.bottom-h.offset-h.labelOffset)*c),m=g=>doesTextFitInRect(g,{width:t,height:f,angle:a,measureText:_=>getStringSize(_,i)});s.set(h,ellipsize(h.formattedValue.toString(),m))}return s}const _excluded$n=["scale","tickNumber"],useUtilityClasses$c=r=>{const{classes:e,position:t,id:n}=r,i={root:["root","directionY",t,`id-${n}`],line:["line"],tickContainer:["tickContainer"],tick:["tick"],tickLabel:["tickLabel"],label:["label"]};return composeClasses(i,getAxisUtilityClass,e)},TICK_LABEL_GAP=2,AXIS_LABEL_TICK_LABEL_GAP=2,YAxisRoot=styled(AxisRoot,{name:"MuiChartsYAxis",slot:"Root"})({}),defaultProps={disableLine:!1,disableTicks:!1,tickSize:6};function ChartsYAxis(r){const{yAxisIds:e,yAxis:t}=useYAxes(),n=t[r.axisId??e[0]],{scale:i,tickNumber:s}=n,a=_objectWithoutPropertiesLoose(n,_excluded$n),o=useThemeProps({props:_extends({},a,r),name:"MuiChartsYAxis"}),c=_extends({},defaultProps,o),{position:h,disableLine:f,disableTicks:m,label:g,labelStyle:_,tickLabelStyle:E,tickSize:A,valueFormatter:C,slots:I,slotProps:b,tickPlacement:R,tickLabelPlacement:V,tickInterval:U,tickLabelInterval:W,sx:j,offset:w,width:P}=c,K=useTheme(),X=useRtl(),Y=useIsHydrated(),Z=useUtilityClasses$c(c),{instance:ae}=useChartContext(),le=useDrawingArea(),{left:ie,top:se,width:ce,height:ue}=le,Ae=m?4:A,Se=useTicks({scale:i,tickNumber:s,valueFormatter:C,tickPlacement:R,tickLabelPlacement:V,tickInterval:U,direction:"y"}),ye=h==="right"?1:-1,he=typeof(E==null?void 0:E.fontSize)=="number"?E.fontSize:12,ke=(I==null?void 0:I.axisLine)??"line",Pe=(I==null?void 0:I.axisTick)??"line",Le=(I==null?void 0:I.axisTickLabel)??ChartsText,$e=(I==null?void 0:I.axisLabel)??ChartsText,qe=getDefaultTextAnchor((h==="right"?-90:90)-((E==null?void 0:E.angle)??0)),xe=getDefaultBaseline((h==="right"?-90:90)-((E==null?void 0:E.angle)??0)),Ie=useSlotProps({elementType:Le,externalSlotProps:b==null?void 0:b.axisTickLabel,additionalProps:{style:_extends({},K.typography.caption,{fontSize:he,textAnchor:X?invertTextAnchor(qe):qe,dominantBaseline:xe},E)},className:Z.tickLabel,ownerState:{}}),Te=useSlotProps({elementType:$e,externalSlotProps:b==null?void 0:b.axisLabel,additionalProps:{style:_extends({},K.typography.body1,{lineHeight:1,fontSize:14,angle:ye*90,textAnchor:"middle",dominantBaseline:"text-before-edge"},_)},ownerState:{}}),pe=useSlotProps({elementType:ke,externalSlotProps:b==null?void 0:b.axisLine,additionalProps:{strokeLinecap:"square"},ownerState:{}}),Fe=i.domain(),Re=isBandScale(i);if(Re&&Fe.length===0||!Re&&Fe.some(isInfinity)||h==="none")return null;const Ue={x:ye*P,y:se+ue/2},Ve=Math.max(0,P-(g?getStringSize(g,Te.style).height+AXIS_LABEL_TICK_LABEL_GAP:0)-Ae-TICK_LABEL_GAP),Me=Y?shortenLabels(Se,le,Ve,X,Ie.style):new Map(Array.from(Se).map(ze=>[ze,ze.formattedValue]));return jsxRuntimeExports.jsxs(YAxisRoot,{transform:`translate(${h==="right"?ie+ce+w:ie-w}, 0)`,className:Z.root,sx:j,children:[!f&&jsxRuntimeExports.jsx(ke,_extends({y1:se,y2:se+ue,className:Z.line},pe)),Se.map((ze,He)=>{const{offset:Ne,labelOffset:Be,value:et}=ze,nt=ye*(Ae+TICK_LABEL_GAP),ir=Be,dr=typeof W=="function"&&!(W!=null&&W(et,He)),Xe=ae.isYInside(Ne),Ke=Me.get(ze);return Xe?jsxRuntimeExports.jsxs("g",{transform:`translate(0, ${Ne})`,className:Z.tickContainer,children:[!m&&jsxRuntimeExports.jsx(Pe,_extends({x2:ye*Ae,className:Z.tick},b==null?void 0:b.axisTick)),Ke!==void 0&&!dr&&jsxRuntimeExports.jsx(Le,_extends({x:nt,y:ir,text:Ke},Ie))]},He):null}),g&&Y&&jsxRuntimeExports.jsx("g",{className:Z.label,children:jsxRuntimeExports.jsx($e,_extends({},Ue,Te,{text:g}))})]})}function ChartsAxis(r){const{slots:e,slotProps:t}=r,{xAxisIds:n,xAxis:i}=useXAxes(),{yAxisIds:s,yAxis:a}=useYAxes();return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[n.map(o=>!i[o].position||i[o].position==="none"?null:jsxRuntimeExports.jsx(ChartsXAxis,{slots:e,slotProps:t,axisId:o},o)),s.map(o=>!a[o].position||a[o].position==="none"?null:jsxRuntimeExports.jsx(ChartsYAxis,{slots:e,slotProps:t,axisId:o},o))]})}function getChartsGridUtilityClass(r){return generateUtilityClass("MuiChartsGrid",r)}const chartsGridClasses=generateUtilityClasses("MuiChartsGrid",["root","line","horizontalLine","verticalLine"]),GridRoot=styled("g",{name:"MuiChartsGrid",slot:"Root",overridesResolver:(r,e)=>[{[`&.${chartsGridClasses.verticalLine}`]:e.verticalLine},{[`&.${chartsGridClasses.horizontalLine}`]:e.horizontalLine},e.root]})({}),GridLine=styled("line",{name:"MuiChartsGrid",slot:"Line"})(({theme:r})=>({stroke:(r.vars||r).palette.divider,shapeRendering:"crispEdges",strokeWidth:1}));function ChartsGridVertical(r){const{axis:e,start:t,end:n,classes:i}=r,{scale:s,tickNumber:a,tickInterval:o}=e,c=useTicks({scale:s,tickNumber:a,tickInterval:o,direction:"x"});return jsxRuntimeExports.jsx(reactExports.Fragment,{children:c.map(({value:h,offset:f})=>{var m;return jsxRuntimeExports.jsx(GridLine,{y1:t,y2:n,x1:f,x2:f,className:i.verticalLine},`vertical-${((m=h==null?void 0:h.getTime)==null?void 0:m.call(h))??h}`)})})}function ChartsGridHorizontal(r){const{axis:e,start:t,end:n,classes:i}=r,{scale:s,tickNumber:a,tickInterval:o}=e,c=useTicks({scale:s,tickNumber:a,tickInterval:o,direction:"y"});return jsxRuntimeExports.jsx(reactExports.Fragment,{children:c.map(({value:h,offset:f})=>{var m;return jsxRuntimeExports.jsx(GridLine,{y1:f,y2:f,x1:t,x2:n,className:i.horizontalLine},`horizontal-${((m=h==null?void 0:h.getTime)==null?void 0:m.call(h))??h}`)})})}const _excluded$m=["vertical","horizontal"],useUtilityClasses$b=({classes:r})=>composeClasses({root:["root"],verticalLine:["line","verticalLine"],horizontalLine:["line","horizontalLine"]},getChartsGridUtilityClass,r);function ChartsGrid(r){const e=useThemeProps({props:r,name:"MuiChartsGrid"}),t=useDrawingArea(),{vertical:n,horizontal:i}=e,s=_objectWithoutPropertiesLoose(e,_excluded$m),{xAxis:a,xAxisIds:o}=useXAxes(),{yAxis:c,yAxisIds:h}=useYAxes(),f=useUtilityClasses$b(e),m=c[h[0]],g=a[o[0]];return jsxRuntimeExports.jsxs(GridRoot,_extends({},s,{className:f.root,children:[n&&jsxRuntimeExports.jsx(ChartsGridVertical,{axis:g,start:t.top,end:t.height+t.top,classes:f}),i&&jsxRuntimeExports.jsx(ChartsGridHorizontal,{axis:m,start:t.left,end:t.width+t.left,classes:f})]}))}function getChartsTooltipUtilityClass(r){return generateUtilityClass("MuiChartsTooltip",r)}const chartsTooltipClasses=generateUtilityClasses("MuiChartsTooltip",["root","paper","table","row","cell","mark","markContainer","labelCell","valueCell","axisValueCell"]),useUtilityClasses$a=r=>composeClasses({root:["root"],paper:["paper"],table:["table"],row:["row"],cell:["cell"],mark:["mark"],markContainer:["markContainer"],labelCell:["labelCell"],valueCell:["valueCell"],axisValueCell:["axisValueCell"]},getChartsTooltipUtilityClass,r);function useInternalItemTooltip(){var W,j,w;const r=useStore(),e=useSelector(r,selectorChartsInteractionItem),t=useSelector(r,selectorChartSeriesConfig),n=useSeries(),{xAxis:i,xAxisIds:s}=useXAxes(),{yAxis:a,yAxisIds:o}=useYAxes(),{zAxis:c,zAxisIds:h}=useZAxes(),{rotationAxis:f,rotationAxisIds:m}=useRotationAxes(),{radiusAxis:g,radiusAxisIds:_}=useRadiusAxes(),E=n.xAxisId??s[0],A=n.yAxisId??o[0],C=n.zAxisId??h[0],I=n.rotationAxisId??m[0],b=n.radiusAxisId??_[0];if(!e)return null;const R=(W=n[e.type])==null?void 0:W.series[e.seriesId];if(!R)return null;const V=((w=(j=t[R.type]).colorProcessor)==null?void 0:w.call(j,R,E&&i[E],A&&a[A],C&&c[C]))??(()=>""),U={};return E!==void 0&&(U.x=i[E]),A!==void 0&&(U.y=a[A]),I!==void 0&&(U.rotation=f[I]),b!==void 0&&(U.radius=g[b]),t[R.type].tooltipGetter({series:R,axesConfig:U,getColor:V,identifier:e})}const ChartsTooltipPaper=styled("div",{name:"MuiChartsTooltip",slot:"Container",overridesResolver:(r,e)=>e.paper})(({theme:r})=>{var e;return{backgroundColor:(r.vars||r).palette.background.paper,color:(r.vars||r).palette.text.primary,borderRadius:(e=(r.vars||r).shape)==null?void 0:e.borderRadius,border:`solid ${(r.vars||r).palette.divider} 1px`}}),ChartsTooltipTable=styled("table",{name:"MuiChartsTooltip",slot:"Table"})(({theme:r})=>({borderSpacing:0,[`& .${chartsTooltipClasses.markContainer}`]:{display:"inline-block",width:`calc(20px + ${r.spacing(1.5)})`,verticalAlign:"middle"},"& caption":{borderBottom:`solid ${(r.vars||r).palette.divider} 1px`,padding:r.spacing(.5,1.5),textAlign:"start",whiteSpace:"nowrap","& span":{marginRight:r.spacing(1.5)}}})),ChartsTooltipRow=styled("tr",{name:"MuiChartsTooltip",slot:"Row"})(({theme:r})=>({"tr:first-of-type& td":{paddingTop:r.spacing(.5)},"tr:last-of-type& td":{paddingBottom:r.spacing(.5)}})),ChartsTooltipCell=styled(Typography,{name:"MuiChartsTooltip",slot:"Cell"})(({theme:r})=>({verticalAlign:"middle",color:(r.vars||r).palette.text.secondary,textAlign:"start",[`&.${chartsTooltipClasses.cell}`]:{paddingLeft:r.spacing(1),paddingRight:r.spacing(1)},[`&.${chartsTooltipClasses.labelCell}`]:{fontWeight:r.typography.fontWeightRegular},[`&.${chartsTooltipClasses.valueCell}, &.${chartsTooltipClasses.axisValueCell}`]:{color:(r.vars||r).palette.text.primary,fontWeight:r.typography.fontWeightMedium},[`&.${chartsTooltipClasses.valueCell}`]:{paddingLeft:r.spacing(1.5),paddingRight:r.spacing(1.5)},"td:first-of-type&, th:first-of-type&":{paddingLeft:r.spacing(1.5)},"td:last-of-type&, th:last-of-type&":{paddingRight:r.spacing(1.5)}}));function getLabelMarkUtilityClass(r){return generateUtilityClass("MuiChartsLabelMark",r)}const labelMarkClasses=generateUtilityClasses("MuiChartsLabelMark",["root","line","square","circle","mask","fill"]),useUtilityClasses$9=r=>{const{type:e}=r;return composeClasses({root:typeof e=="function"?["root"]:["root",e],mask:["mask"],fill:["fill"]},getLabelMarkUtilityClass,r.classes)},consumeThemeProps=(r,e,t)=>reactExports.forwardRef(function(i,s){var g;const a=useThemeProps({props:i,name:r}),o=typeof e.defaultProps=="function"?e.defaultProps(a):e.defaultProps??{},c=resolveProps(o,a),h=useTheme(),f=(g=e.classesResolver)==null?void 0:g.call(e,c,h),m=reactExports.forwardRef(t);return jsxRuntimeExports.jsx(m,_extends({},c,{classes:f,ref:s}))}),_excluded$l=["type","color","className","classes"],Root$1=styled("div",{name:"MuiChartsLabelMark",slot:"Root"})(()=>({display:"flex",width:14,height:14,[`&.${labelMarkClasses.line}`]:{width:16,height:"unset",alignItems:"center",[`.${labelMarkClasses.mask}`]:{height:4,width:"100%",borderRadius:1,overflow:"hidden"}},[`&.${labelMarkClasses.square}`]:{height:13,width:13,borderRadius:2,overflow:"hidden"},[`&.${labelMarkClasses.circle}`]:{height:15,width:15},svg:{display:"block"},[`& .${labelMarkClasses.mask} > *`]:{height:"100%",width:"100%"},[`& .${labelMarkClasses.mask}`]:{height:"100%",width:"100%"}})),ChartsLabelMark=consumeThemeProps("MuiChartsLabelMark",{defaultProps:{type:"square"},classesResolver:useUtilityClasses$9},function r(e,t){const{type:n,color:i,className:s,classes:a}=e,o=_objectWithoutPropertiesLoose(e,_excluded$l),c=n;return jsxRuntimeExports.jsx(Root$1,_extends({className:clsx(a==null?void 0:a.root,s),ownerState:e,"aria-hidden":"true",ref:t},o,{children:jsxRuntimeExports.jsx("div",{className:a==null?void 0:a.mask,children:typeof c=="function"?jsxRuntimeExports.jsx(c,{className:a==null?void 0:a.fill,color:i}):jsxRuntimeExports.jsx("svg",{viewBox:"0 0 24 24",preserveAspectRatio:n==="line"?"none":void 0,children:n==="circle"?jsxRuntimeExports.jsx("circle",{className:a==null?void 0:a.fill,r:"12",cx:"12",cy:"12",fill:i}):jsxRuntimeExports.jsx("rect",{className:a==null?void 0:a.fill,width:"24",height:"24",fill:i})})})}))});function ChartsItemTooltipContent(r){const{classes:e,sx:t}=r,n=useInternalItemTooltip(),i=useUtilityClasses$a(e);if(!n)return null;if("values"in n){const{label:h,color:f,markType:m}=n;return jsxRuntimeExports.jsx(ChartsTooltipPaper,{sx:t,className:i.paper,children:jsxRuntimeExports.jsxs(ChartsTooltipTable,{className:i.table,children:[jsxRuntimeExports.jsxs(Typography,{component:"caption",children:[jsxRuntimeExports.jsx("div",{className:i.markContainer,children:jsxRuntimeExports.jsx(ChartsLabelMark,{type:m,color:f,className:i.mark})}),h]}),jsxRuntimeExports.jsx("tbody",{children:n.values.map(({formattedValue:g,label:_})=>jsxRuntimeExports.jsxs(ChartsTooltipRow,{className:i.row,children:[jsxRuntimeExports.jsx(ChartsTooltipCell,{className:clsx(i.labelCell,i.cell),component:"th",children:_}),jsxRuntimeExports.jsx(ChartsTooltipCell,{className:clsx(i.valueCell,i.cell),component:"td",children:g})]},_))})]})})}const{color:s,label:a,formattedValue:o,markType:c}=n;return jsxRuntimeExports.jsx(ChartsTooltipPaper,{sx:t,className:i.paper,children:jsxRuntimeExports.jsx(ChartsTooltipTable,{className:i.table,children:jsxRuntimeExports.jsx("tbody",{children:jsxRuntimeExports.jsxs(ChartsTooltipRow,{className:i.row,children:[jsxRuntimeExports.jsxs(ChartsTooltipCell,{className:clsx(i.labelCell,i.cell),component:"th",children:[jsxRuntimeExports.jsx("div",{className:i.markContainer,children:jsxRuntimeExports.jsx(ChartsLabelMark,{type:c,color:s,className:i.mark})}),a]}),jsxRuntimeExports.jsx(ChartsTooltipCell,{className:clsx(i.valueCell,i.cell),component:"td",children:o})]})})})})}function useColorProcessor(r){const e=useStore(),t=useSelector(e,selectorChartSeriesConfig);return reactExports.useMemo(()=>{const i={};return Object.keys(t).forEach(s=>{i[s]=t[s].colorProcessor}),i},[t])}function usePointerType(){const r=useSvgRef(),[e,t]=reactExports.useState(null);return reactExports.useEffect(()=>{const n=r.current;if(n===null)return()=>{};const i=a=>{a.pointerType!=="mouse"&&t(null)},s=a=>{t({pointerType:a.pointerType})};return n.addEventListener("pointerenter",s),n.addEventListener("pointerup",i),()=>{n.removeEventListener("pointerenter",s),n.removeEventListener("pointerup",i)}},[r]),e}function utcFormatter(r){return r instanceof Date?r.toUTCString():r.toLocaleString()}const mainPointerFineMediaQuery="@media (pointer: fine)",useIsFineMainPointer=()=>useMediaQuery(mainPointerFineMediaQuery,{defaultMatches:!0}),optionalGetAxisId=(r,e)=>e,optionalGetAxisIds=(r,e)=>e;function indexGetter(r,e,t){return Array.isArray(t)?t.map(n=>getAxisIndex(e.axis[n],r)):getAxisIndex(e.axis[t],r)}const selectorChartsInteractionRotationAngle=createSelector([selectorChartsInteractionPointerX,selectorChartsInteractionPointerY,selectorChartPolarCenter],(r,e,t)=>r===null||e===null?null:generateSvg2rotation(t)(r,e)),selectorChartsInteractionRotationAxisIndex=createSelector([selectorChartsInteractionRotationAngle,selectorChartRotationAxis,optionalGetAxisId],(r,e,t=e.axisIds[0])=>r===null?null:indexGetter(r,e,t)),selectorChartsInteractionRotationAxisIndexes=createSelector([selectorChartsInteractionRotationAngle,selectorChartRotationAxis,optionalGetAxisIds],(r,e,t=e.axisIds)=>r===null?null:indexGetter(r,e,t));createSelector([selectorChartRotationAxis,selectorChartsInteractionRotationAxisIndex,optionalGetAxisId],(r,e,t=r.axisIds[0])=>{var i;if(e===null||e===-1||r.axisIds.length===0)return null;const n=(i=r.axis[t])==null?void 0:i.data;return n?n[e]:null});createSelector([selectorChartRotationAxis,selectorChartsInteractionRotationAxisIndexes,optionalGetAxisIds],(r,e,t=r.axisIds)=>e===null?null:t.map((n,i)=>{var a;const s=e[i];return s===-1?null:(a=r.axis[n].data)==null?void 0:a[s]}));const selectorChartsInteractionTooltipRotationAxes=createSelector([selectorChartsInteractionRotationAxisIndexes,selectorChartRotationAxis],(r,e)=>r===null?[]:e.axisIds.map((t,n)=>({axisId:t,dataIndex:r[n]})).filter(({axisId:t,dataIndex:n})=>e.axis[t].triggerTooltip&&n>=0),{memoizeOptions:{resultEqualityCheck:isDeepEqual}});createSelector([],()=>[]);const selectorChartsInteractionPolarAxisTooltip=createSelector([selectorChartsInteractionTooltipRotationAxes],r=>r.length>0);function defaultAxisTooltipConfig(r,e,t){var a;const n=((a=r.data)==null?void 0:a[e])??null,s=(r.valueFormatter??(o=>r.scaleType==="utc"?utcFormatter(o):o.toLocaleString()))(n,{location:"tooltip",scale:r.scale});return{axisDirection:t,axisId:r.id,mainAxis:r,dataIndex:e,axisValue:n,axisFormattedValue:s,seriesItems:[]}}function useAxisTooltip(r={}){const{multipleAxes:e,directions:t}=r,n=useXAxis(),i=useYAxis(),s=useRotationAxis(),a=useStore(),o=useSelector(a,selectorChartsInteractionTooltipXAxes),c=useSelector(a,selectorChartsInteractionTooltipYAxes),h=useSelector(a,selectorChartsInteractionTooltipRotationAxes),f=useSeries(),{xAxis:m}=useXAxes(),{yAxis:g}=useYAxes(),{zAxis:_,zAxisIds:E}=useZAxes(),{rotationAxis:A}=useRotationAxes(),C=useColorProcessor();if(o.length===0&&c.length===0&&h.length===0)return null;const I=[];return(t===void 0||t.includes("x"))&&o.forEach(({axisId:b,dataIndex:R})=>{!e&&I.length>1||I.push(defaultAxisTooltipConfig(m[b],R,"x"))}),(t===void 0||t.includes("y"))&&c.forEach(({axisId:b,dataIndex:R})=>{!e&&I.length>1||I.push(defaultAxisTooltipConfig(g[b],R,"y"))}),(t===void 0||t.includes("rotation"))&&h.forEach(({axisId:b,dataIndex:R})=>{!e&&I.length>1||I.push(defaultAxisTooltipConfig(A[b],R,"rotation"))}),Object.keys(f).filter(isCartesianSeriesType).forEach(b=>{const R=f[b];return R?R.seriesOrder.forEach(V=>{var P;const U=R.series[V],W=U.xAxisId??n.id,j=U.yAxisId??i.id,w=I.findIndex(({axisDirection:K,axisId:X})=>K==="x"&&X===W||K==="y"&&X===j);if(w>=0){const K="zAxisId"in U?U.zAxisId:E[0],{dataIndex:X}=I[w],Y=((P=C[b])==null?void 0:P.call(C,U,m[W],g[j],K?_[K]:void 0)(X))??"",Z=U.data[X]??null,ae=U.valueFormatter(Z,{dataIndex:X}),le=getLabel(U.label,"tooltip")??null;I[w].seriesItems.push({seriesId:V,color:Y,value:Z,formattedValue:ae,formattedLabel:le,markType:U.labelMarkType})}}):[]}),Object.keys(f).filter(isPolarSeriesType).forEach(b=>{const R=f[b];return R?R.seriesOrder.forEach(V=>{var w;const U=R.series[V],W=U.rotationAxisId??(s==null?void 0:s.id),j=I.findIndex(({axisDirection:P,axisId:K})=>P==="rotation"&&K===W);if(j>=0){const{dataIndex:P}=I[j],K=((w=C[b])==null?void 0:w.call(C,U)(P))??"",X=U.data[P]??null,Y=U.valueFormatter(X,{dataIndex:P}),Z=getLabel(U.label,"tooltip")??null;I[j].seriesItems.push({seriesId:V,color:K,value:X,formattedValue:Y,formattedLabel:Z,markType:U.labelMarkType})}}):[]}),e?I:I.length===0?I[0]:null}function useAxesTooltip(r){return useAxisTooltip(_extends({},r,{multipleAxes:!0}))}function ChartsAxisTooltipContent(r){const e=useUtilityClasses$a(r.classes),t=useAxesTooltip();return t===null?null:jsxRuntimeExports.jsx(ChartsTooltipPaper,{sx:r.sx,className:e.paper,children:t.map(({axisId:n,mainAxis:i,axisValue:s,axisFormattedValue:a,seriesItems:o})=>jsxRuntimeExports.jsxs(ChartsTooltipTable,{className:e.table,children:[s!=null&&!i.hideTooltip&&jsxRuntimeExports.jsx(Typography,{component:"caption",children:a}),jsxRuntimeExports.jsx("tbody",{children:o.map(({seriesId:c,color:h,formattedValue:f,formattedLabel:m,markType:g})=>f==null?null:jsxRuntimeExports.jsxs(ChartsTooltipRow,{className:e.row,children:[jsxRuntimeExports.jsxs(ChartsTooltipCell,{className:clsx(e.labelCell,e.cell),component:"th",children:[jsxRuntimeExports.jsx("div",{className:e.markContainer,children:jsxRuntimeExports.jsx(ChartsLabelMark,{type:g,color:h,className:e.mark})}),m||null]}),jsxRuntimeExports.jsx(ChartsTooltipCell,{className:clsx(e.valueCell,e.cell),component:"td",children:f})]},c))})]},n))})}function rafThrottle(r){let e,t;const n=()=>{t=null,r(...e)};function i(...s){e=s,t||(t=requestAnimationFrame(n))}return i.clear=()=>{t&&(cancelAnimationFrame(t),t=null)},i}function useAxisSystem(){const r=useStore(),e=useSelector(r,selectorChartRawRotationAxis),t=useSelector(r,selectorChartRawXAxis);return e!==void 0?"polar":t!==void 0?"cartesian":"none"}const _excluded$k=["trigger","classes","children"],noAxis=()=>!1,ChartsTooltipRoot=styled(Popper,{name:"MuiChartsTooltip",slot:"Root"})(({theme:r})=>({pointerEvents:"none",zIndex:r.zIndex.modal}));function ChartsTooltipContainer(r){const e=useThemeProps({props:r,name:"MuiChartsTooltipContainer"}),{trigger:t="axis",classes:n,children:i}=e,s=_objectWithoutPropertiesLoose(e,_excluded$k),a=useSvgRef(),o=useUtilityClasses$a(n),c=usePointerType(),h=useIsFineMainPointer(),f=reactExports.useRef(null),m=useLazyRef(()=>({x:0,y:0})),g=useAxisSystem(),_=useStore(),E=useSelector(_,t==="axis"?g==="polar"&&selectorChartsInteractionPolarAxisTooltip||g==="cartesian"&&selectorChartsInteractionAxisTooltip||noAxis:selectorChartsInteractionItemIsDefined);reactExports.useEffect(()=>{const R=a.current;if(R===null)return()=>{};const V=rafThrottle(()=>{var W;return(W=f.current)==null?void 0:W.update()}),U=W=>{m.current={x:W.clientX,y:W.clientY},V()};return R.addEventListener("pointerdown",U),R.addEventListener("pointermove",U),()=>{R.removeEventListener("pointerdown",U),R.removeEventListener("pointermove",U),V.clear()}},[a,m]);const A=reactExports.useMemo(()=>({getBoundingClientRect:()=>({x:m.current.x,y:m.current.y,top:m.current.y,left:m.current.x,right:m.current.x,bottom:m.current.y,width:0,height:0,toJSON:()=>""})}),[m]),C=(c==null?void 0:c.pointerType)==="mouse"||h,I=(c==null?void 0:c.pointerType)==="touch"||!h,b=reactExports.useMemo(()=>[{name:"offset",options:{offset:()=>I?[0,64]:[0,8]}},...C?[]:[{name:"flip",options:{fallbackPlacements:["top-end","top-start","bottom-end","bottom"]}}]],[C,I]);return t==="none"?null:jsxRuntimeExports.jsx(NoSsr,{children:E&&jsxRuntimeExports.jsx(ChartsTooltipRoot,_extends({className:o==null?void 0:o.root,open:E,placement:C?"right-start":"top",popperRef:f,anchorEl:A,modifiers:b},s,{children:i}))})}function ChartsTooltip(r){const{classes:e,trigger:t="axis"}=r,n=useUtilityClasses$a(e);return jsxRuntimeExports.jsx(ChartsTooltipContainer,_extends({},r,{classes:e,children:t==="axis"?jsxRuntimeExports.jsx(ChartsAxisTooltipContent,{classes:n}):jsxRuntimeExports.jsx(ChartsItemTooltipContent,{classes:n})}))}function getLabelUtilityClass(r){return generateUtilityClass("MuiChartsLabel",r)}generateUtilityClasses("MuiChartsLabel",["root"]);const useUtilityClasses$8=r=>composeClasses({root:["root"]},getLabelUtilityClass,r.classes),_excluded$j=["children","className","classes"],ChartsLabel=consumeThemeProps("MuiChartsLabel",{classesResolver:useUtilityClasses$8},function r(e,t){const{children:n,className:i,classes:s}=e,a=_objectWithoutPropertiesLoose(e,_excluded$j);return jsxRuntimeExports.jsx("span",_extends({className:clsx(s==null?void 0:s.root,i),ref:t},a,{children:n}))}),seriesContextBuilder=r=>({type:"series",color:r.color,label:r.label,seriesId:r.seriesId,itemId:r.itemId});function getLegendUtilityClass(r){return generateUtilityClass("MuiChartsLegend",r)}const useUtilityClasses$7=r=>{const{classes:e,direction:t}=r;return composeClasses({root:["root",t],item:["item"],mark:["mark"],label:["label"],series:["series"]},getLegendUtilityClass,e)},legendClasses=generateUtilityClasses("MuiChartsLegend",["root","item","series","mark","label","vertical","horizontal"]),_excluded$i=["slots","slotProps"],_excluded2$1=["ownerState"],consumeSlots=(r,e,t,n)=>{function i(s,a){var U;const o=useThemeProps({props:s,name:r}),c=typeof t.defaultProps=="function"?t.defaultProps(o):t.defaultProps??{},h=resolveProps(c,o),f=h,{slots:m,slotProps:g}=f,_=_objectWithoutPropertiesLoose(f,_excluded$i),E=useTheme(),A=(U=t.classesResolver)==null?void 0:U.call(t,h,E),C=(m==null?void 0:m[e])??n,I=t.propagateSlots&&!(m!=null&&m[e]),b=useSlotProps({elementType:C,externalSlotProps:g==null?void 0:g[e],additionalProps:_extends({},_,{classes:A},I&&{slots:m,slotProps:g}),ownerState:{}}),R=_objectWithoutPropertiesLoose(b,_excluded2$1),V=_extends({},R);for(const W of t.omitProps??[])delete V[W];return jsxRuntimeExports.jsx(C,_extends({},V,{ref:a}))}return reactExports.forwardRef(i)},_excluded$h=["direction","onItemClick","className","classes"],RootElement=styled("ul",{name:"MuiChartsLegend",slot:"Root"})(({ownerState:r,theme:e})=>_extends({},e.typography.caption,{color:(e.vars||e).palette.text.primary,lineHeight:"100%",display:"flex",flexDirection:r.direction==="vertical"?"column":"row",alignItems:r.direction==="vertical"?void 0:"center",flexShrink:0,gap:e.spacing(2),listStyleType:"none",paddingInlineStart:0,marginBlock:e.spacing(1),marginInline:e.spacing(1),flexWrap:"wrap",li:{display:r.direction==="horizontal"?"inline-flex":void 0},[`button.${legendClasses.series}`]:{background:"none",border:"none",padding:0,fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",letterSpacing:"inherit",color:"inherit"},[`& .${legendClasses.series}`]:{display:r.direction==="vertical"?"flex":"inline-flex",alignItems:"center",gap:e.spacing(1)}})),ChartsLegend=consumeSlots("MuiChartsLegend","legend",{defaultProps:{direction:"horizontal"},omitProps:["position"],classesResolver:useUtilityClasses$7},reactExports.forwardRef(function r(e,t){const n=useLegend(),{onItemClick:i,className:s,classes:a}=e,o=_objectWithoutPropertiesLoose(e,_excluded$h);if(n.items.length===0)return null;const c=i?"button":"div";return jsxRuntimeExports.jsx(RootElement,_extends({className:clsx(a==null?void 0:a.root,s),ref:t},o,{ownerState:e,children:n.items.map((h,f)=>jsxRuntimeExports.jsx("li",{className:a==null?void 0:a.item,"data-series":h.id,children:jsxRuntimeExports.jsxs(c,{className:a==null?void 0:a.series,role:i?"button":void 0,type:i?"button":void 0,onClick:i?m=>i(m,seriesContextBuilder(h),f):void 0,children:[jsxRuntimeExports.jsx(ChartsLabelMark,{className:a==null?void 0:a.mark,color:h.color,type:h.markType}),jsxRuntimeExports.jsx(ChartsLabel,{className:a==null?void 0:a.label,children:h.label})]})},h.id))}))}));function getAxisHighlightUtilityClass(r){return generateUtilityClass("MuiChartsAxisHighlight",r)}generateUtilityClasses("MuiChartsAxisHighlight",["root"]);const ChartsAxisHighlightPath=styled("path",{name:"MuiChartsAxisHighlight",slot:"Root"})(({theme:r})=>({pointerEvents:"none",variants:[{props:{axisHighlight:"band"},style:_extends({fill:"white",fillOpacity:.1},r.applyStyles("light",{fill:"gray"}))},{props:{axisHighlight:"line"},style:_extends({strokeDasharray:"5 2",stroke:"#ffffff"},r.applyStyles("light",{stroke:"#000000"}))}]}));function ChartsYHighlight(r){const{type:e,classes:t}=r,{left:n,width:i}=useDrawingArea(),s=useStore(),a=useSelector(s,selectorChartsHighlightYAxisValue),o=useSelector(s,selectorChartYAxis);return a.length===0?null:a.map(({axisId:c,value:h})=>{const m=o.axis[c].scale,g=getValueToPositionMapper(m),_=e==="band"&&h!==null&&isBandScale(m);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[_&&m(h)!==void 0&&jsxRuntimeExports.jsx(ChartsAxisHighlightPath,{d:`M ${n} ${m(h)-(m.step()-m.bandwidth())/2} l 0 ${m.step()} l ${i} 0 l 0 ${-m.step()} Z`,className:t.root,ownerState:{axisHighlight:"band"}}),e==="line"&&h!==null&&jsxRuntimeExports.jsx(ChartsAxisHighlightPath,{d:`M ${n} ${g(h)} L ${n+i} ${g(h)}`,className:t.root,ownerState:{axisHighlight:"line"}})]},`${c}-${h}`)})}function ChartsXHighlight(r){const{type:e,classes:t}=r,{top:n,height:i}=useDrawingArea(),s=useStore(),a=useSelector(s,selectorChartsHighlightXAxisValue),o=useSelector(s,selectorChartXAxis);return a.length===0?null:a.map(({axisId:c,value:h})=>{const m=o.axis[c].scale,g=getValueToPositionMapper(m),_=e==="band"&&h!==null&&isBandScale(m);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[_&&m(h)!==void 0&&jsxRuntimeExports.jsx(ChartsAxisHighlightPath,{d:`M ${m(h)-(m.step()-m.bandwidth())/2} ${n} l ${m.step()} 0 l 0 ${i} l ${-m.step()} 0 Z`,className:t.root,ownerState:{axisHighlight:"band"}}),e==="line"&&h!==null&&jsxRuntimeExports.jsx(ChartsAxisHighlightPath,{d:`M ${g(h)} ${n} L ${g(h)} ${n+i}`,className:t.root,ownerState:{axisHighlight:"line"}})]},`${c}-${h}`)})}const useUtilityClasses$6=()=>composeClasses({root:["root"]},getAxisHighlightUtilityClass);function ChartsAxisHighlight(r){const{x:e,y:t}=r,n=useUtilityClasses$6();return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[e&&jsxRuntimeExports.jsx(ChartsXHighlight,{type:e,classes:n}),t&&jsxRuntimeExports.jsx(ChartsYHighlight,{type:t,classes:n})]})}function getBarElementUtilityClass(r){return generateUtilityClass("MuiBarElement",r)}const barElementClasses=generateUtilityClasses("MuiBarElement",["root","highlighted","faded","series"]),useUtilityClasses$5=r=>{const{classes:e,id:t,isHighlighted:n,isFaded:i}=r,s={root:["root",`series-${t}`,n&&"highlighted",i&&"faded"]};return composeClasses(s,getBarElementUtilityClass,e)};function onPointerDown(r){"hasPointerCapture"in r.currentTarget&&r.currentTarget.hasPointerCapture(r.pointerId)&&r.currentTarget.releasePointerCapture(r.pointerId)}const useInteractionItemProps=(r,e)=>{const{instance:t}=useChartContext(),n=reactExports.useRef(!1),i=reactExports.useCallback(()=>{n.current=!0,t.setItemInteraction({type:r.type,seriesId:r.seriesId,dataIndex:r.dataIndex}),t.setHighlight({seriesId:r.seriesId,dataIndex:r.dataIndex})},[t,r.type,r.seriesId,r.dataIndex]),s=reactExports.useCallback(()=>{n.current=!1,t.removeItemInteraction({type:r.type,seriesId:r.seriesId,dataIndex:r.dataIndex}),t.clearHighlight()},[t,r.type,r.seriesId,r.dataIndex]);return reactExports.useEffect(()=>()=>{n.current&&s()},[s]),{onPointerEnter:i,onPointerLeave:s,onPointerDown}},_excluded$g=["ownerState","skipAnimation","id","dataIndex","xOrigin","yOrigin"];function AnimatedBarElement(r){const{ownerState:e}=r,t=_objectWithoutPropertiesLoose(r,_excluded$g),n=useAnimateBar(r);return jsxRuntimeExports.jsx("rect",_extends({},t,{filter:e.isHighlighted?"brightness(120%)":void 0,opacity:e.isFaded?.3:1,"data-highlighted":e.isHighlighted||void 0,"data-faded":e.isFaded||void 0},n))}const _excluded$f=["id","dataIndex","classes","color","slots","slotProps","style","onClick","skipAnimation","layout","x","xOrigin","y","yOrigin","width","height"];function BarElement(r){const{id:e,dataIndex:t,classes:n,color:i,slots:s,slotProps:a,style:o,onClick:c,skipAnimation:h,layout:f,x:m,xOrigin:g,y:_,yOrigin:E,width:A,height:C}=r,I=_objectWithoutPropertiesLoose(r,_excluded$f),b=useInteractionItemProps({type:"bar",seriesId:e,dataIndex:t}),{isFaded:R,isHighlighted:V}=useItemHighlighted({seriesId:e,dataIndex:t}),U={id:e,dataIndex:t,classes:n,color:i,isFaded:R,isHighlighted:V},W=useUtilityClasses$5(U),j=(s==null?void 0:s.bar)??AnimatedBarElement,w=useSlotProps({elementType:j,externalSlotProps:a==null?void 0:a.bar,externalForwardedProps:I,additionalProps:_extends({},b,{id:e,dataIndex:t,color:i,x:m,xOrigin:g,y:_,yOrigin:E,width:A,height:C,style:o,onClick:c,cursor:c?"pointer":"unset",stroke:"none",fill:i,skipAnimation:h,layout:f}),className:W.root,ownerState:U});return jsxRuntimeExports.jsx(j,_extends({},w))}function barClipPathPropsInterpolator(r,e){const t=interpolateNumber(r.x,e.x),n=interpolateNumber(r.y,e.y),i=interpolateNumber(r.width,e.width),s=interpolateNumber(r.height,e.height),a=interpolateNumber(r.borderRadius,e.borderRadius);return o=>({x:t(o),y:n(o),width:i(o),height:s(o),borderRadius:a(o)})}function useAnimateBarClipPath(r){const e={x:r.layout==="vertical"?r.x:r.xOrigin,y:r.layout==="vertical"?r.yOrigin:r.y,width:r.layout==="vertical"?r.width:0,height:r.layout==="vertical"?0:r.height,borderRadius:r.borderRadius};return useAnimate({x:r.x,y:r.y,width:r.width,height:r.height,borderRadius:r.borderRadius},{createInterpolator:barClipPathPropsInterpolator,transformProps:t=>({d:generateClipPath(r.hasNegative,r.hasPositive,r.layout,t.x,t.y,t.width,t.height,r.xOrigin,r.yOrigin,t.borderRadius)}),applyProps(t,{d:n}){n&&t.setAttribute("d",n)},initialProps:e,skip:r.skipAnimation,ref:r.ref})}function BarClipPath(r){const{maskId:e,x:t,y:n,width:i,height:s,skipAnimation:a}=r,{ref:o,d:c}=useAnimateBarClipPath({layout:r.layout??"vertical",hasNegative:r.hasNegative,hasPositive:r.hasPositive,xOrigin:r.xOrigin,yOrigin:r.yOrigin,x:t,y:n,width:i,height:s,borderRadius:r.borderRadius??0,skipAnimation:a});return!r.borderRadius||r.borderRadius<=0?null:jsxRuntimeExports.jsx("clipPath",{id:e,children:jsxRuntimeExports.jsx("path",{ref:o,d:c})})}function generateClipPath(r,e,t,n,i,s,a,o,c,h){if(t==="vertical"){if(e&&r){const m=Math.min(h,s/2,a/2);return`M${n},${i+a/2} v${-(a/2-m)} a${m},${m} 0 0 1 ${m},${-m} h${s-m*2} a${m},${m} 0 0 1 ${m},${m} v${a-2*m} a${m},${m} 0 0 1 ${-m},${m} h${-(s-m*2)} a${m},${m} 0 0 1 ${-m},${-m} v${-(a/2-m)}`}const f=Math.min(h,s/2);if(e)return`M${n},${Math.max(c,i+f)} v${Math.min(0,-(c-i-f))} a${f},${f} 0 0 1 ${f},${-f} h${s-f*2} a${f},${f} 0 0 1 ${f},${f} v${Math.max(0,c-i-f)} Z`;if(r)return`M${n},${Math.min(c,i+a-f)} v${Math.max(0,a-f)} a${f},${f} 0 0 0 ${f},${f} h${s-f*2} a${f},${f} 0 0 0 ${f},${-f} v${-Math.max(0,a-f)} Z`}if(t==="horizontal"){if(e&&r){const m=Math.min(h,s/2,a/2);return`M${n+s/2},${i} h${s/2-m} a${m},${m} 0 0 1 ${m},${m} v${a-m*2} a${m},${m} 0 0 1 ${-m},${m} h${-(s-2*m)} a${m},${m} 0 0 1 ${-m},${-m} v${-(a-m*2)} a${m},${m} 0 0 1 ${m},${-m} h${s/2-m}`}const f=Math.min(h,a/2);if(e)return`M${Math.min(o,n-f)},${i} h${s} a${f},${f} 0 0 1 ${f},${f} v${a-f*2} a${f},${f} 0 0 1 ${-f},${f} h${-s} Z`;if(r)return`M${Math.max(o,n+s+f)},${i} h${-s} a${f},${f} 0 0 0 ${-f},${f} v${a-f*2} a${f},${f} 0 0 0 ${f},${f} h${s} Z`}}function getBarLabelUtilityClass(r){return generateUtilityClass("MuiBarLabel",r)}const barLabelClasses=generateUtilityClasses("MuiBarLabel",["root","highlighted","faded","animate"]),useUtilityClasses$4=r=>{const{classes:e,seriesId:t,isFaded:n,isHighlighted:i,skipAnimation:s}=r,a={root:["root",`series-${t}`,i&&"highlighted",n&&"faded",!s&&"animate"]};return composeClasses(a,getBarLabelUtilityClass,e)},getBarLabel=r=>{const{barLabel:e,value:t,dataIndex:n,seriesId:i,height:s,width:a}=r;return e==="value"?t?t==null?void 0:t.toString():null:e({seriesId:i,dataIndex:n,value:t},{bar:{height:s,width:a}})},_excluded$e=["seriesId","dataIndex","color","isFaded","isHighlighted","classes","skipAnimation","layout","xOrigin","yOrigin"],BarLabelComponent=styled("text",{name:"MuiBarLabel",slot:"Root",overridesResolver:(r,e)=>[{[`&.${barLabelClasses.faded}`]:e.faded},{[`&.${barLabelClasses.highlighted}`]:e.highlighted},e.root]})(({theme:r})=>{var e,t,n,i;return _extends({},(e=r==null?void 0:r.typography)==null?void 0:e.body2,{stroke:"none",fill:(i=(n=(t=r.vars||r)==null?void 0:t.palette)==null?void 0:n.text)==null?void 0:i.primary,transition:"opacity 0.2s ease-in, fill 0.2s ease-in",textAnchor:"middle",dominantBaseline:"central",pointerEvents:"none",opacity:1,[`&.${barLabelClasses.faded}`]:{opacity:.3}})});function BarLabel(r){const e=useThemeProps({props:r,name:"MuiBarLabel"}),t=_objectWithoutPropertiesLoose(e,_excluded$e),n=useAnimateBarLabel(e);return jsxRuntimeExports.jsx(BarLabelComponent,_extends({},t,n))}const _excluded$d=["seriesId","classes","color","dataIndex","barLabel","slots","slotProps","xOrigin","yOrigin","x","y","width","height","value","skipAnimation","layout"],_excluded2=["ownerState"];function BarLabelItem(r){const{seriesId:e,classes:t,color:n,dataIndex:i,barLabel:s,slots:a,slotProps:o,xOrigin:c,yOrigin:h,x:f,y:m,width:g,height:_,value:E,skipAnimation:A,layout:C}=r,I=_objectWithoutPropertiesLoose(r,_excluded$d),{isFaded:b,isHighlighted:R}=useItemHighlighted({seriesId:e,dataIndex:i}),V={seriesId:e,classes:t,color:n,isFaded:b,isHighlighted:R,dataIndex:i,skipAnimation:A,layout:C},U=useUtilityClasses$4(V),W=(a==null?void 0:a.barLabel)??BarLabel,j=useSlotProps({elementType:W,externalSlotProps:o==null?void 0:o.barLabel,additionalProps:_extends({},I,{xOrigin:c,yOrigin:h,x:f,y:m,width:g,height:_,className:U.root}),ownerState:V}),{ownerState:w}=j,P=_objectWithoutPropertiesLoose(j,_excluded2);if(!s)return null;const K=getBarLabel({barLabel:s,value:E,dataIndex:i,seriesId:e,height:_,width:g});return K?jsxRuntimeExports.jsx(W,_extends({},P,w,{children:K})):null}function getBarUtilityClass(r){return generateUtilityClass("MuiBar",r)}generateUtilityClasses("MuiBar",["root","series","seriesLabels"]);const useUtilityClasses$3=r=>composeClasses({root:["root"],series:["series"],seriesLabels:["seriesLabels"]},getBarUtilityClass,r),_excluded$c=["bars","skipAnimation"];function BarLabelPlot(r){const{bars:e,skipAnimation:t}=r,n=_objectWithoutPropertiesLoose(r,_excluded$c),i=useUtilityClasses$3();return jsxRuntimeExports.jsx(reactExports.Fragment,{children:e.flatMap(({seriesId:s,data:a})=>jsxRuntimeExports.jsx("g",{className:i.seriesLabels,"data-series":s,children:a.map(({xOrigin:o,yOrigin:c,x:h,y:f,dataIndex:m,color:g,value:_,width:E,height:A,layout:C})=>jsxRuntimeExports.jsx(BarLabelItem,_extends({seriesId:s,dataIndex:m,value:_,color:g,xOrigin:o,yOrigin:c,x:h,y:f,width:E,height:A,skipAnimation:t??!1,layout:C??"vertical"},n),m))},s))})}function useSkipAnimation(r){const e=useStore(),t=useSelector(e,selectorChartSkipAnimation);return r||t}function useInternalIsZoomInteracting(){const r=useStore();return useSelector(r,selectorChartZoomIsInteracting)}const getAxisMessage=(r,e)=>{const t=`${r}-axis`,n=`${r}Axis`;return e===(r==="x"?DEFAULT_X_AXIS_KEY:DEFAULT_Y_AXIS_KEY)?`The first \`${n}\``:`The ${t} with id "${e}"`};function checkScaleErrors(r,e,t,n,i,s,a){const o=i[n],c=a[s],h=r?o:c,f=r?c:o,m=r?n:s,g=r?s:n,_=r?"x":"y",E=r?"y":"x";if(!isBandScaleConfig(h))throw new Error(`MUI X Charts: ${getAxisMessage(_,m)} should be of type "band" to display the bar series of id "${e}".`);if(h.data===void 0)throw new Error(`MUI X Charts: ${getAxisMessage(_,m)} should have data property.`);if(isBandScaleConfig(f)||isPointScaleConfig(f))throw new Error(`MUI X Charts: ${getAxisMessage(E,g)} should be a continuous type to display the bar series of id "${e}".`)}function useBarPlotData(r,e,t){const n=useBarSeriesContext()??{series:{},stackingGroups:[]},i=useXAxes().xAxisIds[0],s=useYAxes().yAxisIds[0],a=useChartId(),{series:o,stackingGroups:c}=n,h={};return{completedData:c.flatMap(({ids:m},g)=>{const _=r.left,E=r.left+r.width,A=r.top,C=r.top+r.height;return m.map(I=>{const b=o[I].xAxisId??i,R=o[I].yAxisId??s,V=e[b],U=t[R],W=o[I].layout==="vertical";checkScaleErrors(W,I,o[I],b,e,R,t);const j=W?V:U,w=V.scale,P=U.scale,K=getColor$3(o[I],e[b],t[R]),X=j.scale.bandwidth(),{barWidth:Y,offset:Z}=getBandSize({bandWidth:X,numberOfGroups:c.length,gapRatio:j.barGapRatio}),ae=g*(Y+Z),{stackedData:le,data:ie,layout:se,minBarSize:ce}=o[I],ue=j.data.map((Ae,Se)=>{if(ie[Se]==null)return null;const he=le[Se].map(Te=>W?P(Te):w(Te)),ke=Math.round(Math.min(...he)),Pe=Math.round(Math.max(...he)),Le=o[I].stack,{barSize:$e,startCoordinate:qe}=getValueCoordinate(W,ke,Pe,ie[Se],ce),xe={seriesId:I,dataIndex:Se,layout:se,x:W?w(Ae)+ae:qe,y:W?qe:P(Ae)+ae,xOrigin:w(0)??0,yOrigin:P(0)??0,height:W?$e:Y,width:W?Y:$e,color:K(Se),value:ie[Se],maskId:`${a}_${Le||I}_${g}_${Se}`};if(xe.x>E||xe.x+xe.width<_||xe.y>C||xe.y+xe.height<A)return null;h[xe.maskId]||(h[xe.maskId]={id:xe.maskId,width:0,height:0,hasNegative:!1,hasPositive:!1,layout:xe.layout,xOrigin:w(0),yOrigin:P(0),x:0,y:0});const Ie=h[xe.maskId];return Ie.width=xe.layout==="vertical"?xe.width:Ie.width+xe.width,Ie.height=xe.layout==="vertical"?Ie.height+xe.height:xe.height,Ie.x=Math.min(Ie.x===0?1/0:Ie.x,xe.x),Ie.y=Math.min(Ie.y===0?1/0:Ie.y,xe.y),Ie.hasNegative=Ie.hasNegative||(xe.value??0)<0,Ie.hasPositive=Ie.hasPositive||(xe.value??0)>0,xe}).filter(Ae=>Ae!==null);return{seriesId:I,data:ue}})}),masksData:Object.values(h)}}function getBandSize({bandWidth:r,numberOfGroups:e,gapRatio:t}){if(t===0)return{barWidth:r/e,offset:0};const n=r/(e+(e-1)*t),i=t*n;return{barWidth:n,offset:i}}function getValueCoordinate(r,e,t,n,i){if(n===0||n==null)return{barSize:0,startCoordinate:e};const s=t-e<i,a=s?i:t-e,o=r&&n>=0,c=!r&&n<0;return s&&(o||c)?{barSize:a,startCoordinate:t-a}:{barSize:a,startCoordinate:e}}const _excluded$b=["skipAnimation","onItemClick","borderRadius","barLabel"],BarPlotRoot=styled("g",{name:"MuiBarPlot",slot:"Root"})({[`& .${barElementClasses.root}`]:{transition:"opacity 0.2s ease-in, fill 0.2s ease-in"}});function BarPlot(r){const{skipAnimation:e,onItemClick:t,borderRadius:n,barLabel:i}=r,s=_objectWithoutPropertiesLoose(r,_excluded$b),a=useInternalIsZoomInteracting(),o=useSkipAnimation(a||e),{xAxis:c}=useXAxes(),{yAxis:h}=useYAxes(),{completedData:f,masksData:m}=useBarPlotData(useDrawingArea(),c,h),g=!n||n<=0,_=useUtilityClasses$3();return jsxRuntimeExports.jsxs(BarPlotRoot,{className:_.root,children:[!g&&m.map(({id:E,x:A,y:C,xOrigin:I,yOrigin:b,width:R,height:V,hasPositive:U,hasNegative:W,layout:j})=>jsxRuntimeExports.jsx(BarClipPath,{maskId:E,borderRadius:n,hasNegative:W,hasPositive:U,layout:j,x:A,y:C,xOrigin:I,yOrigin:b,width:R,height:V,skipAnimation:o??!1},E)),f.map(({seriesId:E,data:A})=>jsxRuntimeExports.jsx("g",{"data-series":E,className:_.series,children:A.map(({dataIndex:C,color:I,maskId:b,layout:R,x:V,xOrigin:U,y:W,yOrigin:j,width:w,height:P})=>{const K=jsxRuntimeExports.jsx(BarElement,_extends({id:E,dataIndex:C,color:I,skipAnimation:o??!1,layout:R??"vertical",x:V,xOrigin:U,y:W,yOrigin:j,width:w,height:P},s,{onClick:t&&(X=>{t(X,{type:"bar",seriesId:E,dataIndex:C})})}),C);return g?K:jsxRuntimeExports.jsx("g",{clipPath:`url(#${b})`,children:K},C)})},E)),i&&jsxRuntimeExports.jsx(BarLabelPlot,_extends({bars:f,skipAnimation:o,barLabel:i},s))]})}const _excluded$a=["message"],StyledText$1=styled("text")(({theme:r})=>_extends({},r.typography.body2,{stroke:"none",fill:(r.vars||r).palette.text.primary,shapeRendering:"crispEdges",textAnchor:"middle",dominantBaseline:"middle"}));function ChartsLoadingOverlay(r){const{message:e}=r,t=_objectWithoutPropertiesLoose(r,_excluded$a),{top:n,left:i,height:s,width:a}=useDrawingArea(),{localeText:o}=useChartsLocalization();return jsxRuntimeExports.jsx(StyledText$1,_extends({x:i+a/2,y:n+s/2},t,{children:e??o.loading}))}const _excluded$9=["message"],StyledText=styled("text")(({theme:r})=>_extends({},r.typography.body2,{stroke:"none",fill:(r.vars||r).palette.text.primary,shapeRendering:"crispEdges",textAnchor:"middle",dominantBaseline:"middle"}));function ChartsNoDataOverlay(r){const{message:e}=r,t=_objectWithoutPropertiesLoose(r,_excluded$9),{top:n,left:i,height:s,width:a}=useDrawingArea(),{localeText:o}=useChartsLocalization();return jsxRuntimeExports.jsx(StyledText,_extends({x:i+a/2,y:n+s/2},t,{children:e??o.noData}))}function useNoData(){const r=useSeries();return Object.values(r).every(e=>{if(!e)return!0;const{series:t,seriesOrder:n}=e;return n.every(i=>t[i].data.length===0)})}function ChartsOverlay(r){var t,n,i,s;const e=useNoData();if(r.loading){const a=((t=r.slots)==null?void 0:t.loadingOverlay)??ChartsLoadingOverlay;return jsxRuntimeExports.jsx(a,_extends({},(n=r.slotProps)==null?void 0:n.loadingOverlay))}if(e){const a=((i=r.slots)==null?void 0:i.noDataOverlay)??ChartsNoDataOverlay;return jsxRuntimeExports.jsx(a,_extends({},(s=r.slotProps)==null?void 0:s.noDataOverlay))}return null}const BAR_CHART_PLUGINS=[useChartZAxis,useChartCartesianAxis,useChartInteraction,useChartHighlight],_excluded$8=["xAxis","yAxis","series","width","height","margin","colors","dataset","sx","axisHighlight","grid","children","slots","slotProps","skipAnimation","loading","layout","onItemClick","highlightedItem","onHighlightChange","borderRadius","barLabel","className","hideLegend","showToolbar"],useBarChartProps=r=>{var xe,Ie,Te,pe,Fe;const{xAxis:e,yAxis:t,series:n,width:i,height:s,margin:a,colors:o,dataset:c,sx:h,axisHighlight:f,grid:m,children:g,slots:_,slotProps:E,skipAnimation:A,loading:C,layout:I,onItemClick:b,highlightedItem:R,onHighlightChange:V,borderRadius:U,barLabel:W,className:j}=r,w=_objectWithoutPropertiesLoose(r,_excluded$8),K=`${useId()}-clip-path`,X=I==="horizontal"||I===void 0&&n.some(Re=>Re.layout==="horizontal"),Y=reactExports.useMemo(()=>[{id:DEFAULT_X_AXIS_KEY,scaleType:"band",data:Array.from({length:Math.max(...n.map(Re=>(Re.data??c??[]).length))},(Re,Ue)=>Ue)}],[c,n]),Z=reactExports.useMemo(()=>[{id:DEFAULT_Y_AXIS_KEY,scaleType:"band",data:Array.from({length:Math.max(...n.map(Re=>(Re.data??c??[]).length))},(Re,Ue)=>Ue)}],[c,n]),ae=reactExports.useMemo(()=>n.map(Re=>_extends({type:"bar"},Re,{layout:X?"horizontal":"vertical"})),[X,n]),le=X?void 0:Y,ie=reactExports.useMemo(()=>e?X?e:e.map(Re=>_extends({scaleType:"band"},Re)):le,[le,X,e]),se=X?Z:void 0,ce=reactExports.useMemo(()=>t?X?t.map(Re=>_extends({scaleType:"band"},Re)):t:se,[se,X,t]),ue=_extends({},w,{series:ae,width:i,height:s,margin:a,colors:o,dataset:c,xAxis:ie,yAxis:ce,highlightedItem:R,onHighlightChange:V,disableAxisListener:((xe=E==null?void 0:E.tooltip)==null?void 0:xe.trigger)!=="axis"&&(f==null?void 0:f.x)==="none"&&(f==null?void 0:f.y)==="none",className:j,skipAnimation:A,plugins:BAR_CHART_PLUGINS}),Ae={onItemClick:b,slots:_,slotProps:E,borderRadius:U,barLabel:W},Se={vertical:m==null?void 0:m.vertical,horizontal:m==null?void 0:m.horizontal},ye={clipPath:`url(#${K})`},he={id:K},ke={slots:_,slotProps:E,loading:C},Pe={slots:_,slotProps:E},Le=_extends({},X?{y:"band"}:{x:"band"},f),$e={slots:_,slotProps:E};return{chartsWrapperProps:{sx:h,legendPosition:(Te=(Ie=r.slotProps)==null?void 0:Ie.legend)==null?void 0:Te.position,legendDirection:(Fe=(pe=r.slotProps)==null?void 0:pe.legend)==null?void 0:Fe.direction},chartContainerProps:ue,barPlotProps:Ae,gridProps:Se,clipPathProps:he,clipPathGroupProps:ye,overlayProps:ke,chartsAxisProps:Pe,axisHighlightProps:Le,legendProps:$e,children:g}},baseSlots={baseButton:Button,baseIconButton:IconButton},iconSlots={},defaultSlotsMaterial=_extends({},baseSlots,iconSlots),ChartsSlotsContext=reactExports.createContext(null);function ChartsSlotsProvider(r){const{slots:e,slotProps:t={},defaultSlots:n,children:i}=r,s=reactExports.useMemo(()=>({slots:_extends({},n,e),slotProps:t}),[n,e,t]);return jsxRuntimeExports.jsx(ChartsSlotsContext.Provider,{value:s,children:i})}const epsilon$1=11102230246251565e-32,splitter=134217729,resulterrbound=(3+8*epsilon$1)*epsilon$1;function sum(r,e,t,n,i){let s,a,o,c,h=e[0],f=n[0],m=0,g=0;f>h==f>-h?(s=h,h=e[++m]):(s=f,f=n[++g]);let _=0;if(m<r&&g<t)for(f>h==f>-h?(a=h+s,o=s-(a-h),h=e[++m]):(a=f+s,o=s-(a-f),f=n[++g]),s=a,o!==0&&(i[_++]=o);m<r&&g<t;)f>h==f>-h?(a=s+h,c=a-s,o=s-(a-c)+(h-c),h=e[++m]):(a=s+f,c=a-s,o=s-(a-c)+(f-c),f=n[++g]),s=a,o!==0&&(i[_++]=o);for(;m<r;)a=s+h,c=a-s,o=s-(a-c)+(h-c),h=e[++m],s=a,o!==0&&(i[_++]=o);for(;g<t;)a=s+f,c=a-s,o=s-(a-c)+(f-c),f=n[++g],s=a,o!==0&&(i[_++]=o);return(s!==0||_===0)&&(i[_++]=s),_}function estimate(r,e){let t=e[0];for(let n=1;n<r;n++)t+=e[n];return t}function vec(r){return new Float64Array(r)}const ccwerrboundA=(3+16*epsilon$1)*epsilon$1,ccwerrboundB=(2+12*epsilon$1)*epsilon$1,ccwerrboundC=(9+64*epsilon$1)*epsilon$1*epsilon$1,B=vec(4),C1=vec(8),C2=vec(12),D=vec(16),u=vec(4);function orient2dadapt(r,e,t,n,i,s,a){let o,c,h,f,m,g,_,E,A,C,I,b,R,V,U,W,j,w;const P=r-i,K=t-i,X=e-s,Y=n-s;V=P*Y,g=splitter*P,_=g-(g-P),E=P-_,g=splitter*Y,A=g-(g-Y),C=Y-A,U=E*C-(V-_*A-E*A-_*C),W=X*K,g=splitter*X,_=g-(g-X),E=X-_,g=splitter*K,A=g-(g-K),C=K-A,j=E*C-(W-_*A-E*A-_*C),I=U-j,m=U-I,B[0]=U-(I+m)+(m-j),b=V+I,m=b-V,R=V-(b-m)+(I-m),I=R-W,m=R-I,B[1]=R-(I+m)+(m-W),w=b+I,m=w-b,B[2]=b-(w-m)+(I-m),B[3]=w;let Z=estimate(4,B),ae=ccwerrboundB*a;if(Z>=ae||-Z>=ae||(m=r-P,o=r-(P+m)+(m-i),m=t-K,h=t-(K+m)+(m-i),m=e-X,c=e-(X+m)+(m-s),m=n-Y,f=n-(Y+m)+(m-s),o===0&&c===0&&h===0&&f===0)||(ae=ccwerrboundC*a+resulterrbound*Math.abs(Z),Z+=P*f+Y*o-(X*h+K*c),Z>=ae||-Z>=ae))return Z;V=o*Y,g=splitter*o,_=g-(g-o),E=o-_,g=splitter*Y,A=g-(g-Y),C=Y-A,U=E*C-(V-_*A-E*A-_*C),W=c*K,g=splitter*c,_=g-(g-c),E=c-_,g=splitter*K,A=g-(g-K),C=K-A,j=E*C-(W-_*A-E*A-_*C),I=U-j,m=U-I,u[0]=U-(I+m)+(m-j),b=V+I,m=b-V,R=V-(b-m)+(I-m),I=R-W,m=R-I,u[1]=R-(I+m)+(m-W),w=b+I,m=w-b,u[2]=b-(w-m)+(I-m),u[3]=w;const le=sum(4,B,4,u,C1);V=P*f,g=splitter*P,_=g-(g-P),E=P-_,g=splitter*f,A=g-(g-f),C=f-A,U=E*C-(V-_*A-E*A-_*C),W=X*h,g=splitter*X,_=g-(g-X),E=X-_,g=splitter*h,A=g-(g-h),C=h-A,j=E*C-(W-_*A-E*A-_*C),I=U-j,m=U-I,u[0]=U-(I+m)+(m-j),b=V+I,m=b-V,R=V-(b-m)+(I-m),I=R-W,m=R-I,u[1]=R-(I+m)+(m-W),w=b+I,m=w-b,u[2]=b-(w-m)+(I-m),u[3]=w;const ie=sum(le,C1,4,u,C2);V=o*f,g=splitter*o,_=g-(g-o),E=o-_,g=splitter*f,A=g-(g-f),C=f-A,U=E*C-(V-_*A-E*A-_*C),W=c*h,g=splitter*c,_=g-(g-c),E=c-_,g=splitter*h,A=g-(g-h),C=h-A,j=E*C-(W-_*A-E*A-_*C),I=U-j,m=U-I,u[0]=U-(I+m)+(m-j),b=V+I,m=b-V,R=V-(b-m)+(I-m),I=R-W,m=R-I,u[1]=R-(I+m)+(m-W),w=b+I,m=w-b,u[2]=b-(w-m)+(I-m),u[3]=w;const se=sum(ie,C2,4,u,D);return D[se-1]}function orient2d(r,e,t,n,i,s){const a=(e-s)*(t-i),o=(r-i)*(n-s),c=a-o,h=Math.abs(a+o);return Math.abs(c)>=ccwerrboundA*h?c:-orient2dadapt(r,e,t,n,i,s,h)}const EPSILON=Math.pow(2,-52),EDGE_STACK=new Uint32Array(512);class Delaunator{static from(e,t=defaultGetX,n=defaultGetY){const i=e.length,s=new Float64Array(i*2);for(let a=0;a<i;a++){const o=e[a];s[2*a]=t(o),s[2*a+1]=n(o)}return new Delaunator(s)}constructor(e){const t=e.length>>1;if(t>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const n=Math.max(2*t-5,0);this._triangles=new Uint32Array(n*3),this._halfedges=new Int32Array(n*3),this._hashSize=Math.ceil(Math.sqrt(t)),this._hullPrev=new Uint32Array(t),this._hullNext=new Uint32Array(t),this._hullTri=new Uint32Array(t),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(t),this._dists=new Float64Array(t),this.update()}update(){const{coords:e,_hullPrev:t,_hullNext:n,_hullTri:i,_hullHash:s}=this,a=e.length>>1;let o=1/0,c=1/0,h=-1/0,f=-1/0;for(let P=0;P<a;P++){const K=e[2*P],X=e[2*P+1];K<o&&(o=K),X<c&&(c=X),K>h&&(h=K),X>f&&(f=X),this._ids[P]=P}const m=(o+h)/2,g=(c+f)/2;let _,E,A;for(let P=0,K=1/0;P<a;P++){const X=dist(m,g,e[2*P],e[2*P+1]);X<K&&(_=P,K=X)}const C=e[2*_],I=e[2*_+1];for(let P=0,K=1/0;P<a;P++){if(P===_)continue;const X=dist(C,I,e[2*P],e[2*P+1]);X<K&&X>0&&(E=P,K=X)}let b=e[2*E],R=e[2*E+1],V=1/0;for(let P=0;P<a;P++){if(P===_||P===E)continue;const K=circumradius(C,I,b,R,e[2*P],e[2*P+1]);K<V&&(A=P,V=K)}let U=e[2*A],W=e[2*A+1];if(V===1/0){for(let X=0;X<a;X++)this._dists[X]=e[2*X]-e[0]||e[2*X+1]-e[1];quicksort(this._ids,this._dists,0,a-1);const P=new Uint32Array(a);let K=0;for(let X=0,Y=-1/0;X<a;X++){const Z=this._ids[X],ae=this._dists[Z];ae>Y&&(P[K++]=Z,Y=ae)}this.hull=P.subarray(0,K),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(orient2d(C,I,b,R,U,W)<0){const P=E,K=b,X=R;E=A,b=U,R=W,A=P,U=K,W=X}const j=circumcenter(C,I,b,R,U,W);this._cx=j.x,this._cy=j.y;for(let P=0;P<a;P++)this._dists[P]=dist(e[2*P],e[2*P+1],j.x,j.y);quicksort(this._ids,this._dists,0,a-1),this._hullStart=_;let w=3;n[_]=t[A]=E,n[E]=t[_]=A,n[A]=t[E]=_,i[_]=0,i[E]=1,i[A]=2,s.fill(-1),s[this._hashKey(C,I)]=_,s[this._hashKey(b,R)]=E,s[this._hashKey(U,W)]=A,this.trianglesLen=0,this._addTriangle(_,E,A,-1,-1,-1);for(let P=0,K,X;P<this._ids.length;P++){const Y=this._ids[P],Z=e[2*Y],ae=e[2*Y+1];if(P>0&&Math.abs(Z-K)<=EPSILON&&Math.abs(ae-X)<=EPSILON||(K=Z,X=ae,Y===_||Y===E||Y===A))continue;let le=0;for(let Ae=0,Se=this._hashKey(Z,ae);Ae<this._hashSize&&(le=s[(Se+Ae)%this._hashSize],!(le!==-1&&le!==n[le]));Ae++);le=t[le];let ie=le,se;for(;se=n[ie],orient2d(Z,ae,e[2*ie],e[2*ie+1],e[2*se],e[2*se+1])>=0;)if(ie=se,ie===le){ie=-1;break}if(ie===-1)continue;let ce=this._addTriangle(ie,Y,n[ie],-1,-1,i[ie]);i[Y]=this._legalize(ce+2),i[ie]=ce,w++;let ue=n[ie];for(;se=n[ue],orient2d(Z,ae,e[2*ue],e[2*ue+1],e[2*se],e[2*se+1])<0;)ce=this._addTriangle(ue,Y,se,i[Y],-1,i[ue]),i[Y]=this._legalize(ce+2),n[ue]=ue,w--,ue=se;if(ie===le)for(;se=t[ie],orient2d(Z,ae,e[2*se],e[2*se+1],e[2*ie],e[2*ie+1])<0;)ce=this._addTriangle(se,Y,ie,-1,i[ie],i[se]),this._legalize(ce+2),i[se]=ce,n[ie]=ie,w--,ie=se;this._hullStart=t[Y]=ie,n[ie]=t[ue]=Y,n[Y]=ue,s[this._hashKey(Z,ae)]=Y,s[this._hashKey(e[2*ie],e[2*ie+1])]=ie}this.hull=new Uint32Array(w);for(let P=0,K=this._hullStart;P<w;P++)this.hull[P]=K,K=n[K];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,t){return Math.floor(pseudoAngle(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:t,_halfedges:n,coords:i}=this;let s=0,a=0;for(;;){const o=n[e],c=e-e%3;if(a=c+(e+2)%3,o===-1){if(s===0)break;e=EDGE_STACK[--s];continue}const h=o-o%3,f=c+(e+1)%3,m=h+(o+2)%3,g=t[a],_=t[e],E=t[f],A=t[m];if(inCircle(i[2*g],i[2*g+1],i[2*_],i[2*_+1],i[2*E],i[2*E+1],i[2*A],i[2*A+1])){t[e]=A,t[o]=g;const I=n[m];if(I===-1){let R=this._hullStart;do{if(this._hullTri[R]===m){this._hullTri[R]=e;break}R=this._hullPrev[R]}while(R!==this._hullStart)}this._link(e,I),this._link(o,n[a]),this._link(a,m);const b=h+(o+1)%3;s<EDGE_STACK.length&&(EDGE_STACK[s++]=b)}else{if(s===0)break;e=EDGE_STACK[--s]}}return a}_link(e,t){this._halfedges[e]=t,t!==-1&&(this._halfedges[t]=e)}_addTriangle(e,t,n,i,s,a){const o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,i),this._link(o+1,s),this._link(o+2,a),this.trianglesLen+=3,o}}function pseudoAngle(r,e){const t=r/(Math.abs(r)+Math.abs(e));return(e>0?3-t:1+t)/4}function dist(r,e,t,n){const i=r-t,s=e-n;return i*i+s*s}function inCircle(r,e,t,n,i,s,a,o){const c=r-a,h=e-o,f=t-a,m=n-o,g=i-a,_=s-o,E=c*c+h*h,A=f*f+m*m,C=g*g+_*_;return c*(m*C-A*_)-h*(f*C-A*g)+E*(f*_-m*g)<0}function circumradius(r,e,t,n,i,s){const a=t-r,o=n-e,c=i-r,h=s-e,f=a*a+o*o,m=c*c+h*h,g=.5/(a*h-o*c),_=(h*f-o*m)*g,E=(a*m-c*f)*g;return _*_+E*E}function circumcenter(r,e,t,n,i,s){const a=t-r,o=n-e,c=i-r,h=s-e,f=a*a+o*o,m=c*c+h*h,g=.5/(a*h-o*c),_=r+(h*f-o*m)*g,E=e+(a*m-c*f)*g;return{x:_,y:E}}function quicksort(r,e,t,n){if(n-t<=20)for(let i=t+1;i<=n;i++){const s=r[i],a=e[s];let o=i-1;for(;o>=t&&e[r[o]]>a;)r[o+1]=r[o--];r[o+1]=s}else{const i=t+n>>1;let s=t+1,a=n;swap(r,i,s),e[r[t]]>e[r[n]]&&swap(r,t,n),e[r[s]]>e[r[n]]&&swap(r,s,n),e[r[t]]>e[r[s]]&&swap(r,t,s);const o=r[s],c=e[o];for(;;){do s++;while(e[r[s]]<c);do a--;while(e[r[a]]>c);if(a<s)break;swap(r,s,a)}r[t+1]=r[a],r[a]=o,n-s+1>=a-t?(quicksort(r,e,s,n),quicksort(r,e,t,a-1)):(quicksort(r,e,t,a-1),quicksort(r,e,s,n))}}function swap(r,e,t){const n=r[e];r[e]=r[t],r[t]=n}function defaultGetX(r){return r[0]}function defaultGetY(r){return r[1]}const epsilon=1e-6;class Path{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,t){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,t){this._+=`L${this._x1=+e},${this._y1=+t}`}arc(e,t,n){e=+e,t=+t,n=+n;const i=e+n,s=t;if(n<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${s}`:(Math.abs(this._x1-i)>epsilon||Math.abs(this._y1-s)>epsilon)&&(this._+="L"+i+","+s),n&&(this._+=`A${n},${n},0,1,1,${e-n},${t}A${n},${n},0,1,1,${this._x1=i},${this._y1=s}`)}rect(e,t,n,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${+n}v${+i}h${-n}Z`}value(){return this._||null}}class Polygon{constructor(){this._=[]}moveTo(e,t){this._.push([e,t])}closePath(){this._.push(this._[0].slice())}lineTo(e,t){this._.push([e,t])}value(){return this._.length?this._:null}}class Voronoi{constructor(e,[t,n,i,s]=[0,0,960,500]){if(!((i=+i)>=(t=+t))||!((s=+s)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=i,this.xmin=t,this.ymax=s,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:t,triangles:n},vectors:i}=this;let s,a;const o=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let A=0,C=0,I=n.length,b,R;A<I;A+=3,C+=2){const V=n[A]*2,U=n[A+1]*2,W=n[A+2]*2,j=e[V],w=e[V+1],P=e[U],K=e[U+1],X=e[W],Y=e[W+1],Z=P-j,ae=K-w,le=X-j,ie=Y-w,se=(Z*ie-ae*le)*2;if(Math.abs(se)<1e-9){if(s===void 0){s=a=0;for(const ue of t)s+=e[ue*2],a+=e[ue*2+1];s/=t.length,a/=t.length}const ce=1e9*Math.sign((s-j)*ie-(a-w)*le);b=(j+X)/2-ce*ie,R=(w+Y)/2+ce*le}else{const ce=1/se,ue=Z*Z+ae*ae,Ae=le*le+ie*ie;b=j+(ie*ue-ae*Ae)*ce,R=w+(Z*Ae-le*ue)*ce}o[C]=b,o[C+1]=R}let c=t[t.length-1],h,f=c*4,m,g=e[2*c],_,E=e[2*c+1];i.fill(0);for(let A=0;A<t.length;++A)c=t[A],h=f,m=g,_=E,f=c*4,g=e[2*c],E=e[2*c+1],i[h+2]=i[f]=_-E,i[h+3]=i[f+1]=g-m}render(e){const t=e==null?e=new Path:void 0,{delaunay:{halfedges:n,inedges:i,hull:s},circumcenters:a,vectors:o}=this;if(s.length<=1)return null;for(let f=0,m=n.length;f<m;++f){const g=n[f];if(g<f)continue;const _=Math.floor(f/3)*2,E=Math.floor(g/3)*2,A=a[_],C=a[_+1],I=a[E],b=a[E+1];this._renderSegment(A,C,I,b,e)}let c,h=s[s.length-1];for(let f=0;f<s.length;++f){c=h,h=s[f];const m=Math.floor(i[h]/3)*2,g=a[m],_=a[m+1],E=c*4,A=this._project(g,_,o[E+2],o[E+3]);A&&this._renderSegment(g,_,A[0],A[1],e)}return t&&t.value()}renderBounds(e){const t=e==null?e=new Path:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}renderCell(e,t){const n=t==null?t=new Path:void 0,i=this._clip(e);if(i===null||!i.length)return;t.moveTo(i[0],i[1]);let s=i.length;for(;i[0]===i[s-2]&&i[1]===i[s-1]&&s>1;)s-=2;for(let a=2;a<s;a+=2)(i[a]!==i[a-2]||i[a+1]!==i[a-1])&&t.lineTo(i[a],i[a+1]);return t.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let t=0,n=e.length/2;t<n;++t){const i=this.cellPolygon(t);i&&(i.index=t,yield i)}}cellPolygon(e){const t=new Polygon;return this.renderCell(e,t),t.value()}_renderSegment(e,t,n,i,s){let a;const o=this._regioncode(e,t),c=this._regioncode(n,i);o===0&&c===0?(s.moveTo(e,t),s.lineTo(n,i)):(a=this._clipSegment(e,t,n,i,o,c))&&(s.moveTo(a[0],a[1]),s.lineTo(a[2],a[3]))}contains(e,t,n){return t=+t,t!==t||(n=+n,n!==n)?!1:this.delaunay._step(e,t,n)===e}*neighbors(e){const t=this._clip(e);if(t)for(const n of this.delaunay.neighbors(e)){const i=this._clip(n);if(i){e:for(let s=0,a=t.length;s<a;s+=2)for(let o=0,c=i.length;o<c;o+=2)if(t[s]===i[o]&&t[s+1]===i[o+1]&&t[(s+2)%a]===i[(o+c-2)%c]&&t[(s+3)%a]===i[(o+c-1)%c]){yield n;break e}}}}_cell(e){const{circumcenters:t,delaunay:{inedges:n,halfedges:i,triangles:s}}=this,a=n[e];if(a===-1)return null;const o=[];let c=a;do{const h=Math.floor(c/3);if(o.push(t[h*2],t[h*2+1]),c=c%3===2?c-2:c+1,s[c]!==e)break;c=i[c]}while(c!==a&&c!==-1);return o}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const t=this._cell(e);if(t===null)return null;const{vectors:n}=this,i=e*4;return this._simplify(n[i]||n[i+1]?this._clipInfinite(e,t,n[i],n[i+1],n[i+2],n[i+3]):this._clipFinite(e,t))}_clipFinite(e,t){const n=t.length;let i=null,s,a,o=t[n-2],c=t[n-1],h,f=this._regioncode(o,c),m,g=0;for(let _=0;_<n;_+=2)if(s=o,a=c,o=t[_],c=t[_+1],h=f,f=this._regioncode(o,c),h===0&&f===0)m=g,g=0,i?i.push(o,c):i=[o,c];else{let E,A,C,I,b;if(h===0){if((E=this._clipSegment(s,a,o,c,h,f))===null)continue;[A,C,I,b]=E}else{if((E=this._clipSegment(o,c,s,a,f,h))===null)continue;[I,b,A,C]=E,m=g,g=this._edgecode(A,C),m&&g&&this._edge(e,m,g,i,i.length),i?i.push(A,C):i=[A,C]}m=g,g=this._edgecode(I,b),m&&g&&this._edge(e,m,g,i,i.length),i?i.push(I,b):i=[I,b]}if(i)m=g,g=this._edgecode(i[0],i[1]),m&&g&&this._edge(e,m,g,i,i.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(e,t,n,i,s,a){const o=s<a;for(o&&([e,t,n,i,s,a]=[n,i,e,t,a,s]);;){if(s===0&&a===0)return o?[n,i,e,t]:[e,t,n,i];if(s&a)return null;let c,h,f=s||a;f&8?(c=e+(n-e)*(this.ymax-t)/(i-t),h=this.ymax):f&4?(c=e+(n-e)*(this.ymin-t)/(i-t),h=this.ymin):f&2?(h=t+(i-t)*(this.xmax-e)/(n-e),c=this.xmax):(h=t+(i-t)*(this.xmin-e)/(n-e),c=this.xmin),s?(e=c,t=h,s=this._regioncode(e,t)):(n=c,i=h,a=this._regioncode(n,i))}}_clipInfinite(e,t,n,i,s,a){let o=Array.from(t),c;if((c=this._project(o[0],o[1],n,i))&&o.unshift(c[0],c[1]),(c=this._project(o[o.length-2],o[o.length-1],s,a))&&o.push(c[0],c[1]),o=this._clipFinite(e,o))for(let h=0,f=o.length,m,g=this._edgecode(o[f-2],o[f-1]);h<f;h+=2)m=g,g=this._edgecode(o[h],o[h+1]),m&&g&&(h=this._edge(e,m,g,o,h),f=o.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return o}_edge(e,t,n,i,s){for(;t!==n;){let a,o;switch(t){case 5:t=4;continue;case 4:t=6,a=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,a=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,a=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,a=this.xmin,o=this.ymin;break}(i[s]!==a||i[s+1]!==o)&&this.contains(e,a,o)&&(i.splice(s,0,a,o),s+=2)}return s}_project(e,t,n,i){let s=1/0,a,o,c;if(i<0){if(t<=this.ymin)return null;(a=(this.ymin-t)/i)<s&&(c=this.ymin,o=e+(s=a)*n)}else if(i>0){if(t>=this.ymax)return null;(a=(this.ymax-t)/i)<s&&(c=this.ymax,o=e+(s=a)*n)}if(n>0){if(e>=this.xmax)return null;(a=(this.xmax-e)/n)<s&&(o=this.xmax,c=t+(s=a)*i)}else if(n<0){if(e<=this.xmin)return null;(a=(this.xmin-e)/n)<s&&(o=this.xmin,c=t+(s=a)*i)}return[o,c]}_edgecode(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}_regioncode(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let t=0;t<e.length;t+=2){const n=(t+2)%e.length,i=(t+4)%e.length;(e[t]===e[n]&&e[n]===e[i]||e[t+1]===e[n+1]&&e[n+1]===e[i+1])&&(e.splice(n,2),t-=2)}e.length||(e=null)}return e}}const tau=2*Math.PI,pow=Math.pow;function pointX(r){return r[0]}function pointY(r){return r[1]}function collinear(r){const{triangles:e,coords:t}=r;for(let n=0;n<e.length;n+=3){const i=2*e[n],s=2*e[n+1],a=2*e[n+2];if((t[a]-t[i])*(t[s+1]-t[i+1])-(t[s]-t[i])*(t[a+1]-t[i+1])>1e-10)return!1}return!0}function jitter(r,e,t){return[r+Math.sin(r+e)*t,e+Math.cos(r-e)*t]}class Delaunay{static from(e,t=pointX,n=pointY,i){return new Delaunay("length"in e?flatArray(e,t,n,i):Float64Array.from(flatIterable(e,t,n,i)))}constructor(e){this._delaunator=new Delaunator(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&collinear(e)){this.collinear=Int32Array.from({length:t.length/2},(g,_)=>_).sort((g,_)=>t[2*g]-t[2*_]||t[2*g+1]-t[2*_+1]);const c=this.collinear[0],h=this.collinear[this.collinear.length-1],f=[t[2*c],t[2*c+1],t[2*h],t[2*h+1]],m=1e-8*Math.hypot(f[3]-f[1],f[2]-f[0]);for(let g=0,_=t.length/2;g<_;++g){const E=jitter(t[2*g],t[2*g+1],m);t[2*g]=E[0],t[2*g+1]=E[1]}this._delaunator=new Delaunator(t)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,a=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let c=0,h=n.length;c<h;++c){const f=s[c%3===2?c-2:c+1];(n[c]===-1||a[f]===-1)&&(a[f]=c)}for(let c=0,h=i.length;c<h;++c)o[i[c]]=c;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],a[i[0]]=1,i.length===2&&(a[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(e){return new Voronoi(this,e)}*neighbors(e){const{inedges:t,hull:n,_hullIndex:i,halfedges:s,triangles:a,collinear:o}=this;if(o){const m=o.indexOf(e);m>0&&(yield o[m-1]),m<o.length-1&&(yield o[m+1]);return}const c=t[e];if(c===-1)return;let h=c,f=-1;do{if(yield f=a[h],h=h%3===2?h-2:h+1,a[h]!==e)return;if(h=s[h],h===-1){const m=n[(i[e]+1)%n.length];m!==f&&(yield m);return}}while(h!==c)}find(e,t,n=0){if(e=+e,e!==e||(t=+t,t!==t))return-1;const i=n;let s;for(;(s=this._step(n,e,t))>=0&&s!==n&&s!==i;)n=s;return s}_step(e,t,n){const{inedges:i,hull:s,_hullIndex:a,halfedges:o,triangles:c,points:h}=this;if(i[e]===-1||!h.length)return(e+1)%(h.length>>1);let f=e,m=pow(t-h[e*2],2)+pow(n-h[e*2+1],2);const g=i[e];let _=g;do{let E=c[_];const A=pow(t-h[E*2],2)+pow(n-h[E*2+1],2);if(A<m&&(m=A,f=E),_=_%3===2?_-2:_+1,c[_]!==e)break;if(_=o[_],_===-1){if(_=s[(a[e]+1)%s.length],_!==E&&pow(t-h[_*2],2)+pow(n-h[_*2+1],2)<m)return _;break}}while(_!==g);return f}render(e){const t=e==null?e=new Path:void 0,{points:n,halfedges:i,triangles:s}=this;for(let a=0,o=i.length;a<o;++a){const c=i[a];if(c<a)continue;const h=s[a]*2,f=s[c]*2;e.moveTo(n[h],n[h+1]),e.lineTo(n[f],n[f+1])}return this.renderHull(e),t&&t.value()}renderPoints(e,t){t===void 0&&(!e||typeof e.moveTo!="function")&&(t=e,e=null),t=t==null?2:+t;const n=e==null?e=new Path:void 0,{points:i}=this;for(let s=0,a=i.length;s<a;s+=2){const o=i[s],c=i[s+1];e.moveTo(o+t,c),e.arc(o,c,t,0,tau)}return n&&n.value()}renderHull(e){const t=e==null?e=new Path:void 0,{hull:n,points:i}=this,s=n[0]*2,a=n.length;e.moveTo(i[s],i[s+1]);for(let o=1;o<a;++o){const c=2*n[o];e.lineTo(i[c],i[c+1])}return e.closePath(),t&&t.value()}hullPolygon(){const e=new Polygon;return this.renderHull(e),e.value()}renderTriangle(e,t){const n=t==null?t=new Path:void 0,{points:i,triangles:s}=this,a=s[e*=3]*2,o=s[e+1]*2,c=s[e+2]*2;return t.moveTo(i[a],i[a+1]),t.lineTo(i[o],i[o+1]),t.lineTo(i[c],i[c+1]),t.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:e}=this;for(let t=0,n=e.length/3;t<n;++t)yield this.trianglePolygon(t)}trianglePolygon(e){const t=new Polygon;return this.renderTriangle(e,t),t.value()}}function flatArray(r,e,t,n){const i=r.length,s=new Float64Array(i*2);for(let a=0;a<i;++a){const o=r[a];s[a*2]=e.call(n,o,a,r),s[a*2+1]=t.call(n,o,a,r)}return s}function*flatIterable(r,e,t,n){let i=0;for(const s of r)yield e.call(n,s,i,r),yield t.call(n,s,i,r),++i}const useChartVoronoi=({svgRef:r,params:e,store:t,instance:n})=>{var W;const{disableVoronoi:i,voronoiMaxRadius:s,onItemClick:a}=e,o=useSelector(t,selectorChartDrawingArea),{axis:c,axisIds:h}=useSelector(t,selectorChartXAxis),{axis:f,axisIds:m}=useSelector(t,selectorChartYAxis),g=useSelector(t,selectorChartZoomIsInteracting),{series:_,seriesOrder:E}=((W=useSelector(t,selectorChartSeriesProcessed))==null?void 0:W.scatter)??{},A=reactExports.useRef({}),C=reactExports.useRef(void 0),I=reactExports.useRef(void 0),b=h[0],R=m[0];useEnhancedEffect(()=>{t.update(j=>j.voronoi.isVoronoiEnabled===!i?j:_extends({},j,{voronoi:{isVoronoiEnabled:!i}}))},[t,i]),useEnhancedEffect(()=>{if(g||E===void 0||_===void 0||i)return;A.current={};let j=[];E.forEach(w=>{const{data:P,xAxisId:K,yAxisId:X}=_[w],Y=c[K??b].scale,Z=f[X??R].scale,ae=getValueToPositionMapper(Y),le=getValueToPositionMapper(Z),ie=[],se=[];for(let ce=0;ce<P.length;ce+=1){const{x:ue,y:Ae}=P[ce],Se=ae(ue),ye=le(Ae);n.isPointInside(Se,ye)&&(ie.push(Se),ie.push(ye),se.push(ce))}A.current[w]={seriesId:w,seriesIndexes:se,startIndex:j.length,endIndex:j.length+ie.length},j=j.concat(ie)}),C.current=new Delaunay(j),I.current=void 0},[g,b,R,_,E,c,f,o,n,i]),reactExports.useEffect(()=>{if(r.current===null||i)return;const j=r.current;function w(se){const ce=getSVGPoint(j,se);if(!n.isPointInside(ce.x,ce.y))return I.current=void 0,"outside-chart";if(!C.current)return"no-point-found";const ue=C.current.find(ce.x,ce.y,I.current);if(ue===void 0)return"no-point-found";I.current=ue;const Ae=Object.values(A.current).find(he=>2*ue>=he.startIndex&&2*ue<he.endIndex);if(Ae===void 0)return"no-point-found";const Se=(2*ue-A.current[Ae.seriesId].startIndex)/2,ye=A.current[Ae.seriesId].seriesIndexes[Se];if(s!==void 0){const he=C.current.points[2*ue],ke=C.current.points[2*ue+1];if((he-ce.x)**2+(ke-ce.y)**2>s**2)return"outside-voronoi-max-radius"}return{seriesId:Ae.seriesId,dataIndex:ye}}const P=n.addInteractionListener("moveEnd",se=>{var ce,ue;se.detail.activeGestures.pan||((ce=n.cleanInteraction)==null||ce.call(n),(ue=n.clearHighlight)==null||ue.call(n))}),K=n.addInteractionListener("panEnd",se=>{var ce,ue;se.detail.activeGestures.move||((ce=n.cleanInteraction)==null||ce.call(n),(ue=n.clearHighlight)==null||ue.call(n))}),X=n.addInteractionListener("quickPressEnd",se=>{var ce,ue;!se.detail.activeGestures.move&&!se.detail.activeGestures.pan&&((ce=n.cleanInteraction)==null||ce.call(n),(ue=n.clearHighlight)==null||ue.call(n))}),Y=se=>{var Se,ye,he,ke,Pe,Le;const ce=w(se.detail.srcEvent);if(ce==="outside-chart"){(Se=n.cleanInteraction)==null||Se.call(n),(ye=n.clearHighlight)==null||ye.call(n);return}if(ce==="outside-voronoi-max-radius"||ce==="no-point-found"){(he=n.removeItemInteraction)==null||he.call(n),(ke=n.clearHighlight)==null||ke.call(n);return}const{seriesId:ue,dataIndex:Ae}=ce;(Pe=n.setItemInteraction)==null||Pe.call(n,{type:"scatter",seriesId:ue,dataIndex:Ae}),(Le=n.setHighlight)==null||Le.call(n,{seriesId:ue,dataIndex:Ae})},Z=n.addInteractionListener("tap",se=>{const ce=w(se.detail.srcEvent);if(typeof ce!="string"&&a){const{seriesId:ue,dataIndex:Ae}=ce;a(se.detail.srcEvent,{type:"scatter",seriesId:ue,dataIndex:Ae})}}),ae=n.addInteractionListener("move",Y),le=n.addInteractionListener("pan",Y),ie=n.addInteractionListener("quickPress",Y);return()=>{Z.cleanup(),ae.cleanup(),P.cleanup(),le.cleanup(),K.cleanup(),ie.cleanup(),X.cleanup()}},[r,f,c,s,a,i,o,n]);const V=useEventCallback(()=>{t.update(j=>_extends({},j,{voronoi:_extends({},j.voronoi,{isVoronoiEnabled:!0})}))}),U=useEventCallback(()=>{t.update(j=>_extends({},j,{voronoi:_extends({},j.voronoi,{isVoronoiEnabled:!1})}))});return{instance:{enableVoronoi:V,disableVoronoi:U}}};useChartVoronoi.getDefaultizedParams=({params:r})=>_extends({},r,{disableVoronoi:r.disableVoronoi??!r.series.some(e=>e.type==="scatter")});useChartVoronoi.getInitialState=r=>({voronoi:{isVoronoiEnabled:!r.disableVoronoi}});useChartVoronoi.params={disableVoronoi:!0,voronoiMaxRadius:!0,onItemClick:!0};const DEFAULT_PLUGINS=[useChartZAxis,useChartCartesianAxis,useChartInteraction,useChartHighlight,useChartVoronoi],_excluded$7=["children","localeText","plugins","seriesConfig","slots","slotProps"],useChartDataProviderProps=r=>{const e=useThemeProps({props:r,name:"MuiChartDataProvider"}),{children:t,localeText:n,plugins:i=DEFAULT_PLUGINS,seriesConfig:s,slots:a,slotProps:o}=e,c=_objectWithoutPropertiesLoose(e,_excluded$7),h=useTheme(),f={plugins:i,seriesConfig:s,pluginParams:_extends({theme:h.palette.mode},c)};return{children:t,localeText:n,chartProviderProps:f,slots:a,slotProps:o}};function ChartDataProvider(r){const{children:e,localeText:t,chartProviderProps:n,slots:i,slotProps:s}=useChartDataProviderProps(r);return jsxRuntimeExports.jsx(ChartProvider,_extends({},n,{children:jsxRuntimeExports.jsx(ChartsLocalizationProvider,{localeText:t,children:jsxRuntimeExports.jsx(ChartsSlotsProvider,{slots:i,slotProps:s,defaultSlots:defaultSlotsMaterial,children:e})})}))}function ChartsPiecewiseGradient(r){const{isReversed:e,gradientId:t,size:n,direction:i,scale:s,colorMap:a}=r;return n<=0?null:jsxRuntimeExports.jsx("linearGradient",{id:t,x1:"0",x2:"0",y1:"0",y2:"0",[`${i}${e?1:2}`]:`${n}px`,gradientUnits:"userSpaceOnUse",children:a.thresholds.map((o,c)=>{const h=s(o);if(h===void 0)return null;const f=e?1-h/n:h/n;return Number.isNaN(f)?null:jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("stop",{offset:f,stopColor:a.colors[c],stopOpacity:1}),jsxRuntimeExports.jsx("stop",{offset:f,stopColor:a.colors[c+1],stopOpacity:1})]},o.toString()+c)})})}const PX_PRECISION$1=10;function ChartsContinuousGradient(r){const{gradientUnits:e,isReversed:t,gradientId:n,size:i,direction:s,scale:a,colorScale:o,colorMap:c}=r,h=[c.min??0,c.max??100],f=h.map(a).filter(E=>E!==void 0);if(f.length!==2)return null;const m=typeof h[0]=="number"?interpolateNumber(h[0],h[1]):interpolateDate(h[0],h[1]),g=Math.round((Math.max(...f)-Math.min(...f))/PX_PRECISION$1),_=`${h[0]}-${h[1]}-`;return jsxRuntimeExports.jsx("linearGradient",{id:n,x1:"0",x2:"0",y1:"0",y2:"0",[`${s}${t?1:2}`]:e==="objectBoundingBox"?1:`${i}px`,gradientUnits:e??"userSpaceOnUse",children:Array.from({length:g+1},(E,A)=>{const C=m(A/g);if(C===void 0)return null;const I=a(C);if(I===void 0)return null;const b=t?1-I/i:I/i,R=o(C);return R===null?null:jsxRuntimeExports.jsx("stop",{offset:b,stopColor:R,stopOpacity:1},_+A)})})}const PX_PRECISION=10,getDirection$1=r=>r?{x1:"1",x2:"0",y1:"0",y2:"0"}:{x1:"0",x2:"1",y1:"0",y2:"0"};function ChartsContinuousGradientObjectBound(r){const{isReversed:e,gradientId:t,colorScale:n,colorMap:i}=r,s=[i.min??0,i.max??100],a=typeof s[0]=="number"?interpolateNumber(s[0],s[1]):interpolateDate(s[0],s[1]),o=PX_PRECISION,c=`${s[0]}-${s[1]}-`;return jsxRuntimeExports.jsx("linearGradient",_extends({id:t},getDirection$1(e),{gradientUnits:"objectBoundingBox",children:Array.from({length:o+1},(h,f)=>{const m=f/o,g=a(m);if(g===void 0)return null;const _=n(g);return _===null?null:jsxRuntimeExports.jsx("stop",{offset:m,stopColor:_,stopOpacity:1},c+f)})}))}function ChartsAxesGradients(){const{top:r,height:e,bottom:t,left:n,width:i,right:s}=useDrawingArea(),a=r+e+t,o=n+i+s,c=useChartGradientIdBuilder(),h=useChartGradientIdObjectBoundBuilder(),{xAxis:f,xAxisIds:m}=useXAxes(),{yAxis:g,yAxisIds:_}=useYAxes(),{zAxis:E,zAxisIds:A}=useZAxes(),C=_.filter(R=>g[R].colorMap!==void 0),I=m.filter(R=>f[R].colorMap!==void 0),b=A.filter(R=>E[R].colorMap!==void 0);return C.length===0&&I.length===0&&b.length===0?null:jsxRuntimeExports.jsxs("defs",{children:[C.map(R=>{const V=c(R),U=h(R),{colorMap:W,scale:j,colorScale:w,reverse:P}=g[R];return(W==null?void 0:W.type)==="piecewise"?jsxRuntimeExports.jsx(ChartsPiecewiseGradient,{isReversed:!P,scale:j,colorMap:W,size:a,gradientId:V,direction:"y"},V):(W==null?void 0:W.type)==="continuous"?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(ChartsContinuousGradient,{isReversed:!P,scale:j,colorScale:w,colorMap:W,size:a,gradientId:V,direction:"y"}),jsxRuntimeExports.jsx(ChartsContinuousGradientObjectBound,{isReversed:P,colorScale:w,colorMap:W,gradientId:U})]},V):null}),I.map(R=>{const V=c(R),U=h(R),{colorMap:W,scale:j,reverse:w,colorScale:P}=f[R];return(W==null?void 0:W.type)==="piecewise"?jsxRuntimeExports.jsx(ChartsPiecewiseGradient,{isReversed:w,scale:j,colorMap:W,size:o,gradientId:V,direction:"x"},V):(W==null?void 0:W.type)==="continuous"?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(ChartsContinuousGradient,{isReversed:w,scale:j,colorScale:P,colorMap:W,size:o,gradientId:V,direction:"x"}),jsxRuntimeExports.jsx(ChartsContinuousGradientObjectBound,{isReversed:w,colorScale:P,colorMap:W,gradientId:U})]},V):null}),b.map(R=>{const V=h(R),{colorMap:U,colorScale:W}=E[R];return(U==null?void 0:U.type)==="continuous"?jsxRuntimeExports.jsx(ChartsContinuousGradientObjectBound,{colorScale:W,colorMap:U,gradientId:V},V):null})]})}const _excluded$6=["children","className","title","desc"],ChartsSurfaceStyles=styled("svg",{name:"MuiChartsSurface",slot:"Root"})(({ownerState:r})=>({width:r.width??"100%",height:r.height??"100%",display:"flex",position:"relative",flexDirection:"column",alignItems:"center",justifyContent:"center",overflow:"hidden",touchAction:"pan-y",userSelect:"none"})),ChartsSurface=reactExports.forwardRef(function r(e,t){const n=useStore(),{width:i,height:s}=useSelector(n,selectorChartContainerSize),{width:a,height:o}=useSelector(n,selectorChartPropsSize),c=useSvgRef(),h=useForkRef(c,t),f=useThemeProps({props:e,name:"MuiChartsSurface"}),{children:m,className:g,title:_,desc:E}=f,A=_objectWithoutPropertiesLoose(f,_excluded$6),C=s>0&&i>0;return jsxRuntimeExports.jsxs(ChartsSurfaceStyles,_extends({ownerState:{width:a,height:o},viewBox:`0 0 ${i} ${s}`,className:g},A,{ref:h,children:[_&&jsxRuntimeExports.jsx("title",{children:_}),E&&jsxRuntimeExports.jsx("desc",{children:E}),jsxRuntimeExports.jsx(ChartsAxesGradients,{}),C&&m]}))}),_excluded$5=["width","height","margin","children","series","colors","dataset","desc","onAxisClick","highlightedAxis","onHighlightedAxisChange","disableVoronoi","voronoiMaxRadius","onItemClick","disableAxisListener","highlightedItem","onHighlightChange","sx","title","xAxis","yAxis","zAxis","rotationAxis","radiusAxis","skipAnimation","seriesConfig","plugins","localeText","slots","slotProps","experimentalFeatures"],useChartContainerProps=(r,e)=>{const t=r,{width:n,height:i,margin:s,children:a,series:o,colors:c,dataset:h,desc:f,onAxisClick:m,highlightedAxis:g,onHighlightedAxisChange:_,disableVoronoi:E,voronoiMaxRadius:A,onItemClick:C,disableAxisListener:I,highlightedItem:b,onHighlightChange:R,sx:V,title:U,xAxis:W,yAxis:j,zAxis:w,rotationAxis:P,radiusAxis:K,skipAnimation:X,seriesConfig:Y,plugins:Z,localeText:ae,slots:le,slotProps:ie,experimentalFeatures:se}=t,ce=_objectWithoutPropertiesLoose(t,_excluded$5),ue=_extends({title:U,desc:f,sx:V,ref:e},ce);return{chartDataProviderProps:{margin:s,series:o,colors:c,dataset:h,disableAxisListener:I,highlightedItem:b,onHighlightChange:R,onAxisClick:m,highlightedAxis:g,onHighlightedAxisChange:_,disableVoronoi:E,voronoiMaxRadius:A,onItemClick:C,xAxis:W,yAxis:j,zAxis:w,rotationAxis:P,radiusAxis:K,skipAnimation:X,width:n,height:i,localeText:ae,seriesConfig:Y,experimentalFeatures:se,plugins:Z??DEFAULT_PLUGINS,slots:le,slotProps:ie},chartsSurfaceProps:ue,children:a}},getDirection=(r,e)=>r==="vertical"?(e==null?void 0:e.horizontal)==="start"?"row":"row-reverse":(e==null?void 0:e.vertical)==="bottom"?"column-reverse":"column",getAlign=(r,e)=>{if(r==="vertical"){if((e==null?void 0:e.vertical)==="top")return"flex-start";if((e==null?void 0:e.vertical)==="bottom")return"flex-end"}if(r==="horizontal"){if((e==null?void 0:e.horizontal)==="start")return"flex-start";if((e==null?void 0:e.horizontal)==="end")return"flex-end"}return"center"},Root=styled("div",{name:"MuiChartsWrapper",slot:"Root",shouldForwardProp:r=>shouldForwardProp(r)&&r!=="extendVertically"})(({ownerState:r})=>({display:"flex",flexDirection:getDirection(r.legendDirection,r.legendPosition),flex:1,justifyContent:"center",alignItems:getAlign(r.legendDirection,r.legendPosition),variants:[{props:{extendVertically:!0},style:{height:"100%"}}]}));function ChartsWrapper(r){const{children:e,sx:t,extendVertically:n}=r,i=useChartRootRef(),s=useStore(),{height:a}=useSelector(s,selectorChartPropsSize);return jsxRuntimeExports.jsx(Root,{ref:i,ownerState:r,sx:t,extendVertically:n??a===void 0,children:e})}const BarChart=reactExports.forwardRef(function r(e,t){var R,V,U,W;const n=useThemeProps({props:e,name:"MuiBarChart"}),{chartsWrapperProps:i,chartContainerProps:s,barPlotProps:a,gridProps:o,clipPathProps:c,clipPathGroupProps:h,overlayProps:f,chartsAxisProps:m,axisHighlightProps:g,legendProps:_,children:E}=useBarChartProps(n),{chartDataProviderProps:A,chartsSurfaceProps:C}=useChartContainerProps(s,t),I=((R=n.slots)==null?void 0:R.tooltip)??ChartsTooltip,b=(V=n.slots)==null?void 0:V.toolbar;return jsxRuntimeExports.jsx(ChartDataProvider,_extends({},A,{children:jsxRuntimeExports.jsxs(ChartsWrapper,_extends({},i,{children:[n.showToolbar&&b?jsxRuntimeExports.jsx(b,_extends({},(U=n.slotProps)==null?void 0:U.toolbar)):null,!n.hideLegend&&jsxRuntimeExports.jsx(ChartsLegend,_extends({},_)),jsxRuntimeExports.jsxs(ChartsSurface,_extends({},C,{children:[jsxRuntimeExports.jsx(ChartsGrid,_extends({},o)),jsxRuntimeExports.jsxs("g",_extends({},h,{children:[jsxRuntimeExports.jsx(BarPlot,_extends({},a)),jsxRuntimeExports.jsx(ChartsOverlay,_extends({},f)),jsxRuntimeExports.jsx(ChartsAxisHighlight,_extends({},g))]})),jsxRuntimeExports.jsx(ChartsAxis,_extends({},m)),jsxRuntimeExports.jsx(ChartsClipPath,_extends({},c)),E]})),!n.loading&&jsxRuntimeExports.jsx(I,_extends({},(W=n.slotProps)==null?void 0:W.tooltip))]}))}))}),_excluded$4=["classes","color","dataIndex","id","isFaded","isHighlighted","onClick","cornerRadius","startAngle","endAngle","innerRadius","outerRadius","paddingAngle","skipAnimation"];function getPieArcUtilityClass(r){return generateUtilityClass("MuiPieArc",r)}generateUtilityClasses("MuiPieArc",["root","highlighted","faded","series"]);const useUtilityClasses$2=r=>{const{classes:e,id:t,isFaded:n,isHighlighted:i,dataIndex:s}=r,a={root:["root",`series-${t}`,`data-index-${s}`,i&&"highlighted",n&&"faded"]};return composeClasses(a,getPieArcUtilityClass,e)},PieArcRoot=styled("path",{name:"MuiPieArc",slot:"Root",overridesResolver:(r,e)=>e.arc})(({theme:r})=>({stroke:(r.vars||r).palette.background.paper,transitionProperty:"opacity, fill, filter",transitionDuration:`${ANIMATION_DURATION_MS}ms`,transitionTimingFunction:ANIMATION_TIMING_FUNCTION})),PieArc=reactExports.forwardRef(function r(e,t){const{classes:n,color:i,dataIndex:s,id:a,isFaded:o,isHighlighted:c,onClick:h,cornerRadius:f,startAngle:m,endAngle:g,innerRadius:_,outerRadius:E,paddingAngle:A,skipAnimation:C}=e,I=_objectWithoutPropertiesLoose(e,_excluded$4),b={id:a,dataIndex:s,classes:n,color:i,isFaded:o,isHighlighted:c},R=useUtilityClasses$2(b),V=useInteractionItemProps({type:"pie",seriesId:a,dataIndex:s}),U=useAnimatePieArc({cornerRadius:f,startAngle:m,endAngle:g,innerRadius:_,outerRadius:E,paddingAngle:A,skipAnimation:C,ref:t});return jsxRuntimeExports.jsx(PieArcRoot,_extends({onClick:h,cursor:h?"pointer":"unset",ownerState:b,className:R.root,fill:b.color,opacity:b.isFaded?.3:1,filter:b.isHighlighted?"brightness(120%)":"none",strokeWidth:1,strokeLinejoin:"round","data-highlighted":b.isHighlighted||void 0,"data-faded":b.isFaded||void 0},I,V,U))});function useTransformData(r){const{id:e,data:t,faded:n,highlighted:i,paddingAngle:s=0,innerRadius:a=0,arcLabelRadius:o,outerRadius:c,cornerRadius:h=0}=r,{isFaded:f,isHighlighted:m}=useItemHighlightedGetter();return reactExports.useMemo(()=>t.map((_,E)=>{const A={seriesId:e,dataIndex:E},C=m(A),I=!C&&f(A),b=_extends({additionalRadius:0},I&&n||C&&i||{}),R=Math.max(0,deg2rad(b.paddingAngle??s)),V=Math.max(0,b.innerRadius??a),U=Math.max(0,b.outerRadius??c+b.additionalRadius),W=b.cornerRadius??h,j=b.arcLabelRadius??o??(V+U)/2;return _extends({},_,b,{dataIndex:E,isFaded:I,isHighlighted:C,paddingAngle:R,innerRadius:V,outerRadius:U,cornerRadius:W,arcLabelRadius:j})}),[h,a,c,s,o,t,n,i,f,m,e])}const _excluded$3=["slots","slotProps","innerRadius","outerRadius","cornerRadius","paddingAngle","id","highlighted","faded","data","onItemClick","skipAnimation"];function PieArcPlot(r){const{slots:e,slotProps:t,innerRadius:n=0,outerRadius:i,cornerRadius:s=0,paddingAngle:a=0,id:o,highlighted:c,faded:h={additionalRadius:-5},data:f,onItemClick:m,skipAnimation:g}=r,_=_objectWithoutPropertiesLoose(r,_excluded$3),E=useTransformData({innerRadius:n,outerRadius:i,cornerRadius:s,paddingAngle:a,id:o,highlighted:c,faded:h,data:f});if(f.length===0)return null;const A=(e==null?void 0:e.pieArc)??PieArc;return jsxRuntimeExports.jsx("g",_extends({},_,{children:E.map((C,I)=>jsxRuntimeExports.jsx(A,_extends({startAngle:C.startAngle,endAngle:C.endAngle,paddingAngle:C.paddingAngle,innerRadius:C.innerRadius,outerRadius:C.outerRadius,cornerRadius:C.cornerRadius,skipAnimation:g??!1,id:o,color:C.color,dataIndex:I,isFaded:C.isFaded,isHighlighted:C.isHighlighted,onClick:m&&(b=>{m(b,{type:"pie",seriesId:o,dataIndex:I},C)})},t==null?void 0:t.pieArc),C.dataIndex))}))}const _excluded$2=["id","classes","color","startAngle","endAngle","paddingAngle","arcLabelRadius","innerRadius","outerRadius","cornerRadius","formattedArcLabel","isHighlighted","isFaded","style","skipAnimation"];function getPieArcLabelUtilityClass(r){return generateUtilityClass("MuiPieArcLabel",r)}const pieArcLabelClasses=generateUtilityClasses("MuiPieArcLabel",["root","highlighted","faded","animate","series"]),useUtilityClasses$1=r=>{const{classes:e,id:t,isFaded:n,isHighlighted:i,skipAnimation:s}=r,a={root:["root",`series-${t}`,i&&"highlighted",n&&"faded",!s&&"animate"]};return composeClasses(a,getPieArcLabelUtilityClass,e)},PieArcLabelRoot=styled("text",{name:"MuiPieArcLabel",slot:"Root"})(({theme:r})=>({fill:(r.vars||r).palette.text.primary,textAnchor:"middle",dominantBaseline:"middle",pointerEvents:"none",animationName:"animate-opacity",animationDuration:"0s",animationTimingFunction:ANIMATION_TIMING_FUNCTION,[`&.${pieArcLabelClasses.animate}`]:{animationDuration:`${ANIMATION_DURATION_MS}ms`},"@keyframes animate-opacity":{from:{opacity:0}}})),PieArcLabel=reactExports.forwardRef(function r(e,t){const{id:n,classes:i,color:s,startAngle:a,endAngle:o,paddingAngle:c,arcLabelRadius:h,cornerRadius:f,formattedArcLabel:m,isHighlighted:g,isFaded:_,skipAnimation:E}=e,A=_objectWithoutPropertiesLoose(e,_excluded$2),I=useUtilityClasses$1({id:n,classes:i,isFaded:_,isHighlighted:g,skipAnimation:E}),b=useAnimatePieArcLabel({cornerRadius:f,startAngle:a,endAngle:o,innerRadius:h,outerRadius:h,paddingAngle:c,skipAnimation:E,ref:t});return jsxRuntimeExports.jsx(PieArcLabelRoot,_extends({className:I.root},A,b,{children:m}))}),_excluded$1=["arcLabel","arcLabelMinAngle","arcLabelRadius","cornerRadius","data","faded","highlighted","id","innerRadius","outerRadius","paddingAngle","skipAnimation","slotProps","slots"],RATIO=180/Math.PI;function getItemLabel(r,e,t){var i;if(!r||(t.endAngle-t.startAngle)*RATIO<e)return null;switch(r){case"label":return getLabel(t.label,"arc");case"value":return(i=t.value)==null?void 0:i.toString();case"formattedValue":return t.formattedValue;default:return r(_extends({},t,{label:getLabel(t.label,"arc")}))}}function PieArcLabelPlot(r){const{arcLabel:e,arcLabelMinAngle:t=0,arcLabelRadius:n,cornerRadius:i=0,data:s,faded:a={additionalRadius:-5},highlighted:o,id:c,innerRadius:h,outerRadius:f,paddingAngle:m=0,skipAnimation:g,slotProps:_,slots:E}=r,A=_objectWithoutPropertiesLoose(r,_excluded$1),C=useTransformData({innerRadius:h,outerRadius:f,arcLabelRadius:n,cornerRadius:i,paddingAngle:m,id:c,highlighted:o,faded:a,data:s});if(s.length===0)return null;const I=(E==null?void 0:E.pieArcLabel)??PieArcLabel;return jsxRuntimeExports.jsx("g",_extends({},A,{children:C.map(b=>jsxRuntimeExports.jsx(I,_extends({startAngle:b.startAngle,endAngle:b.endAngle,paddingAngle:b.paddingAngle,innerRadius:b.innerRadius,outerRadius:b.outerRadius,arcLabelRadius:b.arcLabelRadius,cornerRadius:b.cornerRadius,id:c,color:b.color,isFaded:b.isFaded,isHighlighted:b.isHighlighted,formattedArcLabel:getItemLabel(e,t,b),skipAnimation:g??!1},_==null?void 0:_.pieArcLabel),b.id??b.dataIndex))}))}function getPercentageValue(r,e){if(typeof r=="number")return r;if(r==="100%")return e;if(r.endsWith("%")){const t=Number.parseFloat(r.slice(0,r.length-1));if(!Number.isNaN(t))return t*e/100}if(r.endsWith("px")){const t=Number.parseFloat(r.slice(0,r.length-2));if(!Number.isNaN(t))return t}throw new Error(`MUI X Charts: Received an unknown value "${r}". It should be a number, or a string with a percentage value.`)}function getPieCoordinates(r,e){const{height:t,width:n}=e,{cx:i,cy:s}=r,a=Math.min(n,t)/2,o=getPercentageValue(i??"50%",n),c=getPercentageValue(s??"50%",t);return{cx:o,cy:c,availableRadius:a}}function getPieUtilityClass(r){return generateUtilityClass("MuiPieChart",r)}generateUtilityClasses("MuiPieChart",["root","series","seriesLabels"]);const useUtilityClasses=r=>composeClasses({root:["root"],series:["series"],seriesLabels:["seriesLabels"]},getPieUtilityClass,r);function PiePlot(r){const{skipAnimation:e,slots:t,slotProps:n,onItemClick:i}=r,s=usePieSeriesContext(),{left:a,top:o,width:c,height:h}=useDrawingArea(),f=useSkipAnimation(e),m=useUtilityClasses();if(s===void 0)return null;const{series:g,seriesOrder:_}=s;return jsxRuntimeExports.jsxs("g",{children:[_.map(E=>{const{innerRadius:A,outerRadius:C,cornerRadius:I,paddingAngle:b,data:R,cx:V,cy:U,highlighted:W,faded:j}=g[E],{cx:w,cy:P,availableRadius:K}=getPieCoordinates({cx:V,cy:U},{width:c,height:h}),X=getPercentageValue(C??K,K),Y=getPercentageValue(A??0,K);return jsxRuntimeExports.jsx("g",{className:m.series,transform:`translate(${a+w}, ${o+P})`,"data-series":E,children:jsxRuntimeExports.jsx(PieArcPlot,{innerRadius:Y,outerRadius:X,cornerRadius:I,paddingAngle:b,id:E,data:R,skipAnimation:f,highlighted:W,faded:j,onItemClick:i,slots:t,slotProps:n})},E)}),_.map(E=>{const{innerRadius:A,outerRadius:C,arcLabelRadius:I,cornerRadius:b,paddingAngle:R,arcLabel:V,arcLabelMinAngle:U,data:W,cx:j,cy:w}=g[E],{cx:P,cy:K,availableRadius:X}=getPieCoordinates({cx:j,cy:w},{width:c,height:h}),Y=getPercentageValue(C??X,X),Z=getPercentageValue(A??0,X),ae=I===void 0?(Y+Z)/2:getPercentageValue(I,X);return jsxRuntimeExports.jsx("g",{className:m.seriesLabels,transform:`translate(${a+P}, ${o+K})`,"data-series":E,children:jsxRuntimeExports.jsx(PieArcLabelPlot,{innerRadius:Z,outerRadius:Y??X,arcLabelRadius:ae,cornerRadius:b,paddingAngle:R,id:E,data:W,skipAnimation:f,arcLabel:V,arcLabelMinAngle:U,slots:t,slotProps:n})},E)})]})}const PIE_CHART_PLUGINS=[useChartInteraction,useChartHighlight],_excluded=["series","width","height","margin","colors","sx","skipAnimation","hideLegend","children","slots","slotProps","onItemClick","loading","highlightedItem","onHighlightChange","className","showToolbar"],PieChart=reactExports.forwardRef(function r(e,t){var X,Y,Z,ae,le,ie,se,ce;const n=useThemeProps({props:e,name:"MuiPieChart"}),{series:i,width:s,height:a,margin:o,colors:c,sx:h,skipAnimation:f,hideLegend:m,children:g,slots:_,slotProps:E,onItemClick:A,loading:C,highlightedItem:I,onHighlightChange:b,className:R,showToolbar:V}=n,U=_objectWithoutPropertiesLoose(n,_excluded),W=defaultizeMargin(o,DEFAULT_PIE_CHART_MARGIN),{chartDataProviderProps:j,chartsSurfaceProps:w}=useChartContainerProps(_extends({},U,{series:i.map(ue=>_extends({type:"pie"},ue)),width:s,height:a,margin:W,colors:c,highlightedItem:I,onHighlightChange:b,className:R,skipAnimation:f,plugins:PIE_CHART_PLUGINS}),t),P=(_==null?void 0:_.tooltip)??ChartsTooltip,K=(X=n.slots)==null?void 0:X.toolbar;return jsxRuntimeExports.jsx(ChartDataProvider,_extends({},j,{children:jsxRuntimeExports.jsxs(ChartsWrapper,{legendPosition:(Z=(Y=n.slotProps)==null?void 0:Y.legend)==null?void 0:Z.position,legendDirection:((le=(ae=n==null?void 0:n.slotProps)==null?void 0:ae.legend)==null?void 0:le.direction)??"vertical",sx:h,children:[V&&K?jsxRuntimeExports.jsx(K,_extends({},(ie=n.slotProps)==null?void 0:ie.toolbar)):null,!m&&jsxRuntimeExports.jsx(ChartsLegend,{direction:((ce=(se=n==null?void 0:n.slotProps)==null?void 0:se.legend)==null?void 0:ce.direction)??"vertical",slots:_,slotProps:E}),jsxRuntimeExports.jsxs(ChartsSurface,_extends({},w,{children:[jsxRuntimeExports.jsx(PiePlot,{slots:_,slotProps:E,onItemClick:A}),jsxRuntimeExports.jsx(ChartsOverlay,{loading:C,slots:_,slotProps:E}),g]})),!C&&jsxRuntimeExports.jsx(P,_extends({trigger:"item"},E==null?void 0:E.tooltip))]})}))});function Stats(){const{loading:r,error:e,summary:t,tagStats:n,monthlyFinished:i,monthlyAddedBooks:s,monthlyMemos:a,topAuthors:o,topPublishers:c,statusDistribution:h}=useStats(),f=t&&(t.totalBooks>0||t.finishedBooks>0||t.readingBooks>0||t.tsundokuBooks>0||t.reReadingBooks>0);return jsxRuntimeExports.jsxs(Box,{sx:{maxWidth:1200,mx:"auto",mb:10},children:[jsxRuntimeExports.jsx(PageHeader,{title:"統計",subtitle:"あなたの読書活動を可視化"}),jsxRuntimeExports.jsxs(Box,{sx:{p:2},children:[r&&jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[jsxRuntimeExports.jsx(CircularProgress,{size:20}),jsxRuntimeExports.jsx(Typography,{variant:"body2",children:"読み込み中..."})]}),e&&jsxRuntimeExports.jsx(Typography,{color:"error",sx:{mb:2},children:e}),!r&&!e&&!f&&jsxRuntimeExports.jsx(Card,{sx:{mb:2},children:jsxRuntimeExports.jsxs(CardContent,{sx:{textAlign:"center",py:4},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"📚 読書データがありません"}),jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"本を追加して読書を始めると、ここに統計が表示されます"})]})}),f&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(Box,{className:"stats-summary-grid",children:[jsxRuntimeExports.jsx(Card,{"data-testid":"stats-total-books",className:"stats-summary-card",children:jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",children:"総冊数"}),jsxRuntimeExports.jsx(Typography,{variant:"h4",sx:{fontWeight:"bold"},children:(t==null?void 0:t.totalBooks)??"-"})]})}),jsxRuntimeExports.jsx(Card,{"data-testid":"stats-tsundoku-books",className:"stats-summary-card",children:jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",children:"積読冊数"}),jsxRuntimeExports.jsx(Typography,{variant:"h4",sx:{fontWeight:"bold"},children:(t==null?void 0:t.tsundokuBooks)??"-"})]})}),jsxRuntimeExports.jsx(Card,{"data-testid":"stats-reading-books",className:"stats-summary-card",children:jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",children:"読書中冊数"}),jsxRuntimeExports.jsx(Typography,{variant:"h4",sx:{fontWeight:"bold"},children:(t==null?void 0:t.readingBooks)??"-"})]})}),jsxRuntimeExports.jsx(Card,{"data-testid":"stats-rereading-books",className:"stats-summary-card",children:jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",children:"再読中冊数"}),jsxRuntimeExports.jsx(Typography,{variant:"h4",sx:{fontWeight:"bold"},children:(t==null?void 0:t.reReadingBooks)??"-"})]})}),jsxRuntimeExports.jsx(Card,{"data-testid":"stats-finished-books",className:"stats-summary-card",children:jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",children:"読了冊数"}),jsxRuntimeExports.jsx(Typography,{variant:"h4",sx:{fontWeight:"bold"},children:(t==null?void 0:t.finishedBooks)??"-"})]})})]}),!!t&&jsxRuntimeExports.jsx(Card,{sx:{mb:2},"data-testid":"chart-status-pie",children:jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:1},children:"ステータス内訳"}),jsxRuntimeExports.jsx(PieChart,{height:220,series:[{data:[{id:"tsundoku",label:"積読",value:(h==null?void 0:h.tsundoku)??0},{id:"reading",label:"読書中",value:(h==null?void 0:h.reading)??0},{id:"reReading",label:"再読中",value:(h==null?void 0:h.reReading)??0},{id:"finished",label:"読了",value:(h==null?void 0:h.finished)??0}],innerRadius:30,paddingAngle:2}]})]})}),jsxRuntimeExports.jsx(Divider,{sx:{my:2}}),jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:1},children:"月別読了冊数（直近12ヶ月）"}),jsxRuntimeExports.jsx(Card,{sx:{mb:2},"data-testid":"chart-monthly-finished",children:jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx(BarChart,{xAxis:[{scaleType:"band",data:(i??[]).map(m=>m.key)}],series:[{data:(i??[]).map(m=>m.count),label:"読了冊数"}],height:260})})}),jsxRuntimeExports.jsxs(Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",md:"1fr 1fr"},gap:2,mb:2},children:[jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle1",sx:{mb:1},children:"月別追加冊数（直近12ヶ月）"}),jsxRuntimeExports.jsx(Card,{"data-testid":"chart-monthly-added",children:jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx(BarChart,{xAxis:[{scaleType:"band",data:(s??[]).map(m=>m.key)}],series:[{data:(s??[]).map(m=>m.count),label:"追加冊数",color:"#42a5f5"}],height:220})})})]}),jsxRuntimeExports.jsxs(Box,{children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle1",sx:{mb:1},children:"月別メモ数（直近12ヶ月）"}),jsxRuntimeExports.jsx(Card,{"data-testid":"chart-monthly-memos",children:jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx(BarChart,{xAxis:[{scaleType:"band",data:(a??[]).map(m=>m.key)}],series:[{data:(a??[]).map(m=>m.count),label:"メモ数",color:"#9c27b0"}],height:220})})})]})]}),jsxRuntimeExports.jsx(Divider,{sx:{my:2}}),jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:1},children:"タグ使用頻度（上位）"}),!!(n!=null&&n.length)&&jsxRuntimeExports.jsx(Card,{sx:{mb:2},"data-testid":"chart-tag-pie",children:jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsx(PieChart,{height:260,series:[{data:n.slice(0,6).map(m=>({id:m.tag,label:m.tag,value:m.totalCount})),innerRadius:40,paddingAngle:2}]})})}),jsxRuntimeExports.jsxs(Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:2},children:[((n==null?void 0:n.slice(0,10))??[]).map(m=>jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(Card,{"data-testid":`tag-stat-${m.tag}`,children:jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle1",sx:{fontWeight:600},children:m.tag}),jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"text.secondary",children:["本: ",m.bookCount," / メモ: ",m.memoCount," / 合計: ",m.totalCount]})]})})},m.tag)),(!n||n.length===0)&&!r&&jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"タグデータがありません。"})})]}),jsxRuntimeExports.jsx(Divider,{sx:{my:2}}),jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:1},children:"著者トップ"}),jsxRuntimeExports.jsxs(Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:2,mb:2},children:[((o==null?void 0:o.slice(0,10))??[]).map(m=>jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(Card,{"data-testid":`author-top-${m.author}`,children:jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle1",sx:{fontWeight:600},children:m.author}),jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"text.secondary",children:["冊数: ",m.total]})]})})},m.author)),(!o||o.length===0)&&!r&&jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"著者データがありません。"})})]}),jsxRuntimeExports.jsx(Typography,{variant:"h6",sx:{mb:1},children:"出版社トップ"}),jsxRuntimeExports.jsxs(Box,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"1fr 1fr"},gap:2},children:[((c==null?void 0:c.slice(0,10))??[]).map(m=>jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(Card,{"data-testid":`publisher-top-${m.publisher}`,children:jsxRuntimeExports.jsxs(CardContent,{children:[jsxRuntimeExports.jsx(Typography,{variant:"subtitle1",sx:{fontWeight:600},children:m.publisher}),jsxRuntimeExports.jsxs(Typography,{variant:"body2",color:"text.secondary",children:["冊数: ",m.total]})]})})},m.publisher)),(!c||c.length===0)&&!r&&jsxRuntimeExports.jsx(Box,{children:jsxRuntimeExports.jsx(Typography,{variant:"body2",color:"text.secondary",children:"出版社データがありません。"})})]})]})]})]})}function MyPage(){const r=useSwipeable({onSwipedLeft:()=>alert("左スワイプ!"),onSwipedRight:()=>alert("右スワイプ!"),preventDefaultTouchmoveEvent:!0,trackMouse:!0});return jsxRuntimeExports.jsxs("div",{style:{maxWidth:400,margin:"40px auto"},children:[jsxRuntimeExports.jsx("h2",{children:"react-swipeable サンプル"}),jsxRuntimeExports.jsx("div",{...r,style:{background:"#fff",border:"1px solid #ccc",padding:48,fontSize:18,textAlign:"center",userSelect:"none"},children:"このエリアを左右にスワイプ（またはドラッグ）してみてください"})]})}const PWAInstallPrompt=()=>{if(!(typeof window<"u"&&"serviceWorker"in navigator&&"PushManager"in window))return null;try{const{isOnline:e,isInstallable:t,isInstalled:n,installApp:i,shouldShowInstallPrompt:s,shouldShowManualInstallGuide:a,recordInstallPromptDismiss:o}=usePWA(),[c,h]=reactExports.useState(!1),[f,m]=reactExports.useState(!1),[g,_]=reactExports.useState(!1),[E,A]=reactExports.useState(!1);reactExports.useEffect(()=>{t&&!n&&s?_(!0):t&&!n&&h(!0)},[t,n,s]),reactExports.useEffect(()=>{a&&!n&&A(!0)},[a,n]),reactExports.useEffect(()=>{m(!e)},[e]);const C=async()=>{try{await i(),h(!1),_(!1)}catch(W){console.error("Installation failed:",W)}},I=()=>{h(!1),o&&o()},b=()=>{_(!1),o&&o()},R=()=>{m(!1)},V=()=>{A(!1),o&&o()},U=[{icon:jsxRuntimeExports.jsx(SpeedIcon,{}),title:"高速起動",description:"アプリのように素早く起動"},{icon:jsxRuntimeExports.jsx(StorageIcon,{}),title:"オフライン対応",description:"インターネットなしでも利用可能"},{icon:jsxRuntimeExports.jsx(StarIcon,{}),title:"ホーム画面に追加",description:"いつでも簡単にアクセス"}];return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Snackbar,{open:c,anchorOrigin:{vertical:"bottom",horizontal:"center"},sx:{mb:8},children:jsxRuntimeExports.jsx(Alert,{severity:"info",action:jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",alignItems:"center",gap:1},children:[jsxRuntimeExports.jsx(Button,{color:"inherit",size:"small",startIcon:jsxRuntimeExports.jsx(InstallIcon,{}),onClick:C,"data-testid":"pwa-install-button",variant:"contained",sx:{backgroundColor:"primary.main",color:"white","&:hover":{backgroundColor:"primary.dark"}},children:"インストール"}),jsxRuntimeExports.jsx(IconButton,{"aria-label":"close",color:"inherit",size:"small",onClick:I,children:jsxRuntimeExports.jsx(CloseIcon,{fontSize:"inherit"})})]}),sx:{width:"100%"},children:jsxRuntimeExports.jsx(Typography,{variant:"body2",children:"BookMemoをホーム画面に追加して、より快適にご利用いただけます"})})}),jsxRuntimeExports.jsx(Snackbar,{open:g,anchorOrigin:{vertical:"bottom",horizontal:"center"},sx:{mb:8,width:"100%",maxWidth:"600px"},children:jsxRuntimeExports.jsx(Card,{sx:{width:"100%",boxShadow:3},children:jsxRuntimeExports.jsxs(CardContent,{sx:{p:2},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",component:"h2",sx:{fontWeight:"bold"},children:"📱 BookMemoをアプリとしてインストール"}),jsxRuntimeExports.jsx(IconButton,{size:"small",onClick:b,sx:{mt:-.5},children:jsxRuntimeExports.jsx(CloseIcon,{})})]}),jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:"より快適な読書メモ管理体験をお届けします"}),jsxRuntimeExports.jsx(Stack,{direction:"row",spacing:1,sx:{mb:2,flexWrap:"wrap",gap:1},children:U.map((W,j)=>jsxRuntimeExports.jsx(Chip,{icon:W.icon,label:W.title,size:"small",variant:"outlined",sx:{fontSize:"0.75rem"}},j))}),jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[jsxRuntimeExports.jsx(Button,{variant:"outlined",size:"small",onClick:b,children:"後で"}),jsxRuntimeExports.jsx(Button,{variant:"contained",size:"small",startIcon:jsxRuntimeExports.jsx(InstallIcon,{}),onClick:C,sx:{backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:"今すぐインストール"})]})]})})}),jsxRuntimeExports.jsx(Snackbar,{open:f,anchorOrigin:{vertical:"top",horizontal:"center"},children:jsxRuntimeExports.jsx(Alert,{severity:"warning",icon:jsxRuntimeExports.jsx(OfflineIcon,{}),action:jsxRuntimeExports.jsx(IconButton,{"aria-label":"close",color:"inherit",size:"small",onClick:R,children:jsxRuntimeExports.jsx(CloseIcon,{fontSize:"inherit"})}),sx:{width:"100%"},children:jsxRuntimeExports.jsx(Typography,{variant:"body2",children:"オフラインです。一部の機能が制限される場合があります"})})}),jsxRuntimeExports.jsx(Snackbar,{open:e&&f,anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:3e3,onClose:R,children:jsxRuntimeExports.jsx(Alert,{severity:"success",icon:jsxRuntimeExports.jsx(OnlineIcon,{}),sx:{width:"100%"},children:jsxRuntimeExports.jsx(Typography,{variant:"body2",children:"オンラインに復帰しました"})})}),jsxRuntimeExports.jsx(Snackbar,{open:E,anchorOrigin:{vertical:"bottom",horizontal:"center"},sx:{mb:8,width:"100%",maxWidth:"600px"},children:jsxRuntimeExports.jsx(Card,{sx:{width:"100%",boxShadow:3},children:jsxRuntimeExports.jsxs(CardContent,{sx:{p:2},children:[jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"h6",component:"h2",sx:{fontWeight:"bold"},children:"📱 BookMemoをホーム画面に追加"}),jsxRuntimeExports.jsx(IconButton,{size:"small",onClick:V,sx:{mt:-.5},children:jsxRuntimeExports.jsx(CloseIcon,{})})]}),jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{mb:2,color:"text.secondary"},children:"iPhoneでBookMemoをアプリとして使用するには、以下の手順でホーム画面に追加してください："}),jsxRuntimeExports.jsxs(Box,{sx:{mb:2},children:[jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{fontWeight:"bold",mb:1},children:"1. 共有ボタンをタップ"}),jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{mb:1,pl:2},children:"Safariの下部にある「共有」ボタン（□↑）をタップします"}),jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{fontWeight:"bold",mb:1},children:"2. 「ホーム画面に追加」を選択"}),jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{mb:1,pl:2},children:"共有メニューから「ホーム画面に追加」を選択します"}),jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{fontWeight:"bold",mb:1},children:"3. 追加を確認"}),jsxRuntimeExports.jsx(Typography,{variant:"body2",sx:{pl:2},children:"「追加」をタップしてホーム画面に追加します"})]}),jsxRuntimeExports.jsx(Stack,{direction:"row",spacing:1,sx:{mb:2,flexWrap:"wrap",gap:1},children:U.map((W,j)=>jsxRuntimeExports.jsx(Chip,{icon:W.icon,label:W.title,size:"small",variant:"outlined",sx:{fontSize:"0.75rem"}},j))}),jsxRuntimeExports.jsxs(Box,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[jsxRuntimeExports.jsx(Button,{variant:"outlined",size:"small",onClick:V,children:"後で"}),jsxRuntimeExports.jsx(Button,{variant:"contained",size:"small",onClick:V,sx:{backgroundColor:"primary.main","&:hover":{backgroundColor:"primary.dark"}},children:"手順を確認しました"})]})]})})})]})}catch(e){return console.warn("PWA hook error in PWAInstallPrompt, skipping PWA features:",e),null}},checkReactContext=()=>{try{return!(typeof React>"u"||!React.useState||!React.useContext||typeof window>"u"||typeof navigator>"u")}catch(r){return console.warn("React context check failed:",r),!1}},withReactContext=r=>function(t){const[n,i]=React.useState(!1),[s,a]=React.useState(0),o=20,c=50;return React.useEffect(()=>{const h=()=>{if(checkReactContext()){i(!0);return}s<o?(a(f=>f+1),setTimeout(h,c)):(console.warn("React context initialization timeout, proceeding with fallback"),i(!0))};h()},[s]),n?jsxRuntimeExports.jsx(r,{...t}):jsxRuntimeExports.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",fontSize:"1rem",color:"#666"},children:"読み込み中..."})},appTheme=createTheme({palette:{primary:{main:"#1976d2"},secondary:{main:"#dc004e"}},typography:{h4:{fontSize:"1.5rem","@media (min-width:600px)":{fontSize:"2rem"}},h6:{fontSize:"1rem","@media (min-width:600px)":{fontSize:"1.1rem"}},body2:{fontSize:"0.8rem","@media (min-width:600px)":{fontSize:"0.9rem"}},caption:{fontSize:"0.7rem","@media (min-width:600px)":{fontSize:"0.8rem"}}},components:{MuiCard:{styleOverrides:{root:{height:"100%",display:"flex",flexDirection:"column"}}},MuiCardContent:{styleOverrides:{root:{flex:1,display:"flex",flexDirection:"column",padding:"12px","@media (min-width:600px)":{padding:"16px"}}}},MuiTextField:{styleOverrides:{root:{"& .MuiInputBase-root":{fontSize:"0.9rem","@media (min-width:600px)":{fontSize:"1rem"}}}}},MuiButton:{styleOverrides:{root:{fontSize:"0.9rem",padding:"8px 16px","@media (min-width:600px)":{fontSize:"1rem",padding:"10px 20px"}}}},MuiChip:{styleOverrides:{root:{fontSize:"0.7rem",height:"20px","@media (min-width:600px)":{fontSize:"0.8rem",height:"24px"}}}},MuiBottomNavigation:{styleOverrides:{root:{height:"64px","@media (min-width:600px)":{height:"72px"}}}},MuiBottomNavigationAction:{styleOverrides:{root:{fontSize:"0.7rem","@media (min-width:600px)":{fontSize:"0.8rem"}}}}}}),ErrorLogger={saveError:(r,e="")=>{try{const t={timestamp:new Date().toISOString(),error:(r==null?void 0:r.message)||(r==null?void 0:r.toString())||"Unknown error",stack:(r==null?void 0:r.stack)||"",context:e,url:typeof window<"u"?window.location.href:"",userAgent:typeof navigator<"u"?navigator.userAgent:""},n=JSON.parse(localStorage.getItem("bookmemo_error_logs")||"[]");return n.push(t),n.length>10&&n.splice(0,n.length-10),localStorage.setItem("bookmemo_error_logs",JSON.stringify(n)),console.error("🔴 PERSISTENT ERROR LOG:",t),t}catch(t){console.error("Error saving error log:",t)}},getErrors:()=>{try{return JSON.parse(localStorage.getItem("bookmemo_error_logs")||"[]")}catch{return[]}},clearErrors:()=>{localStorage.removeItem("bookmemo_error_logs")}},setupGlobalErrorHandling=()=>{typeof window>"u"||(window.addEventListener("error",r=>{ErrorLogger.saveError(r.error,"Global Error Handler")}),window.addEventListener("unhandledrejection",r=>{ErrorLogger.saveError(r.reason,"Unhandled Promise Rejection")}),window.addEventListener("beforeunload",()=>{ErrorLogger.getErrors().length>0&&console.log("📋 Error logs available in localStorage: bookmemo_error_logs")}))};function PrivateRoute({children:r}){const{user:e,loading:t}=useAuth(),n=useLocation();return reactExports.useEffect(()=>{!t&&!e&&console.warn("🔐 Authentication required for:",n.pathname)},[e,t,n.pathname]),t?(console.log("⏳ Loading authentication state..."),jsxRuntimeExports.jsx("div",{children:"Loading..."})):e?r:(console.warn("🚫 Unauthenticated access attempt, redirecting to login"),jsxRuntimeExports.jsx(Navigate,{to:"/login"}))}function AppBottomNav(){const r=useNavigate(),e=useLocation(),[t,n]=reactExports.useState(0);return reactExports.useEffect(()=>{e.pathname.startsWith("/add")?n(1):e.pathname.startsWith("/tags")?n(2):e.pathname.startsWith("/stats")?n(3):e.pathname.startsWith("/mypage")?n(4):n(0)},[e.pathname]),jsxRuntimeExports.jsxs(BottomNavigation,{value:t,onChange:(i,s)=>{n(s),s===0&&r("/"),s===1&&r("/add"),s===2&&r("/tags"),s===3&&r("/stats"),s===4&&r("/mypage")},showLabels:!0,sx:{position:"fixed",bottom:0,left:0,right:0,zIndex:1e3,backgroundColor:"background.paper",borderTop:1,borderColor:"divider",height:{xs:"64px",sm:"72px"},"& .MuiBottomNavigationAction-root":{minWidth:{xs:"60px",sm:"80px"},padding:{xs:"6px 4px",sm:"8px 6px"}},"& .MuiBottomNavigationAction-label":{fontSize:{xs:"0.7rem",sm:"0.8rem"},marginTop:{xs:"2px",sm:"4px"}},"& .MuiBottomNavigationAction-iconOnly":{fontSize:{xs:"1.5rem",sm:"1.75rem"}}},children:[jsxRuntimeExports.jsx(BottomNavigationAction,{label:"本一覧",icon:jsxRuntimeExports.jsx(LibraryBooksIcon,{}),sx:{"&.Mui-selected":{color:"primary.main"}}}),jsxRuntimeExports.jsx(BottomNavigationAction,{label:"本を追加",icon:jsxRuntimeExports.jsx(AddCircleIcon,{}),sx:{"&.Mui-selected":{color:"primary.main"}}}),jsxRuntimeExports.jsx(BottomNavigationAction,{label:"検索・タグ",icon:jsxRuntimeExports.jsx(SearchIcon,{}),sx:{"&.Mui-selected":{color:"primary.main"}}}),jsxRuntimeExports.jsx(BottomNavigationAction,{label:"統計",icon:jsxRuntimeExports.jsx(BarChartIcon,{}),sx:{"&.Mui-selected":{color:"primary.main"}}}),jsxRuntimeExports.jsx(BottomNavigationAction,{label:"マイページ",icon:jsxRuntimeExports.jsx(PersonIcon,{}),sx:{"&.Mui-selected":{color:"primary.main"}}})]})}function AppRoutes(){const r=useLocation(),{user:e}=useAuth(),{setGlobalError:t}=reactExports.useContext(ErrorDialogContext),n=r.pathname.startsWith("/login")||r.pathname.startsWith("/signup")||!e;return reactExports.useEffect(()=>{setupGlobalErrorHandling()},[]),reactExports.useEffect(()=>{const i=document.getElementById("app-scroll-container");i&&i.scrollTo(0,0)},[r.pathname]),reactExports.useEffect(()=>{const i=c=>{console.error("Global error caught:",c.error),ErrorLogger.saveError(c.error,"AppRoutes Global Error"),c.error&&c.error.message&&c.error.message.includes("404")?t&&t("リソースが見つかりません。ページを再読み込みしてください。"):t&&t("予期しないエラーが発生しました。ページを再読み込みしてください。")},s=c=>{console.error("Unhandled promise rejection:",c.reason),ErrorLogger.saveError(c.reason,"AppRoutes Unhandled Promise Rejection"),c.reason&&c.reason.message&&(c.reason.message.includes("404")||c.reason.message.includes("Failed to fetch")),t&&t("ネットワークエラーが発生しました。接続を確認してください。")},a=c=>{c.target&&c.target.src&&(console.error("Resource loading error:",c.target.src),ErrorLogger.saveError(new Error(`Resource loading failed: ${c.target.src}`),"AppRoutes Resource Error"),(c.target.src.includes("sw.js")||c.target.src.includes("manifest.webmanifest"))&&t&&t("アプリの設定ファイルの読み込みに失敗しました。ページを再読み込みしてください。"))},o=c=>{c.target&&c.target.src&&c.target.src.includes("404")&&(console.error("404 Error detected:",c.target.src),ErrorLogger.saveError(new Error(`404 Error: ${c.target.src} - SPA routing issue detected`),"AppRoutes 404 Error"),t&&t("ページが見つかりません。SPAルーティングの問題の可能性があります。ページを再読み込みしてください。"))};return window.addEventListener("error",o,!0),window.addEventListener("error",i),window.addEventListener("unhandledrejection",s),window.addEventListener("error",a,!0),()=>{window.removeEventListener("error",i),window.removeEventListener("unhandledrejection",s),window.removeEventListener("error",a,!0)}},[t]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Box,{id:"app-scroll-container",sx:{height:"100vh",overflowY:"auto",WebkitOverflowScrolling:"touch",pb:n?0:{xs:"64px",sm:"72px"},background:`
            url('${PATHS.PAPER_TEXTURE()}'),
            #f5f5dc
          `,backgroundSize:"100% auto, cover",backgroundRepeat:"repeat-y, no-repeat",backgroundPosition:"center top, center",backgroundAttachment:"fixed",minHeight:"100vh",width:"100%"},children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/login",element:jsxRuntimeExports.jsx(Login,{})}),jsxRuntimeExports.jsx(Route,{path:"/signup",element:jsxRuntimeExports.jsx(Signup,{})}),jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(PrivateRoute,{children:jsxRuntimeExports.jsx(BookList,{})})}),jsxRuntimeExports.jsx(Route,{path:"/add",element:jsxRuntimeExports.jsx(PrivateRoute,{children:jsxRuntimeExports.jsx(BookAdd,{})})}),jsxRuntimeExports.jsx(Route,{path:"/book/:id",element:jsxRuntimeExports.jsx(PrivateRoute,{children:jsxRuntimeExports.jsx(BookDetail,{})})}),jsxRuntimeExports.jsx(Route,{path:"/tags",element:jsxRuntimeExports.jsx(PrivateRoute,{children:jsxRuntimeExports.jsx(TagSearch,{})})}),jsxRuntimeExports.jsx(Route,{path:"/stats",element:jsxRuntimeExports.jsx(PrivateRoute,{children:jsxRuntimeExports.jsx(Stats,{})})}),jsxRuntimeExports.jsx(Route,{path:"/mypage",element:jsxRuntimeExports.jsx(PrivateRoute,{children:jsxRuntimeExports.jsx(MyPage,{})})}),jsxRuntimeExports.jsx(Route,{path:"*",element:jsxRuntimeExports.jsx(Navigate,{to:"/"})})]})}),!n&&jsxRuntimeExports.jsx(AppBottomNav,{})]})}function App(){return jsxRuntimeExports.jsx(AuthProvider,{children:jsxRuntimeExports.jsx(ErrorDialogProvider,{children:jsxRuntimeExports.jsx(HashRouter,{children:jsxRuntimeExports.jsxs(ThemeProvider,{theme:appTheme,children:[jsxRuntimeExports.jsx(CssBaseline,{}),jsxRuntimeExports.jsx(PWAProvider,{}),jsxRuntimeExports.jsx(AppRoutes,{}),typeof window<"u"&&"serviceWorker"in navigator&&!PATHS.IS_DEVELOPMENT()&&jsxRuntimeExports.jsx(PWAInstallPrompt,{})]})})})})}function PWAProvider(){if(PATHS.IS_DEVELOPMENT()||!("serviceWorker"in navigator&&"PushManager"in window))return null;try{const{registerServiceWorker:e}=usePWA();return reactExports.useEffect(()=>{e().catch(t=>{console.warn("Service Worker registration failed in PWAProvider:",t),ErrorLogger.saveError(t,"PWAProvider Service Worker Registration")})},[e]),null}catch(e){return console.warn("PWA hook error, skipping PWA initialization:",e),ErrorLogger.saveError(e,"PWAProvider Hook Error"),null}}const App$1=withReactContext(App),theme=createTheme({palette:{mode:"light",background:{default:"#f5f7fa",paper:"#fff"},primary:{main:"#1976d2"},secondary:{main:"#f50057"},text:{primary:"#222"}},typography:{fontFamily:"Segoe UI, Helvetica Neue, Arial, sans-serif",h1:{fontSize:"1.8rem","@media (min-width:600px)":{fontSize:"2.5rem"}},h2:{fontSize:"1.5rem","@media (min-width:600px)":{fontSize:"2rem"}},h3:{fontSize:"1.3rem","@media (min-width:600px)":{fontSize:"1.6rem"}},h4:{fontSize:"1.1rem","@media (min-width:600px)":{fontSize:"1.4rem"}},h5:{fontSize:"1rem","@media (min-width:600px)":{fontSize:"1.2rem"}},h6:{fontSize:"0.9rem","@media (min-width:600px)":{fontSize:"1.1rem"}},body1:{fontSize:"0.9rem","@media (min-width:600px)":{fontSize:"1rem"}},body2:{fontSize:"0.8rem","@media (min-width:600px)":{fontSize:"0.9rem"}}},components:{MuiTextField:{styleOverrides:{root:{marginBottom:"8px","@media (min-width:600px)":{marginBottom:"16px"}}},defaultProps:{size:"small",margin:"dense"}},MuiButton:{styleOverrides:{root:{fontSize:"0.9rem",padding:"8px 16px","@media (min-width:600px)":{fontSize:"1rem",padding:"10px 20px"}}},defaultProps:{size:"medium"}},MuiCard:{styleOverrides:{root:{marginBottom:"8px","@media (min-width:600px)":{marginBottom:"16px"}}}},MuiCardContent:{styleOverrides:{root:{padding:"12px","@media (min-width:600px)":{padding:"16px"},"&:last-child":{paddingBottom:"12px","@media (min-width:600px)":{paddingBottom:"16px"}}}}},MuiPaper:{styleOverrides:{root:{padding:"12px","@media (min-width:600px)":{padding:"16px"}}}},MuiAutocomplete:{styleOverrides:{root:{marginBottom:"8px","@media (min-width:600px)":{marginBottom:"16px"}}}},MuiChip:{styleOverrides:{root:{fontSize:"0.8rem",height:"24px","@media (min-width:600px)":{fontSize:"0.9rem",height:"32px"}}}},MuiDialog:{styleOverrides:{paper:{margin:"16px",width:"calc(100% - 32px)",maxWidth:"400px","@media (min-width:600px)":{margin:"32px",width:"calc(100% - 64px)",maxWidth:"600px"}}}},MuiBottomNavigation:{styleOverrides:{root:{height:"56px","@media (min-width:600px)":{height:"64px"}}}}},breakpoints:{values:{xs:0,sm:600,md:900,lg:1200,xl:1536}},spacing:r=>`${4*r}px`});clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(ThemeProvider,{theme,children:jsxRuntimeExports.jsx(App$1,{})})}));
